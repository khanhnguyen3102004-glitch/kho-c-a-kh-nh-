(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function VE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yp={exports:{}},cf={};var Vy;function hC(){if(Vy)return cf;Vy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:o}}return cf.Fragment=e,cf.jsx=r,cf.jsxs=r,cf}var By;function dC(){return By||(By=1,yp.exports=hC()),yp.exports}var y=dC(),wp={exports:{}},pt={};var Uy;function mC(){if(Uy)return pt;Uy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function w(K){return K===null||typeof K!="object"?null:(K=_&&K[_]||K["@@iterator"],typeof K=="function"?K:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,A={};function L(K,M,q){this.props=K,this.context=M,this.refs=A,this.updater=q||S}L.prototype.isReactComponent={},L.prototype.setState=function(K,M){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,M,"setState")},L.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function U(){}U.prototype=L.prototype;function N(K,M,q){this.props=K,this.context=M,this.refs=A,this.updater=q||S}var Q=N.prototype=new U;Q.constructor=N,E(Q,L.prototype),Q.isPureReactComponent=!0;var re=Array.isArray;function ee(){}var k={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function R(K,M,q){var G=q.ref;return{$$typeof:t,type:K,key:M,ref:G!==void 0?G:null,props:q}}function O(K,M){return R(K.type,M,K.props)}function F(K){return typeof K=="object"&&K!==null&&K.$$typeof===t}function D(K){var M={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(q){return M[q]})}var V=/\/+/g;function Te(K,M){return typeof K=="object"&&K!==null&&K.key!=null?D(""+K.key):M.toString(36)}function oe(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(ee,ee):(K.status="pending",K.then(function(M){K.status==="pending"&&(K.status="fulfilled",K.value=M)},function(M){K.status==="pending"&&(K.status="rejected",K.reason=M)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function Y(K,M,q,G,J){var le=typeof K;(le==="undefined"||le==="boolean")&&(K=null);var ye=!1;if(K===null)ye=!0;else switch(le){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(K.$$typeof){case t:case e:ye=!0;break;case p:return ye=K._init,Y(ye(K._payload),M,q,G,J)}}if(ye)return J=J(K),ye=G===""?"."+Te(K,0):G,re(J)?(q="",ye!=null&&(q=ye.replace(V,"$&/")+"/"),Y(J,M,q,"",function(Ie){return Ie})):J!=null&&(F(J)&&(J=O(J,q+(J.key==null||K&&K.key===J.key?"":(""+J.key).replace(V,"$&/")+"/")+ye)),M.push(J)),1;ye=0;var be=G===""?".":G+":";if(re(K))for(var Ee=0;Ee<K.length;Ee++)G=K[Ee],le=be+Te(G,Ee),ye+=Y(G,M,q,le,J);else if(Ee=w(K),typeof Ee=="function")for(K=Ee.call(K),Ee=0;!(G=K.next()).done;)G=G.value,le=be+Te(G,Ee++),ye+=Y(G,M,q,le,J);else if(le==="object"){if(typeof K.then=="function")return Y(oe(K),M,q,G,J);throw M=String(K),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.")}return ye}function ne(K,M,q){if(K==null)return K;var G=[],J=0;return Y(K,G,"","",function(le){return M.call(q,le,J++)}),G}function ve(K){if(K._status===-1){var M=K._result;M=M(),M.then(function(q){(K._status===0||K._status===-1)&&(K._status=1,K._result=q)},function(q){(K._status===0||K._status===-1)&&(K._status=2,K._result=q)}),K._status===-1&&(K._status=0,K._result=M)}if(K._status===1)return K._result.default;throw K._result}var ie=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var M=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(M))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},Ce={map:ne,forEach:function(K,M,q){ne(K,function(){M.apply(this,arguments)},q)},count:function(K){var M=0;return ne(K,function(){M++}),M},toArray:function(K){return ne(K,function(M){return M})||[]},only:function(K){if(!F(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return pt.Activity=v,pt.Children=Ce,pt.Component=L,pt.Fragment=r,pt.Profiler=a,pt.PureComponent=N,pt.StrictMode=n,pt.Suspense=h,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,pt.__COMPILER_RUNTIME={__proto__:null,c:function(K){return k.H.useMemoCache(K)}},pt.cache=function(K){return function(){return K.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(K,M,q){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var G=E({},K.props),J=K.key;if(M!=null)for(le in M.key!==void 0&&(J=""+M.key),M)!I.call(M,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&M.ref===void 0||(G[le]=M[le]);var le=arguments.length-2;if(le===1)G.children=q;else if(1<le){for(var ye=Array(le),be=0;be<le;be++)ye[be]=arguments[be+2];G.children=ye}return R(K.type,J,G)},pt.createContext=function(K){return K={$$typeof:l,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:o,_context:K},K},pt.createElement=function(K,M,q){var G,J={},le=null;if(M!=null)for(G in M.key!==void 0&&(le=""+M.key),M)I.call(M,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(J[G]=M[G]);var ye=arguments.length-2;if(ye===1)J.children=q;else if(1<ye){for(var be=Array(ye),Ee=0;Ee<ye;Ee++)be[Ee]=arguments[Ee+2];J.children=be}if(K&&K.defaultProps)for(G in ye=K.defaultProps,ye)J[G]===void 0&&(J[G]=ye[G]);return R(K,le,J)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(K){return{$$typeof:u,render:K}},pt.isValidElement=F,pt.lazy=function(K){return{$$typeof:p,_payload:{_status:-1,_result:K},_init:ve}},pt.memo=function(K,M){return{$$typeof:d,type:K,compare:M===void 0?null:M}},pt.startTransition=function(K){var M=k.T,q={};k.T=q;try{var G=K(),J=k.S;J!==null&&J(q,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(ee,ie)}catch(le){ie(le)}finally{M!==null&&q.types!==null&&(M.types=q.types),k.T=M}},pt.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},pt.use=function(K){return k.H.use(K)},pt.useActionState=function(K,M,q){return k.H.useActionState(K,M,q)},pt.useCallback=function(K,M){return k.H.useCallback(K,M)},pt.useContext=function(K){return k.H.useContext(K)},pt.useDebugValue=function(){},pt.useDeferredValue=function(K,M){return k.H.useDeferredValue(K,M)},pt.useEffect=function(K,M){return k.H.useEffect(K,M)},pt.useEffectEvent=function(K){return k.H.useEffectEvent(K)},pt.useId=function(){return k.H.useId()},pt.useImperativeHandle=function(K,M,q){return k.H.useImperativeHandle(K,M,q)},pt.useInsertionEffect=function(K,M){return k.H.useInsertionEffect(K,M)},pt.useLayoutEffect=function(K,M){return k.H.useLayoutEffect(K,M)},pt.useMemo=function(K,M){return k.H.useMemo(K,M)},pt.useOptimistic=function(K,M){return k.H.useOptimistic(K,M)},pt.useReducer=function(K,M,q){return k.H.useReducer(K,M,q)},pt.useRef=function(K){return k.H.useRef(K)},pt.useState=function(K){return k.H.useState(K)},pt.useSyncExternalStore=function(K,M,q){return k.H.useSyncExternalStore(K,M,q)},pt.useTransition=function(){return k.H.useTransition()},pt.version="19.2.3",pt}var jy;function Bg(){return jy||(jy=1,wp.exports=mC()),wp.exports}var Be=Bg();const Jp=VE(Be);var Tp={exports:{}},uf={},Ep={exports:{}},Sp={};var zy;function pC(){return zy||(zy=1,(function(t){function e(Y,ne){var ve=Y.length;Y.push(ne);e:for(;0<ve;){var ie=ve-1>>>1,Ce=Y[ie];if(0<a(Ce,ne))Y[ie]=ne,Y[ve]=Ce,ve=ie;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ne=Y[0],ve=Y.pop();if(ve!==ne){Y[0]=ve;e:for(var ie=0,Ce=Y.length,K=Ce>>>1;ie<K;){var M=2*(ie+1)-1,q=Y[M],G=M+1,J=Y[G];if(0>a(q,ve))G<Ce&&0>a(J,q)?(Y[ie]=J,Y[G]=ve,ie=G):(Y[ie]=q,Y[M]=ve,ie=M);else if(G<Ce&&0>a(J,ve))Y[ie]=J,Y[G]=ve,ie=G;else break e}}return ne}function a(Y,ne){var ve=Y.sortIndex-ne.sortIndex;return ve!==0?ve:Y.id-ne.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,v=null,_=3,w=!1,S=!1,E=!1,A=!1,L=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function Q(Y){for(var ne=r(d);ne!==null;){if(ne.callback===null)n(d);else if(ne.startTime<=Y)n(d),ne.sortIndex=ne.expirationTime,e(h,ne);else break;ne=r(d)}}function re(Y){if(E=!1,Q(Y),!S)if(r(h)!==null)S=!0,ee||(ee=!0,D());else{var ne=r(d);ne!==null&&oe(re,ne.startTime-Y)}}var ee=!1,k=-1,I=5,R=-1;function O(){return A?!0:!(t.unstable_now()-R<I)}function F(){if(A=!1,ee){var Y=t.unstable_now();R=Y;var ne=!0;try{e:{S=!1,E&&(E=!1,U(k),k=-1),w=!0;var ve=_;try{t:{for(Q(Y),v=r(h);v!==null&&!(v.expirationTime>Y&&O());){var ie=v.callback;if(typeof ie=="function"){v.callback=null,_=v.priorityLevel;var Ce=ie(v.expirationTime<=Y);if(Y=t.unstable_now(),typeof Ce=="function"){v.callback=Ce,Q(Y),ne=!0;break t}v===r(h)&&n(h),Q(Y)}else n(h);v=r(h)}if(v!==null)ne=!0;else{var K=r(d);K!==null&&oe(re,K.startTime-Y),ne=!1}}break e}finally{v=null,_=ve,w=!1}ne=void 0}}finally{ne?D():ee=!1}}}var D;if(typeof N=="function")D=function(){N(F)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Te=V.port2;V.port1.onmessage=F,D=function(){Te.postMessage(null)}}else D=function(){L(F,0)};function oe(Y,ne){k=L(function(){Y(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var ne=3;break;default:ne=_}var ve=_;_=ne;try{return Y()}finally{_=ve}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(Y,ne){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ve=_;_=Y;try{return ne()}finally{_=ve}},t.unstable_scheduleCallback=function(Y,ne,ve){var ie=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ie+ve:ie):ve=ie,Y){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=ve+Ce,Y={id:p++,callback:ne,priorityLevel:Y,startTime:ve,expirationTime:Ce,sortIndex:-1},ve>ie?(Y.sortIndex=ve,e(d,Y),r(h)===null&&Y===r(d)&&(E?(U(k),k=-1):E=!0,oe(re,ve-ie))):(Y.sortIndex=Ce,e(h,Y),S||w||(S=!0,ee||(ee=!0,D()))),Y},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(Y){var ne=_;return function(){var ve=_;_=ne;try{return Y.apply(this,arguments)}finally{_=ve}}}})(Sp)),Sp}var Hy;function gC(){return Hy||(Hy=1,Ep.exports=pC()),Ep.exports}var bp={exports:{}},Dn={};var Gy;function xC(){if(Gy)return Dn;Gy=1;var t=Bg();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:h,containerInfo:d,implementation:p}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Dn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,p)},Dn.flushSync=function(h){var d=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=p,n.d.f()}},Dn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Dn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Dn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,w=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:w}):p==="script"&&n.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:w,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Dn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Dn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Dn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Dn.requestFormReset=function(h){n.d.r(h)},Dn.unstable_batchedUpdates=function(h,d){return h(d)},Dn.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},Dn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Dn.version="19.2.3",Dn}var qy;function vC(){if(qy)return bp.exports;qy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),bp.exports=xC(),bp.exports}var Xy;function _C(){if(Xy)return uf;Xy=1;var t=gC(),e=Bg(),r=vC();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function l(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function h(i){if(o(i)!==i)throw Error(n(188))}function d(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(n(188));return s!==i?null:i}for(var c=i,f=s;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(f=g.return,f!==null){c=f;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return h(g),i;if(x===f)return h(g),s;x=x.sibling}throw Error(n(188))}if(c.return!==f.return)c=g,f=x;else{for(var b=!1,B=g.child;B;){if(B===c){b=!0,c=g,f=x;break}if(B===f){b=!0,f=g,c=x;break}B=B.sibling}if(!b){for(B=x.child;B;){if(B===c){b=!0,c=x,f=g;break}if(B===f){b=!0,f=x,c=g;break}B=B.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:s}function p(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=p(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),N=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function D(i){return i===null||typeof i!="object"?null:(i=F&&i[F]||i["@@iterator"],typeof i=="function"?i:null)}var V=Symbol.for("react.client.reference");function Te(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===V?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case L:return"Profiler";case A:return"StrictMode";case re:return"Suspense";case ee:return"SuspenseList";case R:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case S:return"Portal";case N:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case Q:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case k:return s=i.displayName||null,s!==null?s:Te(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return Te(i(s))}catch{}}return null}var oe=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},ie=[],Ce=-1;function K(i){return{current:i}}function M(i){0>Ce||(i.current=ie[Ce],ie[Ce]=null,Ce--)}function q(i,s){Ce++,ie[Ce]=i.current,i.current=s}var G=K(null),J=K(null),le=K(null),ye=K(null);function be(i,s){switch(q(le,s),q(J,i),q(G,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?oy(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=oy(s),i=ly(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}M(G),q(G,i)}function Ee(){M(G),M(J),M(le)}function Ie(i){i.memoizedState!==null&&q(ye,i);var s=G.current,c=ly(s,i.type);s!==c&&(q(J,i),q(G,c))}function nt(i){J.current===i&&(M(G),M(J)),ye.current===i&&(M(ye),af._currentValue=ve)}var te,Ft;function ht(i){if(te===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);te=s&&s[1]||"",Ft=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+i+Ft}var It=!1;function at(i,s){if(!i||It)return"";It=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(we){var xe=we}Reflect.construct(i,[],Re)}else{try{Re.call()}catch(we){xe=we}i.call(Re.prototype)}}else{try{throw Error()}catch(we){xe=we}(Re=i())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(we){if(we&&xe&&typeof we.stack=="string")return[we.stack,xe.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),b=x[0],B=x[1];if(b&&B){var ae=b.split(`
`),me=B.split(`
`);for(g=f=0;f<ae.length&&!ae[f].includes("DetermineComponentFrameRoot");)f++;for(;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;if(f===ae.length||g===me.length)for(f=ae.length-1,g=me.length-1;1<=f&&0<=g&&ae[f]!==me[g];)g--;for(;1<=f&&0<=g;f--,g--)if(ae[f]!==me[g]){if(f!==1||g!==1)do if(f--,g--,0>g||ae[f]!==me[g]){var ke=`
`+ae[f].replace(" at new "," at ");return i.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",i.displayName)),ke}while(1<=f&&0<=g);break}}}finally{It=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?ht(c):""}function je(i,s){switch(i.tag){case 26:case 27:case 5:return ht(i.type);case 16:return ht("Lazy");case 13:return i.child!==s&&s!==null?ht("Suspense Fallback"):ht("Suspense");case 19:return ht("SuspenseList");case 0:case 15:return at(i.type,!1);case 11:return at(i.type.render,!1);case 1:return at(i.type,!0);case 31:return ht("Activity");default:return""}}function $t(i){try{var s="",c=null;do s+=je(i,c),c=i,i=i.return;while(i);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Dt=Object.prototype.hasOwnProperty,Ut=t.unstable_scheduleCallback,Ur=t.unstable_cancelCallback,Za=t.unstable_shouldYield,Xn=t.unstable_requestPaint,Lt=t.unstable_now,Jr=t.unstable_getCurrentPriorityLevel,gn=t.unstable_ImmediatePriority,Wn=t.unstable_UserBlockingPriority,Pt=t.unstable_NormalPriority,Nn=t.unstable_LowPriority,ut=t.unstable_IdlePriority,ar=t.log,Zr=t.unstable_setDisableYieldValue,De=null,Xe=null;function Ke(i){if(typeof ar=="function"&&Zr(i),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(De,i)}catch{}}var Ze=Math.clz32?Math.clz32:jr,_r=Math.log,en=Math.LN2;function jr(i){return i>>>=0,i===0?32:31-(_r(i)/en|0)|0}var ln=256,ea=262144,Gt=4194304;function Ir(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Tr(i,s,c){var f=i.pendingLanes;if(f===0)return 0;var g=0,x=i.suspendedLanes,b=i.pingedLanes;i=i.warmLanes;var B=f&134217727;return B!==0?(f=B&~x,f!==0?g=Ir(f):(b&=B,b!==0?g=Ir(b):c||(c=B&~i,c!==0&&(g=Ir(c))))):(B=f&~x,B!==0?g=Ir(B):b!==0?g=Ir(b):c||(c=f&~i,c!==0&&(g=Ir(c)))),g===0?0:s!==0&&s!==g&&(s&x)===0&&(x=g&-g,c=s&-s,x>=c||x===32&&(c&4194048)!==0)?s:g}function tn(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Ns(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wi(){var i=Gt;return Gt<<=1,(Gt&62914560)===0&&(Gt=4194304),i}function cn(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function ei(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function jo(i,s,c,f,g,x){var b=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var B=i.entanglements,ae=i.expirationTimes,me=i.hiddenUpdates;for(c=b&~c;0<c;){var ke=31-Ze(c),Re=1<<ke;B[ke]=0,ae[ke]=-1;var xe=me[ke];if(xe!==null)for(me[ke]=null,ke=0;ke<xe.length;ke++){var we=xe[ke];we!==null&&(we.lane&=-536870913)}c&=~Re}f!==0&&ti(i,f,0),x!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=x&~(b&~s))}function ti(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-Ze(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|c&261930}function qt(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var f=31-Ze(c),g=1<<f;g&s|i[f]&s&&(i[f]|=s),c&=~g}}function Kn(i,s){var c=s&-s;return c=(c&42)!==0?1:da(c),(c&(i.suspendedLanes|s))!==0?0:c}function da(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ma(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function P(){var i=ne.p;return i!==0?i:(i=window.event,i===void 0?32:Iy(i.type))}function W(i,s){var c=ne.p;try{return ne.p=i,s()}finally{ne.p=c}}var j=Math.random().toString(36).slice(2),H="__reactFiber$"+j,X="__reactProps$"+j,Z="__reactContainer$"+j,he="__reactEvents$"+j,Ae="__reactListeners$"+j,de="__reactHandles$"+j,ge="__reactResources$"+j,pe="__reactMarker$"+j;function Pe(i){delete i[H],delete i[X],delete i[he],delete i[Ae],delete i[de]}function Ve(i){var s=i[H];if(s)return s;for(var c=i.parentNode;c;){if(s=c[Z]||c[H]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=py(i);i!==null;){if(c=i[H])return c;i=py(i)}return s}i=c,c=i.parentNode}return null}function qe(i){if(i=i[H]||i[Z]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Le(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function Ge(i){var s=i[ge];return s||(s=i[ge]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ye(i){i[pe]=!0}var Yt=new Set,Qt={};function ur(i,s){Rn(i,s),Rn(i+"Capture",s)}function Rn(i,s){for(Qt[i]=s,i=0;i<s.length;i++)Yt.add(s[i])}var ri=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ni={},pa={};function Rs(i){return Dt.call(pa,i)?!0:Dt.call(ni,i)?!1:ri.test(i)?pa[i]=!0:(ni[i]=!0,!1)}function In(i,s,c){if(Rs(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function ga(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function zr(i,s,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+f)}}function un(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Is(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function gu(i,s,c){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,x=f.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(b){c=""+b,x.call(this,b)}}),Object.defineProperty(i,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Jt(i){if(!i._valueTracker){var s=Is(i)?"checked":"value";i._valueTracker=gu(i,s,""+i[s])}}function zo(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return i&&(f=Is(i)?i.checked?"true":"false":i.value),i=f,i!==c?(s.setValue(i),!0):!1}function Ti(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Ho=/[\n"\\]/g;function ta(i){return i.replace(Ho,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Xl(i,s,c,f,g,x,b,B){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),s!=null?b==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+un(s)):i.value!==""+un(s)&&(i.value=""+un(s)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),s!=null?xu(i,b,un(s)):c!=null?xu(i,b,un(c)):f!=null&&i.removeAttribute("value"),g==null&&x!=null&&(i.defaultChecked=!!x),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?i.name=""+un(B):i.removeAttribute("name")}function y0(i,s,c,f,g,x,b,B){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),s!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||s!=null)){Jt(i);return}c=c!=null?""+un(c):"",s=s!=null?""+un(s):c,B||s===i.value||(i.value=s),i.defaultValue=s}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=B?i.checked:!!f,i.defaultChecked=!!f,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b),Jt(i)}function xu(i,s,c){s==="number"&&Ti(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Ds(i,s,c,f){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&f&&(i[c].defaultSelected=!0)}else{for(c=""+un(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function w0(i,s,c){if(s!=null&&(s=""+un(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+un(c):""}function Os(i,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(oe(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=un(s),i.defaultValue=c,f=i.textContent,f===c&&f!==""&&f!==null&&(i.value=f),Jt(i)}function ra(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var T0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vu(i,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,c):typeof c!="number"||c===0||T0.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function _u(i,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var g in s)f=s[g],s.hasOwnProperty(g)&&c[g]!==f&&vu(i,g,f)}else for(var x in s)s.hasOwnProperty(x)&&vu(i,x,s[x])}function Wl(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var E0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kl(i){return Fs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ai(){}var yu=null;function Da(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ms=null,Ei=null;function Go(i){var s=qe(i);if(s&&(i=s.stateNode)){var c=i[X]||null;e:switch(i=s.stateNode,s.type){case"input":if(Xl(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ta(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==i&&f.form===i.form){var g=f[X]||null;if(!g)throw Error(n(90));Xl(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===i.form&&zo(f)}break e;case"textarea":w0(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Ds(i,!!c.multiple,s,!1)}}}var $l=!1;function Ls(i,s,c){if($l)return i(s,c);$l=!0;try{var f=i(s);return f}finally{if($l=!1,(Ms!==null||Ei!==null)&&(gh(),Ms&&(s=Ms,i=Ei,Ei=Ms=null,Go(s),i)))for(s=0;s<i.length;s++)Go(i[s])}}function ii(i,s){var c=i.stateNode;if(c===null)return null;var f=c[X]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var Oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qo=!1;if(Oa)try{var ir={};Object.defineProperty(ir,"passive",{get:function(){qo=!0}}),window.addEventListener("test",ir,ir),window.removeEventListener("test",ir,ir)}catch{qo=!1}var Si=null,wu=null,Xo=null;function Tu(){if(Xo)return Xo;var i,s=wu,c=s.length,f,g="value"in Si?Si.value:Si.textContent,x=g.length;for(i=0;i<c&&s[i]===g[i];i++);var b=c-i;for(f=1;f<=b&&s[c-f]===g[x-f];f++);return Xo=g.slice(i,1<f?1-f:void 0)}function Wo(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function $i(){return!0}function si(){return!1}function xn(i){function s(c,f,g,x,b){this._reactName=c,this._targetInst=g,this.type=f,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var B in i)i.hasOwnProperty(B)&&(c=i[B],this[B]=c?c(x):x[B]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?$i:si,this.isPropagationStopped=si,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=$i)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=$i)},persist:function(){},isPersistent:$i}),s}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bi=xn(Yi),Ps=v({},Yi,{view:0,detail:0}),Eu=xn(Ps),Vs,Yl,Ai,Ql=v({},Ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ai&&(Ai&&i.type==="mousemove"?(Vs=i.screenX-Ai.screenX,Yl=i.screenY-Ai.screenY):Yl=Vs=0,Ai=i),Vs)},movementY:function(i){return"movementY"in i?i.movementY:Yl}}),Su=xn(Ql),Ko=v({},Ql,{dataTransfer:0}),S0=xn(Ko),b0=v({},Ps,{relatedTarget:0}),$o=xn(b0),bu=v({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),A0=xn(bu),Jl=v({},Yi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),k0=xn(Jl),C0=v({},Yi,{data:0}),ki=xn(C0),N0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},R0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},I0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D0(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=I0[i])?!!s[i]:!1}function Bs(){return D0}var $n=v({},Ps,{key:function(i){if(i.key){var s=N0[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Wo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?R0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bs,charCode:function(i){return i.type==="keypress"?Wo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Wo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),O0=xn($n),F0=v({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qi=xn(F0),m=v({},Ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bs}),T=xn(m),C=v({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),z=xn(C),ue=v({},Ql,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),_e=xn(ue),He=v({},Yi,{newState:0,oldState:0}),xt=xn(He),Dr=[9,13,27,32],Xt=Oa&&"CompositionEvent"in window,yr=null;Oa&&"documentMode"in document&&(yr=document.documentMode);var Fa=Oa&&"TextEvent"in window&&!yr,Ci=Oa&&(!Xt||yr&&8<yr&&11>=yr),oi=" ",li=!1;function Yo(i,s){switch(i){case"keyup":return Dr.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zl(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ec=!1;function Lk(i,s){switch(i){case"compositionend":return Zl(s);case"keypress":return s.which!==32?null:(li=!0,oi);case"textInput":return i=s.data,i===oi&&li?null:i;default:return null}}function Pk(i,s){if(ec)return i==="compositionend"||!Xt&&Yo(i,s)?(i=Tu(),Xo=wu=Si=null,ec=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ci&&s.locale!=="ko"?null:s.data;default:return null}}var Vk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vv(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Vk[i.type]:s==="textarea"}function _v(i,s,c,f){Ms?Ei?Ei.push(f):Ei=[f]:Ms=f,s=Eh(s,"onChange"),0<s.length&&(c=new bi("onChange","change",null,c,f),i.push({event:c,listeners:s}))}var Au=null,ku=null;function Bk(i){ty(i,0)}function M0(i){var s=Le(i);if(zo(s))return i}function yv(i,s){if(i==="change")return s}var wv=!1;if(Oa){var km;if(Oa){var Cm="oninput"in document;if(!Cm){var Tv=document.createElement("div");Tv.setAttribute("oninput","return;"),Cm=typeof Tv.oninput=="function"}km=Cm}else km=!1;wv=km&&(!document.documentMode||9<document.documentMode)}function Ev(){Au&&(Au.detachEvent("onpropertychange",Sv),ku=Au=null)}function Sv(i){if(i.propertyName==="value"&&M0(ku)){var s=[];_v(s,ku,i,Da(i)),Ls(Bk,s)}}function Uk(i,s,c){i==="focusin"?(Ev(),Au=s,ku=c,Au.attachEvent("onpropertychange",Sv)):i==="focusout"&&Ev()}function jk(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return M0(ku)}function zk(i,s){if(i==="click")return M0(s)}function Hk(i,s){if(i==="input"||i==="change")return M0(s)}function Gk(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var xa=typeof Object.is=="function"?Object.is:Gk;function Cu(i,s){if(xa(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var g=c[f];if(!Dt.call(s,g)||!xa(i[g],s[g]))return!1}return!0}function bv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Av(i,s){var c=bv(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=s&&f>=s)return{node:c,offset:s-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=bv(c)}}function kv(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?kv(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Cv(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Ti(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=Ti(i.document)}return s}function Nm(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var qk=Oa&&"documentMode"in document&&11>=document.documentMode,tc=null,Rm=null,Nu=null,Im=!1;function Nv(i,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Im||tc==null||tc!==Ti(f)||(f=tc,"selectionStart"in f&&Nm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Nu&&Cu(Nu,f)||(Nu=f,f=Eh(Rm,"onSelect"),0<f.length&&(s=new bi("onSelect","select",null,s,c),i.push({event:s,listeners:f}),s.target=tc)))}function Qo(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var rc={animationend:Qo("Animation","AnimationEnd"),animationiteration:Qo("Animation","AnimationIteration"),animationstart:Qo("Animation","AnimationStart"),transitionrun:Qo("Transition","TransitionRun"),transitionstart:Qo("Transition","TransitionStart"),transitioncancel:Qo("Transition","TransitionCancel"),transitionend:Qo("Transition","TransitionEnd")},Dm={},Rv={};Oa&&(Rv=document.createElement("div").style,"AnimationEvent"in window||(delete rc.animationend.animation,delete rc.animationiteration.animation,delete rc.animationstart.animation),"TransitionEvent"in window||delete rc.transitionend.transition);function Jo(i){if(Dm[i])return Dm[i];if(!rc[i])return i;var s=rc[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in Rv)return Dm[i]=s[c];return i}var Iv=Jo("animationend"),Dv=Jo("animationiteration"),Ov=Jo("animationstart"),Xk=Jo("transitionrun"),Wk=Jo("transitionstart"),Kk=Jo("transitioncancel"),Fv=Jo("transitionend"),Mv=new Map,Om="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Om.push("scrollEnd");function ci(i,s){Mv.set(i,s),ur(s,[i])}var L0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ma=[],nc=0,Fm=0;function P0(){for(var i=nc,s=Fm=nc=0;s<i;){var c=Ma[s];Ma[s++]=null;var f=Ma[s];Ma[s++]=null;var g=Ma[s];Ma[s++]=null;var x=Ma[s];if(Ma[s++]=null,f!==null&&g!==null){var b=f.pending;b===null?g.next=g:(g.next=b.next,b.next=g),f.pending=g}x!==0&&Lv(c,g,x)}}function V0(i,s,c,f){Ma[nc++]=i,Ma[nc++]=s,Ma[nc++]=c,Ma[nc++]=f,Fm|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function Mm(i,s,c,f){return V0(i,s,c,f),B0(i)}function Zo(i,s){return V0(i,null,null,s),B0(i)}function Lv(i,s,c){i.lanes|=c;var f=i.alternate;f!==null&&(f.lanes|=c);for(var g=!1,x=i.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(g=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,g&&s!==null&&(g=31-Ze(c),i=x.hiddenUpdates,f=i[g],f===null?i[g]=[s]:f.push(s),s.lane=c|536870912),x):null}function B0(i){if(50<Qu)throw Qu=0,G1=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var ac={};function $k(i,s,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(i,s,c,f){return new $k(i,s,c,f)}function Lm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ji(i,s){var c=i.alternate;return c===null?(c=va(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Pv(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function U0(i,s,c,f,g,x){var b=0;if(f=i,typeof i=="function")Lm(i)&&(b=1);else if(typeof i=="string")b=eC(i,c,G.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case R:return i=va(31,c,s,g),i.elementType=R,i.lanes=x,i;case E:return el(c.children,g,x,s);case A:b=8,g|=24;break;case L:return i=va(12,c,s,g|2),i.elementType=L,i.lanes=x,i;case re:return i=va(13,c,s,g),i.elementType=re,i.lanes=x,i;case ee:return i=va(19,c,s,g),i.elementType=ee,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:b=10;break e;case U:b=9;break e;case Q:b=11;break e;case k:b=14;break e;case I:b=16,f=null;break e}b=29,c=Error(n(130,i===null?"null":typeof i,"")),f=null}return s=va(b,c,s,g),s.elementType=i,s.type=f,s.lanes=x,s}function el(i,s,c,f){return i=va(7,i,f,s),i.lanes=c,i}function Pm(i,s,c){return i=va(6,i,null,s),i.lanes=c,i}function Vv(i){var s=va(18,null,null,0);return s.stateNode=i,s}function Vm(i,s,c){return s=va(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Bv=new WeakMap;function La(i,s){if(typeof i=="object"&&i!==null){var c=Bv.get(i);return c!==void 0?c:(s={value:i,source:s,stack:$t(s)},Bv.set(i,s),s)}return{value:i,source:s,stack:$t(s)}}var ic=[],sc=0,j0=null,Ru=0,Pa=[],Va=0,Us=null,Ni=1,Ri="";function Zi(i,s){ic[sc++]=Ru,ic[sc++]=j0,j0=i,Ru=s}function Uv(i,s,c){Pa[Va++]=Ni,Pa[Va++]=Ri,Pa[Va++]=Us,Us=i;var f=Ni;i=Ri;var g=32-Ze(f)-1;f&=~(1<<g),c+=1;var x=32-Ze(s)+g;if(30<x){var b=g-g%5;x=(f&(1<<b)-1).toString(32),f>>=b,g-=b,Ni=1<<32-Ze(s)+g|c<<g|f,Ri=x+i}else Ni=1<<x|c<<g|f,Ri=i}function Bm(i){i.return!==null&&(Zi(i,1),Uv(i,1,0))}function Um(i){for(;i===j0;)j0=ic[--sc],ic[sc]=null,Ru=ic[--sc],ic[sc]=null;for(;i===Us;)Us=Pa[--Va],Pa[Va]=null,Ri=Pa[--Va],Pa[Va]=null,Ni=Pa[--Va],Pa[Va]=null}function jv(i,s){Pa[Va++]=Ni,Pa[Va++]=Ri,Pa[Va++]=Us,Ni=s.id,Ri=s.overflow,Us=i}var vn=null,hr=null,Ot=!1,js=null,Ba=!1,jm=Error(n(519));function zs(i){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Iu(La(s,i)),jm}function zv(i){var s=i.stateNode,c=i.type,f=i.memoizedProps;switch(s[H]=i,s[X]=f,c){case"dialog":bt("cancel",s),bt("close",s);break;case"iframe":case"object":case"embed":bt("load",s);break;case"video":case"audio":for(c=0;c<Zu.length;c++)bt(Zu[c],s);break;case"source":bt("error",s);break;case"img":case"image":case"link":bt("error",s),bt("load",s);break;case"details":bt("toggle",s);break;case"input":bt("invalid",s),y0(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":bt("invalid",s);break;case"textarea":bt("invalid",s),Os(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||iy(s.textContent,c)?(f.popover!=null&&(bt("beforetoggle",s),bt("toggle",s)),f.onScroll!=null&&bt("scroll",s),f.onScrollEnd!=null&&bt("scrollend",s),f.onClick!=null&&(s.onclick=ai),s=!0):s=!1,s||zs(i,!0)}function Hv(i){for(vn=i.return;vn;)switch(vn.tag){case 5:case 31:case 13:Ba=!1;return;case 27:case 3:Ba=!0;return;default:vn=vn.return}}function oc(i){if(i!==vn)return!1;if(!Ot)return Hv(i),Ot=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||ip(i.type,i.memoizedProps)),c=!c),c&&hr&&zs(i),Hv(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));hr=my(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));hr=my(i)}else s===27?(s=hr,ro(i.type)?(i=up,up=null,hr=i):hr=s):hr=vn?ja(i.stateNode.nextSibling):null;return!0}function tl(){hr=vn=null,Ot=!1}function zm(){var i=js;return i!==null&&(sa===null?sa=i:sa.push.apply(sa,i),js=null),i}function Iu(i){js===null?js=[i]:js.push(i)}var Hm=K(null),rl=null,es=null;function Hs(i,s,c){q(Hm,s._currentValue),s._currentValue=c}function ts(i){i._currentValue=Hm.current,M(Hm)}function Gm(i,s,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===c)break;i=i.return}}function qm(i,s,c,f){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var x=g.dependencies;if(x!==null){var b=g.child;x=x.firstContext;e:for(;x!==null;){var B=x;x=g;for(var ae=0;ae<s.length;ae++)if(B.context===s[ae]){x.lanes|=c,B=x.alternate,B!==null&&(B.lanes|=c),Gm(x.return,c,i),f||(b=null);break e}x=B.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(n(341));b.lanes|=c,x=b.alternate,x!==null&&(x.lanes|=c),Gm(b,c,i),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===i){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function lc(i,s,c,f){i=null;for(var g=s,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var B=g.type;xa(g.pendingProps.value,b.value)||(i!==null?i.push(B):i=[B])}}else if(g===ye.current){if(b=g.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(af):i=[af])}g=g.return}i!==null&&qm(s,i,c,f),s.flags|=262144}function z0(i){for(i=i.firstContext;i!==null;){if(!xa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function nl(i){rl=i,es=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function _n(i){return Gv(rl,i)}function H0(i,s){return rl===null&&nl(i),Gv(i,s)}function Gv(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},es===null){if(i===null)throw Error(n(308));es=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else es=es.next=s;return c}var Yk=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},Qk=t.unstable_scheduleCallback,Jk=t.unstable_NormalPriority,Hr={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xm(){return{controller:new Yk,data:new Map,refCount:0}}function Du(i){i.refCount--,i.refCount===0&&Qk(Jk,function(){i.controller.abort()})}var Ou=null,Wm=0,cc=0,uc=null;function Zk(i,s){if(Ou===null){var c=Ou=[];Wm=0,cc=Y1(),uc={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Wm++,s.then(qv,qv),s}function qv(){if(--Wm===0&&Ou!==null){uc!==null&&(uc.status="fulfilled");var i=Ou;Ou=null,cc=0,uc=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function e3(i,s){var c=[],f={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(f.status="rejected",f.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),f}var Xv=Y.S;Y.S=function(i,s){N2=Lt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Zk(i,s),Xv!==null&&Xv(i,s)};var al=K(null);function Km(){var i=al.current;return i!==null?i:fr.pooledCache}function G0(i,s){s===null?q(al,al.current):q(al,s.pool)}function Wv(){var i=Km();return i===null?null:{parent:Hr._currentValue,pool:i}}var fc=Error(n(460)),$m=Error(n(474)),q0=Error(n(542)),X0={then:function(){}};function Kv(i){return i=i.status,i==="fulfilled"||i==="rejected"}function $v(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(ai,ai),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Qv(i),i;default:if(typeof s.status=="string")s.then(ai,ai);else{if(i=fr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=f}},function(f){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Qv(i),i}throw sl=s,fc}}function il(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(sl=c,fc):c}}var sl=null;function Yv(){if(sl===null)throw Error(n(459));var i=sl;return sl=null,i}function Qv(i){if(i===fc||i===q0)throw Error(n(483))}var hc=null,Fu=0;function W0(i){var s=Fu;return Fu+=1,hc===null&&(hc=[]),$v(hc,i,s)}function Mu(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function K0(i,s){throw s.$$typeof===_?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Jv(i){function s(ce,se){if(i){var fe=ce.deletions;fe===null?(ce.deletions=[se],ce.flags|=16):fe.push(se)}}function c(ce,se){if(!i)return null;for(;se!==null;)s(ce,se),se=se.sibling;return null}function f(ce){for(var se=new Map;ce!==null;)ce.key!==null?se.set(ce.key,ce):se.set(ce.index,ce),ce=ce.sibling;return se}function g(ce,se){return ce=Ji(ce,se),ce.index=0,ce.sibling=null,ce}function x(ce,se,fe){return ce.index=fe,i?(fe=ce.alternate,fe!==null?(fe=fe.index,fe<se?(ce.flags|=67108866,se):fe):(ce.flags|=67108866,se)):(ce.flags|=1048576,se)}function b(ce){return i&&ce.alternate===null&&(ce.flags|=67108866),ce}function B(ce,se,fe,Ne){return se===null||se.tag!==6?(se=Pm(fe,ce.mode,Ne),se.return=ce,se):(se=g(se,fe),se.return=ce,se)}function ae(ce,se,fe,Ne){var et=fe.type;return et===E?ke(ce,se,fe.props.children,Ne,fe.key):se!==null&&(se.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===I&&il(et)===se.type)?(se=g(se,fe.props),Mu(se,fe),se.return=ce,se):(se=U0(fe.type,fe.key,fe.props,null,ce.mode,Ne),Mu(se,fe),se.return=ce,se)}function me(ce,se,fe,Ne){return se===null||se.tag!==4||se.stateNode.containerInfo!==fe.containerInfo||se.stateNode.implementation!==fe.implementation?(se=Vm(fe,ce.mode,Ne),se.return=ce,se):(se=g(se,fe.children||[]),se.return=ce,se)}function ke(ce,se,fe,Ne,et){return se===null||se.tag!==7?(se=el(fe,ce.mode,Ne,et),se.return=ce,se):(se=g(se,fe),se.return=ce,se)}function Re(ce,se,fe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Pm(""+se,ce.mode,fe),se.return=ce,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case w:return fe=U0(se.type,se.key,se.props,null,ce.mode,fe),Mu(fe,se),fe.return=ce,fe;case S:return se=Vm(se,ce.mode,fe),se.return=ce,se;case I:return se=il(se),Re(ce,se,fe)}if(oe(se)||D(se))return se=el(se,ce.mode,fe,null),se.return=ce,se;if(typeof se.then=="function")return Re(ce,W0(se),fe);if(se.$$typeof===N)return Re(ce,H0(ce,se),fe);K0(ce,se)}return null}function xe(ce,se,fe,Ne){var et=se!==null?se.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return et!==null?null:B(ce,se,""+fe,Ne);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case w:return fe.key===et?ae(ce,se,fe,Ne):null;case S:return fe.key===et?me(ce,se,fe,Ne):null;case I:return fe=il(fe),xe(ce,se,fe,Ne)}if(oe(fe)||D(fe))return et!==null?null:ke(ce,se,fe,Ne,null);if(typeof fe.then=="function")return xe(ce,se,W0(fe),Ne);if(fe.$$typeof===N)return xe(ce,se,H0(ce,fe),Ne);K0(ce,fe)}return null}function we(ce,se,fe,Ne,et){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return ce=ce.get(fe)||null,B(se,ce,""+Ne,et);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case w:return ce=ce.get(Ne.key===null?fe:Ne.key)||null,ae(se,ce,Ne,et);case S:return ce=ce.get(Ne.key===null?fe:Ne.key)||null,me(se,ce,Ne,et);case I:return Ne=il(Ne),we(ce,se,fe,Ne,et)}if(oe(Ne)||D(Ne))return ce=ce.get(fe)||null,ke(se,ce,Ne,et,null);if(typeof Ne.then=="function")return we(ce,se,fe,W0(Ne),et);if(Ne.$$typeof===N)return we(ce,se,fe,H0(se,Ne),et);K0(se,Ne)}return null}function $e(ce,se,fe,Ne){for(var et=null,jt=null,Qe=se,yt=se=0,kt=null;Qe!==null&&yt<fe.length;yt++){Qe.index>yt?(kt=Qe,Qe=null):kt=Qe.sibling;var zt=xe(ce,Qe,fe[yt],Ne);if(zt===null){Qe===null&&(Qe=kt);break}i&&Qe&&zt.alternate===null&&s(ce,Qe),se=x(zt,se,yt),jt===null?et=zt:jt.sibling=zt,jt=zt,Qe=kt}if(yt===fe.length)return c(ce,Qe),Ot&&Zi(ce,yt),et;if(Qe===null){for(;yt<fe.length;yt++)Qe=Re(ce,fe[yt],Ne),Qe!==null&&(se=x(Qe,se,yt),jt===null?et=Qe:jt.sibling=Qe,jt=Qe);return Ot&&Zi(ce,yt),et}for(Qe=f(Qe);yt<fe.length;yt++)kt=we(Qe,ce,yt,fe[yt],Ne),kt!==null&&(i&&kt.alternate!==null&&Qe.delete(kt.key===null?yt:kt.key),se=x(kt,se,yt),jt===null?et=kt:jt.sibling=kt,jt=kt);return i&&Qe.forEach(function(oo){return s(ce,oo)}),Ot&&Zi(ce,yt),et}function it(ce,se,fe,Ne){if(fe==null)throw Error(n(151));for(var et=null,jt=null,Qe=se,yt=se=0,kt=null,zt=fe.next();Qe!==null&&!zt.done;yt++,zt=fe.next()){Qe.index>yt?(kt=Qe,Qe=null):kt=Qe.sibling;var oo=xe(ce,Qe,zt.value,Ne);if(oo===null){Qe===null&&(Qe=kt);break}i&&Qe&&oo.alternate===null&&s(ce,Qe),se=x(oo,se,yt),jt===null?et=oo:jt.sibling=oo,jt=oo,Qe=kt}if(zt.done)return c(ce,Qe),Ot&&Zi(ce,yt),et;if(Qe===null){for(;!zt.done;yt++,zt=fe.next())zt=Re(ce,zt.value,Ne),zt!==null&&(se=x(zt,se,yt),jt===null?et=zt:jt.sibling=zt,jt=zt);return Ot&&Zi(ce,yt),et}for(Qe=f(Qe);!zt.done;yt++,zt=fe.next())zt=we(Qe,ce,yt,zt.value,Ne),zt!==null&&(i&&zt.alternate!==null&&Qe.delete(zt.key===null?yt:zt.key),se=x(zt,se,yt),jt===null?et=zt:jt.sibling=zt,jt=zt);return i&&Qe.forEach(function(fC){return s(ce,fC)}),Ot&&Zi(ce,yt),et}function lr(ce,se,fe,Ne){if(typeof fe=="object"&&fe!==null&&fe.type===E&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case w:e:{for(var et=fe.key;se!==null;){if(se.key===et){if(et=fe.type,et===E){if(se.tag===7){c(ce,se.sibling),Ne=g(se,fe.props.children),Ne.return=ce,ce=Ne;break e}}else if(se.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===I&&il(et)===se.type){c(ce,se.sibling),Ne=g(se,fe.props),Mu(Ne,fe),Ne.return=ce,ce=Ne;break e}c(ce,se);break}else s(ce,se);se=se.sibling}fe.type===E?(Ne=el(fe.props.children,ce.mode,Ne,fe.key),Ne.return=ce,ce=Ne):(Ne=U0(fe.type,fe.key,fe.props,null,ce.mode,Ne),Mu(Ne,fe),Ne.return=ce,ce=Ne)}return b(ce);case S:e:{for(et=fe.key;se!==null;){if(se.key===et)if(se.tag===4&&se.stateNode.containerInfo===fe.containerInfo&&se.stateNode.implementation===fe.implementation){c(ce,se.sibling),Ne=g(se,fe.children||[]),Ne.return=ce,ce=Ne;break e}else{c(ce,se);break}else s(ce,se);se=se.sibling}Ne=Vm(fe,ce.mode,Ne),Ne.return=ce,ce=Ne}return b(ce);case I:return fe=il(fe),lr(ce,se,fe,Ne)}if(oe(fe))return $e(ce,se,fe,Ne);if(D(fe)){if(et=D(fe),typeof et!="function")throw Error(n(150));return fe=et.call(fe),it(ce,se,fe,Ne)}if(typeof fe.then=="function")return lr(ce,se,W0(fe),Ne);if(fe.$$typeof===N)return lr(ce,se,H0(ce,fe),Ne);K0(ce,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,se!==null&&se.tag===6?(c(ce,se.sibling),Ne=g(se,fe),Ne.return=ce,ce=Ne):(c(ce,se),Ne=Pm(fe,ce.mode,Ne),Ne.return=ce,ce=Ne),b(ce)):c(ce,se)}return function(ce,se,fe,Ne){try{Fu=0;var et=lr(ce,se,fe,Ne);return hc=null,et}catch(Qe){if(Qe===fc||Qe===q0)throw Qe;var jt=va(29,Qe,null,ce.mode);return jt.lanes=Ne,jt.return=ce,jt}}}var ol=Jv(!0),Zv=Jv(!1),Gs=!1;function Ym(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qm(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function qs(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Xs(i,s,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(Wt&2)!==0){var g=f.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),f.pending=s,s=B0(i),Lv(i,null,c),s}return V0(i,f,s,c),B0(i)}function Lu(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,qt(i,c)}}function Jm(i,s){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=b:x=x.next=b,c=c.next}while(c!==null);x===null?g=x=s:x=x.next=s}else g=x=s;c={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var Zm=!1;function Pu(){if(Zm){var i=uc;if(i!==null)throw i}}function Vu(i,s,c,f){Zm=!1;var g=i.updateQueue;Gs=!1;var x=g.firstBaseUpdate,b=g.lastBaseUpdate,B=g.shared.pending;if(B!==null){g.shared.pending=null;var ae=B,me=ae.next;ae.next=null,b===null?x=me:b.next=me,b=ae;var ke=i.alternate;ke!==null&&(ke=ke.updateQueue,B=ke.lastBaseUpdate,B!==b&&(B===null?ke.firstBaseUpdate=me:B.next=me,ke.lastBaseUpdate=ae))}if(x!==null){var Re=g.baseState;b=0,ke=me=ae=null,B=x;do{var xe=B.lane&-536870913,we=xe!==B.lane;if(we?(At&xe)===xe:(f&xe)===xe){xe!==0&&xe===cc&&(Zm=!0),ke!==null&&(ke=ke.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var $e=i,it=B;xe=s;var lr=c;switch(it.tag){case 1:if($e=it.payload,typeof $e=="function"){Re=$e.call(lr,Re,xe);break e}Re=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=it.payload,xe=typeof $e=="function"?$e.call(lr,Re,xe):$e,xe==null)break e;Re=v({},Re,xe);break e;case 2:Gs=!0}}xe=B.callback,xe!==null&&(i.flags|=64,we&&(i.flags|=8192),we=g.callbacks,we===null?g.callbacks=[xe]:we.push(xe))}else we={lane:xe,tag:B.tag,payload:B.payload,callback:B.callback,next:null},ke===null?(me=ke=we,ae=Re):ke=ke.next=we,b|=xe;if(B=B.next,B===null){if(B=g.shared.pending,B===null)break;we=B,B=we.next,we.next=null,g.lastBaseUpdate=we,g.shared.pending=null}}while(!0);ke===null&&(ae=Re),g.baseState=ae,g.firstBaseUpdate=me,g.lastBaseUpdate=ke,x===null&&(g.shared.lanes=0),Qs|=b,i.lanes=b,i.memoizedState=Re}}function e_(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function t_(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)e_(c[i],s)}var dc=K(null),$0=K(0);function r_(i,s){i=us,q($0,i),q(dc,s),us=i|s.baseLanes}function e1(){q($0,us),q(dc,dc.current)}function t1(){us=$0.current,M(dc),M($0)}var _a=K(null),Ua=null;function Ws(i){var s=i.alternate;q(Or,Or.current&1),q(_a,i),Ua===null&&(s===null||dc.current!==null||s.memoizedState!==null)&&(Ua=i)}function r1(i){q(Or,Or.current),q(_a,i),Ua===null&&(Ua=i)}function n_(i){i.tag===22?(q(Or,Or.current),q(_a,i),Ua===null&&(Ua=i)):Ks()}function Ks(){q(Or,Or.current),q(_a,_a.current)}function ya(i){M(_a),Ua===i&&(Ua=null),M(Or)}var Or=K(0);function Y0(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||lp(c)||cp(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var rs=0,vt=null,sr=null,Gr=null,Q0=!1,mc=!1,ll=!1,J0=0,Bu=0,pc=null,t3=0;function Ar(){throw Error(n(321))}function n1(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!xa(i[c],s[c]))return!1;return!0}function a1(i,s,c,f,g,x){return rs=x,vt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Y.H=i===null||i.memoizedState===null?U_:_1,ll=!1,x=c(f,g),ll=!1,mc&&(x=i_(s,c,f,g)),a_(i),x}function a_(i){Y.H=zu;var s=sr!==null&&sr.next!==null;if(rs=0,Gr=sr=vt=null,Q0=!1,Bu=0,pc=null,s)throw Error(n(300));i===null||qr||(i=i.dependencies,i!==null&&z0(i)&&(qr=!0))}function i_(i,s,c,f){vt=i;var g=0;do{if(mc&&(pc=null),Bu=0,mc=!1,25<=g)throw Error(n(301));if(g+=1,Gr=sr=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}Y.H=j_,x=s(c,f)}while(mc);return x}function r3(){var i=Y.H,s=i.useState()[0];return s=typeof s.then=="function"?Uu(s):s,i=i.useState()[0],(sr!==null?sr.memoizedState:null)!==i&&(vt.flags|=1024),s}function i1(){var i=J0!==0;return J0=0,i}function s1(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function o1(i){if(Q0){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Q0=!1}rs=0,Gr=sr=vt=null,mc=!1,Bu=J0=0,pc=null}function Yn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?vt.memoizedState=Gr=i:Gr=Gr.next=i,Gr}function Fr(){if(sr===null){var i=vt.alternate;i=i!==null?i.memoizedState:null}else i=sr.next;var s=Gr===null?vt.memoizedState:Gr.next;if(s!==null)Gr=s,sr=i;else{if(i===null)throw vt.alternate===null?Error(n(467)):Error(n(310));sr=i,i={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},Gr===null?vt.memoizedState=Gr=i:Gr=Gr.next=i}return Gr}function Z0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Uu(i){var s=Bu;return Bu+=1,pc===null&&(pc=[]),i=$v(pc,i,s),s=vt,(Gr===null?s.memoizedState:Gr.next)===null&&(s=s.alternate,Y.H=s===null||s.memoizedState===null?U_:_1),i}function eh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Uu(i);if(i.$$typeof===N)return _n(i)}throw Error(n(438,String(i)))}function l1(i){var s=null,c=vt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=vt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Z0(),vt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),f=0;f<i;f++)c[f]=O;return s.index++,c}function ns(i,s){return typeof s=="function"?s(i):s}function th(i){var s=Fr();return c1(s,sr,i)}function c1(i,s,c){var f=i.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var g=i.baseQueue,x=f.pending;if(x!==null){if(g!==null){var b=g.next;g.next=x.next,x.next=b}s.baseQueue=g=x,f.pending=null}if(x=i.baseState,g===null)i.memoizedState=x;else{s=g.next;var B=b=null,ae=null,me=s,ke=!1;do{var Re=me.lane&-536870913;if(Re!==me.lane?(At&Re)===Re:(rs&Re)===Re){var xe=me.revertLane;if(xe===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),Re===cc&&(ke=!0);else if((rs&xe)===xe){me=me.next,xe===cc&&(ke=!0);continue}else Re={lane:0,revertLane:me.revertLane,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},ae===null?(B=ae=Re,b=x):ae=ae.next=Re,vt.lanes|=xe,Qs|=xe;Re=me.action,ll&&c(x,Re),x=me.hasEagerState?me.eagerState:c(x,Re)}else xe={lane:Re,revertLane:me.revertLane,gesture:me.gesture,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},ae===null?(B=ae=xe,b=x):ae=ae.next=xe,vt.lanes|=Re,Qs|=Re;me=me.next}while(me!==null&&me!==s);if(ae===null?b=x:ae.next=B,!xa(x,i.memoizedState)&&(qr=!0,ke&&(c=uc,c!==null)))throw c;i.memoizedState=x,i.baseState=b,i.baseQueue=ae,f.lastRenderedState=x}return g===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function u1(i){var s=Fr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var f=c.dispatch,g=c.pending,x=s.memoizedState;if(g!==null){c.pending=null;var b=g=g.next;do x=i(x,b.action),b=b.next;while(b!==g);xa(x,s.memoizedState)||(qr=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),c.lastRenderedState=x}return[x,f]}function s_(i,s,c){var f=vt,g=Fr(),x=Ot;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=s();var b=!xa((sr||g).memoizedState,c);if(b&&(g.memoizedState=c,qr=!0),g=g.queue,d1(c_.bind(null,f,g,i),[i]),g.getSnapshot!==s||b||Gr!==null&&Gr.memoizedState.tag&1){if(f.flags|=2048,gc(9,{destroy:void 0},l_.bind(null,f,g,c,s),null),fr===null)throw Error(n(349));x||(rs&127)!==0||o_(f,s,c)}return c}function o_(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=vt.updateQueue,s===null?(s=Z0(),vt.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function l_(i,s,c,f){s.value=c,s.getSnapshot=f,u_(s)&&f_(i)}function c_(i,s,c){return c(function(){u_(s)&&f_(i)})}function u_(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!xa(i,c)}catch{return!0}}function f_(i){var s=Zo(i,2);s!==null&&oa(s,i,2)}function f1(i){var s=Yn();if(typeof i=="function"){var c=i;if(i=c(),ll){Ke(!0);try{c()}finally{Ke(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:i},s}function h_(i,s,c,f){return i.baseState=c,c1(i,sr,typeof f=="function"?f:ns)}function n3(i,s,c,f,g){if(ah(i))throw Error(n(485));if(i=s.action,i!==null){var x={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){x.listeners.push(b)}};Y.T!==null?c(!0):x.isTransition=!1,f(x),c=s.pending,c===null?(x.next=s.pending=x,d_(s,x)):(x.next=c.next,s.pending=c.next=x)}}function d_(i,s){var c=s.action,f=s.payload,g=i.state;if(s.isTransition){var x=Y.T,b={};Y.T=b;try{var B=c(g,f),ae=Y.S;ae!==null&&ae(b,B),m_(i,s,B)}catch(me){h1(i,s,me)}finally{x!==null&&b.types!==null&&(x.types=b.types),Y.T=x}}else try{x=c(g,f),m_(i,s,x)}catch(me){h1(i,s,me)}}function m_(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){p_(i,s,f)},function(f){return h1(i,s,f)}):p_(i,s,c)}function p_(i,s,c){s.status="fulfilled",s.value=c,g_(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,d_(i,c)))}function h1(i,s,c){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,g_(s),s=s.next;while(s!==f)}i.action=null}function g_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function x_(i,s){return s}function v_(i,s){if(Ot){var c=fr.formState;if(c!==null){e:{var f=vt;if(Ot){if(hr){t:{for(var g=hr,x=Ba;g.nodeType!==8;){if(!x){g=null;break t}if(g=ja(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){hr=ja(g.nextSibling),f=g.data==="F!";break e}}zs(f)}f=!1}f&&(s=c[0])}}return c=Yn(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x_,lastRenderedState:s},c.queue=f,c=P_.bind(null,vt,f),f.dispatch=c,f=f1(!1),x=v1.bind(null,vt,!1,f.queue),f=Yn(),g={state:s,dispatch:null,action:i,pending:null},f.queue=g,c=n3.bind(null,vt,g,x,c),g.dispatch=c,f.memoizedState=i,[s,c,!1]}function __(i){var s=Fr();return y_(s,sr,i)}function y_(i,s,c){if(s=c1(i,s,x_)[0],i=th(ns)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Uu(s)}catch(b){throw b===fc?q0:b}else f=s;s=Fr();var g=s.queue,x=g.dispatch;return c!==s.memoizedState&&(vt.flags|=2048,gc(9,{destroy:void 0},a3.bind(null,g,c),null)),[f,x,i]}function a3(i,s){i.action=s}function w_(i){var s=Fr(),c=sr;if(c!==null)return y_(s,c,i);Fr(),s=s.memoizedState,c=Fr();var f=c.queue.dispatch;return c.memoizedState=i,[s,f,!1]}function gc(i,s,c,f){return i={tag:i,create:c,deps:f,inst:s,next:null},s=vt.updateQueue,s===null&&(s=Z0(),vt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,s.lastEffect=i),i}function T_(){return Fr().memoizedState}function rh(i,s,c,f){var g=Yn();vt.flags|=i,g.memoizedState=gc(1|s,{destroy:void 0},c,f===void 0?null:f)}function nh(i,s,c,f){var g=Fr();f=f===void 0?null:f;var x=g.memoizedState.inst;sr!==null&&f!==null&&n1(f,sr.memoizedState.deps)?g.memoizedState=gc(s,x,c,f):(vt.flags|=i,g.memoizedState=gc(1|s,x,c,f))}function E_(i,s){rh(8390656,8,i,s)}function d1(i,s){nh(2048,8,i,s)}function i3(i){vt.flags|=4;var s=vt.updateQueue;if(s===null)s=Z0(),vt.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function S_(i){var s=Fr().memoizedState;return i3({ref:s,nextImpl:i}),function(){if((Wt&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function b_(i,s){return nh(4,2,i,s)}function A_(i,s){return nh(4,4,i,s)}function k_(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function C_(i,s,c){c=c!=null?c.concat([i]):null,nh(4,4,k_.bind(null,s,i),c)}function m1(){}function N_(i,s){var c=Fr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&n1(s,f[1])?f[0]:(c.memoizedState=[i,s],i)}function R_(i,s){var c=Fr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&n1(s,f[1]))return f[0];if(f=i(),ll){Ke(!0);try{i()}finally{Ke(!1)}}return c.memoizedState=[f,s],f}function p1(i,s,c){return c===void 0||(rs&1073741824)!==0&&(At&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=I2(),vt.lanes|=i,Qs|=i,c)}function I_(i,s,c,f){return xa(c,s)?c:dc.current!==null?(i=p1(i,c,f),xa(i,s)||(qr=!0),i):(rs&42)===0||(rs&1073741824)!==0&&(At&261930)===0?(qr=!0,i.memoizedState=c):(i=I2(),vt.lanes|=i,Qs|=i,s)}function D_(i,s,c,f,g){var x=ne.p;ne.p=x!==0&&8>x?x:8;var b=Y.T,B={};Y.T=B,v1(i,!1,s,c);try{var ae=g(),me=Y.S;if(me!==null&&me(B,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var ke=e3(ae,f);ju(i,s,ke,Ea(i))}else ju(i,s,f,Ea(i))}catch(Re){ju(i,s,{then:function(){},status:"rejected",reason:Re},Ea())}finally{ne.p=x,b!==null&&B.types!==null&&(b.types=B.types),Y.T=b}}function s3(){}function g1(i,s,c,f){if(i.tag!==5)throw Error(n(476));var g=O_(i).queue;D_(i,g,s,ve,c===null?s3:function(){return F_(i),c(f)})}function O_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:ve},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function F_(i){var s=O_(i);s.next===null&&(s=i.alternate.memoizedState),ju(i,s.next.queue,{},Ea())}function x1(){return _n(af)}function M_(){return Fr().memoizedState}function L_(){return Fr().memoizedState}function o3(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=Ea();i=qs(c);var f=Xs(s,i,c);f!==null&&(oa(f,s,c),Lu(f,s,c)),s={cache:Xm()},i.payload=s;return}s=s.return}}function l3(i,s,c){var f=Ea();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ah(i)?V_(s,c):(c=Mm(i,s,c,f),c!==null&&(oa(c,i,f),B_(c,s,f)))}function P_(i,s,c){var f=Ea();ju(i,s,c,f)}function ju(i,s,c,f){var g={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(ah(i))V_(s,g);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var b=s.lastRenderedState,B=x(b,c);if(g.hasEagerState=!0,g.eagerState=B,xa(B,b))return V0(i,s,g,0),fr===null&&P0(),!1}catch{}if(c=Mm(i,s,g,f),c!==null)return oa(c,i,f),B_(c,s,f),!0}return!1}function v1(i,s,c,f){if(f={lane:2,revertLane:Y1(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},ah(i)){if(s)throw Error(n(479))}else s=Mm(i,c,f,2),s!==null&&oa(s,i,2)}function ah(i){var s=i.alternate;return i===vt||s!==null&&s===vt}function V_(i,s){mc=Q0=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function B_(i,s,c){if((c&4194048)!==0){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,qt(i,c)}}var zu={readContext:_n,use:eh,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useLayoutEffect:Ar,useInsertionEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useSyncExternalStore:Ar,useId:Ar,useHostTransitionStatus:Ar,useFormState:Ar,useActionState:Ar,useOptimistic:Ar,useMemoCache:Ar,useCacheRefresh:Ar};zu.useEffectEvent=Ar;var U_={readContext:_n,use:eh,useCallback:function(i,s){return Yn().memoizedState=[i,s===void 0?null:s],i},useContext:_n,useEffect:E_,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,rh(4194308,4,k_.bind(null,s,i),c)},useLayoutEffect:function(i,s){return rh(4194308,4,i,s)},useInsertionEffect:function(i,s){rh(4,2,i,s)},useMemo:function(i,s){var c=Yn();s=s===void 0?null:s;var f=i();if(ll){Ke(!0);try{i()}finally{Ke(!1)}}return c.memoizedState=[f,s],f},useReducer:function(i,s,c){var f=Yn();if(c!==void 0){var g=c(s);if(ll){Ke(!0);try{c(s)}finally{Ke(!1)}}}else g=s;return f.memoizedState=f.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},f.queue=i,i=i.dispatch=l3.bind(null,vt,i),[f.memoizedState,i]},useRef:function(i){var s=Yn();return i={current:i},s.memoizedState=i},useState:function(i){i=f1(i);var s=i.queue,c=P_.bind(null,vt,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:m1,useDeferredValue:function(i,s){var c=Yn();return p1(c,i,s)},useTransition:function(){var i=f1(!1);return i=D_.bind(null,vt,i.queue,!0,!1),Yn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var f=vt,g=Yn();if(Ot){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),fr===null)throw Error(n(349));(At&127)!==0||o_(f,s,c)}g.memoizedState=c;var x={value:c,getSnapshot:s};return g.queue=x,E_(c_.bind(null,f,x,i),[i]),f.flags|=2048,gc(9,{destroy:void 0},l_.bind(null,f,x,c,s),null),c},useId:function(){var i=Yn(),s=fr.identifierPrefix;if(Ot){var c=Ri,f=Ni;c=(f&~(1<<32-Ze(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=J0++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=t3++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:x1,useFormState:v_,useActionState:v_,useOptimistic:function(i){var s=Yn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=v1.bind(null,vt,!0,c),c.dispatch=s,[i,s]},useMemoCache:l1,useCacheRefresh:function(){return Yn().memoizedState=o3.bind(null,vt)},useEffectEvent:function(i){var s=Yn(),c={impl:i};return s.memoizedState=c,function(){if((Wt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},_1={readContext:_n,use:eh,useCallback:N_,useContext:_n,useEffect:d1,useImperativeHandle:C_,useInsertionEffect:b_,useLayoutEffect:A_,useMemo:R_,useReducer:th,useRef:T_,useState:function(){return th(ns)},useDebugValue:m1,useDeferredValue:function(i,s){var c=Fr();return I_(c,sr.memoizedState,i,s)},useTransition:function(){var i=th(ns)[0],s=Fr().memoizedState;return[typeof i=="boolean"?i:Uu(i),s]},useSyncExternalStore:s_,useId:M_,useHostTransitionStatus:x1,useFormState:__,useActionState:__,useOptimistic:function(i,s){var c=Fr();return h_(c,sr,i,s)},useMemoCache:l1,useCacheRefresh:L_};_1.useEffectEvent=S_;var j_={readContext:_n,use:eh,useCallback:N_,useContext:_n,useEffect:d1,useImperativeHandle:C_,useInsertionEffect:b_,useLayoutEffect:A_,useMemo:R_,useReducer:u1,useRef:T_,useState:function(){return u1(ns)},useDebugValue:m1,useDeferredValue:function(i,s){var c=Fr();return sr===null?p1(c,i,s):I_(c,sr.memoizedState,i,s)},useTransition:function(){var i=u1(ns)[0],s=Fr().memoizedState;return[typeof i=="boolean"?i:Uu(i),s]},useSyncExternalStore:s_,useId:M_,useHostTransitionStatus:x1,useFormState:w_,useActionState:w_,useOptimistic:function(i,s){var c=Fr();return sr!==null?h_(c,sr,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:l1,useCacheRefresh:L_};j_.useEffectEvent=S_;function y1(i,s,c,f){s=i.memoizedState,c=c(f,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var w1={enqueueSetState:function(i,s,c){i=i._reactInternals;var f=Ea(),g=qs(f);g.payload=s,c!=null&&(g.callback=c),s=Xs(i,g,f),s!==null&&(oa(s,i,f),Lu(s,i,f))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var f=Ea(),g=qs(f);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=Xs(i,g,f),s!==null&&(oa(s,i,f),Lu(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=Ea(),f=qs(c);f.tag=2,s!=null&&(f.callback=s),s=Xs(i,f,c),s!==null&&(oa(s,i,c),Lu(s,i,c))}};function z_(i,s,c,f,g,x,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,b):s.prototype&&s.prototype.isPureReactComponent?!Cu(c,f)||!Cu(g,x):!0}function H_(i,s,c,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==i&&w1.enqueueReplaceState(s,s.state,null)}function cl(i,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}function G_(i){L0(i)}function q_(i){console.error(i)}function X_(i){L0(i)}function ih(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function W_(i,s,c){try{var f=i.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function T1(i,s,c){return c=qs(c),c.tag=3,c.payload={element:null},c.callback=function(){ih(i,s)},c}function K_(i){return i=qs(i),i.tag=3,i}function $_(i,s,c,f){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=f.value;i.payload=function(){return g(x)},i.callback=function(){W_(s,c,f)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){W_(s,c,f),typeof g!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var B=f.stack;this.componentDidCatch(f.value,{componentStack:B!==null?B:""})})}function c3(i,s,c,f,g){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&lc(s,c,g,!0),c=_a.current,c!==null){switch(c.tag){case 31:case 13:return Ua===null?xh():c.alternate===null&&kr===0&&(kr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,f===X0?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),W1(i,f,g)),!1;case 22:return c.flags|=65536,f===X0?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),W1(i,f,g)),!1}throw Error(n(435,c.tag))}return W1(i,f,g),xh(),!1}if(Ot)return s=_a.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,f!==jm&&(i=Error(n(422),{cause:f}),Iu(La(i,c)))):(f!==jm&&(s=Error(n(423),{cause:f}),Iu(La(s,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,f=La(f,c),g=T1(i.stateNode,f,g),Jm(i,g),kr!==4&&(kr=2)),!1;var x=Error(n(520),{cause:f});if(x=La(x,c),Yu===null?Yu=[x]:Yu.push(x),kr!==4&&(kr=2),s===null)return!0;f=La(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=T1(c.stateNode,f,i),Jm(c,i),!1;case 1:if(s=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Js===null||!Js.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=K_(g),$_(g,i,c,f),Jm(c,g),!1}c=c.return}while(c!==null);return!1}var E1=Error(n(461)),qr=!1;function yn(i,s,c,f){s.child=i===null?Zv(s,null,c,f):ol(s,i.child,c,f)}function Y_(i,s,c,f,g){c=c.render;var x=s.ref;if("ref"in f){var b={};for(var B in f)B!=="ref"&&(b[B]=f[B])}else b=f;return nl(s),f=a1(i,s,c,b,x,g),B=i1(),i!==null&&!qr?(s1(i,s,g),as(i,s,g)):(Ot&&B&&Bm(s),s.flags|=1,yn(i,s,f,g),s.child)}function Q_(i,s,c,f,g){if(i===null){var x=c.type;return typeof x=="function"&&!Lm(x)&&x.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=x,J_(i,s,x,f,g)):(i=U0(c.type,null,f,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(x=i.child,!I1(i,g)){var b=x.memoizedProps;if(c=c.compare,c=c!==null?c:Cu,c(b,f)&&i.ref===s.ref)return as(i,s,g)}return s.flags|=1,i=Ji(x,f),i.ref=s.ref,i.return=s,s.child=i}function J_(i,s,c,f,g){if(i!==null){var x=i.memoizedProps;if(Cu(x,f)&&i.ref===s.ref)if(qr=!1,s.pendingProps=f=x,I1(i,g))(i.flags&131072)!==0&&(qr=!0);else return s.lanes=i.lanes,as(i,s,g)}return S1(i,s,c,f,g)}function Z_(i,s,c,f){var g=f.children,x=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,i!==null){for(f=s.child=i.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;f=g&~x}else f=0,s.child=null;return e2(i,s,x,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&G0(s,x!==null?x.cachePool:null),x!==null?r_(s,x):e1(),n_(s);else return f=s.lanes=536870912,e2(i,s,x!==null?x.baseLanes|c:c,c,f)}else x!==null?(G0(s,x.cachePool),r_(s,x),Ks(),s.memoizedState=null):(i!==null&&G0(s,null),e1(),Ks());return yn(i,s,g,c),s.child}function Hu(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function e2(i,s,c,f,g){var x=Km();return x=x===null?null:{parent:Hr._currentValue,pool:x},s.memoizedState={baseLanes:c,cachePool:x},i!==null&&G0(s,null),e1(),n_(s),i!==null&&lc(i,s,f,!0),s.childLanes=g,null}function sh(i,s){return s=lh({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function t2(i,s,c){return ol(s,i.child,null,c),i=sh(s,s.pendingProps),i.flags|=2,ya(s),s.memoizedState=null,i}function u3(i,s,c){var f=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(Ot){if(f.mode==="hidden")return i=sh(s,f),s.lanes=536870912,Hu(null,i);if(r1(s),(i=hr)?(i=dy(i,Ba),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Us!==null?{id:Ni,overflow:Ri}:null,retryLane:536870912,hydrationErrors:null},c=Vv(i),c.return=s,s.child=c,vn=s,hr=null)):i=null,i===null)throw zs(s);return s.lanes=536870912,null}return sh(s,f)}var x=i.memoizedState;if(x!==null){var b=x.dehydrated;if(r1(s),g)if(s.flags&256)s.flags&=-257,s=t2(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(n(558));else if(qr||lc(i,s,c,!1),g=(c&i.childLanes)!==0,qr||g){if(f=fr,f!==null&&(b=Kn(f,c),b!==0&&b!==x.retryLane))throw x.retryLane=b,Zo(i,b),oa(f,i,b),E1;xh(),s=t2(i,s,c)}else i=x.treeContext,hr=ja(b.nextSibling),vn=s,Ot=!0,js=null,Ba=!1,i!==null&&jv(s,i),s=sh(s,f),s.flags|=4096;return s}return i=Ji(i.child,{mode:f.mode,children:f.children}),i.ref=s.ref,s.child=i,i.return=s,i}function oh(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function S1(i,s,c,f,g){return nl(s),c=a1(i,s,c,f,void 0,g),f=i1(),i!==null&&!qr?(s1(i,s,g),as(i,s,g)):(Ot&&f&&Bm(s),s.flags|=1,yn(i,s,c,g),s.child)}function r2(i,s,c,f,g,x){return nl(s),s.updateQueue=null,c=i_(s,f,c,g),a_(i),f=i1(),i!==null&&!qr?(s1(i,s,x),as(i,s,x)):(Ot&&f&&Bm(s),s.flags|=1,yn(i,s,c,x),s.child)}function n2(i,s,c,f,g){if(nl(s),s.stateNode===null){var x=ac,b=c.contextType;typeof b=="object"&&b!==null&&(x=_n(b)),x=new c(f,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=w1,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=f,x.state=s.memoizedState,x.refs={},Ym(s),b=c.contextType,x.context=typeof b=="object"&&b!==null?_n(b):ac,x.state=s.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(y1(s,c,b,f),x.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(b=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),b!==x.state&&w1.enqueueReplaceState(x,x.state,null),Vu(s,f,x,g),Pu(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){x=s.stateNode;var B=s.memoizedProps,ae=cl(c,B);x.props=ae;var me=x.context,ke=c.contextType;b=ac,typeof ke=="object"&&ke!==null&&(b=_n(ke));var Re=c.getDerivedStateFromProps;ke=typeof Re=="function"||typeof x.getSnapshotBeforeUpdate=="function",B=s.pendingProps!==B,ke||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(B||me!==b)&&H_(s,x,f,b),Gs=!1;var xe=s.memoizedState;x.state=xe,Vu(s,f,x,g),Pu(),me=s.memoizedState,B||xe!==me||Gs?(typeof Re=="function"&&(y1(s,c,Re,f),me=s.memoizedState),(ae=Gs||z_(s,c,ae,f,xe,me,b))?(ke||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=me),x.props=f,x.state=me,x.context=b,f=ae):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{x=s.stateNode,Qm(i,s),b=s.memoizedProps,ke=cl(c,b),x.props=ke,Re=s.pendingProps,xe=x.context,me=c.contextType,ae=ac,typeof me=="object"&&me!==null&&(ae=_n(me)),B=c.getDerivedStateFromProps,(me=typeof B=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(b!==Re||xe!==ae)&&H_(s,x,f,ae),Gs=!1,xe=s.memoizedState,x.state=xe,Vu(s,f,x,g),Pu();var we=s.memoizedState;b!==Re||xe!==we||Gs||i!==null&&i.dependencies!==null&&z0(i.dependencies)?(typeof B=="function"&&(y1(s,c,B,f),we=s.memoizedState),(ke=Gs||z_(s,c,ke,f,xe,we,ae)||i!==null&&i.dependencies!==null&&z0(i.dependencies))?(me||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,we,ae),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,we,ae)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=we),x.props=f,x.state=we,x.context=ae,f=ke):(typeof x.componentDidUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(s.flags|=1024),f=!1)}return x=f,oh(i,s),f=(s.flags&128)!==0,x||f?(x=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,i!==null&&f?(s.child=ol(s,i.child,null,g),s.child=ol(s,null,c,g)):yn(i,s,c,g),s.memoizedState=x.state,i=s.child):i=as(i,s,g),i}function a2(i,s,c,f){return tl(),s.flags|=256,yn(i,s,c,f),s.child}var b1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function A1(i){return{baseLanes:i,cachePool:Wv()}}function k1(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=Ta),i}function i2(i,s,c){var f=s.pendingProps,g=!1,x=(s.flags&128)!==0,b;if((b=x)||(b=i!==null&&i.memoizedState===null?!1:(Or.current&2)!==0),b&&(g=!0,s.flags&=-129),b=(s.flags&32)!==0,s.flags&=-33,i===null){if(Ot){if(g?Ws(s):Ks(),(i=hr)?(i=dy(i,Ba),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Us!==null?{id:Ni,overflow:Ri}:null,retryLane:536870912,hydrationErrors:null},c=Vv(i),c.return=s,s.child=c,vn=s,hr=null)):i=null,i===null)throw zs(s);return cp(i)?s.lanes=32:s.lanes=536870912,null}var B=f.children;return f=f.fallback,g?(Ks(),g=s.mode,B=lh({mode:"hidden",children:B},g),f=el(f,g,c,null),B.return=s,f.return=s,B.sibling=f,s.child=B,f=s.child,f.memoizedState=A1(c),f.childLanes=k1(i,b,c),s.memoizedState=b1,Hu(null,f)):(Ws(s),C1(s,B))}var ae=i.memoizedState;if(ae!==null&&(B=ae.dehydrated,B!==null)){if(x)s.flags&256?(Ws(s),s.flags&=-257,s=N1(i,s,c)):s.memoizedState!==null?(Ks(),s.child=i.child,s.flags|=128,s=null):(Ks(),B=f.fallback,g=s.mode,f=lh({mode:"visible",children:f.children},g),B=el(B,g,c,null),B.flags|=2,f.return=s,B.return=s,f.sibling=B,s.child=f,ol(s,i.child,null,c),f=s.child,f.memoizedState=A1(c),f.childLanes=k1(i,b,c),s.memoizedState=b1,s=Hu(null,f));else if(Ws(s),cp(B)){if(b=B.nextSibling&&B.nextSibling.dataset,b)var me=b.dgst;b=me,f=Error(n(419)),f.stack="",f.digest=b,Iu({value:f,source:null,stack:null}),s=N1(i,s,c)}else if(qr||lc(i,s,c,!1),b=(c&i.childLanes)!==0,qr||b){if(b=fr,b!==null&&(f=Kn(b,c),f!==0&&f!==ae.retryLane))throw ae.retryLane=f,Zo(i,f),oa(b,i,f),E1;lp(B)||xh(),s=N1(i,s,c)}else lp(B)?(s.flags|=192,s.child=i.child,s=null):(i=ae.treeContext,hr=ja(B.nextSibling),vn=s,Ot=!0,js=null,Ba=!1,i!==null&&jv(s,i),s=C1(s,f.children),s.flags|=4096);return s}return g?(Ks(),B=f.fallback,g=s.mode,ae=i.child,me=ae.sibling,f=Ji(ae,{mode:"hidden",children:f.children}),f.subtreeFlags=ae.subtreeFlags&65011712,me!==null?B=Ji(me,B):(B=el(B,g,c,null),B.flags|=2),B.return=s,f.return=s,f.sibling=B,s.child=f,Hu(null,f),f=s.child,B=i.child.memoizedState,B===null?B=A1(c):(g=B.cachePool,g!==null?(ae=Hr._currentValue,g=g.parent!==ae?{parent:ae,pool:ae}:g):g=Wv(),B={baseLanes:B.baseLanes|c,cachePool:g}),f.memoizedState=B,f.childLanes=k1(i,b,c),s.memoizedState=b1,Hu(i.child,f)):(Ws(s),c=i.child,i=c.sibling,c=Ji(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,i!==null&&(b=s.deletions,b===null?(s.deletions=[i],s.flags|=16):b.push(i)),s.child=c,s.memoizedState=null,c)}function C1(i,s){return s=lh({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function lh(i,s){return i=va(22,i,null,s),i.lanes=0,i}function N1(i,s,c){return ol(s,i.child,null,c),i=C1(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function s2(i,s,c){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),Gm(i.return,s,c)}function R1(i,s,c,f,g,x){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:g,treeForkCount:x}:(b.isBackwards=s,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=c,b.tailMode=g,b.treeForkCount=x)}function o2(i,s,c){var f=s.pendingProps,g=f.revealOrder,x=f.tail;f=f.children;var b=Or.current,B=(b&2)!==0;if(B?(b=b&1|2,s.flags|=128):b&=1,q(Or,b),yn(i,s,f,c),f=Ot?Ru:0,!B&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&s2(i,c,s);else if(i.tag===19)s2(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&Y0(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),R1(s,!1,g,c,x,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&Y0(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}R1(s,!0,c,null,x,f);break;case"together":R1(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function as(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Qs|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(lc(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,c=Ji(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Ji(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function I1(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&z0(i)))}function f3(i,s,c){switch(s.tag){case 3:be(s,s.stateNode.containerInfo),Hs(s,Hr,i.memoizedState.cache),tl();break;case 27:case 5:Ie(s);break;case 4:be(s,s.stateNode.containerInfo);break;case 10:Hs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,r1(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Ws(s),s.flags|=128,null):(c&s.child.childLanes)!==0?i2(i,s,c):(Ws(s),i=as(i,s,c),i!==null?i.sibling:null);Ws(s);break;case 19:var g=(i.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(lc(i,s,c,!1),f=(c&s.childLanes)!==0),g){if(f)return o2(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),q(Or,Or.current),f)break;return null;case 22:return s.lanes=0,Z_(i,s,c,s.pendingProps);case 24:Hs(s,Hr,i.memoizedState.cache)}return as(i,s,c)}function l2(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)qr=!0;else{if(!I1(i,c)&&(s.flags&128)===0)return qr=!1,f3(i,s,c);qr=(i.flags&131072)!==0}else qr=!1,Ot&&(s.flags&1048576)!==0&&Uv(s,Ru,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(i=il(s.elementType),s.type=i,typeof i=="function")Lm(i)?(f=cl(i,f),s.tag=1,s=n2(null,s,i,f,c)):(s.tag=0,s=S1(null,s,i,f,c));else{if(i!=null){var g=i.$$typeof;if(g===Q){s.tag=11,s=Y_(null,s,i,f,c);break e}else if(g===k){s.tag=14,s=Q_(null,s,i,f,c);break e}}throw s=Te(i)||i,Error(n(306,s,""))}}return s;case 0:return S1(i,s,s.type,s.pendingProps,c);case 1:return f=s.type,g=cl(f,s.pendingProps),n2(i,s,f,g,c);case 3:e:{if(be(s,s.stateNode.containerInfo),i===null)throw Error(n(387));f=s.pendingProps;var x=s.memoizedState;g=x.element,Qm(i,s),Vu(s,f,null,c);var b=s.memoizedState;if(f=b.cache,Hs(s,Hr,f),f!==x.cache&&qm(s,[Hr],c,!0),Pu(),f=b.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:b.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=a2(i,s,f,c);break e}else if(f!==g){g=La(Error(n(424)),s),Iu(g),s=a2(i,s,f,c);break e}else for(i=s.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,hr=ja(i.firstChild),vn=s,Ot=!0,js=null,Ba=!0,c=Zv(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(tl(),f===g){s=as(i,s,c);break e}yn(i,s,f,c)}s=s.child}return s;case 26:return oh(i,s),i===null?(c=_y(s.type,null,s.pendingProps,null))?s.memoizedState=c:Ot||(c=s.type,i=s.pendingProps,f=Sh(le.current).createElement(c),f[H]=s,f[X]=i,wn(f,c,i),Ye(f),s.stateNode=f):s.memoizedState=_y(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Ie(s),i===null&&Ot&&(f=s.stateNode=gy(s.type,s.pendingProps,le.current),vn=s,Ba=!0,g=hr,ro(s.type)?(up=g,hr=ja(f.firstChild)):hr=g),yn(i,s,s.pendingProps.children,c),oh(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Ot&&((g=f=hr)&&(f=j3(f,s.type,s.pendingProps,Ba),f!==null?(s.stateNode=f,vn=s,hr=ja(f.firstChild),Ba=!1,g=!0):g=!1),g||zs(s)),Ie(s),g=s.type,x=s.pendingProps,b=i!==null?i.memoizedProps:null,f=x.children,ip(g,x)?f=null:b!==null&&ip(g,b)&&(s.flags|=32),s.memoizedState!==null&&(g=a1(i,s,r3,null,null,c),af._currentValue=g),oh(i,s),yn(i,s,f,c),s.child;case 6:return i===null&&Ot&&((i=c=hr)&&(c=z3(c,s.pendingProps,Ba),c!==null?(s.stateNode=c,vn=s,hr=null,i=!0):i=!1),i||zs(s)),null;case 13:return i2(i,s,c);case 4:return be(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=ol(s,null,f,c):yn(i,s,f,c),s.child;case 11:return Y_(i,s,s.type,s.pendingProps,c);case 7:return yn(i,s,s.pendingProps,c),s.child;case 8:return yn(i,s,s.pendingProps.children,c),s.child;case 12:return yn(i,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,Hs(s,s.type,f.value),yn(i,s,f.children,c),s.child;case 9:return g=s.type._context,f=s.pendingProps.children,nl(s),g=_n(g),f=f(g),s.flags|=1,yn(i,s,f,c),s.child;case 14:return Q_(i,s,s.type,s.pendingProps,c);case 15:return J_(i,s,s.type,s.pendingProps,c);case 19:return o2(i,s,c);case 31:return u3(i,s,c);case 22:return Z_(i,s,c,s.pendingProps);case 24:return nl(s),f=_n(Hr),i===null?(g=Km(),g===null&&(g=fr,x=Xm(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),s.memoizedState={parent:f,cache:g},Ym(s),Hs(s,Hr,g)):((i.lanes&c)!==0&&(Qm(i,s),Vu(s,null,null,c),Pu()),g=i.memoizedState,x=s.memoizedState,g.parent!==f?(g={parent:f,cache:f},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Hs(s,Hr,f)):(f=x.cache,Hs(s,Hr,f),f!==g.cache&&qm(s,[Hr],c,!0))),yn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function is(i){i.flags|=4}function D1(i,s,c,f,g){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(M2())i.flags|=8192;else throw sl=X0,$m}else i.flags&=-16777217}function c2(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Sy(s))if(M2())i.flags|=8192;else throw sl=X0,$m}function ch(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?wi():536870912,i.lanes|=s,yc|=s)}function Gu(i,s){if(!Ot)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function dr(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=c,s}function h3(i,s,c){var f=s.pendingProps;switch(Um(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(s),null;case 1:return dr(s),null;case 3:return c=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),ts(Hr),Ee(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(oc(s)?is(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,zm())),dr(s),null;case 26:var g=s.type,x=s.memoizedState;return i===null?(is(s),x!==null?(dr(s),c2(s,x)):(dr(s),D1(s,g,null,f,c))):x?x!==i.memoizedState?(is(s),dr(s),c2(s,x)):(dr(s),s.flags&=-16777217):(i=i.memoizedProps,i!==f&&is(s),dr(s),D1(s,g,i,f,c)),null;case 27:if(nt(s),c=le.current,g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&is(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return dr(s),null}i=G.current,oc(s)?zv(s):(i=gy(g,f,c),s.stateNode=i,is(s))}return dr(s),null;case 5:if(nt(s),g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&is(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return dr(s),null}if(x=G.current,oc(s))zv(s);else{var b=Sh(le.current);switch(x){case 1:x=b.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:x=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":x=b.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":x=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":x=b.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof f.is=="string"?b.createElement("select",{is:f.is}):b.createElement("select"),f.multiple?x.multiple=!0:f.size&&(x.size=f.size);break;default:x=typeof f.is=="string"?b.createElement(g,{is:f.is}):b.createElement(g)}}x[H]=s,x[X]=f;e:for(b=s.child;b!==null;){if(b.tag===5||b.tag===6)x.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===s)break e;for(;b.sibling===null;){if(b.return===null||b.return===s)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}s.stateNode=x;e:switch(wn(x,g,f),g){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&is(s)}}return dr(s),D1(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&is(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(i=le.current,oc(s)){if(i=s.stateNode,c=s.memoizedProps,f=null,g=vn,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}i[H]=s,i=!!(i.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||iy(i.nodeValue,c)),i||zs(s,!0)}else i=Sh(i).createTextNode(f),i[H]=s,s.stateNode=i}return dr(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(f=oc(s),c!==null){if(i===null){if(!f)throw Error(n(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[H]=s}else tl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;dr(s),i=!1}else c=zm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(ya(s),s):(ya(s),null);if((s.flags&128)!==0)throw Error(n(558))}return dr(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=oc(s),f!==null&&f.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[H]=s}else tl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;dr(s),g=!1}else g=zm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(ya(s),s):(ya(s),null)}return ya(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,i=i!==null&&i.memoizedState!==null,c&&(f=s.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==g&&(f.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),ch(s,s.updateQueue),dr(s),null);case 4:return Ee(),i===null&&ep(s.stateNode.containerInfo),dr(s),null;case 10:return ts(s.type),dr(s),null;case 19:if(M(Or),f=s.memoizedState,f===null)return dr(s),null;if(g=(s.flags&128)!==0,x=f.rendering,x===null)if(g)Gu(f,!1);else{if(kr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(x=Y0(i),x!==null){for(s.flags|=128,Gu(f,!1),i=x.updateQueue,s.updateQueue=i,ch(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Pv(c,i),c=c.sibling;return q(Or,Or.current&1|2),Ot&&Zi(s,f.treeForkCount),s.child}i=i.sibling}f.tail!==null&&Lt()>mh&&(s.flags|=128,g=!0,Gu(f,!1),s.lanes=4194304)}else{if(!g)if(i=Y0(x),i!==null){if(s.flags|=128,g=!0,i=i.updateQueue,s.updateQueue=i,ch(s,i),Gu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!Ot)return dr(s),null}else 2*Lt()-f.renderingStartTime>mh&&c!==536870912&&(s.flags|=128,g=!0,Gu(f,!1),s.lanes=4194304);f.isBackwards?(x.sibling=s.child,s.child=x):(i=f.last,i!==null?i.sibling=x:s.child=x,f.last=x)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Lt(),i.sibling=null,c=Or.current,q(Or,g?c&1|2:c&1),Ot&&Zi(s,f.treeForkCount),i):(dr(s),null);case 22:case 23:return ya(s),t1(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(dr(s),s.subtreeFlags&6&&(s.flags|=8192)):dr(s),c=s.updateQueue,c!==null&&ch(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),i!==null&&M(al),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),ts(Hr),dr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function d3(i,s){switch(Um(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return ts(Hr),Ee(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return nt(s),null;case 31:if(s.memoizedState!==null){if(ya(s),s.alternate===null)throw Error(n(340));tl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(ya(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));tl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return M(Or),null;case 4:return Ee(),null;case 10:return ts(s.type),null;case 22:case 23:return ya(s),t1(),i!==null&&M(al),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return ts(Hr),null;case 25:return null;default:return null}}function u2(i,s){switch(Um(s),s.tag){case 3:ts(Hr),Ee();break;case 26:case 27:case 5:nt(s);break;case 4:Ee();break;case 31:s.memoizedState!==null&&ya(s);break;case 13:ya(s);break;case 19:M(Or);break;case 10:ts(s.type);break;case 22:case 23:ya(s),t1(),i!==null&&M(al);break;case 24:ts(Hr)}}function qu(i,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&i)===i){f=void 0;var x=c.create,b=c.inst;f=x(),b.destroy=f}c=c.next}while(c!==g)}}catch(B){er(s,s.return,B)}}function $s(i,s,c){try{var f=s.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&i)===i){var b=f.inst,B=b.destroy;if(B!==void 0){b.destroy=void 0,g=s;var ae=c,me=B;try{me()}catch(ke){er(g,ae,ke)}}}f=f.next}while(f!==x)}}catch(ke){er(s,s.return,ke)}}function f2(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{t_(s,c)}catch(f){er(i,i.return,f)}}}function h2(i,s,c){c.props=cl(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(f){er(i,s,f)}}function Xu(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof c=="function"?i.refCleanup=c(f):c.current=f}}catch(g){er(i,s,g)}}function Ii(i,s){var c=i.ref,f=i.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(g){er(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){er(i,s,g)}else c.current=null}function d2(i){var s=i.type,c=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(g){er(i,i.return,g)}}function O1(i,s,c){try{var f=i.stateNode;M3(f,i.type,c,s),f[X]=s}catch(g){er(i,i.return,g)}}function m2(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ro(i.type)||i.tag===4}function F1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||m2(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ro(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function M1(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=ai));else if(f!==4&&(f===27&&ro(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(M1(i,s,c),i=i.sibling;i!==null;)M1(i,s,c),i=i.sibling}function uh(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(f!==4&&(f===27&&ro(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(uh(i,s,c),i=i.sibling;i!==null;)uh(i,s,c),i=i.sibling}function p2(i){var s=i.stateNode,c=i.memoizedProps;try{for(var f=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);wn(s,f,c),s[H]=i,s[X]=c}catch(x){er(i,i.return,x)}}var ss=!1,Xr=!1,L1=!1,g2=typeof WeakSet=="function"?WeakSet:Set,fn=null;function m3(i,s){if(i=i.containerInfo,np=Ih,i=Cv(i),Nm(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var g=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var b=0,B=-1,ae=-1,me=0,ke=0,Re=i,xe=null;t:for(;;){for(var we;Re!==c||g!==0&&Re.nodeType!==3||(B=b+g),Re!==x||f!==0&&Re.nodeType!==3||(ae=b+f),Re.nodeType===3&&(b+=Re.nodeValue.length),(we=Re.firstChild)!==null;)xe=Re,Re=we;for(;;){if(Re===i)break t;if(xe===c&&++me===g&&(B=b),xe===x&&++ke===f&&(ae=b),(we=Re.nextSibling)!==null)break;Re=xe,xe=Re.parentNode}Re=we}c=B===-1||ae===-1?null:{start:B,end:ae}}else c=null}c=c||{start:0,end:0}}else c=null;for(ap={focusedElem:i,selectionRange:c},Ih=!1,fn=s;fn!==null;)if(s=fn,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,fn=i;else for(;fn!==null;){switch(s=fn,x=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)g=i[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,c=s,g=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var $e=cl(c.type,g);i=f.getSnapshotBeforeUpdate($e,x),f.__reactInternalSnapshotBeforeUpdate=i}catch(it){er(c,c.return,it)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)op(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":op(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,fn=i;break}fn=s.return}}function x2(i,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ls(i,c),f&4&&qu(5,c);break;case 1:if(ls(i,c),f&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(b){er(c,c.return,b)}else{var g=cl(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(b){er(c,c.return,b)}}f&64&&f2(c),f&512&&Xu(c,c.return);break;case 3:if(ls(i,c),f&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{t_(i,s)}catch(b){er(c,c.return,b)}}break;case 27:s===null&&f&4&&p2(c);case 26:case 5:ls(i,c),s===null&&f&4&&d2(c),f&512&&Xu(c,c.return);break;case 12:ls(i,c);break;case 31:ls(i,c),f&4&&y2(i,c);break;case 13:ls(i,c),f&4&&w2(i,c),f&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=E3.bind(null,c),H3(i,c))));break;case 22:if(f=c.memoizedState!==null||ss,!f){s=s!==null&&s.memoizedState!==null||Xr,g=ss;var x=Xr;ss=f,(Xr=s)&&!x?cs(i,c,(c.subtreeFlags&8772)!==0):ls(i,c),ss=g,Xr=x}break;case 30:break;default:ls(i,c)}}function v2(i){var s=i.alternate;s!==null&&(i.alternate=null,v2(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Pe(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var wr=null,na=!1;function os(i,s,c){for(c=c.child;c!==null;)_2(i,s,c),c=c.sibling}function _2(i,s,c){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(De,c)}catch{}switch(c.tag){case 26:Xr||Ii(c,s),os(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Xr||Ii(c,s);var f=wr,g=na;ro(c.type)&&(wr=c.stateNode,na=!1),os(i,s,c),tf(c.stateNode),wr=f,na=g;break;case 5:Xr||Ii(c,s);case 6:if(f=wr,g=na,wr=null,os(i,s,c),wr=f,na=g,wr!==null)if(na)try{(wr.nodeType===9?wr.body:wr.nodeName==="HTML"?wr.ownerDocument.body:wr).removeChild(c.stateNode)}catch(x){er(c,s,x)}else try{wr.removeChild(c.stateNode)}catch(x){er(c,s,x)}break;case 18:wr!==null&&(na?(i=wr,fy(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Cc(i)):fy(wr,c.stateNode));break;case 4:f=wr,g=na,wr=c.stateNode.containerInfo,na=!0,os(i,s,c),wr=f,na=g;break;case 0:case 11:case 14:case 15:$s(2,c,s),Xr||$s(4,c,s),os(i,s,c);break;case 1:Xr||(Ii(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&h2(c,s,f)),os(i,s,c);break;case 21:os(i,s,c);break;case 22:Xr=(f=Xr)||c.memoizedState!==null,os(i,s,c),Xr=f;break;default:os(i,s,c)}}function y2(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Cc(i)}catch(c){er(s,s.return,c)}}}function w2(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Cc(i)}catch(c){er(s,s.return,c)}}function p3(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new g2),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new g2),s;default:throw Error(n(435,i.tag))}}function fh(i,s){var c=p3(i);s.forEach(function(f){if(!c.has(f)){c.add(f);var g=S3.bind(null,i,f);f.then(g,g)}})}function aa(i,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var g=c[f],x=i,b=s,B=b;e:for(;B!==null;){switch(B.tag){case 27:if(ro(B.type)){wr=B.stateNode,na=!1;break e}break;case 5:wr=B.stateNode,na=!1;break e;case 3:case 4:wr=B.stateNode.containerInfo,na=!0;break e}B=B.return}if(wr===null)throw Error(n(160));_2(x,b,g),wr=null,na=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)T2(s,i),s=s.sibling}var ui=null;function T2(i,s){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:aa(s,i),ia(i),f&4&&($s(3,i,i.return),qu(3,i),$s(5,i,i.return));break;case 1:aa(s,i),ia(i),f&512&&(Xr||c===null||Ii(c,c.return)),f&64&&ss&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var g=ui;if(aa(s,i),ia(i),f&512&&(Xr||c===null||Ii(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=i.memoizedState,c===null)if(f===null)if(i.stateNode===null){e:{f=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":x=g.getElementsByTagName("title")[0],(!x||x[pe]||x[H]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(f),g.head.insertBefore(x,g.querySelector("head > title"))),wn(x,f,c),x[H]=i,Ye(x),f=x;break e;case"link":var b=Ty("link","href",g).get(f+(c.href||""));if(b){for(var B=0;B<b.length;B++)if(x=b[B],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(B,1);break t}}x=g.createElement(f),wn(x,f,c),g.head.appendChild(x);break;case"meta":if(b=Ty("meta","content",g).get(f+(c.content||""))){for(B=0;B<b.length;B++)if(x=b[B],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(B,1);break t}}x=g.createElement(f),wn(x,f,c),g.head.appendChild(x);break;default:throw Error(n(468,f))}x[H]=i,Ye(x),f=x}i.stateNode=f}else Ey(g,i.type,i.stateNode);else i.stateNode=wy(g,f,i.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?Ey(g,i.type,i.stateNode):wy(g,f,i.memoizedProps)):f===null&&i.stateNode!==null&&O1(i,i.memoizedProps,c.memoizedProps)}break;case 27:aa(s,i),ia(i),f&512&&(Xr||c===null||Ii(c,c.return)),c!==null&&f&4&&O1(i,i.memoizedProps,c.memoizedProps);break;case 5:if(aa(s,i),ia(i),f&512&&(Xr||c===null||Ii(c,c.return)),i.flags&32){g=i.stateNode;try{ra(g,"")}catch($e){er(i,i.return,$e)}}f&4&&i.stateNode!=null&&(g=i.memoizedProps,O1(i,g,c!==null?c.memoizedProps:g)),f&1024&&(L1=!0);break;case 6:if(aa(s,i),ia(i),f&4){if(i.stateNode===null)throw Error(n(162));f=i.memoizedProps,c=i.stateNode;try{c.nodeValue=f}catch($e){er(i,i.return,$e)}}break;case 3:if(kh=null,g=ui,ui=bh(s.containerInfo),aa(s,i),ui=g,ia(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Cc(s.containerInfo)}catch($e){er(i,i.return,$e)}L1&&(L1=!1,E2(i));break;case 4:f=ui,ui=bh(i.stateNode.containerInfo),aa(s,i),ia(i),ui=f;break;case 12:aa(s,i),ia(i);break;case 31:aa(s,i),ia(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,fh(i,f)));break;case 13:aa(s,i),ia(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(dh=Lt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,fh(i,f)));break;case 22:g=i.memoizedState!==null;var ae=c!==null&&c.memoizedState!==null,me=ss,ke=Xr;if(ss=me||g,Xr=ke||ae,aa(s,i),Xr=ke,ss=me,ia(i),f&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||ae||ss||Xr||ul(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){ae=c=s;try{if(x=ae.stateNode,g)b=x.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{B=ae.stateNode;var Re=ae.memoizedProps.style,xe=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;B.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch($e){er(ae,ae.return,$e)}}}else if(s.tag===6){if(c===null){ae=s;try{ae.stateNode.nodeValue=g?"":ae.memoizedProps}catch($e){er(ae,ae.return,$e)}}}else if(s.tag===18){if(c===null){ae=s;try{var we=ae.stateNode;g?hy(we,!0):hy(ae.stateNode,!1)}catch($e){er(ae,ae.return,$e)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,fh(i,c))));break;case 19:aa(s,i),ia(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,fh(i,f)));break;case 30:break;case 21:break;default:aa(s,i),ia(i)}}function ia(i){var s=i.flags;if(s&2){try{for(var c,f=i.return;f!==null;){if(m2(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,x=F1(i);uh(i,x,g);break;case 5:var b=c.stateNode;c.flags&32&&(ra(b,""),c.flags&=-33);var B=F1(i);uh(i,B,b);break;case 3:case 4:var ae=c.stateNode.containerInfo,me=F1(i);M1(i,me,ae);break;default:throw Error(n(161))}}catch(ke){er(i,i.return,ke)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function E2(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;E2(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function ls(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)x2(i,s.alternate,s),s=s.sibling}function ul(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:$s(4,s,s.return),ul(s);break;case 1:Ii(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&h2(s,s.return,c),ul(s);break;case 27:tf(s.stateNode);case 26:case 5:Ii(s,s.return),ul(s);break;case 22:s.memoizedState===null&&ul(s);break;case 30:ul(s);break;default:ul(s)}i=i.sibling}}function cs(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,g=i,x=s,b=x.flags;switch(x.tag){case 0:case 11:case 15:cs(g,x,c),qu(4,x);break;case 1:if(cs(g,x,c),f=x,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(me){er(f,f.return,me)}if(f=x,g=f.updateQueue,g!==null){var B=f.stateNode;try{var ae=g.shared.hiddenCallbacks;if(ae!==null)for(g.shared.hiddenCallbacks=null,g=0;g<ae.length;g++)e_(ae[g],B)}catch(me){er(f,f.return,me)}}c&&b&64&&f2(x),Xu(x,x.return);break;case 27:p2(x);case 26:case 5:cs(g,x,c),c&&f===null&&b&4&&d2(x),Xu(x,x.return);break;case 12:cs(g,x,c);break;case 31:cs(g,x,c),c&&b&4&&y2(g,x);break;case 13:cs(g,x,c),c&&b&4&&w2(g,x);break;case 22:x.memoizedState===null&&cs(g,x,c),Xu(x,x.return);break;case 30:break;default:cs(g,x,c)}s=s.sibling}}function P1(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Du(c))}function V1(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Du(i))}function fi(i,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)S2(i,s,c,f),s=s.sibling}function S2(i,s,c,f){var g=s.flags;switch(s.tag){case 0:case 11:case 15:fi(i,s,c,f),g&2048&&qu(9,s);break;case 1:fi(i,s,c,f);break;case 3:fi(i,s,c,f),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Du(i)));break;case 12:if(g&2048){fi(i,s,c,f),i=s.stateNode;try{var x=s.memoizedProps,b=x.id,B=x.onPostCommit;typeof B=="function"&&B(b,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ae){er(s,s.return,ae)}}else fi(i,s,c,f);break;case 31:fi(i,s,c,f);break;case 13:fi(i,s,c,f);break;case 23:break;case 22:x=s.stateNode,b=s.alternate,s.memoizedState!==null?x._visibility&2?fi(i,s,c,f):Wu(i,s):x._visibility&2?fi(i,s,c,f):(x._visibility|=2,xc(i,s,c,f,(s.subtreeFlags&10256)!==0||!1)),g&2048&&P1(b,s);break;case 24:fi(i,s,c,f),g&2048&&V1(s.alternate,s);break;default:fi(i,s,c,f)}}function xc(i,s,c,f,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var x=i,b=s,B=c,ae=f,me=b.flags;switch(b.tag){case 0:case 11:case 15:xc(x,b,B,ae,g),qu(8,b);break;case 23:break;case 22:var ke=b.stateNode;b.memoizedState!==null?ke._visibility&2?xc(x,b,B,ae,g):Wu(x,b):(ke._visibility|=2,xc(x,b,B,ae,g)),g&&me&2048&&P1(b.alternate,b);break;case 24:xc(x,b,B,ae,g),g&&me&2048&&V1(b.alternate,b);break;default:xc(x,b,B,ae,g)}s=s.sibling}}function Wu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,f=s,g=f.flags;switch(f.tag){case 22:Wu(c,f),g&2048&&P1(f.alternate,f);break;case 24:Wu(c,f),g&2048&&V1(f.alternate,f);break;default:Wu(c,f)}s=s.sibling}}var Ku=8192;function vc(i,s,c){if(i.subtreeFlags&Ku)for(i=i.child;i!==null;)b2(i,s,c),i=i.sibling}function b2(i,s,c){switch(i.tag){case 26:vc(i,s,c),i.flags&Ku&&i.memoizedState!==null&&tC(c,ui,i.memoizedState,i.memoizedProps);break;case 5:vc(i,s,c);break;case 3:case 4:var f=ui;ui=bh(i.stateNode.containerInfo),vc(i,s,c),ui=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=Ku,Ku=16777216,vc(i,s,c),Ku=f):vc(i,s,c));break;default:vc(i,s,c)}}function A2(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function $u(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];fn=f,C2(f,i)}A2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)k2(i),i=i.sibling}function k2(i){switch(i.tag){case 0:case 11:case 15:$u(i),i.flags&2048&&$s(9,i,i.return);break;case 3:$u(i);break;case 12:$u(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,hh(i)):$u(i);break;default:$u(i)}}function hh(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];fn=f,C2(f,i)}A2(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:$s(8,s,s.return),hh(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,hh(s));break;default:hh(s)}i=i.sibling}}function C2(i,s){for(;fn!==null;){var c=fn;switch(c.tag){case 0:case 11:case 15:$s(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Du(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,fn=f;else e:for(c=i;fn!==null;){f=fn;var g=f.sibling,x=f.return;if(v2(f),f===c){fn=null;break e}if(g!==null){g.return=x,fn=g;break e}fn=x}}}var g3={getCacheForType:function(i){var s=_n(Hr),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return _n(Hr).controller.signal}},x3=typeof WeakMap=="function"?WeakMap:Map,Wt=0,fr=null,St=null,At=0,Zt=0,wa=null,Ys=!1,_c=!1,B1=!1,us=0,kr=0,Qs=0,fl=0,U1=0,Ta=0,yc=0,Yu=null,sa=null,j1=!1,dh=0,N2=0,mh=1/0,ph=null,Js=null,rn=0,Zs=null,wc=null,fs=0,z1=0,H1=null,R2=null,Qu=0,G1=null;function Ea(){return(Wt&2)!==0&&At!==0?At&-At:Y.T!==null?Y1():P()}function I2(){if(Ta===0)if((At&536870912)===0||Ot){var i=ea;ea<<=1,(ea&3932160)===0&&(ea=262144),Ta=i}else Ta=536870912;return i=_a.current,i!==null&&(i.flags|=32),Ta}function oa(i,s,c){(i===fr&&(Zt===2||Zt===9)||i.cancelPendingCommit!==null)&&(Tc(i,0),eo(i,At,Ta,!1)),ei(i,c),((Wt&2)===0||i!==fr)&&(i===fr&&((Wt&2)===0&&(fl|=c),kr===4&&eo(i,At,Ta,!1)),Di(i))}function D2(i,s,c){if((Wt&6)!==0)throw Error(n(327));var f=!c&&(s&127)===0&&(s&i.expiredLanes)===0||tn(i,s),g=f?y3(i,s):X1(i,s,!0),x=f;do{if(g===0){_c&&!f&&eo(i,s,0,!1);break}else{if(c=i.current.alternate,x&&!v3(c)){g=X1(i,s,!1),x=!1;continue}if(g===2){if(x=s,i.errorRecoveryDisabledLanes&x)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){s=b;e:{var B=i;g=Yu;var ae=B.current.memoizedState.isDehydrated;if(ae&&(Tc(B,b).flags|=256),b=X1(B,b,!1),b!==2){if(B1&&!ae){B.errorRecoveryDisabledLanes|=x,fl|=x,g=4;break e}x=sa,sa=g,x!==null&&(sa===null?sa=x:sa.push.apply(sa,x))}g=b}if(x=!1,g!==2)continue}}if(g===1){Tc(i,0),eo(i,s,0,!0);break}e:{switch(f=i,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:eo(f,s,Ta,!Ys);break e;case 2:sa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(g=dh+300-Lt(),10<g)){if(eo(f,s,Ta,!Ys),Tr(f,0,!0)!==0)break e;fs=s,f.timeoutHandle=cy(O2.bind(null,f,c,sa,ph,j1,s,Ta,fl,yc,Ys,x,"Throttled",-0,0),g);break e}O2(f,c,sa,ph,j1,s,Ta,fl,yc,Ys,x,null,-0,0)}}break}while(!0);Di(i)}function O2(i,s,c,f,g,x,b,B,ae,me,ke,Re,xe,we){if(i.timeoutHandle=-1,Re=s.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ai},b2(s,x,Re);var $e=(x&62914560)===x?dh-Lt():(x&4194048)===x?N2-Lt():0;if($e=rC(Re,$e),$e!==null){fs=x,i.cancelPendingCommit=$e(j2.bind(null,i,s,x,c,f,g,b,B,ae,ke,Re,null,xe,we)),eo(i,x,b,!me);return}}j2(i,s,x,c,f,g,b,B,ae)}function v3(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var g=c[f],x=g.getSnapshot;g=g.value;try{if(!xa(x(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function eo(i,s,c,f){s&=~U1,s&=~fl,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var g=s;0<g;){var x=31-Ze(g),b=1<<x;f[x]=-1,g&=~b}c!==0&&ti(i,c,s)}function gh(){return(Wt&6)===0?(Ju(0),!1):!0}function q1(){if(St!==null){if(Zt===0)var i=St.return;else i=St,es=rl=null,o1(i),hc=null,Fu=0,i=St;for(;i!==null;)u2(i.alternate,i),i=i.return;St=null}}function Tc(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,V3(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),fs=0,q1(),fr=i,St=c=Ji(i.current,null),At=s,Zt=0,wa=null,Ys=!1,_c=tn(i,s),B1=!1,yc=Ta=U1=fl=Qs=kr=0,sa=Yu=null,j1=!1,(s&8)!==0&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var g=31-Ze(f),x=1<<g;s|=i[g],f&=~x}return us=s,P0(),c}function F2(i,s){vt=null,Y.H=zu,s===fc||s===q0?(s=Yv(),Zt=3):s===$m?(s=Yv(),Zt=4):Zt=s===E1?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,wa=s,St===null&&(kr=1,ih(i,La(s,i.current)))}function M2(){var i=_a.current;return i===null?!0:(At&4194048)===At?Ua===null:(At&62914560)===At||(At&536870912)!==0?i===Ua:!1}function L2(){var i=Y.H;return Y.H=zu,i===null?zu:i}function P2(){var i=Y.A;return Y.A=g3,i}function xh(){kr=4,Ys||(At&4194048)!==At&&_a.current!==null||(_c=!0),(Qs&134217727)===0&&(fl&134217727)===0||fr===null||eo(fr,At,Ta,!1)}function X1(i,s,c){var f=Wt;Wt|=2;var g=L2(),x=P2();(fr!==i||At!==s)&&(ph=null,Tc(i,s)),s=!1;var b=kr;e:do try{if(Zt!==0&&St!==null){var B=St,ae=wa;switch(Zt){case 8:q1(),b=6;break e;case 3:case 2:case 9:case 6:_a.current===null&&(s=!0);var me=Zt;if(Zt=0,wa=null,Ec(i,B,ae,me),c&&_c){b=0;break e}break;default:me=Zt,Zt=0,wa=null,Ec(i,B,ae,me)}}_3(),b=kr;break}catch(ke){F2(i,ke)}while(!0);return s&&i.shellSuspendCounter++,es=rl=null,Wt=f,Y.H=g,Y.A=x,St===null&&(fr=null,At=0,P0()),b}function _3(){for(;St!==null;)V2(St)}function y3(i,s){var c=Wt;Wt|=2;var f=L2(),g=P2();fr!==i||At!==s?(ph=null,mh=Lt()+500,Tc(i,s)):_c=tn(i,s);e:do try{if(Zt!==0&&St!==null){s=St;var x=wa;t:switch(Zt){case 1:Zt=0,wa=null,Ec(i,s,x,1);break;case 2:case 9:if(Kv(x)){Zt=0,wa=null,B2(s);break}s=function(){Zt!==2&&Zt!==9||fr!==i||(Zt=7),Di(i)},x.then(s,s);break e;case 3:Zt=7;break e;case 4:Zt=5;break e;case 7:Kv(x)?(Zt=0,wa=null,B2(s)):(Zt=0,wa=null,Ec(i,s,x,7));break;case 5:var b=null;switch(St.tag){case 26:b=St.memoizedState;case 5:case 27:var B=St;if(b?Sy(b):B.stateNode.complete){Zt=0,wa=null;var ae=B.sibling;if(ae!==null)St=ae;else{var me=B.return;me!==null?(St=me,vh(me)):St=null}break t}}Zt=0,wa=null,Ec(i,s,x,5);break;case 6:Zt=0,wa=null,Ec(i,s,x,6);break;case 8:q1(),kr=6;break e;default:throw Error(n(462))}}w3();break}catch(ke){F2(i,ke)}while(!0);return es=rl=null,Y.H=f,Y.A=g,Wt=c,St!==null?0:(fr=null,At=0,P0(),kr)}function w3(){for(;St!==null&&!Za();)V2(St)}function V2(i){var s=l2(i.alternate,i,us);i.memoizedProps=i.pendingProps,s===null?vh(i):St=s}function B2(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=r2(c,s,s.pendingProps,s.type,void 0,At);break;case 11:s=r2(c,s,s.pendingProps,s.type.render,s.ref,At);break;case 5:o1(s);default:u2(c,s),s=St=Pv(s,us),s=l2(c,s,us)}i.memoizedProps=i.pendingProps,s===null?vh(i):St=s}function Ec(i,s,c,f){es=rl=null,o1(s),hc=null,Fu=0;var g=s.return;try{if(c3(i,g,s,c,At)){kr=1,ih(i,La(c,i.current)),St=null;return}}catch(x){if(g!==null)throw St=g,x;kr=1,ih(i,La(c,i.current)),St=null;return}s.flags&32768?(Ot||f===1?i=!0:_c||(At&536870912)!==0?i=!1:(Ys=i=!0,(f===2||f===9||f===3||f===6)&&(f=_a.current,f!==null&&f.tag===13&&(f.flags|=16384))),U2(s,i)):vh(s)}function vh(i){var s=i;do{if((s.flags&32768)!==0){U2(s,Ys);return}i=s.return;var c=h3(s.alternate,s,us);if(c!==null){St=c;return}if(s=s.sibling,s!==null){St=s;return}St=s=i}while(s!==null);kr===0&&(kr=5)}function U2(i,s){do{var c=d3(i.alternate,i);if(c!==null){c.flags&=32767,St=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){St=i;return}St=i=c}while(i!==null);kr=6,St=null}function j2(i,s,c,f,g,x,b,B,ae){i.cancelPendingCommit=null;do _h();while(rn!==0);if((Wt&6)!==0)throw Error(n(327));if(s!==null){if(s===i.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=Fm,jo(i,c,x,b,B,ae),i===fr&&(St=fr=null,At=0),wc=s,Zs=i,fs=c,z1=x,H1=g,R2=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,b3(Pt,function(){return X2(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=Y.T,Y.T=null,g=ne.p,ne.p=2,b=Wt,Wt|=4;try{m3(i,s,c)}finally{Wt=b,ne.p=g,Y.T=f}}rn=1,z2(),H2(),G2()}}function z2(){if(rn===1){rn=0;var i=Zs,s=wc,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null;var f=ne.p;ne.p=2;var g=Wt;Wt|=4;try{T2(s,i);var x=ap,b=Cv(i.containerInfo),B=x.focusedElem,ae=x.selectionRange;if(b!==B&&B&&B.ownerDocument&&kv(B.ownerDocument.documentElement,B)){if(ae!==null&&Nm(B)){var me=ae.start,ke=ae.end;if(ke===void 0&&(ke=me),"selectionStart"in B)B.selectionStart=me,B.selectionEnd=Math.min(ke,B.value.length);else{var Re=B.ownerDocument||document,xe=Re&&Re.defaultView||window;if(xe.getSelection){var we=xe.getSelection(),$e=B.textContent.length,it=Math.min(ae.start,$e),lr=ae.end===void 0?it:Math.min(ae.end,$e);!we.extend&&it>lr&&(b=lr,lr=it,it=b);var ce=Av(B,it),se=Av(B,lr);if(ce&&se&&(we.rangeCount!==1||we.anchorNode!==ce.node||we.anchorOffset!==ce.offset||we.focusNode!==se.node||we.focusOffset!==se.offset)){var fe=Re.createRange();fe.setStart(ce.node,ce.offset),we.removeAllRanges(),it>lr?(we.addRange(fe),we.extend(se.node,se.offset)):(fe.setEnd(se.node,se.offset),we.addRange(fe))}}}}for(Re=[],we=B;we=we.parentNode;)we.nodeType===1&&Re.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Re.length;B++){var Ne=Re[B];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}Ih=!!np,ap=np=null}finally{Wt=g,ne.p=f,Y.T=c}}i.current=s,rn=2}}function H2(){if(rn===2){rn=0;var i=Zs,s=wc,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=Y.T,Y.T=null;var f=ne.p;ne.p=2;var g=Wt;Wt|=4;try{x2(i,s.alternate,s)}finally{Wt=g,ne.p=f,Y.T=c}}rn=3}}function G2(){if(rn===4||rn===3){rn=0,Xn();var i=Zs,s=wc,c=fs,f=R2;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?rn=5:(rn=0,wc=Zs=null,q2(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(Js=null),ma(c),s=s.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(De,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=Y.T,g=ne.p,ne.p=2,Y.T=null;try{for(var x=i.onRecoverableError,b=0;b<f.length;b++){var B=f[b];x(B.value,{componentStack:B.stack})}}finally{Y.T=s,ne.p=g}}(fs&3)!==0&&_h(),Di(i),g=i.pendingLanes,(c&261930)!==0&&(g&42)!==0?i===G1?Qu++:(Qu=0,G1=i):Qu=0,Ju(0)}}function q2(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Du(s)))}function _h(){return z2(),H2(),G2(),X2()}function X2(){if(rn!==5)return!1;var i=Zs,s=z1;z1=0;var c=ma(fs),f=Y.T,g=ne.p;try{ne.p=32>c?32:c,Y.T=null,c=H1,H1=null;var x=Zs,b=fs;if(rn=0,wc=Zs=null,fs=0,(Wt&6)!==0)throw Error(n(331));var B=Wt;if(Wt|=4,k2(x.current),S2(x,x.current,b,c),Wt=B,Ju(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(De,x)}catch{}return!0}finally{ne.p=g,Y.T=f,q2(i,s)}}function W2(i,s,c){s=La(c,s),s=T1(i.stateNode,s,2),i=Xs(i,s,2),i!==null&&(ei(i,2),Di(i))}function er(i,s,c){if(i.tag===3)W2(i,i,c);else for(;s!==null;){if(s.tag===3){W2(s,i,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Js===null||!Js.has(f))){i=La(c,i),c=K_(2),f=Xs(s,c,2),f!==null&&($_(c,f,s,i),ei(f,2),Di(f));break}}s=s.return}}function W1(i,s,c){var f=i.pingCache;if(f===null){f=i.pingCache=new x3;var g=new Set;f.set(s,g)}else g=f.get(s),g===void 0&&(g=new Set,f.set(s,g));g.has(c)||(B1=!0,g.add(c),i=T3.bind(null,i,s,c),s.then(i,i))}function T3(i,s,c){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,fr===i&&(At&c)===c&&(kr===4||kr===3&&(At&62914560)===At&&300>Lt()-dh?(Wt&2)===0&&Tc(i,0):U1|=c,yc===At&&(yc=0)),Di(i)}function K2(i,s){s===0&&(s=wi()),i=Zo(i,s),i!==null&&(ei(i,s),Di(i))}function E3(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),K2(i,c)}function S3(i,s){var c=0;switch(i.tag){case 31:case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),K2(i,c)}function b3(i,s){return Ut(i,s)}var yh=null,Sc=null,K1=!1,wh=!1,$1=!1,to=0;function Di(i){i!==Sc&&i.next===null&&(Sc===null?yh=Sc=i:Sc=Sc.next=i),wh=!0,K1||(K1=!0,k3())}function Ju(i,s){if(!$1&&wh){$1=!0;do for(var c=!1,f=yh;f!==null;){if(i!==0){var g=f.pendingLanes;if(g===0)var x=0;else{var b=f.suspendedLanes,B=f.pingedLanes;x=(1<<31-Ze(42|i)+1)-1,x&=g&~(b&~B),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,J2(f,x))}else x=At,x=Tr(f,f===fr?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||tn(f,x)||(c=!0,J2(f,x));f=f.next}while(c);$1=!1}}function A3(){$2()}function $2(){wh=K1=!1;var i=0;to!==0&&P3()&&(i=to);for(var s=Lt(),c=null,f=yh;f!==null;){var g=f.next,x=Y2(f,s);x===0?(f.next=null,c===null?yh=g:c.next=g,g===null&&(Sc=c)):(c=f,(i!==0||(x&3)!==0)&&(wh=!0)),f=g}rn!==0&&rn!==5||Ju(i),to!==0&&(to=0)}function Y2(i,s){for(var c=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var b=31-Ze(x),B=1<<b,ae=g[b];ae===-1?((B&c)===0||(B&f)!==0)&&(g[b]=Ns(B,s)):ae<=s&&(i.expiredLanes|=B),x&=~B}if(s=fr,c=At,c=Tr(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,c===0||i===s&&(Zt===2||Zt===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Ur(f),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||tn(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(f!==null&&Ur(f),ma(c)){case 2:case 8:c=Wn;break;case 32:c=Pt;break;case 268435456:c=ut;break;default:c=Pt}return f=Q2.bind(null,i),c=Ut(c,f),i.callbackPriority=s,i.callbackNode=c,s}return f!==null&&f!==null&&Ur(f),i.callbackPriority=2,i.callbackNode=null,2}function Q2(i,s){if(rn!==0&&rn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(_h()&&i.callbackNode!==c)return null;var f=At;return f=Tr(i,i===fr?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(D2(i,f,s),Y2(i,Lt()),i.callbackNode!=null&&i.callbackNode===c?Q2.bind(null,i):null)}function J2(i,s){if(_h())return null;D2(i,s,!0)}function k3(){B3(function(){(Wt&6)!==0?Ut(gn,A3):$2()})}function Y1(){if(to===0){var i=cc;i===0&&(i=ln,ln<<=1,(ln&261888)===0&&(ln=256)),to=i}return to}function Z2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Kl(""+i)}function ey(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function C3(i,s,c,f,g){if(s==="submit"&&c&&c.stateNode===g){var x=Z2((g[X]||null).action),b=f.submitter;b&&(s=(s=b[X]||null)?Z2(s.formAction):b.getAttribute("formAction"),s!==null&&(x=s,b=null));var B=new bi("action","action",null,f,g);i.push({event:B,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(to!==0){var ae=b?ey(g,b):new FormData(g);g1(c,{pending:!0,data:ae,method:g.method,action:x},null,ae)}}else typeof x=="function"&&(B.preventDefault(),ae=b?ey(g,b):new FormData(g),g1(c,{pending:!0,data:ae,method:g.method,action:x},x,ae))},currentTarget:g}]})}}for(var Q1=0;Q1<Om.length;Q1++){var J1=Om[Q1],N3=J1.toLowerCase(),R3=J1[0].toUpperCase()+J1.slice(1);ci(N3,"on"+R3)}ci(Iv,"onAnimationEnd"),ci(Dv,"onAnimationIteration"),ci(Ov,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(Xk,"onTransitionRun"),ci(Wk,"onTransitionStart"),ci(Kk,"onTransitionCancel"),ci(Fv,"onTransitionEnd"),Rn("onMouseEnter",["mouseout","mouseover"]),Rn("onMouseLeave",["mouseout","mouseover"]),Rn("onPointerEnter",["pointerout","pointerover"]),Rn("onPointerLeave",["pointerout","pointerover"]),ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ur("onBeforeInput",["compositionend","keypress","textInput","paste"]),ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zu));function ty(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],g=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var b=f.length-1;0<=b;b--){var B=f[b],ae=B.instance,me=B.currentTarget;if(B=B.listener,ae!==x&&g.isPropagationStopped())break e;x=B,g.currentTarget=me;try{x(g)}catch(ke){L0(ke)}g.currentTarget=null,x=ae}else for(b=0;b<f.length;b++){if(B=f[b],ae=B.instance,me=B.currentTarget,B=B.listener,ae!==x&&g.isPropagationStopped())break e;x=B,g.currentTarget=me;try{x(g)}catch(ke){L0(ke)}g.currentTarget=null,x=ae}}}}function bt(i,s){var c=s[he];c===void 0&&(c=s[he]=new Set);var f=i+"__bubble";c.has(f)||(ry(s,i,2,!1),c.add(f))}function Z1(i,s,c){var f=0;s&&(f|=4),ry(c,i,f,s)}var Th="_reactListening"+Math.random().toString(36).slice(2);function ep(i){if(!i[Th]){i[Th]=!0,Yt.forEach(function(c){c!=="selectionchange"&&(I3.has(c)||Z1(c,!1,i),Z1(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Th]||(s[Th]=!0,Z1("selectionchange",!1,s))}}function ry(i,s,c,f){switch(Iy(s)){case 2:var g=iC;break;case 8:g=sC;break;default:g=pp}c=g.bind(null,s,c,i),g=void 0,!qo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function tp(i,s,c,f,g){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var B=f.stateNode.containerInfo;if(B===g)break;if(b===4)for(b=f.return;b!==null;){var ae=b.tag;if((ae===3||ae===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;B!==null;){if(b=Ve(B),b===null)return;if(ae=b.tag,ae===5||ae===6||ae===26||ae===27){f=x=b;continue e}B=B.parentNode}}f=f.return}Ls(function(){var me=x,ke=Da(c),Re=[];e:{var xe=Mv.get(i);if(xe!==void 0){var we=bi,$e=i;switch(i){case"keypress":if(Wo(c)===0)break e;case"keydown":case"keyup":we=O0;break;case"focusin":$e="focus",we=$o;break;case"focusout":$e="blur",we=$o;break;case"beforeblur":case"afterblur":we=$o;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Su;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=S0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=T;break;case Iv:case Dv:case Ov:we=A0;break;case Fv:we=z;break;case"scroll":case"scrollend":we=Eu;break;case"wheel":we=_e;break;case"copy":case"cut":case"paste":we=k0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=Qi;break;case"toggle":case"beforetoggle":we=xt}var it=(s&4)!==0,lr=!it&&(i==="scroll"||i==="scrollend"),ce=it?xe!==null?xe+"Capture":null:xe;it=[];for(var se=me,fe;se!==null;){var Ne=se;if(fe=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||fe===null||ce===null||(Ne=ii(se,ce),Ne!=null&&it.push(ef(se,Ne,fe))),lr)break;se=se.return}0<it.length&&(xe=new we(xe,$e,null,c,ke),Re.push({event:xe,listeners:it}))}}if((s&7)===0){e:{if(xe=i==="mouseover"||i==="pointerover",we=i==="mouseout"||i==="pointerout",xe&&c!==yu&&($e=c.relatedTarget||c.fromElement)&&(Ve($e)||$e[Z]))break e;if((we||xe)&&(xe=ke.window===ke?ke:(xe=ke.ownerDocument)?xe.defaultView||xe.parentWindow:window,we?($e=c.relatedTarget||c.toElement,we=me,$e=$e?Ve($e):null,$e!==null&&(lr=o($e),it=$e.tag,$e!==lr||it!==5&&it!==27&&it!==6)&&($e=null)):(we=null,$e=me),we!==$e)){if(it=Su,Ne="onMouseLeave",ce="onMouseEnter",se="mouse",(i==="pointerout"||i==="pointerover")&&(it=Qi,Ne="onPointerLeave",ce="onPointerEnter",se="pointer"),lr=we==null?xe:Le(we),fe=$e==null?xe:Le($e),xe=new it(Ne,se+"leave",we,c,ke),xe.target=lr,xe.relatedTarget=fe,Ne=null,Ve(ke)===me&&(it=new it(ce,se+"enter",$e,c,ke),it.target=fe,it.relatedTarget=lr,Ne=it),lr=Ne,we&&$e)t:{for(it=D3,ce=we,se=$e,fe=0,Ne=ce;Ne;Ne=it(Ne))fe++;Ne=0;for(var et=se;et;et=it(et))Ne++;for(;0<fe-Ne;)ce=it(ce),fe--;for(;0<Ne-fe;)se=it(se),Ne--;for(;fe--;){if(ce===se||se!==null&&ce===se.alternate){it=ce;break t}ce=it(ce),se=it(se)}it=null}else it=null;we!==null&&ny(Re,xe,we,it,!1),$e!==null&&lr!==null&&ny(Re,lr,$e,it,!0)}}e:{if(xe=me?Le(me):window,we=xe.nodeName&&xe.nodeName.toLowerCase(),we==="select"||we==="input"&&xe.type==="file")var jt=yv;else if(vv(xe))if(wv)jt=Hk;else{jt=jk;var Qe=Uk}else we=xe.nodeName,!we||we.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?me&&Wl(me.elementType)&&(jt=yv):jt=zk;if(jt&&(jt=jt(i,me))){_v(Re,jt,c,ke);break e}Qe&&Qe(i,xe,me),i==="focusout"&&me&&xe.type==="number"&&me.memoizedProps.value!=null&&xu(xe,"number",xe.value)}switch(Qe=me?Le(me):window,i){case"focusin":(vv(Qe)||Qe.contentEditable==="true")&&(tc=Qe,Rm=me,Nu=null);break;case"focusout":Nu=Rm=tc=null;break;case"mousedown":Im=!0;break;case"contextmenu":case"mouseup":case"dragend":Im=!1,Nv(Re,c,ke);break;case"selectionchange":if(qk)break;case"keydown":case"keyup":Nv(Re,c,ke)}var yt;if(Xt)e:{switch(i){case"compositionstart":var kt="onCompositionStart";break e;case"compositionend":kt="onCompositionEnd";break e;case"compositionupdate":kt="onCompositionUpdate";break e}kt=void 0}else ec?Yo(i,c)&&(kt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(kt="onCompositionStart");kt&&(Ci&&c.locale!=="ko"&&(ec||kt!=="onCompositionStart"?kt==="onCompositionEnd"&&ec&&(yt=Tu()):(Si=ke,wu="value"in Si?Si.value:Si.textContent,ec=!0)),Qe=Eh(me,kt),0<Qe.length&&(kt=new ki(kt,i,null,c,ke),Re.push({event:kt,listeners:Qe}),yt?kt.data=yt:(yt=Zl(c),yt!==null&&(kt.data=yt)))),(yt=Fa?Lk(i,c):Pk(i,c))&&(kt=Eh(me,"onBeforeInput"),0<kt.length&&(Qe=new ki("onBeforeInput","beforeinput",null,c,ke),Re.push({event:Qe,listeners:kt}),Qe.data=yt)),C3(Re,i,me,c,ke)}ty(Re,s)})}function ef(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Eh(i,s){for(var c=s+"Capture",f=[];i!==null;){var g=i,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=ii(i,c),g!=null&&f.unshift(ef(i,g,x)),g=ii(i,s),g!=null&&f.push(ef(i,g,x))),i.tag===3)return f;i=i.return}return[]}function D3(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ny(i,s,c,f,g){for(var x=s._reactName,b=[];c!==null&&c!==f;){var B=c,ae=B.alternate,me=B.stateNode;if(B=B.tag,ae!==null&&ae===f)break;B!==5&&B!==26&&B!==27||me===null||(ae=me,g?(me=ii(c,x),me!=null&&b.unshift(ef(c,me,ae))):g||(me=ii(c,x),me!=null&&b.push(ef(c,me,ae)))),c=c.return}b.length!==0&&i.push({event:s,listeners:b})}var O3=/\r\n?/g,F3=/\u0000|\uFFFD/g;function ay(i){return(typeof i=="string"?i:""+i).replace(O3,`
`).replace(F3,"")}function iy(i,s){return s=ay(s),ay(i)===s}function or(i,s,c,f,g,x){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||ra(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&ra(i,""+f);break;case"className":ga(i,"class",f);break;case"tabIndex":ga(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":ga(i,c,f);break;case"style":_u(i,f,x);break;case"data":if(s!=="object"){ga(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=Kl(""+f),i.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(s!=="input"&&or(i,s,"name",g.name,g,null),or(i,s,"formEncType",g.formEncType,g,null),or(i,s,"formMethod",g.formMethod,g,null),or(i,s,"formTarget",g.formTarget,g,null)):(or(i,s,"encType",g.encType,g,null),or(i,s,"method",g.method,g,null),or(i,s,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=Kl(""+f),i.setAttribute(c,f);break;case"onClick":f!=null&&(i.onclick=ai);break;case"onScroll":f!=null&&bt("scroll",i);break;case"onScrollEnd":f!=null&&bt("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}c=Kl(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""+f):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":f===!0?i.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,f):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(c,f):i.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(c):i.setAttribute(c,f);break;case"popover":bt("beforetoggle",i),bt("toggle",i),In(i,"popover",f);break;case"xlinkActuate":zr(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":zr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":zr(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":zr(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":zr(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":zr(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":zr(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":zr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":zr(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":In(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=E0.get(c)||c,In(i,c,f))}}function rp(i,s,c,f,g,x){switch(c){case"style":_u(i,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof f=="string"?ra(i,f):(typeof f=="number"||typeof f=="bigint")&&ra(i,""+f);break;case"onScroll":f!=null&&bt("scroll",i);break;case"onScrollEnd":f!=null&&bt("scrollend",i);break;case"onClick":f!=null&&(i.onclick=ai);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),x=i[X]||null,x=x!=null?x[c]:null,typeof x=="function"&&i.removeEventListener(s,x,g),typeof f=="function")){typeof x!="function"&&x!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,f,g);break e}c in i?i[c]=f:f===!0?i.setAttribute(c,""):In(i,c,f)}}}function wn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":bt("error",i),bt("load",i);var f=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var b=c[x];if(b!=null)switch(x){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:or(i,s,x,b,c,null)}}g&&or(i,s,"srcSet",c.srcSet,c,null),f&&or(i,s,"src",c.src,c,null);return;case"input":bt("invalid",i);var B=x=b=g=null,ae=null,me=null;for(f in c)if(c.hasOwnProperty(f)){var ke=c[f];if(ke!=null)switch(f){case"name":g=ke;break;case"type":b=ke;break;case"checked":ae=ke;break;case"defaultChecked":me=ke;break;case"value":x=ke;break;case"defaultValue":B=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,s));break;default:or(i,s,f,ke,c,null)}}y0(i,x,B,ae,me,b,g,!1);return;case"select":bt("invalid",i),f=b=x=null;for(g in c)if(c.hasOwnProperty(g)&&(B=c[g],B!=null))switch(g){case"value":x=B;break;case"defaultValue":b=B;break;case"multiple":f=B;default:or(i,s,g,B,c,null)}s=x,c=b,i.multiple=!!f,s!=null?Ds(i,!!f,s,!1):c!=null&&Ds(i,!!f,c,!0);return;case"textarea":bt("invalid",i),x=g=f=null;for(b in c)if(c.hasOwnProperty(b)&&(B=c[b],B!=null))switch(b){case"value":f=B;break;case"defaultValue":g=B;break;case"children":x=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:or(i,s,b,B,c,null)}Os(i,f,g,x);return;case"option":for(ae in c)c.hasOwnProperty(ae)&&(f=c[ae],f!=null)&&(ae==="selected"?i.selected=f&&typeof f!="function"&&typeof f!="symbol":or(i,s,ae,f,c,null));return;case"dialog":bt("beforetoggle",i),bt("toggle",i),bt("cancel",i),bt("close",i);break;case"iframe":case"object":bt("load",i);break;case"video":case"audio":for(f=0;f<Zu.length;f++)bt(Zu[f],i);break;case"image":bt("error",i),bt("load",i);break;case"details":bt("toggle",i);break;case"embed":case"source":case"link":bt("error",i),bt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in c)if(c.hasOwnProperty(me)&&(f=c[me],f!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:or(i,s,me,f,c,null)}return;default:if(Wl(s)){for(ke in c)c.hasOwnProperty(ke)&&(f=c[ke],f!==void 0&&rp(i,s,ke,f,c,void 0));return}}for(B in c)c.hasOwnProperty(B)&&(f=c[B],f!=null&&or(i,s,B,f,c,null))}function M3(i,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,b=null,B=null,ae=null,me=null,ke=null;for(we in c){var Re=c[we];if(c.hasOwnProperty(we)&&Re!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":ae=Re;default:f.hasOwnProperty(we)||or(i,s,we,null,f,Re)}}for(var xe in f){var we=f[xe];if(Re=c[xe],f.hasOwnProperty(xe)&&(we!=null||Re!=null))switch(xe){case"type":x=we;break;case"name":g=we;break;case"checked":me=we;break;case"defaultChecked":ke=we;break;case"value":b=we;break;case"defaultValue":B=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,s));break;default:we!==Re&&or(i,s,xe,we,f,Re)}}Xl(i,b,B,ae,me,ke,x,g);return;case"select":we=b=B=xe=null;for(x in c)if(ae=c[x],c.hasOwnProperty(x)&&ae!=null)switch(x){case"value":break;case"multiple":we=ae;default:f.hasOwnProperty(x)||or(i,s,x,null,f,ae)}for(g in f)if(x=f[g],ae=c[g],f.hasOwnProperty(g)&&(x!=null||ae!=null))switch(g){case"value":xe=x;break;case"defaultValue":B=x;break;case"multiple":b=x;default:x!==ae&&or(i,s,g,x,f,ae)}s=B,c=b,f=we,xe!=null?Ds(i,!!c,xe,!1):!!f!=!!c&&(s!=null?Ds(i,!!c,s,!0):Ds(i,!!c,c?[]:"",!1));return;case"textarea":we=xe=null;for(B in c)if(g=c[B],c.hasOwnProperty(B)&&g!=null&&!f.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:or(i,s,B,null,f,g)}for(b in f)if(g=f[b],x=c[b],f.hasOwnProperty(b)&&(g!=null||x!=null))switch(b){case"value":xe=g;break;case"defaultValue":we=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&or(i,s,b,g,f,x)}w0(i,xe,we);return;case"option":for(var $e in c)xe=c[$e],c.hasOwnProperty($e)&&xe!=null&&!f.hasOwnProperty($e)&&($e==="selected"?i.selected=!1:or(i,s,$e,null,f,xe));for(ae in f)xe=f[ae],we=c[ae],f.hasOwnProperty(ae)&&xe!==we&&(xe!=null||we!=null)&&(ae==="selected"?i.selected=xe&&typeof xe!="function"&&typeof xe!="symbol":or(i,s,ae,xe,f,we));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in c)xe=c[it],c.hasOwnProperty(it)&&xe!=null&&!f.hasOwnProperty(it)&&or(i,s,it,null,f,xe);for(me in f)if(xe=f[me],we=c[me],f.hasOwnProperty(me)&&xe!==we&&(xe!=null||we!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(n(137,s));break;default:or(i,s,me,xe,f,we)}return;default:if(Wl(s)){for(var lr in c)xe=c[lr],c.hasOwnProperty(lr)&&xe!==void 0&&!f.hasOwnProperty(lr)&&rp(i,s,lr,void 0,f,xe);for(ke in f)xe=f[ke],we=c[ke],!f.hasOwnProperty(ke)||xe===we||xe===void 0&&we===void 0||rp(i,s,ke,xe,f,we);return}}for(var ce in c)xe=c[ce],c.hasOwnProperty(ce)&&xe!=null&&!f.hasOwnProperty(ce)&&or(i,s,ce,null,f,xe);for(Re in f)xe=f[Re],we=c[Re],!f.hasOwnProperty(Re)||xe===we||xe==null&&we==null||or(i,s,Re,xe,f,we)}function sy(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function L3(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var g=c[f],x=g.transferSize,b=g.initiatorType,B=g.duration;if(x&&B&&sy(b)){for(b=0,B=g.responseEnd,f+=1;f<c.length;f++){var ae=c[f],me=ae.startTime;if(me>B)break;var ke=ae.transferSize,Re=ae.initiatorType;ke&&sy(Re)&&(ae=ae.responseEnd,b+=ke*(ae<B?1:(B-me)/(ae-me)))}if(--f,s+=8*(x+b)/(g.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var np=null,ap=null;function Sh(i){return i.nodeType===9?i:i.ownerDocument}function oy(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ly(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function ip(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var sp=null;function P3(){var i=window.event;return i&&i.type==="popstate"?i===sp?!1:(sp=i,!0):(sp=null,!1)}var cy=typeof setTimeout=="function"?setTimeout:void 0,V3=typeof clearTimeout=="function"?clearTimeout:void 0,uy=typeof Promise=="function"?Promise:void 0,B3=typeof queueMicrotask=="function"?queueMicrotask:typeof uy<"u"?function(i){return uy.resolve(null).then(i).catch(U3)}:cy;function U3(i){setTimeout(function(){throw i})}function ro(i){return i==="head"}function fy(i,s){var c=s,f=0;do{var g=c.nextSibling;if(i.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(f===0){i.removeChild(g),Cc(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")tf(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,tf(c);for(var x=c.firstChild;x;){var b=x.nextSibling,B=x.nodeName;x[pe]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=b}}else c==="body"&&tf(i.ownerDocument.body);c=g}while(c);Cc(s)}function hy(i,s){var c=i;i=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=f}while(c)}function op(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":op(c),Pe(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function j3(i,s,c,f){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[pe])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=ja(i.nextSibling),i===null)break}return null}function z3(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=ja(i.nextSibling),i===null))return null;return i}function dy(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=ja(i.nextSibling),i===null))return null;return i}function lp(i){return i.data==="$?"||i.data==="$~"}function cp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function H3(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function ja(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var up=null;function my(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return ja(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function py(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function gy(i,s,c){switch(s=Sh(c),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function tf(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Pe(i)}var za=new Map,xy=new Set;function bh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var hs=ne.d;ne.d={f:G3,r:q3,D:X3,C:W3,L:K3,m:$3,X:Q3,S:Y3,M:J3};function G3(){var i=hs.f(),s=gh();return i||s}function q3(i){var s=qe(i);s!==null&&s.tag===5&&s.type==="form"?F_(s):hs.r(i)}var bc=typeof document>"u"?null:document;function vy(i,s,c){var f=bc;if(f&&typeof s=="string"&&s){var g=ta(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),xy.has(g)||(xy.add(g),i={rel:i,crossOrigin:c,href:s},f.querySelector(g)===null&&(s=f.createElement("link"),wn(s,"link",i),Ye(s),f.head.appendChild(s)))}}function X3(i){hs.D(i),vy("dns-prefetch",i,null)}function W3(i,s){hs.C(i,s),vy("preconnect",i,s)}function K3(i,s,c){hs.L(i,s,c);var f=bc;if(f&&i&&s){var g='link[rel="preload"][as="'+ta(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+ta(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+ta(c.imageSizes)+'"]')):g+='[href="'+ta(i)+'"]';var x=g;switch(s){case"style":x=Ac(i);break;case"script":x=kc(i)}za.has(x)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),za.set(x,i),f.querySelector(g)!==null||s==="style"&&f.querySelector(rf(x))||s==="script"&&f.querySelector(nf(x))||(s=f.createElement("link"),wn(s,"link",i),Ye(s),f.head.appendChild(s)))}}function $3(i,s){hs.m(i,s);var c=bc;if(c&&i){var f=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+ta(f)+'"][href="'+ta(i)+'"]',x=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=kc(i)}if(!za.has(x)&&(i=v({rel:"modulepreload",href:i},s),za.set(x,i),c.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(nf(x)))return}f=c.createElement("link"),wn(f,"link",i),Ye(f),c.head.appendChild(f)}}}function Y3(i,s,c){hs.S(i,s,c);var f=bc;if(f&&i){var g=Ge(f).hoistableStyles,x=Ac(i);s=s||"default";var b=g.get(x);if(!b){var B={loading:0,preload:null};if(b=f.querySelector(rf(x)))B.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=za.get(x))&&fp(i,c);var ae=b=f.createElement("link");Ye(ae),wn(ae,"link",i),ae._p=new Promise(function(me,ke){ae.onload=me,ae.onerror=ke}),ae.addEventListener("load",function(){B.loading|=1}),ae.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Ah(b,s,f)}b={type:"stylesheet",instance:b,count:1,state:B},g.set(x,b)}}}function Q3(i,s){hs.X(i,s);var c=bc;if(c&&i){var f=Ge(c).hoistableScripts,g=kc(i),x=f.get(g);x||(x=c.querySelector(nf(g)),x||(i=v({src:i,async:!0},s),(s=za.get(g))&&hp(i,s),x=c.createElement("script"),Ye(x),wn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function J3(i,s){hs.M(i,s);var c=bc;if(c&&i){var f=Ge(c).hoistableScripts,g=kc(i),x=f.get(g);x||(x=c.querySelector(nf(g)),x||(i=v({src:i,async:!0,type:"module"},s),(s=za.get(g))&&hp(i,s),x=c.createElement("script"),Ye(x),wn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function _y(i,s,c,f){var g=(g=le.current)?bh(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ac(c.href),c=Ge(g).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Ac(c.href);var x=Ge(g).hoistableStyles,b=x.get(i);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,b),(x=g.querySelector(rf(i)))&&!x._p&&(b.instance=x,b.state.loading=5),za.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},za.set(i,c),x||Z3(g,i,c,b.state))),s&&f===null)throw Error(n(528,""));return b}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=kc(c),c=Ge(g).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Ac(i){return'href="'+ta(i)+'"'}function rf(i){return'link[rel="stylesheet"]['+i+"]"}function yy(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function Z3(i,s,c,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),wn(s,"link",c),Ye(s),i.head.appendChild(s))}function kc(i){return'[src="'+ta(i)+'"]'}function nf(i){return"script[async]"+i}function wy(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+ta(c.href)+'"]');if(f)return s.instance=f,Ye(f),f;var g=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),Ye(f),wn(f,"style",g),Ah(f,c.precedence,i),s.instance=f;case"stylesheet":g=Ac(c.href);var x=i.querySelector(rf(g));if(x)return s.state.loading|=4,s.instance=x,Ye(x),x;f=yy(c),(g=za.get(g))&&fp(f,g),x=(i.ownerDocument||i).createElement("link"),Ye(x);var b=x;return b._p=new Promise(function(B,ae){b.onload=B,b.onerror=ae}),wn(x,"link",f),s.state.loading|=4,Ah(x,c.precedence,i),s.instance=x;case"script":return x=kc(c.src),(g=i.querySelector(nf(x)))?(s.instance=g,Ye(g),g):(f=c,(g=za.get(x))&&(f=v({},c),hp(f,g)),i=i.ownerDocument||i,g=i.createElement("script"),Ye(g),wn(g,"link",f),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,Ah(f,c.precedence,i));return s.instance}function Ah(i,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,x=g,b=0;b<f.length;b++){var B=f[b];if(B.dataset.precedence===s)x=B;else if(x!==g)break}x?x.parentNode.insertBefore(i,x.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function fp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function hp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var kh=null;function Ty(i,s,c){if(kh===null){var f=new Map,g=kh=new Map;g.set(c,f)}else g=kh,f=g.get(c),f||(f=new Map,g.set(c,f));if(f.has(i))return f;for(f.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var x=c[g];if(!(x[pe]||x[H]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var b=x.getAttribute(s)||"";b=i+b;var B=f.get(b);B?B.push(x):f.set(b,[x])}}return f}function Ey(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function eC(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(i=s.disabled,typeof s.precedence=="string"&&i==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Sy(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function tC(i,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=Ac(f.href),x=s.querySelector(rf(g));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=Ch.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=x,Ye(x);return}x=s.ownerDocument||s,f=yy(f),(g=za.get(g))&&fp(f,g),x=x.createElement("link"),Ye(x);var b=x;b._p=new Promise(function(B,ae){b.onload=B,b.onerror=ae}),wn(x,"link",f),c.instance=x}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=Ch.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var dp=0;function rC(i,s){return i.stylesheets&&i.count===0&&Rh(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var f=setTimeout(function(){if(i.stylesheets&&Rh(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4+s);0<i.imgBytes&&dp===0&&(dp=62500*L3());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Rh(i,i.stylesheets),i.unsuspend)){var x=i.unsuspend;i.unsuspend=null,x()}},(i.imgBytes>dp?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(g)}}:null}function Ch(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Rh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Nh=null;function Rh(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Nh=new Map,s.forEach(nC,i),Nh=null,Ch.call(i))}function nC(i,s){if(!(s.state.loading&4)){var c=Nh.get(i);if(c)var f=c.get(null);else{c=new Map,Nh.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var b=g[x];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),f=b)}f&&c.set(null,f)}g=s.instance,b=g.getAttribute("data-precedence"),x=c.get(b)||f,x===f&&c.set(null,g),c.set(b,g),this.count++,f=Ch.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),x?x.parentNode.insertBefore(g,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var af={$$typeof:N,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function aC(i,s,c,f,g,x,b,B,ae){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.hiddenUpdates=cn(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function by(i,s,c,f,g,x,b,B,ae,me,ke,Re){return i=new aC(i,s,c,b,ae,me,ke,Re,B),s=1,x===!0&&(s|=24),x=va(3,null,null,s),i.current=x,x.stateNode=i,s=Xm(),s.refCount++,i.pooledCache=s,s.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:s},Ym(x),i}function Ay(i){return i?(i=ac,i):ac}function ky(i,s,c,f,g,x){g=Ay(g),f.context===null?f.context=g:f.pendingContext=g,f=qs(s),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=Xs(i,f,s),c!==null&&(oa(c,i,s),Lu(c,i,s))}function Cy(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function mp(i,s){Cy(i,s),(i=i.alternate)&&Cy(i,s)}function Ny(i){if(i.tag===13||i.tag===31){var s=Zo(i,67108864);s!==null&&oa(s,i,67108864),mp(i,67108864)}}function Ry(i){if(i.tag===13||i.tag===31){var s=Ea();s=da(s);var c=Zo(i,s);c!==null&&oa(c,i,s),mp(i,s)}}var Ih=!0;function iC(i,s,c,f){var g=Y.T;Y.T=null;var x=ne.p;try{ne.p=2,pp(i,s,c,f)}finally{ne.p=x,Y.T=g}}function sC(i,s,c,f){var g=Y.T;Y.T=null;var x=ne.p;try{ne.p=8,pp(i,s,c,f)}finally{ne.p=x,Y.T=g}}function pp(i,s,c,f){if(Ih){var g=gp(f);if(g===null)tp(i,s,f,Dh,c),Dy(i,f);else if(lC(g,i,s,c,f))f.stopPropagation();else if(Dy(i,f),s&4&&-1<oC.indexOf(i)){for(;g!==null;){var x=qe(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var b=Ir(x.pendingLanes);if(b!==0){var B=x;for(B.pendingLanes|=2,B.entangledLanes|=2;b;){var ae=1<<31-Ze(b);B.entanglements[1]|=ae,b&=~ae}Di(x),(Wt&6)===0&&(mh=Lt()+500,Ju(0))}}break;case 31:case 13:B=Zo(x,2),B!==null&&oa(B,x,2),gh(),mp(x,2)}if(x=gp(f),x===null&&tp(i,s,f,Dh,c),x===g)break;g=x}g!==null&&f.stopPropagation()}else tp(i,s,f,null,c)}}function gp(i){return i=Da(i),xp(i)}var Dh=null;function xp(i){if(Dh=null,i=Ve(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=l(s),i!==null)return i;i=null}else if(c===31){if(i=u(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Dh=i,null}function Iy(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jr()){case gn:return 2;case Wn:return 8;case Pt:case Nn:return 32;case ut:return 268435456;default:return 32}default:return 32}}var vp=!1,no=null,ao=null,io=null,sf=new Map,of=new Map,so=[],oC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dy(i,s){switch(i){case"focusin":case"focusout":no=null;break;case"dragenter":case"dragleave":ao=null;break;case"mouseover":case"mouseout":io=null;break;case"pointerover":case"pointerout":sf.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":of.delete(s.pointerId)}}function lf(i,s,c,f,g,x){return i===null||i.nativeEvent!==x?(i={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[g]},s!==null&&(s=qe(s),s!==null&&Ny(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function lC(i,s,c,f,g){switch(s){case"focusin":return no=lf(no,i,s,c,f,g),!0;case"dragenter":return ao=lf(ao,i,s,c,f,g),!0;case"mouseover":return io=lf(io,i,s,c,f,g),!0;case"pointerover":var x=g.pointerId;return sf.set(x,lf(sf.get(x)||null,i,s,c,f,g)),!0;case"gotpointercapture":return x=g.pointerId,of.set(x,lf(of.get(x)||null,i,s,c,f,g)),!0}return!1}function Oy(i){var s=Ve(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){i.blockedOn=s,W(i.priority,function(){Ry(c)});return}}else if(s===31){if(s=u(c),s!==null){i.blockedOn=s,W(i.priority,function(){Ry(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Oh(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=gp(i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);yu=f,c.target.dispatchEvent(f),yu=null}else return s=qe(c),s!==null&&Ny(s),i.blockedOn=c,!1;s.shift()}return!0}function Fy(i,s,c){Oh(i)&&c.delete(s)}function cC(){vp=!1,no!==null&&Oh(no)&&(no=null),ao!==null&&Oh(ao)&&(ao=null),io!==null&&Oh(io)&&(io=null),sf.forEach(Fy),of.forEach(Fy)}function Fh(i,s){i.blockedOn===s&&(i.blockedOn=null,vp||(vp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,cC)))}var Mh=null;function My(i){Mh!==i&&(Mh=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Mh===i&&(Mh=null);for(var s=0;s<i.length;s+=3){var c=i[s],f=i[s+1],g=i[s+2];if(typeof f!="function"){if(xp(f||c)===null)continue;break}var x=qe(c);x!==null&&(i.splice(s,3),s-=3,g1(x,{pending:!0,data:g,method:c.method,action:f},f,g))}}))}function Cc(i){function s(ae){return Fh(ae,i)}no!==null&&Fh(no,i),ao!==null&&Fh(ao,i),io!==null&&Fh(io,i),sf.forEach(s),of.forEach(s);for(var c=0;c<so.length;c++){var f=so[c];f.blockedOn===i&&(f.blockedOn=null)}for(;0<so.length&&(c=so[0],c.blockedOn===null);)Oy(c),c.blockedOn===null&&so.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var g=c[f],x=c[f+1],b=g[X]||null;if(typeof x=="function")b||My(c);else if(b){var B=null;if(x&&x.hasAttribute("formAction")){if(g=x,b=x[X]||null)B=b.formAction;else if(xp(g)!==null)continue}else B=b.action;typeof B=="function"?c[f+1]=B:(c.splice(f,3),f-=3),My(c)}}}function Ly(){function i(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(b){return g=b})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function _p(i){this._internalRoot=i}Lh.prototype.render=_p.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=Ea();ky(c,f,i,s,null,null)},Lh.prototype.unmount=_p.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;ky(i.current,2,null,i,null,null),gh(),s[Z]=null}};function Lh(i){this._internalRoot=i}Lh.prototype.unstable_scheduleHydration=function(i){if(i){var s=P();i={blockedOn:null,target:i,priority:s};for(var c=0;c<so.length&&s!==0&&s<so[c].priority;c++);so.splice(c,0,i),c===0&&Oy(i)}};var Py=e.version;if(Py!=="19.2.3")throw Error(n(527,Py,"19.2.3"));ne.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(s),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var uC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ph.isDisabled&&Ph.supportsFiber)try{De=Ph.inject(uC),Xe=Ph}catch{}}return uf.createRoot=function(i,s){if(!a(i))throw Error(n(299));var c=!1,f="",g=G_,x=q_,b=X_;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError)),s=by(i,1,!1,null,null,c,f,null,g,x,b,Ly),i[Z]=s.current,ep(i),new _p(s)},uf.hydrateRoot=function(i,s,c){if(!a(i))throw Error(n(299));var f=!1,g="",x=G_,b=q_,B=X_,ae=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.formState!==void 0&&(ae=c.formState)),s=by(i,1,!0,s,c??null,f,g,ae,x,b,B,Ly),s.context=Ay(null),c=s.current,f=Ea(),f=da(f),g=qs(f),g.callback=null,Xs(c,g,f),c=f,s.current.lanes=c,ei(s,c),Di(s),i[Z]=s.current,ep(i),new Lh(s)},uf.version="19.2.3",uf}var Wy;function yC(){if(Wy)return Tp.exports;Wy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Tp.exports=_C(),Tp.exports}var wC=yC();const TC=VE(wC),EC=()=>{};var Ky={};const BE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},SC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],l=t[r++],u=t[r++],h=((a&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|l&63)}}return e.join("")},UE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],l=a+1<t.length,u=l?t[a+1]:0,h=a+2<t.length,d=h?t[a+2]:0,p=o>>2,v=(o&3)<<4|u>>4;let _=(u&15)<<2|d>>6,w=d&63;h||(w=64,l||(_=64)),n.push(r[p],r[v],r[_],r[w])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(BE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const v=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||d==null||v==null)throw new bC;const _=o<<2|u>>4;if(n.push(_),d!==64){const w=u<<4&240|d>>2;if(n.push(w),v!==64){const S=d<<6&192|v;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AC=function(t){const e=BE(t);return UE.encodeByteArray(e,!0)},dd=function(t){return AC(t).replace(/\./g,"")},jE=function(t){try{return UE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function kC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const CC=()=>kC().__FIREBASE_DEFAULTS__,NC=()=>{if(typeof process>"u"||typeof Ky>"u")return;const t=Ky.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},RC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&jE(t[1]);return e&&JSON.parse(e)},Wd=()=>{try{return EC()||CC()||NC()||RC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},zE=t=>Wd()?.emulatorHosts?.[t],IC=t=>{const e=zE(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},HE=()=>Wd()?.config,GE=t=>Wd()?.[`_${t}`];class DC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function iu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qE(t){return(await fetch(t,{credentials:"include"})).ok}function OC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[dd(JSON.stringify(r)),dd(JSON.stringify(l)),""].join(".")}const _f={};function FC(){const t={prod:[],emulator:[]};for(const e of Object.keys(_f))_f[e]?t.emulator.push(e):t.prod.push(e);return t}function MC(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let $y=!1;function XE(t,e){if(typeof window>"u"||typeof document>"u"||!iu(window.location.host)||_f[t]===e||_f[t]||$y)return;_f[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=FC().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function h(_,w){_.setAttribute("width","24"),_.setAttribute("id",w),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{$y=!0,l()},_}function p(_,w){_.setAttribute("id",w),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=MC(n),w=r("text"),S=document.getElementById(w)||document.createElement("span"),E=r("learnmore"),A=document.getElementById(E)||document.createElement("a"),L=r("preprendIcon"),U=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const N=_.element;u(N),p(A,E);const Q=d();h(U,L),N.append(U,S,A,Q),document.body.appendChild(N)}o?(S.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hn())}function PC(){const t=Wd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function VC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function UC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jC(){const t=Hn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function zC(){return!PC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HC(){try{return typeof indexedDB=="object"}catch{return!1}}function GC(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}const qC="FirebaseError";class bs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=qC,Object.setPrototypeOf(this,bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t0.prototype.create)}}class t0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],l=o?XC(o,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new bs(a,u,n)}}function XC(t,e){return t.replace(WC,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const WC=/\{\$([^}]+)}/g;function KC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],l=e[a];if(Yy(o)&&Yy(l)){if(!bl(o,l))return!1}else if(o!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Yy(t){return t!==null&&typeof t=="object"}function r0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function $C(t,e){const r=new YC(t,e);return r.subscribe.bind(r)}class YC{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");QC(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=Ap),a.error===void 0&&(a.error=Ap),a.complete===void 0&&(a.complete=Ap);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Ap(){}function kn(t){return t&&t._delegate?t._delegate:t}class Al{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ml="[DEFAULT]";class JC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new DC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(e5(e))try{this.getOrInitializeService({instanceIdentifier:ml})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=ml){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ml){return this.instances.has(e)}getOptions(e=ml){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const o=this.instances.get(n);return o&&e(o,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ZC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ml){return this.component?this.component.multipleInstances?e:ml:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZC(t){return t===ml?void 0:t}function e5(t){return t.instantiationMode==="EAGER"}class t5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new JC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ct||(Ct={}));const r5={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},n5=Ct.INFO,a5={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},i5=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=a5[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ug{constructor(e){this.name=e,this._logLevel=n5,this._logHandler=i5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?r5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const s5=(t,e)=>e.some(r=>t instanceof r);let Qy,Jy;function o5(){return Qy||(Qy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function l5(){return Jy||(Jy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const WE=new WeakMap,Zp=new WeakMap,KE=new WeakMap,kp=new WeakMap,jg=new WeakMap;function c5(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{r(vo(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&WE.set(r,t)}).catch(()=>{}),jg.set(e,t),e}function u5(t){if(Zp.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});Zp.set(t,e)}let eg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Zp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||KE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return vo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function f5(t){eg=t(eg)}function h5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Cp(this),e,...r);return KE.set(n,e.sort?e.sort():[e]),vo(n)}:l5().includes(t)?function(...e){return t.apply(Cp(this),e),vo(WE.get(this))}:function(...e){return vo(t.apply(Cp(this),e))}}function d5(t){return typeof t=="function"?h5(t):(t instanceof IDBTransaction&&u5(t),s5(t,o5())?new Proxy(t,eg):t)}function vo(t){if(t instanceof IDBRequest)return c5(t);if(kp.has(t))return kp.get(t);const e=d5(t);return e!==t&&(kp.set(t,e),jg.set(e,t)),e}const Cp=t=>jg.get(t);function m5(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const l=indexedDB.open(t,e),u=vo(l);return n&&l.addEventListener("upgradeneeded",h=>{n(vo(l.result),h.oldVersion,h.newVersion,vo(l.transaction),h)}),r&&l.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const p5=["get","getKey","getAll","getAllKeys","count"],g5=["put","add","delete","clear"],Np=new Map;function Zy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Np.get(e))return Np.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=g5.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||p5.includes(r)))return;const o=async function(l,...u){const h=this.transaction(l,a?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&h.done]))[0]};return Np.set(e,o),o}f5(t=>({...t,get:(e,r,n)=>Zy(e,r)||t.get(e,r,n),has:(e,r)=>!!Zy(e,r)||t.has(e,r)}));class x5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(v5(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function v5(t){return t.getComponent()?.type==="VERSION"}const tg="@firebase/app",ew="0.14.6";const _s=new Ug("@firebase/app"),_5="@firebase/app-compat",y5="@firebase/analytics-compat",w5="@firebase/analytics",T5="@firebase/app-check-compat",E5="@firebase/app-check",S5="@firebase/auth",b5="@firebase/auth-compat",A5="@firebase/database",k5="@firebase/data-connect",C5="@firebase/database-compat",N5="@firebase/functions",R5="@firebase/functions-compat",I5="@firebase/installations",D5="@firebase/installations-compat",O5="@firebase/messaging",F5="@firebase/messaging-compat",M5="@firebase/performance",L5="@firebase/performance-compat",P5="@firebase/remote-config",V5="@firebase/remote-config-compat",B5="@firebase/storage",U5="@firebase/storage-compat",j5="@firebase/firestore",z5="@firebase/ai",H5="@firebase/firestore-compat",G5="firebase",q5="12.6.0";const rg="[DEFAULT]",X5={[tg]:"fire-core",[_5]:"fire-core-compat",[w5]:"fire-analytics",[y5]:"fire-analytics-compat",[E5]:"fire-app-check",[T5]:"fire-app-check-compat",[S5]:"fire-auth",[b5]:"fire-auth-compat",[A5]:"fire-rtdb",[k5]:"fire-data-connect",[C5]:"fire-rtdb-compat",[N5]:"fire-fn",[R5]:"fire-fn-compat",[I5]:"fire-iid",[D5]:"fire-iid-compat",[O5]:"fire-fcm",[F5]:"fire-fcm-compat",[M5]:"fire-perf",[L5]:"fire-perf-compat",[P5]:"fire-rc",[V5]:"fire-rc-compat",[B5]:"fire-gcs",[U5]:"fire-gcs-compat",[j5]:"fire-fst",[H5]:"fire-fst-compat",[z5]:"fire-vertex","fire-js":"fire-js",[G5]:"fire-js-all"};const md=new Map,W5=new Map,ng=new Map;function tw(t,e){try{t.container.addComponent(e)}catch(r){_s.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Kc(t){const e=t.name;if(ng.has(e))return _s.debug(`There were multiple attempts to register component ${e}.`),!1;ng.set(e,t);for(const r of md.values())tw(r,t);for(const r of W5.values())tw(r,t);return!0}function zg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function di(t){return t==null?!1:t.settings!==void 0}const K5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_o=new t0("app","Firebase",K5);class $5{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _o.create("app-deleted",{appName:this._name})}}const su=q5;function n0(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:rg,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw _o.create("bad-app-name",{appName:String(a)});if(r||(r=HE()),!r)throw _o.create("no-options");const o=md.get(a);if(o){if(bl(r,o.options)&&bl(n,o.config))return o;throw _o.create("duplicate-app",{appName:a})}const l=new t5(a);for(const h of ng.values())l.addComponent(h);const u=new $5(r,n,l);return md.set(a,u),u}function $E(t=rg){const e=md.get(t);if(!e&&t===rg&&HE())return n0();if(!e)throw _o.create("no-app",{appName:t});return e}function yo(t,e,r){let n=X5[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${n}" with version "${e}":`];a&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_s.warn(l.join(" "));return}Kc(new Al(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const Y5="firebase-heartbeat-database",Q5=1,Of="firebase-heartbeat-store";let Rp=null;function YE(){return Rp||(Rp=m5(Y5,Q5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Of)}catch(r){console.warn(r)}}}}).catch(t=>{throw _o.create("idb-open",{originalErrorMessage:t.message})})),Rp}async function J5(t){try{const r=(await YE()).transaction(Of),n=await r.objectStore(Of).get(QE(t));return await r.done,n}catch(e){if(e instanceof bs)_s.warn(e.message);else{const r=_o.create("idb-get",{originalErrorMessage:e?.message});_s.warn(r.message)}}}async function rw(t,e){try{const n=(await YE()).transaction(Of,"readwrite");await n.objectStore(Of).put(e,QE(t)),await n.done}catch(r){if(r instanceof bs)_s.warn(r.message);else{const n=_o.create("idb-set",{originalErrorMessage:r?.message});_s.warn(n.message)}}}function QE(t){return`${t.name}!${t.options.appId}`}const Z5=1024,eN=30;class tN{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new nN(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=nw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>eN){const a=aN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_s.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nw(),{heartbeatsToSend:r,unsentEntries:n}=rN(this._heartbeatsCache.heartbeats),a=dd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return _s.warn(e),""}}}function nw(){return new Date().toISOString().substring(0,10)}function rN(t,e=Z5){const r=[];let n=t.slice();for(const a of t){const o=r.find(l=>l.agent===a.agent);if(o){if(o.dates.push(a.date),aw(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),aw(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class nN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return HC()?GC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await J5(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return rw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return rw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function aw(t){return dd(JSON.stringify({version:2,heartbeats:t})).length}function aN(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function iN(t){Kc(new Al("platform-logger",e=>new x5(e),"PRIVATE")),Kc(new Al("heartbeat",e=>new tN(e),"PRIVATE")),yo(tg,ew,t),yo(tg,ew,"esm2020"),yo("fire-js","")}iN("");var sN="firebase",oN="12.7.0";yo(sN,oN,"app");var iw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var wo,JE;(function(){var t;function e(k,I){function R(){}R.prototype=I.prototype,k.F=I.prototype,k.prototype=new R,k.prototype.constructor=k,k.D=function(O,F,D){for(var V=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)V[Te-2]=arguments[Te];return I.prototype[F].apply(O,V)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,I,R){R||(R=0);const O=Array(16);if(typeof I=="string")for(var F=0;F<16;++F)O[F]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(F=0;F<16;++F)O[F]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=k.g[0],R=k.g[1],F=k.g[2];let D=k.g[3],V;V=I+(D^R&(F^D))+O[0]+3614090360&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(F^I&(R^F))+O[1]+3905402710&4294967295,D=I+(V<<12&4294967295|V>>>20),V=F+(R^D&(I^R))+O[2]+606105819&4294967295,F=D+(V<<17&4294967295|V>>>15),V=R+(I^F&(D^I))+O[3]+3250441966&4294967295,R=F+(V<<22&4294967295|V>>>10),V=I+(D^R&(F^D))+O[4]+4118548399&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(F^I&(R^F))+O[5]+1200080426&4294967295,D=I+(V<<12&4294967295|V>>>20),V=F+(R^D&(I^R))+O[6]+2821735955&4294967295,F=D+(V<<17&4294967295|V>>>15),V=R+(I^F&(D^I))+O[7]+4249261313&4294967295,R=F+(V<<22&4294967295|V>>>10),V=I+(D^R&(F^D))+O[8]+1770035416&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(F^I&(R^F))+O[9]+2336552879&4294967295,D=I+(V<<12&4294967295|V>>>20),V=F+(R^D&(I^R))+O[10]+4294925233&4294967295,F=D+(V<<17&4294967295|V>>>15),V=R+(I^F&(D^I))+O[11]+2304563134&4294967295,R=F+(V<<22&4294967295|V>>>10),V=I+(D^R&(F^D))+O[12]+1804603682&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(F^I&(R^F))+O[13]+4254626195&4294967295,D=I+(V<<12&4294967295|V>>>20),V=F+(R^D&(I^R))+O[14]+2792965006&4294967295,F=D+(V<<17&4294967295|V>>>15),V=R+(I^F&(D^I))+O[15]+1236535329&4294967295,R=F+(V<<22&4294967295|V>>>10),V=I+(F^D&(R^F))+O[1]+4129170786&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^F&(I^R))+O[6]+3225465664&4294967295,D=I+(V<<9&4294967295|V>>>23),V=F+(I^R&(D^I))+O[11]+643717713&4294967295,F=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(F^D))+O[0]+3921069994&4294967295,R=F+(V<<20&4294967295|V>>>12),V=I+(F^D&(R^F))+O[5]+3593408605&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^F&(I^R))+O[10]+38016083&4294967295,D=I+(V<<9&4294967295|V>>>23),V=F+(I^R&(D^I))+O[15]+3634488961&4294967295,F=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(F^D))+O[4]+3889429448&4294967295,R=F+(V<<20&4294967295|V>>>12),V=I+(F^D&(R^F))+O[9]+568446438&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^F&(I^R))+O[14]+3275163606&4294967295,D=I+(V<<9&4294967295|V>>>23),V=F+(I^R&(D^I))+O[3]+4107603335&4294967295,F=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(F^D))+O[8]+1163531501&4294967295,R=F+(V<<20&4294967295|V>>>12),V=I+(F^D&(R^F))+O[13]+2850285829&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^F&(I^R))+O[2]+4243563512&4294967295,D=I+(V<<9&4294967295|V>>>23),V=F+(I^R&(D^I))+O[7]+1735328473&4294967295,F=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(F^D))+O[12]+2368359562&4294967295,R=F+(V<<20&4294967295|V>>>12),V=I+(R^F^D)+O[5]+4294588738&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^F)+O[8]+2272392833&4294967295,D=I+(V<<11&4294967295|V>>>21),V=F+(D^I^R)+O[11]+1839030562&4294967295,F=D+(V<<16&4294967295|V>>>16),V=R+(F^D^I)+O[14]+4259657740&4294967295,R=F+(V<<23&4294967295|V>>>9),V=I+(R^F^D)+O[1]+2763975236&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^F)+O[4]+1272893353&4294967295,D=I+(V<<11&4294967295|V>>>21),V=F+(D^I^R)+O[7]+4139469664&4294967295,F=D+(V<<16&4294967295|V>>>16),V=R+(F^D^I)+O[10]+3200236656&4294967295,R=F+(V<<23&4294967295|V>>>9),V=I+(R^F^D)+O[13]+681279174&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^F)+O[0]+3936430074&4294967295,D=I+(V<<11&4294967295|V>>>21),V=F+(D^I^R)+O[3]+3572445317&4294967295,F=D+(V<<16&4294967295|V>>>16),V=R+(F^D^I)+O[6]+76029189&4294967295,R=F+(V<<23&4294967295|V>>>9),V=I+(R^F^D)+O[9]+3654602809&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^F)+O[12]+3873151461&4294967295,D=I+(V<<11&4294967295|V>>>21),V=F+(D^I^R)+O[15]+530742520&4294967295,F=D+(V<<16&4294967295|V>>>16),V=R+(F^D^I)+O[2]+3299628645&4294967295,R=F+(V<<23&4294967295|V>>>9),V=I+(F^(R|~D))+O[0]+4096336452&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~F))+O[7]+1126891415&4294967295,D=I+(V<<10&4294967295|V>>>22),V=F+(I^(D|~R))+O[14]+2878612391&4294967295,F=D+(V<<15&4294967295|V>>>17),V=R+(D^(F|~I))+O[5]+4237533241&4294967295,R=F+(V<<21&4294967295|V>>>11),V=I+(F^(R|~D))+O[12]+1700485571&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~F))+O[3]+2399980690&4294967295,D=I+(V<<10&4294967295|V>>>22),V=F+(I^(D|~R))+O[10]+4293915773&4294967295,F=D+(V<<15&4294967295|V>>>17),V=R+(D^(F|~I))+O[1]+2240044497&4294967295,R=F+(V<<21&4294967295|V>>>11),V=I+(F^(R|~D))+O[8]+1873313359&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~F))+O[15]+4264355552&4294967295,D=I+(V<<10&4294967295|V>>>22),V=F+(I^(D|~R))+O[6]+2734768916&4294967295,F=D+(V<<15&4294967295|V>>>17),V=R+(D^(F|~I))+O[13]+1309151649&4294967295,R=F+(V<<21&4294967295|V>>>11),V=I+(F^(R|~D))+O[4]+4149444226&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~F))+O[11]+3174756917&4294967295,D=I+(V<<10&4294967295|V>>>22),V=F+(I^(D|~R))+O[2]+718787259&4294967295,F=D+(V<<15&4294967295|V>>>17),V=R+(D^(F|~I))+O[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(F+(V<<21&4294967295|V>>>11))&4294967295,k.g[2]=k.g[2]+F&4294967295,k.g[3]=k.g[3]+D&4294967295}n.prototype.v=function(k,I){I===void 0&&(I=k.length);const R=I-this.blockSize,O=this.C;let F=this.h,D=0;for(;D<I;){if(F==0)for(;D<=R;)a(this,k,D),D+=this.blockSize;if(typeof k=="string"){for(;D<I;)if(O[F++]=k.charCodeAt(D++),F==this.blockSize){a(this,O),F=0;break}}else for(;D<I;)if(O[F++]=k[D++],F==this.blockSize){a(this,O),F=0;break}}this.h=F,this.o+=I},n.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var R=k.length-8;R<k.length;++R)k[R]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,R=0;R<4;++R)for(let O=0;O<32;O+=8)k[I++]=this.g[R]>>>O&255;return k};function o(k,I){var R=u;return Object.prototype.hasOwnProperty.call(R,k)?R[k]:R[k]=I(k)}function l(k,I){this.h=I;const R=[];let O=!0;for(let F=k.length-1;F>=0;F--){const D=k[F]|0;O&&D==I||(R[F]=D,O=!1)}this.g=R}var u={};function h(k){return-128<=k&&k<128?o(k,function(I){return new l([I|0],I<0?-1:0)}):new l([k|0],k<0?-1:0)}function d(k){if(isNaN(k)||!isFinite(k))return v;if(k<0)return A(d(-k));const I=[];let R=1;for(let O=0;k>=R;O++)I[O]=k/R|0,R*=4294967296;return new l(I,0)}function p(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return A(p(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=d(Math.pow(I,8));let O=v;for(let D=0;D<k.length;D+=8){var F=Math.min(8,k.length-D);const V=parseInt(k.substring(D,D+F),I);F<8?(F=d(Math.pow(I,F)),O=O.j(F).add(d(V))):(O=O.j(R),O=O.add(d(V)))}return O}var v=h(0),_=h(1),w=h(16777216);t=l.prototype,t.m=function(){if(E(this))return-A(this).m();let k=0,I=1;for(let R=0;R<this.g.length;R++){const O=this.i(R);k+=(O>=0?O:4294967296+O)*I,I*=4294967296}return k},t.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(S(this))return"0";if(E(this))return"-"+A(this).toString(k);const I=d(Math.pow(k,6));var R=this;let O="";for(;;){const F=Q(R,I).g;R=L(R,F.j(I));let D=((R.g.length>0?R.g[0]:R.h)>>>0).toString(k);if(R=F,S(R))return D+O;for(;D.length<6;)D="0"+D;O=D+O}},t.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function S(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function E(k){return k.h==-1}t.l=function(k){return k=L(this,k),E(k)?-1:S(k)?0:1};function A(k){const I=k.g.length,R=[];for(let O=0;O<I;O++)R[O]=~k.g[O];return new l(R,~k.h).add(_)}t.abs=function(){return E(this)?A(this):this},t.add=function(k){const I=Math.max(this.g.length,k.g.length),R=[];let O=0;for(let F=0;F<=I;F++){let D=O+(this.i(F)&65535)+(k.i(F)&65535),V=(D>>>16)+(this.i(F)>>>16)+(k.i(F)>>>16);O=V>>>16,D&=65535,V&=65535,R[F]=V<<16|D}return new l(R,R[R.length-1]&-2147483648?-1:0)};function L(k,I){return k.add(A(I))}t.j=function(k){if(S(this)||S(k))return v;if(E(this))return E(k)?A(this).j(A(k)):A(A(this).j(k));if(E(k))return A(this.j(A(k)));if(this.l(w)<0&&k.l(w)<0)return d(this.m()*k.m());const I=this.g.length+k.g.length,R=[];for(var O=0;O<2*I;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(let F=0;F<k.g.length;F++){const D=this.i(O)>>>16,V=this.i(O)&65535,Te=k.i(F)>>>16,oe=k.i(F)&65535;R[2*O+2*F]+=V*oe,U(R,2*O+2*F),R[2*O+2*F+1]+=D*oe,U(R,2*O+2*F+1),R[2*O+2*F+1]+=V*Te,U(R,2*O+2*F+1),R[2*O+2*F+2]+=D*Te,U(R,2*O+2*F+2)}for(k=0;k<I;k++)R[k]=R[2*k+1]<<16|R[2*k];for(k=I;k<2*I;k++)R[k]=0;return new l(R,0)};function U(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function N(k,I){this.g=k,this.h=I}function Q(k,I){if(S(I))throw Error("division by zero");if(S(k))return new N(v,v);if(E(k))return I=Q(A(k),I),new N(A(I.g),A(I.h));if(E(I))return I=Q(k,A(I)),new N(A(I.g),I.h);if(k.g.length>30){if(E(k)||E(I))throw Error("slowDivide_ only works with positive integers.");for(var R=_,O=I;O.l(k)<=0;)R=re(R),O=re(O);var F=ee(R,1),D=ee(O,1);for(O=ee(O,2),R=ee(R,2);!S(O);){var V=D.add(O);V.l(k)<=0&&(F=F.add(R),D=V),O=ee(O,1),R=ee(R,1)}return I=L(k,F.j(I)),new N(F,I)}for(F=v;k.l(I)>=0;){for(R=Math.max(1,Math.floor(k.m()/I.m())),O=Math.ceil(Math.log(R)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),D=d(R),V=D.j(I);E(V)||V.l(k)>0;)R-=O,D=d(R),V=D.j(I);S(D)&&(D=_),F=F.add(D),k=L(k,V)}return new N(F,k)}t.B=function(k){return Q(this,k).h},t.and=function(k){const I=Math.max(this.g.length,k.g.length),R=[];for(let O=0;O<I;O++)R[O]=this.i(O)&k.i(O);return new l(R,this.h&k.h)},t.or=function(k){const I=Math.max(this.g.length,k.g.length),R=[];for(let O=0;O<I;O++)R[O]=this.i(O)|k.i(O);return new l(R,this.h|k.h)},t.xor=function(k){const I=Math.max(this.g.length,k.g.length),R=[];for(let O=0;O<I;O++)R[O]=this.i(O)^k.i(O);return new l(R,this.h^k.h)};function re(k){const I=k.g.length+1,R=[];for(let O=0;O<I;O++)R[O]=k.i(O)<<1|k.i(O-1)>>>31;return new l(R,k.h)}function ee(k,I){const R=I>>5;I%=32;const O=k.g.length-R,F=[];for(let D=0;D<O;D++)F[D]=I>0?k.i(D+R)>>>I|k.i(D+R+1)<<32-I:k.i(D+R);return new l(F,k.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,JE=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,wo=l}).apply(typeof iw<"u"?iw:typeof self<"u"?self:typeof window<"u"?window:{});var Vh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ZE,hf,eS,nd,ag,tS,rS,nS;(function(){var t,e=Object.defineProperty;function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vh=="object"&&Vh];for(var T=0;T<m.length;++T){var C=m[T];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function a(m,T){if(T)e:{var C=n;m=m.split(".");for(var z=0;z<m.length-1;z++){var ue=m[z];if(!(ue in C))break e;C=C[ue]}m=m[m.length-1],z=C[m],T=T(z),T!=z&&T!=null&&e(C,m,{configurable:!0,writable:!0,value:T})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(T){var C=[],z;for(z in T)Object.prototype.hasOwnProperty.call(T,z)&&C.push([z,T[z]]);return C}});var o=o||{},l=this||self;function u(m){var T=typeof m;return T=="object"&&m!=null||T=="function"}function h(m,T,C){return m.call.apply(m.bind,arguments)}function d(m,T,C){return d=h,d.apply(null,arguments)}function p(m,T){var C=Array.prototype.slice.call(arguments,1);return function(){var z=C.slice();return z.push.apply(z,arguments),m.apply(this,z)}}function v(m,T){function C(){}C.prototype=T.prototype,m.Z=T.prototype,m.prototype=new C,m.prototype.constructor=m,m.Ob=function(z,ue,_e){for(var He=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)He[xt-2]=arguments[xt];return T.prototype[ue].apply(z,He)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function w(m){const T=m.length;if(T>0){const C=Array(T);for(let z=0;z<T;z++)C[z]=m[z];return C}return[]}function S(m,T){for(let z=1;z<arguments.length;z++){const ue=arguments[z];var C=typeof ue;if(C=C!="object"?C:ue?Array.isArray(ue)?"array":C:"null",C=="array"||C=="object"&&typeof ue.length=="number"){C=m.length||0;const _e=ue.length||0;m.length=C+_e;for(let He=0;He<_e;He++)m[C+He]=ue[He]}else m.push(ue)}}class E{constructor(T,C){this.i=T,this.j=C,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function A(m){l.setTimeout(()=>{throw m},0)}function L(){var m=k;let T=null;return m.g&&(T=m.g,m.g=m.g.next,m.g||(m.h=null),T.next=null),T}class U{constructor(){this.h=this.g=null}add(T,C){const z=N.get();z.set(T,C),this.h?this.h.next=z:this.g=z,this.h=z}}var N=new E(()=>new Q,m=>m.reset());class Q{constructor(){this.next=this.g=this.h=null}set(T,C){this.h=T,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let re,ee=!1,k=new U,I=()=>{const m=Promise.resolve(void 0);re=()=>{m.then(R)}};function R(){for(var m;m=L();){try{m.h.call(m.g)}catch(C){A(C)}var T=N;T.j(m),T.h<100&&(T.h++,m.next=T.g,T.g=m)}ee=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(m,T){this.type=m,this.g=this.target=T,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,T=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const C=()=>{};l.addEventListener("test",C,T),l.removeEventListener("test",C,T)}catch{}return m})();function V(m){return/^[\s\xa0]*$/.test(m)}function Te(m,T){F.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,T)}v(Te,F),Te.prototype.init=function(m,T){const C=this.type=m.type,z=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=T,T=m.relatedTarget,T||(C=="mouseover"?T=m.fromElement:C=="mouseout"&&(T=m.toElement)),this.relatedTarget=T,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&Te.Z.h.call(this)},Te.prototype.h=function(){Te.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var oe="closure_listenable_"+(Math.random()*1e6|0),Y=0;function ne(m,T,C,z,ue){this.listener=m,this.proxy=null,this.src=T,this.type=C,this.capture=!!z,this.ha=ue,this.key=++Y,this.da=this.fa=!1}function ve(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ie(m,T,C){for(const z in m)T.call(C,m[z],z,m)}function Ce(m,T){for(const C in m)T.call(void 0,m[C],C,m)}function K(m){const T={};for(const C in m)T[C]=m[C];return T}const M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(m,T){let C,z;for(let ue=1;ue<arguments.length;ue++){z=arguments[ue];for(C in z)m[C]=z[C];for(let _e=0;_e<M.length;_e++)C=M[_e],Object.prototype.hasOwnProperty.call(z,C)&&(m[C]=z[C])}}function G(m){this.src=m,this.g={},this.h=0}G.prototype.add=function(m,T,C,z,ue){const _e=m.toString();m=this.g[_e],m||(m=this.g[_e]=[],this.h++);const He=le(m,T,z,ue);return He>-1?(T=m[He],C||(T.fa=!1)):(T=new ne(T,this.src,_e,!!z,ue),T.fa=C,m.push(T)),T};function J(m,T){const C=T.type;if(C in m.g){var z=m.g[C],ue=Array.prototype.indexOf.call(z,T,void 0),_e;(_e=ue>=0)&&Array.prototype.splice.call(z,ue,1),_e&&(ve(T),m.g[C].length==0&&(delete m.g[C],m.h--))}}function le(m,T,C,z){for(let ue=0;ue<m.length;++ue){const _e=m[ue];if(!_e.da&&_e.listener==T&&_e.capture==!!C&&_e.ha==z)return ue}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),be={};function Ee(m,T,C,z,ue){if(Array.isArray(T)){for(let _e=0;_e<T.length;_e++)Ee(m,T[_e],C,z,ue);return null}return C=$t(C),m&&m[oe]?m.J(T,C,u(z)?!!z.capture:!1,ue):Ie(m,T,C,!1,z,ue)}function Ie(m,T,C,z,ue,_e){if(!T)throw Error("Invalid event type");const He=u(ue)?!!ue.capture:!!ue;let xt=at(m);if(xt||(m[ye]=xt=new G(m)),C=xt.add(T,C,z,He,_e),C.proxy)return C;if(z=nt(),C.proxy=z,z.src=m,z.listener=C,m.addEventListener)D||(ue=He),ue===void 0&&(ue=!1),m.addEventListener(T.toString(),z,ue);else if(m.attachEvent)m.attachEvent(ht(T.toString()),z);else if(m.addListener&&m.removeListener)m.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return C}function nt(){function m(C){return T.call(m.src,m.listener,C)}const T=It;return m}function te(m,T,C,z,ue){if(Array.isArray(T))for(var _e=0;_e<T.length;_e++)te(m,T[_e],C,z,ue);else z=u(z)?!!z.capture:!!z,C=$t(C),m&&m[oe]?(m=m.i,_e=String(T).toString(),_e in m.g&&(T=m.g[_e],C=le(T,C,z,ue),C>-1&&(ve(T[C]),Array.prototype.splice.call(T,C,1),T.length==0&&(delete m.g[_e],m.h--)))):m&&(m=at(m))&&(T=m.g[T.toString()],m=-1,T&&(m=le(T,C,z,ue)),(C=m>-1?T[m]:null)&&Ft(C))}function Ft(m){if(typeof m!="number"&&m&&!m.da){var T=m.src;if(T&&T[oe])J(T.i,m);else{var C=m.type,z=m.proxy;T.removeEventListener?T.removeEventListener(C,z,m.capture):T.detachEvent?T.detachEvent(ht(C),z):T.addListener&&T.removeListener&&T.removeListener(z),(C=at(T))?(J(C,m),C.h==0&&(C.src=null,T[ye]=null)):ve(m)}}}function ht(m){return m in be?be[m]:be[m]="on"+m}function It(m,T){if(m.da)m=!0;else{T=new Te(T,this);const C=m.listener,z=m.ha||m.src;m.fa&&Ft(m),m=C.call(z,T)}return m}function at(m){return m=m[ye],m instanceof G?m:null}var je="__closure_events_fn_"+(Math.random()*1e9>>>0);function $t(m){return typeof m=="function"?m:(m[je]||(m[je]=function(T){return m.handleEvent(T)}),m[je])}function Dt(){O.call(this),this.i=new G(this),this.M=this,this.G=null}v(Dt,O),Dt.prototype[oe]=!0,Dt.prototype.removeEventListener=function(m,T,C,z){te(this,m,T,C,z)};function Ut(m,T){var C,z=m.G;if(z)for(C=[];z;z=z.G)C.push(z);if(m=m.M,z=T.type||T,typeof T=="string")T=new F(T,m);else if(T instanceof F)T.target=T.target||m;else{var ue=T;T=new F(z,m),q(T,ue)}ue=!0;let _e,He;if(C)for(He=C.length-1;He>=0;He--)_e=T.g=C[He],ue=Ur(_e,z,!0,T)&&ue;if(_e=T.g=m,ue=Ur(_e,z,!0,T)&&ue,ue=Ur(_e,z,!1,T)&&ue,C)for(He=0;He<C.length;He++)_e=T.g=C[He],ue=Ur(_e,z,!1,T)&&ue}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var m=this.i;for(const T in m.g){const C=m.g[T];for(let z=0;z<C.length;z++)ve(C[z]);delete m.g[T],m.h--}}this.G=null},Dt.prototype.J=function(m,T,C,z){return this.i.add(String(m),T,!1,C,z)},Dt.prototype.K=function(m,T,C,z){return this.i.add(String(m),T,!0,C,z)};function Ur(m,T,C,z){if(T=m.i.g[String(T)],!T)return!0;T=T.concat();let ue=!0;for(let _e=0;_e<T.length;++_e){const He=T[_e];if(He&&!He.da&&He.capture==C){const xt=He.listener,Dr=He.ha||He.src;He.fa&&J(m.i,He),ue=xt.call(Dr,z)!==!1&&ue}}return ue&&!z.defaultPrevented}function Za(m,T){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=d(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:l.setTimeout(m,T||0)}function Xn(m){m.g=Za(()=>{m.g=null,m.i&&(m.i=!1,Xn(m))},m.l);const T=m.h;m.h=null,m.m.apply(null,T)}class Lt extends O{constructor(T,C){super(),this.m=T,this.l=C,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:Xn(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jr(m){O.call(this),this.h=m,this.g={}}v(Jr,O);var gn=[];function Wn(m){ie(m.g,function(T,C){this.g.hasOwnProperty(C)&&Ft(T)},m),m.g={}}Jr.prototype.N=function(){Jr.Z.N.call(this),Wn(this)},Jr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pt=l.JSON.stringify,Nn=l.JSON.parse,ut=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function ar(){}function Zr(){}var De={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xe(){F.call(this,"d")}v(Xe,F);function Ke(){F.call(this,"c")}v(Ke,F);var Ze={},_r=null;function en(){return _r=_r||new Dt}Ze.Ia="serverreachability";function jr(m){F.call(this,Ze.Ia,m)}v(jr,F);function ln(m){const T=en();Ut(T,new jr(T))}Ze.STAT_EVENT="statevent";function ea(m,T){F.call(this,Ze.STAT_EVENT,m),this.stat=T}v(ea,F);function Gt(m){const T=en();Ut(T,new ea(T,m))}Ze.Ja="timingevent";function Ir(m,T){F.call(this,Ze.Ja,m),this.size=T}v(Ir,F);function Tr(m,T){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},T)}function tn(){this.g=!0}tn.prototype.ua=function(){this.g=!1};function Ns(m,T,C,z,ue,_e){m.info(function(){if(m.g)if(_e){var He="",xt=_e.split("&");for(let Xt=0;Xt<xt.length;Xt++){var Dr=xt[Xt].split("=");if(Dr.length>1){const yr=Dr[0];Dr=Dr[1];const Fa=yr.split("_");He=Fa.length>=2&&Fa[1]=="type"?He+(yr+"="+Dr+"&"):He+(yr+"=redacted&")}}}else He=null;else He=_e;return"XMLHTTP REQ ("+z+") [attempt "+ue+"]: "+T+`
`+C+`
`+He})}function wi(m,T,C,z,ue,_e,He){m.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ue+"]: "+T+`
`+C+`
`+_e+" "+He})}function cn(m,T,C,z){m.info(function(){return"XMLHTTP TEXT ("+T+"): "+jo(m,C)+(z?" "+z:"")})}function ei(m,T){m.info(function(){return"TIMEOUT: "+T})}tn.prototype.info=function(){};function jo(m,T){if(!m.g)return T;if(!T)return null;try{const _e=JSON.parse(T);if(_e){for(m=0;m<_e.length;m++)if(Array.isArray(_e[m])){var C=_e[m];if(!(C.length<2)){var z=C[1];if(Array.isArray(z)&&!(z.length<1)){var ue=z[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(let He=1;He<z.length;He++)z[He]=""}}}}return Pt(_e)}catch{return T}}var ti={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},qt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Kn;function da(){}v(da,ar),da.prototype.g=function(){return new XMLHttpRequest},Kn=new da;function ma(m){return encodeURIComponent(String(m))}function P(m){var T=1;m=m.split(":");const C=[];for(;T>0&&m.length;)C.push(m.shift()),T--;return m.length&&C.push(m.join(":")),C}function W(m,T,C,z){this.j=m,this.i=T,this.l=C,this.S=z||1,this.V=new Jr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new j}function j(){this.i=null,this.g="",this.h=!1}var H={},X={};function Z(m,T,C){m.M=1,m.A=zo(zr(T)),m.u=C,m.R=!0,he(m,null)}function he(m,T){m.F=Date.now(),pe(m),m.B=zr(m.A);var C=m.B,z=m.S;Array.isArray(z)||(z=[String(z)]),Wl(C.i,"t",z),m.C=0,C=m.j.L,m.h=new j,m.g=I0(m.j,C?T:null,!m.u),m.P>0&&(m.O=new Lt(d(m.Y,m,m.g),m.P)),T=m.V,C=m.g,z=m.ba;var ue="readystatechange";Array.isArray(ue)||(ue&&(gn[0]=ue.toString()),ue=gn);for(let _e=0;_e<ue.length;_e++){const He=Ee(C,ue[_e],z||T.handleEvent,!1,T.h||T);if(!He)break;T.g[He.key]=He}T=m.J?K(m.J):{},m.u?(m.v||(m.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,T)):(m.v="GET",m.g.ea(m.B,m.v,null,T)),ln(),Ns(m.i,m.v,m.B,m.l,m.S,m.u)}W.prototype.ba=function(m){m=m.target;const T=this.O;T&&si(m)==3?T.j():this.Y(m)},W.prototype.Y=function(m){try{if(m==this.g)e:{const xt=si(this.g),Dr=this.g.ya(),Xt=this.g.ca();if(!(xt<3)&&(xt!=3||this.g&&(this.h.h||this.g.la()||xn(this.g)))){this.K||xt!=4||Dr==7||(Dr==8||Xt<=0?ln(3):ln(2)),Ve(this);var T=this.g.ca();this.X=T;var C=Ae(this);if(this.o=T==200,wi(this.i,this.v,this.B,this.l,this.S,xt,T),this.o){if(this.U&&!this.L){t:{if(this.g){var z,ue=this.g;if((z=ue.g?ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(z)){var _e=z;break t}}_e=null}if(m=_e)cn(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ge(this,m);else{this.o=!1,this.m=3,Gt(12),Le(this),qe(this);break e}}if(this.R){m=!0;let yr;for(;!this.K&&this.C<C.length;)if(yr=ge(this,C),yr==X){xt==4&&(this.m=4,Gt(14),m=!1),cn(this.i,this.l,null,"[Incomplete Response]");break}else if(yr==H){this.m=4,Gt(15),cn(this.i,this.l,C,"[Invalid Chunk]"),m=!1;break}else cn(this.i,this.l,yr,null),Ge(this,yr);if(de(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||C.length!=0||this.h.h||(this.m=1,Gt(16),m=!1),this.o=this.o&&m,!m)cn(this.i,this.l,C,"[Invalid Chunked Response]"),Le(this),qe(this);else if(C.length>0&&!this.W){this.W=!0;var He=this.j;He.g==this&&He.aa&&!He.P&&(He.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),bu(He),He.P=!0,Gt(11))}}else cn(this.i,this.l,C,null),Ge(this,C);xt==4&&Le(this),this.o&&!this.K&&(xt==4?k0(this.j,this):(this.o=!1,pe(this)))}else Yi(this.g),T==400&&C.indexOf("Unknown SID")>0?(this.m=3,Gt(12)):(this.m=0,Gt(13)),Le(this),qe(this)}}}catch{}};function Ae(m){if(!de(m))return m.g.la();const T=xn(m.g);if(T==="")return"";let C="";const z=T.length,ue=si(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Le(m),qe(m),"";m.h.i=new l.TextDecoder}for(let _e=0;_e<z;_e++)m.h.h=!0,C+=m.h.i.decode(T[_e],{stream:!(ue&&_e==z-1)});return T.length=0,m.h.g+=C,m.C=0,m.h.g}function de(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function ge(m,T){var C=m.C,z=T.indexOf(`
`,C);return z==-1?X:(C=Number(T.substring(C,z)),isNaN(C)?H:(z+=1,z+C>T.length?X:(T=T.slice(z,z+C),m.C=z+C,T)))}W.prototype.cancel=function(){this.K=!0,Le(this)};function pe(m){m.T=Date.now()+m.H,Pe(m,m.H)}function Pe(m,T){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Tr(d(m.aa,m),T)}function Ve(m){m.D&&(l.clearTimeout(m.D),m.D=null)}W.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(ei(this.i,this.B),this.M!=2&&(ln(),Gt(17)),Le(this),this.m=2,qe(this)):Pe(this,this.T-m)};function qe(m){m.j.I==0||m.K||k0(m.j,m)}function Le(m){Ve(m);var T=m.O;T&&typeof T.dispose=="function"&&T.dispose(),m.O=null,Wn(m.V),m.g&&(T=m.g,m.g=null,T.abort(),T.dispose())}function Ge(m,T){try{var C=m.j;if(C.I!=0&&(C.g==m||Rn(C.h,m))){if(!m.L&&Rn(C.h,m)&&C.I==3){try{var z=C.Ba.g.parse(T)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ue=z;if(ue[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<m.F)Jl(C),Vs(C);else break e;$o(C),Gt(18)}}else C.xa=ue[1],0<C.xa-C.K&&ue[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=Tr(d(C.Va,C),6e3));ur(C.h)<=1&&C.ta&&(C.ta=void 0)}else ki(C,11)}else if((m.L||C.g==m)&&Jl(C),!V(T))for(ue=C.Ba.g.parse(T),T=0;T<ue.length;T++){let Xt=ue[T];const yr=Xt[0];if(!(yr<=C.K))if(C.K=yr,Xt=Xt[1],C.I==2)if(Xt[0]=="c"){C.M=Xt[1],C.ba=Xt[2];const Fa=Xt[3];Fa!=null&&(C.ka=Fa,C.j.info("VER="+C.ka));const Ci=Xt[4];Ci!=null&&(C.za=Ci,C.j.info("SVER="+C.za));const oi=Xt[5];oi!=null&&typeof oi=="number"&&oi>0&&(z=1.5*oi,C.O=z,C.j.info("backChannelRequestTimeoutMs_="+z)),z=C;const li=m.g;if(li){const Yo=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yo){var _e=z.h;_e.g||Yo.indexOf("spdy")==-1&&Yo.indexOf("quic")==-1&&Yo.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(ri(_e,_e.h),_e.h=null))}if(z.G){const Zl=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;Zl&&(z.wa=Zl,Jt(z.J,z.G,Zl))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-m.F,C.j.info("Handshake RTT: "+C.T+"ms")),z=C;var He=m;if(z.na=R0(z,z.L?z.ba:null,z.W),He.L){ni(z.h,He);var xt=He,Dr=z.O;Dr&&(xt.H=Dr),xt.D&&(Ve(xt),pe(xt)),z.g=He}else b0(z);C.i.length>0&&Ai(C)}else Xt[0]!="stop"&&Xt[0]!="close"||ki(C,7);else C.I==3&&(Xt[0]=="stop"||Xt[0]=="close"?Xt[0]=="stop"?ki(C,7):Eu(C):Xt[0]!="noop"&&C.l&&C.l.qa(Xt),C.A=0)}}ln(4)}catch{}}var Ye=class{constructor(m,T){this.g=m,this.map=T}};function Yt(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qt(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function ur(m){return m.h?1:m.g?m.g.size:0}function Rn(m,T){return m.h?m.h==T:m.g?m.g.has(T):!1}function ri(m,T){m.g?m.g.add(T):m.h=T}function ni(m,T){m.h&&m.h==T?m.h=null:m.g&&m.g.has(T)&&m.g.delete(T)}Yt.prototype.cancel=function(){if(this.i=pa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function pa(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let T=m.i;for(const C of m.g.values())T=T.concat(C.G);return T}return w(m.i)}var Rs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function In(m,T){if(m){m=m.split("&");for(let C=0;C<m.length;C++){const z=m[C].indexOf("=");let ue,_e=null;z>=0?(ue=m[C].substring(0,z),_e=m[C].substring(z+1)):ue=m[C],T(ue,_e?decodeURIComponent(_e.replace(/\+/g," ")):"")}}}function ga(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;m instanceof ga?(this.l=m.l,un(this,m.j),this.o=m.o,this.g=m.g,Is(this,m.u),this.h=m.h,gu(this,E0(m.i)),this.m=m.m):m&&(T=String(m).match(Rs))?(this.l=!1,un(this,T[1]||"",!0),this.o=Ti(T[2]||""),this.g=Ti(T[3]||"",!0),Is(this,T[4]),this.h=Ti(T[5]||"",!0),gu(this,T[6]||"",!0),this.m=Ti(T[7]||"")):(this.l=!1,this.i=new Os(null,this.l))}ga.prototype.toString=function(){const m=[];var T=this.j;T&&m.push(Ho(T,Xl,!0),":");var C=this.g;return(C||T=="file")&&(m.push("//"),(T=this.o)&&m.push(Ho(T,Xl,!0),"@"),m.push(ma(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&m.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&m.push("/"),m.push(Ho(C,C.charAt(0)=="/"?xu:y0,!0))),(C=this.i.toString())&&m.push("?",C),(C=this.m)&&m.push("#",Ho(C,w0)),m.join("")},ga.prototype.resolve=function(m){const T=zr(this);let C=!!m.j;C?un(T,m.j):C=!!m.o,C?T.o=m.o:C=!!m.g,C?T.g=m.g:C=m.u!=null;var z=m.h;if(C)Is(T,m.u);else if(C=!!m.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var ue=T.h.lastIndexOf("/");ue!=-1&&(z=T.h.slice(0,ue+1)+z)}if(ue=z,ue==".."||ue==".")z="";else if(ue.indexOf("./")!=-1||ue.indexOf("/.")!=-1){z=ue.lastIndexOf("/",0)==0,ue=ue.split("/");const _e=[];for(let He=0;He<ue.length;){const xt=ue[He++];xt=="."?z&&He==ue.length&&_e.push(""):xt==".."?((_e.length>1||_e.length==1&&_e[0]!="")&&_e.pop(),z&&He==ue.length&&_e.push("")):(_e.push(xt),z=!0)}z=_e.join("/")}else z=ue}return C?T.h=z:C=m.i.toString()!=="",C?gu(T,E0(m.i)):C=!!m.m,C&&(T.m=m.m),T};function zr(m){return new ga(m)}function un(m,T,C){m.j=C?Ti(T,!0):T,m.j&&(m.j=m.j.replace(/:$/,""))}function Is(m,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);m.u=T}else m.u=null}function gu(m,T,C){T instanceof Os?(m.i=T,Kl(m.i,m.l)):(C||(T=Ho(T,Ds)),m.i=new Os(T,m.l))}function Jt(m,T,C){m.i.set(T,C)}function zo(m){return Jt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Ti(m,T){return m?T?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Ho(m,T,C){return typeof m=="string"?(m=encodeURI(m).replace(T,ta),C&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function ta(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Xl=/[#\/\?@]/g,y0=/[#\?:]/g,xu=/[#\?]/g,Ds=/[#\?@]/g,w0=/#/g;function Os(m,T){this.h=this.g=null,this.i=m||null,this.j=!!T}function ra(m){m.g||(m.g=new Map,m.h=0,m.i&&In(m.i,function(T,C){m.add(decodeURIComponent(T.replace(/\+/g," ")),C)}))}t=Os.prototype,t.add=function(m,T){ra(this),this.i=null,m=Fs(this,m);let C=this.g.get(m);return C||this.g.set(m,C=[]),C.push(T),this.h+=1,this};function T0(m,T){ra(m),T=Fs(m,T),m.g.has(T)&&(m.i=null,m.h-=m.g.get(T).length,m.g.delete(T))}function vu(m,T){return ra(m),T=Fs(m,T),m.g.has(T)}t.forEach=function(m,T){ra(this),this.g.forEach(function(C,z){C.forEach(function(ue){m.call(T,ue,z,this)},this)},this)};function _u(m,T){ra(m);let C=[];if(typeof T=="string")vu(m,T)&&(C=C.concat(m.g.get(Fs(m,T))));else for(m=Array.from(m.g.values()),T=0;T<m.length;T++)C=C.concat(m[T]);return C}t.set=function(m,T){return ra(this),this.i=null,m=Fs(this,m),vu(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[T]),this.h+=1,this},t.get=function(m,T){return m?(m=_u(this,m),m.length>0?String(m[0]):T):T};function Wl(m,T,C){T0(m,T),C.length>0&&(m.i=null,m.g.set(Fs(m,T),w(C)),m.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],T=Array.from(this.g.keys());for(let z=0;z<T.length;z++){var C=T[z];const ue=ma(C);C=_u(this,C);for(let _e=0;_e<C.length;_e++){let He=ue;C[_e]!==""&&(He+="="+ma(C[_e])),m.push(He)}}return this.i=m.join("&")};function E0(m){const T=new Os;return T.i=m.i,m.g&&(T.g=new Map(m.g),T.h=m.h),T}function Fs(m,T){return T=String(T),m.j&&(T=T.toLowerCase()),T}function Kl(m,T){T&&!m.j&&(ra(m),m.i=null,m.g.forEach(function(C,z){const ue=z.toLowerCase();z!=ue&&(T0(this,z),Wl(this,ue,C))},m)),m.j=T}function ai(m,T){const C=new tn;if(l.Image){const z=new Image;z.onload=p(Da,C,"TestLoadImage: loaded",!0,T,z),z.onerror=p(Da,C,"TestLoadImage: error",!1,T,z),z.onabort=p(Da,C,"TestLoadImage: abort",!1,T,z),z.ontimeout=p(Da,C,"TestLoadImage: timeout",!1,T,z),l.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=m}else T(!1)}function yu(m,T){const C=new tn,z=new AbortController,ue=setTimeout(()=>{z.abort(),Da(C,"TestPingServer: timeout",!1,T)},1e4);fetch(m,{signal:z.signal}).then(_e=>{clearTimeout(ue),_e.ok?Da(C,"TestPingServer: ok",!0,T):Da(C,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(ue),Da(C,"TestPingServer: error",!1,T)})}function Da(m,T,C,z,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),z(C)}catch{}}function Ms(){this.g=new ut}function Ei(m){this.i=m.Sb||null,this.h=m.ab||!1}v(Ei,ar),Ei.prototype.g=function(){return new Go(this.i,this.h)};function Go(m,T){Dt.call(this),this.H=m,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Go,Dt),t=Go.prototype,t.open=function(m,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=T,this.readyState=1,ii(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(T.body=m),(this.H||l).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ls(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,ii(this)),this.g&&(this.readyState=3,ii(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;$l(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function $l(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var T=m.value?m.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!m.done}))&&(this.response=this.responseText+=T)}m.done?Ls(this):ii(this),this.readyState==3&&$l(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,Ls(this))},t.Na=function(m){this.g&&(this.response=m,Ls(this))},t.ga=function(){this.g&&Ls(this)};function Ls(m){m.readyState=4,m.l=null,m.j=null,m.B=null,ii(m)}t.setRequestHeader=function(m,T){this.A.append(m,T)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],T=this.h.entries();for(var C=T.next();!C.done;)C=C.value,m.push(C[0]+": "+C[1]),C=T.next();return m.join(`\r
`)};function ii(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Go.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Oa(m){let T="";return ie(m,function(C,z){T+=z,T+=":",T+=C,T+=`\r
`}),T}function qo(m,T,C){e:{for(z in C){var z=!1;break e}z=!0}z||(C=Oa(C),typeof m=="string"?C!=null&&ma(C):Jt(m,T,C))}function ir(m){Dt.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ir,Dt);var Si=/^https?$/i,wu=["POST","PUT"];t=ir.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,T,C,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);T=T?T.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Kn.g(),this.g.onreadystatechange=_(d(this.Ca,this));try{this.B=!0,this.g.open(T,String(m),!0),this.B=!1}catch(_e){Xo(this,_e);return}if(m=C||"",C=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ue in z)C.set(ue,z[ue]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const _e of z.keys())C.set(_e,z.get(_e));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(C.keys()).find(_e=>_e.toLowerCase()=="content-type"),ue=l.FormData&&m instanceof l.FormData,!(Array.prototype.indexOf.call(wu,T,void 0)>=0)||z||ue||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,He]of C)this.g.setRequestHeader(_e,He);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(_e){Xo(this,_e)}};function Xo(m,T){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=T,m.o=5,Tu(m),$i(m)}function Tu(m){m.A||(m.A=!0,Ut(m,"complete"),Ut(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,Ut(this,"complete"),Ut(this,"abort"),$i(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$i(this,!0)),ir.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Wo(this):this.Xa())},t.Xa=function(){Wo(this)};function Wo(m){if(m.h&&typeof o<"u"){if(m.v&&si(m)==4)setTimeout(m.Ca.bind(m),0);else if(Ut(m,"readystatechange"),si(m)==4){m.h=!1;try{const _e=m.ca();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var C;if(!(C=T)){var z;if(z=_e===0){let He=String(m.D).match(Rs)[1]||null;!He&&l.self&&l.self.location&&(He=l.self.location.protocol.slice(0,-1)),z=!Si.test(He?He.toLowerCase():"")}C=z}if(C)Ut(m,"complete"),Ut(m,"success");else{m.o=6;try{var ue=si(m)>2?m.g.statusText:""}catch{ue=""}m.l=ue+" ["+m.ca()+"]",Tu(m)}}finally{$i(m)}}}}function $i(m,T){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const C=m.g;m.g=null,T||Ut(m,"ready");try{C.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function si(m){return m.g?m.g.readyState:0}t.ca=function(){try{return si(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var T=this.g.responseText;return m&&T.indexOf(m)==0&&(T=T.substring(m.length)),Nn(T)}};function xn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Yi(m){const T={};m=(m.g&&si(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<m.length;z++){if(V(m[z]))continue;var C=P(m[z]);const ue=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const _e=T[ue]||[];T[ue]=_e,_e.push(C)}Ce(T,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bi(m,T,C){return C&&C.internalChannelParams&&C.internalChannelParams[m]||T}function Ps(m){this.za=0,this.i=[],this.j=new tn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bi("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bi("baseRetryDelayMs",5e3,m),this.Za=bi("retryDelaySeedMs",1e4,m),this.Ta=bi("forwardChannelMaxRetries",2,m),this.va=bi("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Yt(m&&m.concurrentRequestLimit),this.Ba=new Ms,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ps.prototype,t.ka=8,t.I=1,t.connect=function(m,T,C,z){Gt(0),this.W=m,this.H=T||{},C&&z!==void 0&&(this.H.OSID=C,this.H.OAID=z),this.F=this.X,this.J=R0(this,null,this.W),Ai(this)};function Eu(m){if(Yl(m),m.I==3){var T=m.V++,C=zr(m.J);if(Jt(C,"SID",m.M),Jt(C,"RID",T),Jt(C,"TYPE","terminate"),Ko(m,C),T=new W(m,m.j,T),T.M=2,T.A=zo(zr(C)),C=!1,l.navigator&&l.navigator.sendBeacon)try{C=l.navigator.sendBeacon(T.A.toString(),"")}catch{}!C&&l.Image&&(new Image().src=T.A,C=!0),C||(T.g=I0(T.j,null),T.g.ea(T.A)),T.F=Date.now(),pe(T)}N0(m)}function Vs(m){m.g&&(bu(m),m.g.cancel(),m.g=null)}function Yl(m){Vs(m),m.v&&(l.clearTimeout(m.v),m.v=null),Jl(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&l.clearTimeout(m.m),m.m=null)}function Ai(m){if(!Qt(m.h)&&!m.m){m.m=!0;var T=m.Ea;re||I(),ee||(re(),ee=!0),k.add(T,m),m.D=0}}function Ql(m,T){return ur(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=T.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Tr(d(m.Ea,m,T),C0(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const ue=new W(this,this.j,m);let _e=this.o;if(this.U&&(_e?(_e=K(_e),q(_e,this.U)):_e=this.U),this.u!==null||this.R||(ue.J=_e,_e=null),this.S)e:{for(var T=0,C=0;C<this.i.length;C++){t:{var z=this.i[C];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(T+=z,T>4096){T=C;break e}if(T===4096||C===this.i.length-1){T=C+1;break e}}T=1e3}else T=1e3;T=S0(this,ue,T),C=zr(this.J),Jt(C,"RID",m),Jt(C,"CVER",22),this.G&&Jt(C,"X-HTTP-Session-Id",this.G),Ko(this,C),_e&&(this.R?T="headers="+ma(Oa(_e))+"&"+T:this.u&&qo(C,this.u,_e)),ri(this.h,ue),this.Ra&&Jt(C,"TYPE","init"),this.S?(Jt(C,"$req",T),Jt(C,"SID","null"),ue.U=!0,Z(ue,C,null)):Z(ue,C,T),this.I=2}}else this.I==3&&(m?Su(this,m):this.i.length==0||Qt(this.h)||Su(this))};function Su(m,T){var C;T?C=T.l:C=m.V++;const z=zr(m.J);Jt(z,"SID",m.M),Jt(z,"RID",C),Jt(z,"AID",m.K),Ko(m,z),m.u&&m.o&&qo(z,m.u,m.o),C=new W(m,m.j,C,m.D+1),m.u===null&&(C.J=m.o),T&&(m.i=T.G.concat(m.i)),T=S0(m,C,1e3),C.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),ri(m.h,C),Z(C,z,T)}function Ko(m,T){m.H&&ie(m.H,function(C,z){Jt(T,z,C)}),m.l&&ie({},function(C,z){Jt(T,z,C)})}function S0(m,T,C){C=Math.min(m.i.length,C);const z=m.l?d(m.l.Ka,m.l,m):null;e:{var ue=m.i;let xt=-1;for(;;){const Dr=["count="+C];xt==-1?C>0?(xt=ue[0].g,Dr.push("ofs="+xt)):xt=0:Dr.push("ofs="+xt);let Xt=!0;for(let yr=0;yr<C;yr++){var _e=ue[yr].g;const Fa=ue[yr].map;if(_e-=xt,_e<0)xt=Math.max(0,ue[yr].g-100),Xt=!1;else try{_e="req"+_e+"_"||"";try{var He=Fa instanceof Map?Fa:Object.entries(Fa);for(const[Ci,oi]of He){let li=oi;u(oi)&&(li=Pt(oi)),Dr.push(_e+Ci+"="+encodeURIComponent(li))}}catch(Ci){throw Dr.push(_e+"type="+encodeURIComponent("_badmap")),Ci}}catch{z&&z(Fa)}}if(Xt){He=Dr.join("&");break e}}He=void 0}return m=m.i.splice(0,C),T.G=m,He}function b0(m){if(!m.g&&!m.v){m.Y=1;var T=m.Da;re||I(),ee||(re(),ee=!0),k.add(T,m),m.A=0}}function $o(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Tr(d(m.Da,m),C0(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,A0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Tr(d(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Gt(10),Vs(this),A0(this))};function bu(m){m.B!=null&&(l.clearTimeout(m.B),m.B=null)}function A0(m){m.g=new W(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var T=zr(m.na);Jt(T,"RID","rpc"),Jt(T,"SID",m.M),Jt(T,"AID",m.K),Jt(T,"CI",m.F?"0":"1"),!m.F&&m.ia&&Jt(T,"TO",m.ia),Jt(T,"TYPE","xmlhttp"),Ko(m,T),m.u&&m.o&&qo(T,m.u,m.o),m.O&&(m.g.H=m.O);var C=m.g;m=m.ba,C.M=1,C.A=zo(zr(T)),C.u=null,C.R=!0,he(C,m)}t.Va=function(){this.C!=null&&(this.C=null,Vs(this),$o(this),Gt(19))};function Jl(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function k0(m,T){var C=null;if(m.g==T){Jl(m),bu(m),m.g=null;var z=2}else if(Rn(m.h,T))C=T.G,ni(m.h,T),z=1;else return;if(m.I!=0){if(T.o)if(z==1){C=T.u?T.u.length:0,T=Date.now()-T.F;var ue=m.D;z=en(),Ut(z,new Ir(z,C)),Ai(m)}else b0(m);else if(ue=T.m,ue==3||ue==0&&T.X>0||!(z==1&&Ql(m,T)||z==2&&$o(m)))switch(C&&C.length>0&&(T=m.h,T.i=T.i.concat(C)),ue){case 1:ki(m,5);break;case 4:ki(m,10);break;case 3:ki(m,6);break;default:ki(m,2)}}}function C0(m,T){let C=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(C*=2),C*T}function ki(m,T){if(m.j.info("Error code "+T),T==2){var C=d(m.bb,m),z=m.Ua;const ue=!z;z=new ga(z||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||un(z,"https"),zo(z),ue?ai(z.toString(),C):yu(z.toString(),C)}else Gt(2);m.I=0,m.l&&m.l.pa(T),N0(m),Yl(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function N0(m){if(m.I=0,m.ja=[],m.l){const T=pa(m.h);(T.length!=0||m.i.length!=0)&&(S(m.ja,T),S(m.ja,m.i),m.h.i.length=0,w(m.i),m.i.length=0),m.l.oa()}}function R0(m,T,C){var z=C instanceof ga?zr(C):new ga(C);if(z.g!="")T&&(z.g=T+"."+z.g),Is(z,z.u);else{var ue=l.location;z=ue.protocol,T=T?T+"."+ue.hostname:ue.hostname,ue=+ue.port;const _e=new ga(null);z&&un(_e,z),T&&(_e.g=T),ue&&Is(_e,ue),C&&(_e.h=C),z=_e}return C=m.G,T=m.wa,C&&T&&Jt(z,C,T),Jt(z,"VER",m.ka),Ko(m,z),z}function I0(m,T,C){if(T&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=m.Aa&&!m.ma?new ir(new Ei({ab:C})):new ir(m.ma),T.Fa(m.L),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function D0(){}t=D0.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Bs(){}Bs.prototype.g=function(m,T){return new $n(m,T)};function $n(m,T){Dt.call(this),this.g=new Ps(T),this.l=m,this.h=T&&T.messageUrlParams||null,m=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(m?m["X-WebChannel-Content-Type"]=T.messageContentType:m={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(m?m["X-WebChannel-Client-Profile"]=T.sa:m={"X-WebChannel-Client-Profile":T.sa}),this.g.U=m,(m=T&&T.Qb)&&!V(m)&&(this.g.u=m),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!V(T)&&(this.g.G=T,m=this.h,m!==null&&T in m&&(m=this.h,T in m&&delete m[T])),this.j=new Qi(this)}v($n,Dt),$n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){Eu(this.g)},$n.prototype.o=function(m){var T=this.g;if(typeof m=="string"){var C={};C.__data__=m,m=C}else this.v&&(C={},C.__data__=Pt(m),m=C);T.i.push(new Ye(T.Ya++,m)),T.I==3&&Ai(T)},$n.prototype.N=function(){this.g.l=null,delete this.j,Eu(this.g),delete this.g,$n.Z.N.call(this)};function O0(m){Xe.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var T=m.__sm__;if(T){e:{for(const C in T){m=C;break e}m=void 0}(this.i=m)&&(m=this.i,T=T!==null&&m in T?T[m]:void 0),this.data=T}else this.data=m}v(O0,Xe);function F0(){Ke.call(this),this.status=1}v(F0,Ke);function Qi(m){this.g=m}v(Qi,D0),Qi.prototype.ra=function(){Ut(this.g,"a")},Qi.prototype.qa=function(m){Ut(this.g,new O0(m))},Qi.prototype.pa=function(m){Ut(this.g,new F0)},Qi.prototype.oa=function(){Ut(this.g,"b")},Bs.prototype.createWebChannel=Bs.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,nS=function(){return new Bs},rS=function(){return en()},tS=Ze,ag={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ti.NO_ERROR=0,ti.TIMEOUT=8,ti.HTTP_ERROR=6,nd=ti,qt.COMPLETE="complete",eS=qt,Zr.EventType=De,De.OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,hf=Zr,ir.prototype.listenOnce=ir.prototype.K,ir.prototype.getLastError=ir.prototype.Ha,ir.prototype.getLastErrorCode=ir.prototype.ya,ir.prototype.getStatus=ir.prototype.ca,ir.prototype.getResponseJson=ir.prototype.La,ir.prototype.getResponseText=ir.prototype.la,ir.prototype.send=ir.prototype.ea,ir.prototype.setWithCredentials=ir.prototype.Fa,ZE=ir}).apply(typeof Vh<"u"?Vh:typeof self<"u"?self:typeof window<"u"?window:{});const sw="@firebase/firestore",ow="4.9.3";let Mn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");let ou="12.7.0";const kl=new Ug("@firebase/firestore");function Dc(){return kl.logLevel}function We(t,...e){if(kl.logLevel<=Ct.DEBUG){const r=e.map(Hg);kl.debug(`Firestore (${ou}): ${t}`,...r)}}function ys(t,...e){if(kl.logLevel<=Ct.ERROR){const r=e.map(Hg);kl.error(`Firestore (${ou}): ${t}`,...r)}}function $c(t,...e){if(kl.logLevel<=Ct.WARN){const r=e.map(Hg);kl.warn(`Firestore (${ou}): ${t}`,...r)}}function Hg(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function lt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,aS(t,n,r)}function aS(t,e,r){let n=`FIRESTORE (${ou}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ys(n),new Error(n)}function Kt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||aS(e,a,n)}function gt(t,e){return t}const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Je extends bs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class To{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class iS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Mn.UNAUTHENTICATED)))}shutdown(){}}class cN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class uN{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Kt(this.o===void 0,42304);let n=this.i;const a=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new To;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new To,e.enqueueRetryable((()=>a(this.currentUser)))};const l=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await a(this.currentUser)}))},u=h=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new To)}}),0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Kt(typeof n.accessToken=="string",31837,{l:n}),new iS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kt(e===null||typeof e=="string",2055,{h:e}),new Mn(e)}}class fN{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hN{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new fN(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Mn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class lw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dN{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,di(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Kt(this.o===void 0,3512);const n=o=>{o.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,We("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const a=o=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>a(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new lw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Kt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new lw(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function mN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class Gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=mN(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function Nt(t,e){return t<e?-1:t>e?1:0}function ig(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),o=e.charAt(n);if(a!==o)return Ip(a)===Ip(o)?Nt(a,o):Ip(a)?1:-1}return Nt(t.length,e.length)}const pN=55296,gN=57343;function Ip(t){const e=t.charCodeAt(0);return e>=pN&&e<=gN}function Yc(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}const cw="__name__";class Li{constructor(e,r,n){r===void 0?r=0:r>e.length&&lt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&lt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Li.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Li?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=Li.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return Nt(e.length,r.length)}static compareSegments(e,r){const n=Li.isNumericId(e),a=Li.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Li.extractNumericId(e).compare(Li.extractNumericId(r)):ig(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return wo.fromString(e.substring(4,e.length-2))}}class pr extends Li{construct(e,r,n){return new pr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Je(Me.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new pr(r)}static emptyPath(){return new pr([])}}const xN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends Li{construct(e,r,n){return new bn(e,r,n)}static isValidIdentifier(e){return xN.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cw}static keyField(){return new bn([cw])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new Je(Me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new Je(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Je(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(o(),a++)}if(o(),l)throw new Je(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(r)}static emptyPath(){return new bn([])}}class rt{constructor(e){this.path=e}static fromPath(e){return new rt(pr.fromString(e))}static fromName(e){return new rt(pr.fromString(e).popFirst(5))}static empty(){return new rt(pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rt(new pr(e.slice()))}}function sS(t,e,r){if(!r)throw new Je(Me.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vN(t,e,r,n){if(e===!0&&n===!0)throw new Je(Me.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function uw(t){if(!rt.isDocumentKey(t))throw new Je(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function fw(t){if(rt.isDocumentKey(t))throw new Je(Me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function oS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function qg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":lt(12329,{type:typeof t})}function xi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Je(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=qg(t);throw new Je(Me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function Qr(t,e){const r={typeString:t};return e&&(r.value=e),r}function a0(t,e){if(!oS(t))throw new Je(Me.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(o!==void 0&&l!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Je(Me.INVALID_ARGUMENT,r);return!0}const hw=-62135596800,dw=1e6;class gr{static now(){return gr.fromMillis(Date.now())}static fromDate(e){return gr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*dw);return new gr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Je(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Je(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<hw)throw new Je(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Je(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/dw}_compareTo(e){return this.seconds===e.seconds?Nt(this.nanoseconds,e.nanoseconds):Nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(a0(e,gr._jsonSchema))return new gr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-hw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gr._jsonSchemaVersion="firestore/timestamp/1.0",gr._jsonSchema={type:Qr("string",gr._jsonSchemaVersion),seconds:Qr("number"),nanoseconds:Qr("number")};class mt{static fromTimestamp(e){return new mt(e)}static min(){return new mt(new gr(0,0))}static max(){return new mt(new gr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ff=-1;function _N(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=mt.fromTimestamp(n===1e9?new gr(r+1,0):new gr(r,n));return new bo(a,rt.empty(),e)}function yN(t){return new bo(t.readTime,t.key,Ff)}class bo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new bo(mt.min(),rt.empty(),Ff)}static max(){return new bo(mt.max(),rt.empty(),Ff)}}function wN(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=rt.comparator(t.documentKey,e.documentKey),r!==0?r:Nt(t.largestBatchId,e.largestBatchId))}const TN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class EN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function lu(t){if(t.code!==Me.FAILED_PRECONDITION||t.message!==TN)throw t;We("LocalStore","Unexpectedly lost primary lease")}class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&lt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Oe(((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Oe?r:Oe.resolve(r)}catch(r){return Oe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Oe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Oe.reject(r)}static resolve(e){return new Oe(((r,n)=>{r(e)}))}static reject(e){return new Oe(((r,n)=>{n(e)}))}static waitFor(e){return new Oe(((r,n)=>{let a=0,o=0,l=!1;e.forEach((u=>{++a,u.next((()=>{++o,l&&o===a&&r()}),(h=>n(h)))})),l=!0,o===a&&r()}))}static or(e){let r=Oe.resolve(!1);for(const n of e)r=r.next((a=>a?Oe.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,o)=>{n.push(r.call(this,a,o))})),this.waitFor(n)}static mapArray(e,r){return new Oe(((n,a)=>{const o=e.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next((p=>{l[d]=p,++u,u===o&&n(l)}),(p=>a(p)))}}))}static doWhile(e,r){return new Oe(((n,a)=>{const o=()=>{e()===!0?r().next((()=>{o()}),a):n()};o()}))}}function SN(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function cu(t){return t.name==="IndexedDbTransactionError"}class Kd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kd.ce=-1;const Xg=-1;function $d(t){return t==null}function pd(t){return t===0&&1/t==-1/0}function bN(t){return typeof t=="number"&&Number.isInteger(t)&&!pd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const lS="";function AN(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=mw(e)),e=kN(t.get(r),e);return mw(e)}function kN(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case lS:r+="";break;default:r+=o}}return r}function mw(t){return t+lS+""}function pw(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Lo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function cS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class br{constructor(e,r){this.comparator=e,this.root=r||En.EMPTY}insert(e,r){return new br(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new br(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bh(this.root,e,this.comparator,!0)}}class Bh{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??En.RED,this.left=a??En.EMPTY,this.right=o??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new En(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return En.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw lt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw lt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw lt(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw lt(57766)}get value(){throw lt(16141)}get color(){throw lt(16727)}get left(){throw lt(29726)}get right(){throw lt(36894)}copy(e,r,n,a,o){return this}insert(e,r,n){return new En(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sn{constructor(e){this.comparator=e,this.data=new br(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new gw(this.data.getIterator())}getIteratorFrom(e){return new gw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new sn(this.comparator);return r.data=e,r}}class gw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ra{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new Ra([])}unionWith(e){let r=new sn(bn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ra(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Yc(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class uS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new uS("Invalid base64 string: "+o):o}})(e);return new Cn(r)}static fromUint8Array(e){const r=(function(a){let o="";for(let l=0;l<a.length;++l)o+=String.fromCharCode(a[l]);return o})(e);return new Cn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const CN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ao(t){if(Kt(!!t,39018),typeof t=="string"){let e=0;const r=CN.exec(t);if(Kt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Lr(t.seconds),nanos:Lr(t.nanos)}}function Lr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ko(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}const fS="server_timestamp",hS="__type__",dS="__previous_value__",mS="__local_write_time__";function Wg(t){return(t?.mapValue?.fields||{})[hS]?.stringValue===fS}function Yd(t){const e=t.mapValue.fields[dS];return Wg(e)?Yd(e):e}function Mf(t){const e=Ao(t.mapValue.fields[mS].timestampValue);return new gr(e.seconds,e.nanos)}class NN{constructor(e,r,n,a,o,l,u,h,d,p){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const gd="(default)";class Lf{constructor(e,r){this.projectId=e,this.database=r||gd}static empty(){return new Lf("","")}get isDefaultDatabase(){return this.database===gd}isEqual(e){return e instanceof Lf&&e.projectId===this.projectId&&e.database===this.database}}const pS="__type__",RN="__max__",Uh={mapValue:{}},gS="__vector__",xd="value";function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Wg(t)?4:DN(t)?9007199254740991:IN(t)?10:11:lt(28295,{value:t})}function qi(t,e){if(t===e)return!0;const r=Co(t);if(r!==Co(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mf(t).isEqual(Mf(e));case 3:return(function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const l=Ao(a.timestampValue),u=Ao(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,o){return ko(a.bytesValue).isEqual(ko(o.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,o){return Lr(a.geoPointValue.latitude)===Lr(o.geoPointValue.latitude)&&Lr(a.geoPointValue.longitude)===Lr(o.geoPointValue.longitude)})(t,e);case 2:return(function(a,o){if("integerValue"in a&&"integerValue"in o)return Lr(a.integerValue)===Lr(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const l=Lr(a.doubleValue),u=Lr(o.doubleValue);return l===u?pd(l)===pd(u):isNaN(l)&&isNaN(u)}return!1})(t,e);case 9:return Yc(t.arrayValue.values||[],e.arrayValue.values||[],qi);case 10:case 11:return(function(a,o){const l=a.mapValue.fields||{},u=o.mapValue.fields||{};if(pw(l)!==pw(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!qi(l[h],u[h])))return!1;return!0})(t,e);default:return lt(52216,{left:t})}}function Pf(t,e){return(t.values||[]).find((r=>qi(r,e)))!==void 0}function Qc(t,e){if(t===e)return 0;const r=Co(t),n=Co(e);if(r!==n)return Nt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Nt(t.booleanValue,e.booleanValue);case 2:return(function(o,l){const u=Lr(o.integerValue||o.doubleValue),h=Lr(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(t,e);case 3:return xw(t.timestampValue,e.timestampValue);case 4:return xw(Mf(t),Mf(e));case 5:return ig(t.stringValue,e.stringValue);case 6:return(function(o,l){const u=ko(o),h=ko(l);return u.compareTo(h)})(t.bytesValue,e.bytesValue);case 7:return(function(o,l){const u=o.split("/"),h=l.split("/");for(let d=0;d<u.length&&d<h.length;d++){const p=Nt(u[d],h[d]);if(p!==0)return p}return Nt(u.length,h.length)})(t.referenceValue,e.referenceValue);case 8:return(function(o,l){const u=Nt(Lr(o.latitude),Lr(l.latitude));return u!==0?u:Nt(Lr(o.longitude),Lr(l.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return vw(t.arrayValue,e.arrayValue);case 10:return(function(o,l){const u=o.fields||{},h=l.fields||{},d=u[xd]?.arrayValue,p=h[xd]?.arrayValue,v=Nt(d?.values?.length||0,p?.values?.length||0);return v!==0?v:vw(d,p)})(t.mapValue,e.mapValue);case 11:return(function(o,l){if(o===Uh.mapValue&&l===Uh.mapValue)return 0;if(o===Uh.mapValue)return 1;if(l===Uh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){const _=ig(h[v],p[v]);if(_!==0)return _;const w=Qc(u[h[v]],d[p[v]]);if(w!==0)return w}return Nt(h.length,p.length)})(t.mapValue,e.mapValue);default:throw lt(23264,{he:r})}}function xw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Nt(t,e);const r=Ao(t),n=Ao(e),a=Nt(r.seconds,n.seconds);return a!==0?a:Nt(r.nanos,n.nanos)}function vw(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=Qc(r[a],n[a]);if(o)return o}return Nt(r.length,n.length)}function Jc(t){return sg(t)}function sg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=Ao(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return ko(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return rt.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=sg(o);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const l of n)o?o=!1:a+=",",a+=`${l}:${sg(r.fields[l])}`;return a+"}"})(t.mapValue):lt(61005,{value:t})}function ad(t){switch(Co(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yd(t);return e?16+ad(e):16;case 5:return 2*t.stringValue.length;case 6:return ko(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,o)=>a+ad(o)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return Lo(n.fields,((o,l)=>{a+=o.length+ad(l)})),a})(t.mapValue);default:throw lt(13486,{value:t})}}function og(t){return!!t&&"integerValue"in t}function Kg(t){return!!t&&"arrayValue"in t}function _w(t){return!!t&&"nullValue"in t}function yw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function id(t){return!!t&&"mapValue"in t}function IN(t){return(t?.mapValue?.fields||{})[pS]?.stringValue===gS}function yf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Lo(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=yf(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=yf(t.arrayValue.values[r]);return e}return{...t}}function DN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===RN}class ua{constructor(e){this.value=e}static empty(){return new ua({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!id(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=yf(r)}setAll(e){let r=bn.emptyPath(),n={},a=[];e.forEach(((l,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=yf(l):a.push(u.lastSegment())}));const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());id(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return qi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];id(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Lo(r,((a,o)=>e[a]=o));for(const a of n)delete e[a]}clone(){return new ua(yf(this.value))}}function xS(t){const e=[];return Lo(t.fields,((r,n)=>{const a=new bn([r]);if(id(n)){const o=xS(n.mapValue).fields;if(o.length===0)e.push(a);else for(const l of o)e.push(a.child(l))}else e.push(a)})),new Ra(e)}class Bn{constructor(e,r,n,a,o,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Bn(e,0,mt.min(),mt.min(),mt.min(),ua.empty(),0)}static newFoundDocument(e,r,n,a){return new Bn(e,1,r,mt.min(),n,a,0)}static newNoDocument(e,r){return new Bn(e,2,r,mt.min(),mt.min(),ua.empty(),0)}static newUnknownDocument(e,r){return new Bn(e,3,r,mt.min(),mt.min(),ua.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ua.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ua.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class vd{constructor(e,r){this.position=e,this.inclusive=r}}function ww(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],l=t.position[a];if(o.field.isKeyField()?n=rt.comparator(rt.fromName(l.referenceValue),r.key):n=Qc(l,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Tw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!qi(t.position[r],e.position[r]))return!1;return!0}class _d{constructor(e,r="asc"){this.field=e,this.dir=r}}function ON(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class vS{}class nn extends vS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new MN(e,r,n):r==="array-contains"?new VN(e,n):r==="in"?new BN(e,n):r==="not-in"?new UN(e,n):r==="array-contains-any"?new jN(e,n):new nn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new LN(e,n):new PN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Qc(r,this.value)):r!==null&&Co(this.value)===Co(r)&&this.matchesComparison(Qc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return lt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xi extends vS{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Xi(e,r)}matches(e){return _S(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function _S(t){return t.op==="and"}function yS(t){return FN(t)&&_S(t)}function FN(t){for(const e of t.filters)if(e instanceof Xi)return!1;return!0}function lg(t){if(t instanceof nn)return t.field.canonicalString()+t.op.toString()+Jc(t.value);if(yS(t))return t.filters.map((e=>lg(e))).join(",");{const e=t.filters.map((r=>lg(r))).join(",");return`${t.op}(${e})`}}function wS(t,e){return t instanceof nn?(function(n,a){return a instanceof nn&&n.op===a.op&&n.field.isEqual(a.field)&&qi(n.value,a.value)})(t,e):t instanceof Xi?(function(n,a){return a instanceof Xi&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((o,l,u)=>o&&wS(l,a.filters[u])),!0):!1})(t,e):void lt(19439)}function TS(t){return t instanceof nn?(function(r){return`${r.field.canonicalString()} ${r.op} ${Jc(r.value)}`})(t):t instanceof Xi?(function(r){return r.op.toString()+" {"+r.getFilters().map(TS).join(" ,")+"}"})(t):"Filter"}class MN extends nn{constructor(e,r,n){super(e,r,n),this.key=rt.fromName(n.referenceValue)}matches(e){const r=rt.comparator(e.key,this.key);return this.matchesComparison(r)}}class LN extends nn{constructor(e,r){super(e,"in",r),this.keys=ES("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class PN extends nn{constructor(e,r){super(e,"not-in",r),this.keys=ES("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function ES(t,e){return(e.arrayValue?.values||[]).map((r=>rt.fromName(r.referenceValue)))}class VN extends nn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Kg(r)&&Pf(r.arrayValue,this.value)}}class BN extends nn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Pf(this.value.arrayValue,r)}}class UN extends nn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Pf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Pf(this.value.arrayValue,r)}}class jN extends nn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Kg(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>Pf(this.value.arrayValue,n)))}}class zN{constructor(e,r=null,n=[],a=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function Ew(t,e=null,r=[],n=[],a=null,o=null,l=null){return new zN(t,e,r,n,a,o,l)}function $g(t){const e=gt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>lg(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),$d(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Jc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Jc(n))).join(",")),e.Te=r}return e.Te}function Yg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!ON(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!wS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Tw(t.startAt,e.startAt)&&Tw(t.endAt,e.endAt)}function cg(t){return rt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Qd{constructor(e,r=null,n=[],a=[],o=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HN(t,e,r,n,a,o,l,u){return new Qd(t,e,r,n,a,o,l,u)}function Jd(t){return new Qd(t)}function Sw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function GN(t){return t.collectionGroup!==null}function wf(t){const e=gt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new sn(bn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new _d(o,n))})),r.has(bn.keyField().canonicalString())||e.Ie.push(new _d(bn.keyField(),n))}return e.Ie}function Bi(t){const e=gt(t);return e.Ee||(e.Ee=qN(e,wf(t))),e.Ee}function qN(t,e){if(t.limitType==="F")return Ew(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const o=a.dir==="desc"?"asc":"desc";return new _d(a.field,o)}));const r=t.endAt?new vd(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new vd(t.startAt.position,t.startAt.inclusive):null;return Ew(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function ug(t,e,r){return new Qd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Zd(t,e){return Yg(Bi(t),Bi(e))&&t.limitType===e.limitType}function SS(t){return`${$g(Bi(t))}|lt:${t.limitType}`}function Oc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>TS(a))).join(", ")}]`),$d(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>Jc(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>Jc(a))).join(",")),`Target(${n})`})(Bi(t))}; limitType=${t.limitType})`}function em(t,e){return e.isFoundDocument()&&(function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):rt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(t,e)&&(function(n,a){for(const o of wf(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(l,u,h){const d=ww(l,u,h);return l.inclusive?d<=0:d<0})(n.startAt,wf(n),a)||n.endAt&&!(function(l,u,h){const d=ww(l,u,h);return l.inclusive?d>=0:d>0})(n.endAt,wf(n),a))})(t,e)}function XN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bS(t){return(e,r)=>{let n=!1;for(const a of wf(t)){const o=WN(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function WN(t,e,r){const n=t.field.isKeyField()?rt.comparator(e.key,r.key):(function(o,l,u){const h=l.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Qc(h,d):lt(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return lt(19790,{direction:t.dir})}}class Vl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Lo(this.inner,((r,n)=>{for(const[a,o]of n)e(a,o)}))}isEmpty(){return cS(this.inner)}size(){return this.innerSize}}const KN=new br(rt.comparator);function ws(){return KN}const AS=new br(rt.comparator);function df(...t){let e=AS;for(const r of t)e=e.insert(r.key,r);return e}function kS(t){let e=AS;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function gl(){return Tf()}function CS(){return Tf()}function Tf(){return new Vl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const $N=new br(rt.comparator),YN=new sn(rt.comparator);function Rt(...t){let e=YN;for(const r of t)e=e.add(r);return e}const QN=new sn(Nt);function JN(){return QN}function Qg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pd(e)?"-0":e}}function NS(t){return{integerValue:""+t}}function ZN(t,e){return bN(e)?NS(e):Qg(t,e)}class tm{constructor(){this._=void 0}}function e6(t,e,r){return t instanceof yd?(function(a,o){const l={fields:{[hS]:{stringValue:fS},[mS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&Wg(o)&&(o=Yd(o)),o&&(l.fields[dS]=o),{mapValue:l}})(r,e):t instanceof Vf?IS(t,e):t instanceof Bf?DS(t,e):(function(a,o){const l=RS(a,o),u=bw(l)+bw(a.Ae);return og(l)&&og(a.Ae)?NS(u):Qg(a.serializer,u)})(t,e)}function t6(t,e,r){return t instanceof Vf?IS(t,e):t instanceof Bf?DS(t,e):r}function RS(t,e){return t instanceof wd?(function(n){return og(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class yd extends tm{}class Vf extends tm{constructor(e){super(),this.elements=e}}function IS(t,e){const r=OS(e);for(const n of t.elements)r.some((a=>qi(a,n)))||r.push(n);return{arrayValue:{values:r}}}class Bf extends tm{constructor(e){super(),this.elements=e}}function DS(t,e){let r=OS(e);for(const n of t.elements)r=r.filter((a=>!qi(a,n)));return{arrayValue:{values:r}}}class wd extends tm{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function bw(t){return Lr(t.integerValue||t.doubleValue)}function OS(t){return Kg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function r6(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof Vf&&a instanceof Vf||n instanceof Bf&&a instanceof Bf?Yc(n.elements,a.elements,qi):n instanceof wd&&a instanceof wd?qi(n.Ae,a.Ae):n instanceof yd&&a instanceof yd})(t.transform,e.transform)}class n6{constructor(e,r){this.version=e,this.transformResults=r}}class vi{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new vi}static exists(e){return new vi(void 0,e)}static updateTime(e){return new vi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class rm{}function FS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Jg(t.key,vi.none()):new i0(t.key,t.data,vi.none());{const r=t.data,n=ua.empty();let a=new sn(bn.comparator);for(let o of e.fields)if(!a.has(o)){let l=r.field(o);l===null&&o.length>1&&(o=o.popLast(),l=r.field(o)),l===null?n.delete(o):n.set(o,l),a=a.add(o)}return new Po(t.key,n,new Ra(a.toArray()),vi.none())}}function a6(t,e,r){t instanceof i0?(function(a,o,l){const u=a.value.clone(),h=kw(a.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(t,e,r):t instanceof Po?(function(a,o,l){if(!sd(a.precondition,o))return void o.convertToUnknownDocument(l.version);const u=kw(a.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(MS(a)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(t,e,r):(function(a,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,r)}function Ef(t,e,r,n){return t instanceof i0?(function(o,l,u,h){if(!sd(o.precondition,l))return u;const d=o.value.clone(),p=Cw(o.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof Po?(function(o,l,u,h){if(!sd(o.precondition,l))return u;const d=Cw(o.fieldTransforms,h,l),p=l.data;return p.setAll(MS(o)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(t,e,r,n):(function(o,l,u){return sd(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(t,e,r)}function i6(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=RS(n.transform,a||null);o!=null&&(r===null&&(r=ua.empty()),r.set(n.field,o))}return r||null}function Aw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Yc(n,a,((o,l)=>r6(o,l)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class i0 extends rm{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Po extends rm{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function MS(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function kw(t,e,r){const n=new Map;Kt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const o=t[a],l=o.transform,u=e.data.field(o.field);n.set(o.field,t6(l,u,r[a]))}return n}function Cw(t,e,r){const n=new Map;for(const a of t){const o=a.transform,l=r.data.field(a.field);n.set(a.field,e6(o,l,e))}return n}class Jg extends rm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class s6 extends rm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class o6{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&a6(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ef(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ef(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=CS();return this.mutations.forEach((a=>{const o=e.get(a.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=r.has(a.key)?null:u;const h=FS(l,u);h!==null&&n.set(a.key,h),l.isValidDocument()||l.convertToNoDocument(mt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Rt())}isEqual(e){return this.batchId===e.batchId&&Yc(this.mutations,e.mutations,((r,n)=>Aw(r,n)))&&Yc(this.baseMutations,e.baseMutations,((r,n)=>Aw(r,n)))}}class Zg{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Kt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return $N})();const o=e.mutations;for(let l=0;l<o.length;l++)a=a.insert(o[l].key,n[l].version);return new Zg(e,r,n,a)}}class l6{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class c6{constructor(e,r){this.count=e,this.unchangedNames=r}}var Kr,Mt;function u6(t){switch(t){case Me.OK:return lt(64938);case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0;default:return lt(15467,{code:t})}}function LS(t){if(t===void 0)return ys("GRPC error has no .code"),Me.UNKNOWN;switch(t){case Kr.OK:return Me.OK;case Kr.CANCELLED:return Me.CANCELLED;case Kr.UNKNOWN:return Me.UNKNOWN;case Kr.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case Kr.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case Kr.INTERNAL:return Me.INTERNAL;case Kr.UNAVAILABLE:return Me.UNAVAILABLE;case Kr.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case Kr.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case Kr.NOT_FOUND:return Me.NOT_FOUND;case Kr.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case Kr.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case Kr.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case Kr.ABORTED:return Me.ABORTED;case Kr.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case Kr.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case Kr.DATA_LOSS:return Me.DATA_LOSS;default:return lt(39323,{code:t})}}(Mt=Kr||(Kr={}))[Mt.OK=0]="OK",Mt[Mt.CANCELLED=1]="CANCELLED",Mt[Mt.UNKNOWN=2]="UNKNOWN",Mt[Mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mt[Mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mt[Mt.NOT_FOUND=5]="NOT_FOUND",Mt[Mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mt[Mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mt[Mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mt[Mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mt[Mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mt[Mt.ABORTED=10]="ABORTED",Mt[Mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mt[Mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mt[Mt.INTERNAL=13]="INTERNAL",Mt[Mt.UNAVAILABLE=14]="UNAVAILABLE",Mt[Mt.DATA_LOSS=15]="DATA_LOSS";function f6(){return new TextEncoder}const h6=new wo([4294967295,4294967295],0);function Nw(t){const e=f6().encode(t),r=new JE;return r.update(e),new Uint8Array(r.digest())}function Rw(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new wo([r,n],0),new wo([a,o],0)]}class ex{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new mf(`Invalid padding: ${r}`);if(n<0)throw new mf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new mf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new mf(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=wo.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(wo.fromNumber(n)));return a.compare(h6)===1&&(a=new wo([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Nw(e),[n,a]=Rw(r);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,a,o);if(!this.we(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new ex(o,a,r);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const r=Nw(e),[n,a]=Rw(r);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,a,o);this.Se(l)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class mf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nm{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,s0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new nm(mt.min(),a,new br(Nt),ws(),Rt())}}class s0{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new s0(n,r,Rt(),Rt(),Rt())}}class od{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class PS{constructor(e,r){this.targetId=e,this.Ce=r}}class VS{constructor(e,r,n=Cn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class Iw{constructor(){this.ve=0,this.Fe=Dw(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Rt(),r=Rt(),n=Rt();return this.Fe.forEach(((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:lt(38017,{changeType:o})}})),new s0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Dw()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Kt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class d6{constructor(e){this.Ge=e,this.ze=new Map,this.je=ws(),this.Je=jh(),this.He=jh(),this.Ye=new br(Nt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:lt(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const o=a.target;if(cg(o))if(n===0){const l=new rt(o.path);this.et(r,l,Bn.newNoDocument(l,mt.min()))}else Kt(n===1,20013,{expectedCount:n});else{const l=this._t(r);if(l!==n){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let l,u;try{l=ko(n).toUint8Array()}catch(h){if(h instanceof uS)return $c("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new ex(l,a,o)}catch(h){return $c(h instanceof mf?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(r,o,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&cg(u.target)){const h=new rt(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Bn.newNoDocument(h,e))}o.Be&&(r.set(l,o.ke()),o.qe())}}));let n=Rt();this.He.forEach(((o,l)=>{let u=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const a=new nm(e,r,this.Ye,this.je,n);return this.je=ws(),this.Je=jh(),this.He=jh(),this.Ye=new br(Nt),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Iw,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new sn(Nt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new sn(Nt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||We("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Iw),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function jh(){return new br(rt.comparator)}function Dw(){return new br(rt.comparator)}const m6={asc:"ASCENDING",desc:"DESCENDING"},p6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g6={and:"AND",or:"OR"};class x6{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function fg(t,e){return t.useProto3Json||$d(e)?e:{value:e}}function Td(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function v6(t,e){return Td(t,e.toTimestamp())}function Ui(t){return Kt(!!t,49232),mt.fromTimestamp((function(r){const n=Ao(r);return new gr(n.seconds,n.nanos)})(t))}function tx(t,e){return hg(t,e).canonicalString()}function hg(t,e){const r=(function(a){return new pr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function US(t){const e=pr.fromString(t);return Kt(qS(e),10190,{key:e.toString()}),e}function dg(t,e){return tx(t.databaseId,e.path)}function Dp(t,e){const r=US(e);if(r.get(1)!==t.databaseId.projectId)throw new Je(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Je(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new rt(zS(r))}function jS(t,e){return tx(t.databaseId,e)}function _6(t){const e=US(t);return e.length===4?pr.emptyPath():zS(e)}function mg(t){return new pr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function zS(t){return Kt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Ow(t,e,r){return{name:dg(t,e),fields:r.value.mapValue.fields}}function y6(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:lt(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(Kt(p===void 0||typeof p=="string",58123),Cn.fromBase64String(p||"")):(Kt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Cn.fromUint8Array(p||new Uint8Array))})(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(d){const p=d.code===void 0?Me.UNKNOWN:LS(d.code);return new Je(p,d.message||"")})(l);r=new VS(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Dp(t,n.document.name),o=Ui(n.document.updateTime),l=n.document.createTime?Ui(n.document.createTime):mt.min(),u=new ua({mapValue:{fields:n.document.fields}}),h=Bn.newFoundDocument(a,o,l,u),d=n.targetIds||[],p=n.removedTargetIds||[];r=new od(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Dp(t,n.document),o=n.readTime?Ui(n.readTime):mt.min(),l=Bn.newNoDocument(a,o),u=n.removedTargetIds||[];r=new od([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Dp(t,n.document),o=n.removedTargetIds||[];r=new od([],o,a,null)}else{if(!("filter"in e))return lt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,l=new c6(a,o),u=n.targetId;r=new PS(u,l)}}return r}function w6(t,e){let r;if(e instanceof i0)r={update:Ow(t,e.key,e.value)};else if(e instanceof Jg)r={delete:dg(t,e.key)};else if(e instanceof Po)r={update:Ow(t,e.key,e.data),updateMask:R6(e.fieldMask)};else{if(!(e instanceof s6))return lt(16599,{Vt:e.type});r={verify:dg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(o,l){const u=l.transform;if(u instanceof yd)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Vf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Bf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof wd)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw lt(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,o){return o.updateTime!==void 0?{updateTime:v6(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:lt(27497)})(t,e.precondition)),r}function T6(t,e){return t&&t.length>0?(Kt(e!==void 0,14353),t.map((r=>(function(a,o){let l=a.updateTime?Ui(a.updateTime):Ui(o);return l.isEqual(mt.min())&&(l=Ui(o)),new n6(l,a.transformResults||[])})(r,e)))):[]}function E6(t,e){return{documents:[jS(t,e.path)]}}function S6(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=jS(t,a);const o=(function(d){if(d.length!==0)return GS(Xi.create(d,"and"))})(e.filters);o&&(r.structuredQuery.where=o);const l=(function(d){if(d.length!==0)return d.map((p=>(function(_){return{field:Fc(_.field),direction:k6(_.dir)}})(p)))})(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=fg(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:a}}function b6(t){let e=_6(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Kt(n===1,65062);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let o=[];r.where&&(o=(function(v){const _=HS(v);return _ instanceof Xi&&yS(_)?_.getFilters():[_]})(r.where));let l=[];r.orderBy&&(l=(function(v){return v.map((_=>(function(S){return new _d(Mc(S.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(r.orderBy));let u=null;r.limit&&(u=(function(v){let _;return _=typeof v=="object"?v.value:v,$d(_)?null:_})(r.limit));let h=null;r.startAt&&(h=(function(v){const _=!!v.before,w=v.values||[];return new vd(w,_)})(r.startAt));let d=null;return r.endAt&&(d=(function(v){const _=!v.before,w=v.values||[];return new vd(w,_)})(r.endAt)),HN(e,a,l,o,u,"F",h,d)}function A6(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function HS(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Mc(r.unaryFilter.field);return nn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Mc(r.unaryFilter.field);return nn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Mc(r.unaryFilter.field);return nn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Mc(r.unaryFilter.field);return nn.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return lt(61313);default:return lt(60726)}})(t):t.fieldFilter!==void 0?(function(r){return nn.create(Mc(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return lt(58110);default:return lt(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Xi.create(r.compositeFilter.filters.map((n=>HS(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return lt(1026)}})(r.compositeFilter.op))})(t):lt(30097,{filter:t})}function k6(t){return m6[t]}function C6(t){return p6[t]}function N6(t){return g6[t]}function Fc(t){return{fieldPath:t.canonicalString()}}function Mc(t){return bn.fromServerFormat(t.fieldPath)}function GS(t){return t instanceof nn?(function(r){if(r.op==="=="){if(yw(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NAN"}};if(_w(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(yw(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NOT_NAN"}};if(_w(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(r.field),op:C6(r.op),value:r.value}}})(t):t instanceof Xi?(function(r){const n=r.getFilters().map((a=>GS(a)));return n.length===1?n[0]:{compositeFilter:{op:N6(r.op),filters:n}}})(t):lt(54877,{filter:t})}function R6(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function qS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class po{constructor(e,r,n,a,o=mt.min(),l=mt.min(),u=Cn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new po(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class I6{constructor(e){this.yt=e}}function D6(t){const e=b6({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ug(e,e.limit,"L"):e}class O6{constructor(){this.Cn=new F6}addToCollectionParentIndex(e,r){return this.Cn.add(r),Oe.resolve()}getCollectionParents(e,r){return Oe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Oe.resolve()}deleteFieldIndex(e,r){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,r){return Oe.resolve()}getDocumentsMatchingTarget(e,r){return Oe.resolve(null)}getIndexType(e,r){return Oe.resolve(0)}getFieldIndexes(e,r){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,r){return Oe.resolve(bo.min())}getMinOffsetFromCollectionGroup(e,r){return Oe.resolve(bo.min())}updateCollectionGroup(e,r,n){return Oe.resolve()}updateIndexEntries(e,r){return Oe.resolve()}}class F6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new sn(pr.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new sn(pr.comparator)).toArray()}}const Fw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XS=41943040;class ca{static withCacheSize(e){return new ca(e,ca.DEFAULT_COLLECTION_PERCENTILE,ca.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}ca.DEFAULT_COLLECTION_PERCENTILE=10,ca.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ca.DEFAULT=new ca(XS,ca.DEFAULT_COLLECTION_PERCENTILE,ca.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ca.DISABLED=new ca(-1,0,0);class Zc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zc(0)}static cr(){return new Zc(-1)}}const Mw="LruGarbageCollector",M6=1048576;function Lw([t,e],[r,n]){const a=Nt(t,r);return a===0?Nt(e,n):a}class L6{constructor(e){this.Ir=e,this.buffer=new sn(Lw),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Lw(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class P6{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){We(Mw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){cu(r)?We(Mw,"Ignoring IndexedDB error during garbage collection: ",r):await lu(r)}await this.Vr(3e5)}))}}class V6{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Oe.resolve(Kd.ce);const n=new L6(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(We("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(Fw)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(We("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fw):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,o,l,u,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(We("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,l=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(n=v,u=Date.now(),this.removeTargets(e,n,r)))).next((v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,n)))).next((v=>(d=Date.now(),Dc()<=Ct.DEBUG&&We("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:v}))))}}function B6(t,e){return new V6(t,e)}class U6{constructor(){this.changes=new Vl((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Oe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class j6{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class z6{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Ef(n.mutation,a,Ra.empty(),gr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Rt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Rt()){const a=gl();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((o=>{let l=df();return o.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,r){const n=gl();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Rt())))}populateOverlays(e,r,n){const a=[];return n.forEach((o=>{r.has(o)||a.push(o)})),this.documentOverlayCache.getOverlays(e,a).next((o=>{o.forEach(((l,u)=>{r.set(l,u)}))}))}computeViews(e,r,n,a){let o=ws();const l=Tf(),u=(function(){return Tf()})();return r.forEach(((h,d)=>{const p=n.get(d.key);a.has(d.key)&&(p===void 0||p.mutation instanceof Po)?o=o.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),Ef(p.mutation,d,p.mutation.getFieldMask(),gr.now())):l.set(d.key,Ra.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((d,p)=>l.set(d,p))),r.forEach(((d,p)=>u.set(d,new j6(p,l.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Tf();let a=new br(((l,u)=>l-u)),o=Rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((l=>{for(const u of l)u.keys().forEach((h=>{const d=r.get(h);if(d===null)return;let p=n.get(h)||Ra.empty();p=u.applyToLocalView(d,p),n.set(h,p);const v=(a.get(u.batchId)||Rt()).add(h);a=a.insert(u.batchId,v)}))})).next((()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,p=h.value,v=CS();p.forEach((_=>{if(!o.has(_)){const w=FS(r.get(_),n.get(_));w!==null&&v.set(_,w),o=o.add(_)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,v))}return Oe.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(l){return rt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):GN(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((o=>{const l=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):Oe.resolve(gl());let u=Ff,h=o;return l.next((d=>Oe.forEach(d,((p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(p)?Oe.resolve():this.remoteDocumentCache.getEntry(e,p).next((_=>{h=h.insert(p,_)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,h,d,Rt()))).next((p=>({batchId:u,changes:kS(p)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new rt(r)).next((n=>{let a=df();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let l=df();return this.indexManager.getCollectionParents(e,o).next((u=>Oe.forEach(u,(h=>{const d=(function(v,_){return new Qd(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((p=>{p.forEach(((v,_)=>{l=l.insert(v,_)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a)))).next((l=>{o.forEach(((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,Bn.newInvalidDocument(p)))}));let u=df();return l.forEach(((h,d)=>{const p=o.get(h);p!==void 0&&Ef(p.mutation,d,Ra.empty(),gr.now()),em(r,d)&&(u=u.insert(h,d))})),u}))}}class H6{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Oe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:Ui(a.createTime)}})(r)),Oe.resolve()}getNamedQuery(e,r){return Oe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:D6(a.bundledQuery),readTime:Ui(a.readTime)}})(r)),Oe.resolve()}}class G6{constructor(){this.overlays=new br(rt.comparator),this.qr=new Map}getOverlay(e,r){return Oe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=gl();return Oe.forEach(r,(a=>this.getOverlay(e,a).next((o=>{o!==null&&n.set(a,o)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,o)=>{this.St(e,r,o)})),Oe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),Oe.resolve()}getOverlaysForCollection(e,r,n){const a=gl(),o=r.length+1,l=new rt(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&a.set(h.getKey(),h)}return Oe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new br(((d,p)=>d-p));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let p=o.get(d.largestBatchId);p===null&&(p=gl(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=gl(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>u.set(d,p))),!(u.size()>=a)););return Oe.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new l6(r,n));let o=this.qr.get(r);o===void 0&&(o=Rt(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}class q6{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Oe.resolve()}}class rx{constructor(){this.Qr=new sn(hn.$r),this.Ur=new sn(hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new hn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new hn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new rt(new pr([])),n=new hn(r,e),a=new hn(r,e+1),o=[];return this.Ur.forEachInRange([n,a],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new rt(new pr([])),n=new hn(r,e),a=new hn(r,e+1);let o=Rt();return this.Ur.forEachInRange([n,a],(l=>{o=o.add(l.key)})),o}containsKey(e){const r=new hn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class hn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return rt.comparator(e.key,r.key)||Nt(e.Yr,r.Yr)}static Kr(e,r){return Nt(e.Yr,r.Yr)||rt.comparator(e.key,r.key)}}class X6{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new sn(hn.$r)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new o6(o,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Zr=this.Zr.add(new hn(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Oe.resolve(l)}lookupMutationBatch(e,r){return Oe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),o=a<0?0:a;return Oe.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?Xg:this.tr-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new hn(r,0),a=new hn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,a],(l=>{const u=this.Xr(l.Yr);o.push(u)})),Oe.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new sn(Nt);return r.forEach((a=>{const o=new hn(a,0),l=new hn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(u=>{n=n.add(u.Yr)}))})),Oe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;rt.isDocumentKey(o)||(o=o.child(""));const l=new hn(new rt(o),0);let u=new sn(Nt);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(h.Yr)),!0)}),l),Oe.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Kt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Oe.forEach(r.mutations,(a=>{const o=new hn(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new hn(r,0),a=this.Zr.firstAfterOrEqual(n);return Oe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class W6{constructor(e){this.ri=e,this.docs=(function(){return new br(rt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,l=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Oe.resolve(n?n.document.mutableCopy():Bn.newInvalidDocument(r))}getEntries(e,r){let n=ws();return r.forEach((a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():Bn.newInvalidDocument(a))})),Oe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=ws();const l=r.path,u=new rt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||wN(yN(p),n)<=0||(a.has(p.key)||em(r,p))&&(o=o.insert(p.key,p.mutableCopy()))}return Oe.resolve(o)}getAllFromCollectionGroup(e,r,n,a){lt(9500)}ii(e,r){return Oe.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new K6(this)}getSize(e){return Oe.resolve(this.size)}}class K6 extends U6{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),Oe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class $6{constructor(e){this.persistence=e,this.si=new Vl((r=>$g(r)),Yg),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.oi=0,this._i=new rx,this.targetCount=0,this.ai=Zc.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Oe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Zc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Oe.resolve()}updateTargetData(e,r){return this.Pr(r),Oe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),Oe.waitFor(o).next((()=>a))}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Oe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Oe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach((l=>{o.push(a.markPotentiallyOrphaned(e,l))})),Oe.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Oe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Oe.resolve(n)}containsKey(e,r){return Oe.resolve(this._i.containsKey(r))}}class WS{constructor(e,r){this.ui={},this.overlays={},this.ci=new Kd(0),this.li=!1,this.li=!0,this.hi=new q6,this.referenceDelegate=e(this),this.Pi=new $6(this),this.indexManager=new O6,this.remoteDocumentCache=(function(a){return new W6(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new I6(r),this.Ii=new H6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new G6,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new X6(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){We("MemoryPersistence","Starting transaction:",e);const a=new Y6(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((o=>this.referenceDelegate.di(a).next((()=>o)))).toPromise().then((o=>(a.raiseOnCommittedEvent(),o)))}Ai(e,r){return Oe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class Y6 extends EN{constructor(e){super(),this.currentSequenceNumber=e}}class nx{constructor(e){this.persistence=e,this.Ri=new rx,this.Vi=null}static mi(e){return new nx(e)}get fi(){if(this.Vi)return this.Vi;throw lt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Oe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Oe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Oe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.fi,(n=>{const a=rt.fromPath(n);return this.gi(e,a).next((o=>{o||r.removeEntry(a,mt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Oe.or([()=>Oe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Ed{constructor(e,r){this.persistence=e,this.pi=new Vl((n=>AN(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=B6(this,r)}static mi(e,r){return new Ed(e,r)}Ei(){}di(e){return Oe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Oe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((o=>o?Oe.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ii(e,(l=>this.br(e,l,r).next((u=>{u||(n++,o.removeEntry(l,mt.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Oe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ad(e.data.value)),r}br(e,r,n){return Oe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return Oe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ax{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Rt(),a=Rt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new ax(e,r.fromCache,n,a)}}class Q6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class J6{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return zC()?8:SN(Hn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.ys(e,r).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(e,r,a,n).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new Q6;return this.Ss(e,r,l).next((u=>{if(o.result=u,this.Vs)return this.bs(e,r,l,u.size)}))})).next((()=>o.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(Dc()<=Ct.DEBUG&&We("QueryEngine","SDK will not create cache indexes for query:",Oc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Oe.resolve()):(Dc()<=Ct.DEBUG&&We("QueryEngine","Query:",Oc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(Dc()<=Ct.DEBUG&&We("QueryEngine","The SDK decides to create cache indexes for query:",Oc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bi(r))):Oe.resolve())}ys(e,r){if(Sw(r))return Oe.resolve(null);let n=Bi(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=ug(r,null,"F"),n=Bi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const l=Rt(...o);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((h=>{const d=this.Ds(r,u);return this.Cs(r,d,l,h.readTime)?this.ys(e,ug(r,null,"F")):this.vs(e,d,r,h)}))))})))))}ws(e,r,n,a){return Sw(r)||a.isEqual(mt.min())?Oe.resolve(null):this.ps.getDocuments(e,n).next((o=>{const l=this.Ds(r,o);return this.Cs(r,l,n,a)?Oe.resolve(null):(Dc()<=Ct.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Oc(r)),this.vs(e,l,r,_N(a,Ff)).next((u=>u)))}))}Ds(e,r){let n=new sn(bS(e));return r.forEach(((a,o)=>{em(e,o)&&(n=n.add(o))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}Ss(e,r,n){return Dc()<=Ct.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",Oc(r)),this.ps.getDocumentsMatchingQuery(e,r,bo.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((o=>(r.forEach((l=>{o=o.insert(l.key,l)})),o)))}}const ix="LocalStore",Z6=3e8;class eR{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new br(Nt),this.xs=new Vl((o=>$g(o)),Yg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new z6(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function tR(t,e,r,n){return new eR(t,e,r,n)}async function KS(t,e){const r=gt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((o=>(a=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((o=>{const l=[],u=[];let h=Rt();for(const d of a){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of o){u.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return r.localDocuments.getDocuments(n,h).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:u})))}))}))}function rR(t,e){const r=gt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,p){const v=d.batch,_=v.keys();let w=Oe.resolve();return _.forEach((S=>{w=w.next((()=>p.getEntry(h,S))).next((E=>{const A=d.docVersions.get(S);Kt(A!==null,48541),E.version.compareTo(A)<0&&(v.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),p.addEntry(E)))}))})),w.next((()=>u.mutationQueue.removeMutationBatch(h,v)))})(r,n,e,o).next((()=>o.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=Rt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function $S(t){const e=gt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function nR(t,e){const r=gt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((p,v)=>{const _=a.get(v);if(!_)return;u.push(r.Pi.removeMatchingKeys(o,p.removedDocuments,v).next((()=>r.Pi.addMatchingKeys(o,p.addedDocuments,v))));let w=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(Cn.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,n)),a=a.insert(v,w),(function(E,A,L){return E.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=Z6?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(_,w,p)&&u.push(r.Pi.updateTargetData(o,w))}));let h=ws(),d=Rt();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,p))})),u.push(aR(o,l,e.documentUpdates).next((p=>{h=p.ks,d=p.qs}))),!n.isEqual(mt.min())){const p=r.Pi.getLastRemoteSnapshotVersion(o).next((v=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(p)}return Oe.waitFor(u).next((()=>l.apply(o))).next((()=>r.localDocuments.getLocalViewOfDocuments(o,h,d))).next((()=>h))})).then((o=>(r.Ms=a,o)))}function aR(t,e,r){let n=Rt(),a=Rt();return r.forEach((o=>n=n.add(o))),e.getEntries(t,n).next((o=>{let l=ws();return r.forEach(((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),h.isNoDocument()&&h.version.isEqual(mt.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):We(ix,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)})),{ks:l,qs:a}}))}function iR(t,e){const r=gt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Xg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function sR(t,e){const r=gt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((o=>o?(a=o,Oe.resolve(a)):r.Pi.allocateTargetId(n).next((l=>(a=new po(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function pg(t,e,r){const n=gt(t),a=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,(l=>n.persistence.referenceDelegate.removeTarget(l,a)))}catch(l){if(!cu(l))throw l;We(ix,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function Pw(t,e,r){const n=gt(t);let a=mt.min(),o=Rt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,p){const v=gt(h),_=v.xs.get(p);return _!==void 0?Oe.resolve(v.Ms.get(_)):v.Pi.getTargetData(d,p)})(n,l,Bi(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{o=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,r?a:mt.min(),r?o:Rt()))).next((u=>(oR(n,XN(e),u),{documents:u,Qs:o})))))}function oR(t,e,r){let n=t.Os.get(e)||mt.min();r.forEach(((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),t.Os.set(e,n)}class Vw{constructor(){this.activeTargetIds=JN()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lR{constructor(){this.Mo=new Vw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Vw,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class cR{Oo(e){}shutdown(){}}const Bw="ConnectivityMonitor";class Uw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){We(Bw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){We(Bw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let zh=null;function gg(){return zh===null?zh=(function(){return 268435456+Math.round(2147483648*Math.random())})():zh++,"0x"+zh.toString(16)}const Op="RestConnection",uR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fR{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===gd?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,o){const l=gg(),u=this.zo(e,r.toUriEncodedString());We(Op,`Sending RPC '${e}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,a,o);const{host:d}=new URL(u),p=iu(d);return this.Jo(e,u,h,n,p).then((v=>(We(Op,`Received RPC '${e}' ${l}: `,v),v)),(v=>{throw $c(Op,`RPC '${e}' ${l} failed with error: `,v,"url: ",u,"request:",n),v}))}Ho(e,r,n,a,o,l){return this.Go(e,r,n,a,o)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ou})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,o)=>e[o]=a)),n&&n.headers.forEach(((a,o)=>e[o]=a))}zo(e,r){const n=uR[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class hR{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const On="WebChannelConnection";class dR extends fR{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,o){const l=gg();return new Promise(((u,h)=>{const d=new ZE;d.setWithCredentials(!0),d.listenOnce(eS.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case nd.NO_ERROR:const v=d.getResponseJson();We(On,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),u(v);break;case nd.TIMEOUT:We(On,`RPC '${e}' ${l} timed out`),h(new Je(Me.DEADLINE_EXCEEDED,"Request time out"));break;case nd.HTTP_ERROR:const _=d.getStatus();if(We(On,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w?.error;if(S&&S.status&&S.message){const E=(function(L){const U=L.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(U)>=0?U:Me.UNKNOWN})(S.status);h(new Je(E,S.message))}else h(new Je(Me.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new Je(Me.UNAVAILABLE,"Connection failed."));break;default:lt(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{We(On,`RPC '${e}' ${l} completed.`)}}));const p=JSON.stringify(a);We(On,`RPC '${e}' ${l} sending request:`,a),d.send(r,"POST",p,n,15)}))}T_(e,r,n){const a=gg(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=nS(),u=rS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const p=o.join("");We(On,`Creating RPC '${e}' stream ${a}: ${p}`,h);const v=l.createWebChannel(p,h);this.I_(v);let _=!1,w=!1;const S=new hR({Yo:A=>{w?We(On,`Not sending because RPC '${e}' stream ${a} is closed:`,A):(_||(We(On,`Opening RPC '${e}' stream ${a} transport.`),v.open(),_=!0),We(On,`RPC '${e}' stream ${a} sending:`,A),v.send(A))},Zo:()=>v.close()}),E=(A,L,U)=>{A.listen(L,(N=>{try{U(N)}catch(Q){setTimeout((()=>{throw Q}),0)}}))};return E(v,hf.EventType.OPEN,(()=>{w||(We(On,`RPC '${e}' stream ${a} transport opened.`),S.o_())})),E(v,hf.EventType.CLOSE,(()=>{w||(w=!0,We(On,`RPC '${e}' stream ${a} transport closed`),S.a_(),this.E_(v))})),E(v,hf.EventType.ERROR,(A=>{w||(w=!0,$c(On,`RPC '${e}' stream ${a} transport errored. Name:`,A.name,"Message:",A.message),S.a_(new Je(Me.UNAVAILABLE,"The operation could not be completed")))})),E(v,hf.EventType.MESSAGE,(A=>{if(!w){const L=A.data[0];Kt(!!L,16349);const U=L,N=U?.error||U[0]?.error;if(N){We(On,`RPC '${e}' stream ${a} received error:`,N);const Q=N.status;let re=(function(I){const R=Kr[I];if(R!==void 0)return LS(R)})(Q),ee=N.message;re===void 0&&(re=Me.INTERNAL,ee="Unknown error status: "+Q+" with message "+N.message),w=!0,S.a_(new Je(re,ee)),v.close()}else We(On,`RPC '${e}' stream ${a} received:`,L),S.u_(L)}})),E(u,tS.STAT_EVENT,(A=>{A.stat===ag.PROXY?We(On,`RPC '${e}' stream ${a} detected buffering proxy`):A.stat===ag.NOPROXY&&We(On,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function Fp(){return typeof document<"u"?document:null}function am(t){return new x6(t,!0)}class YS{constructor(e,r,n=1e3,a=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&We("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const jw="PersistentStream";class QS{constructor(e,r,n,a,o,l,u,h){this.Mi=e,this.S_=n,this.b_=a,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new YS(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Me.RESOURCE_EXHAUSTED?(ys(r.toString()),ys("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new Je(Me.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return We(jw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(We(jw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class mR extends QS{constructor(e,r,n,a,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=y6(this.serializer,e),n=(function(o){if(!("targetChange"in o))return mt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?mt.min():l.readTime?Ui(l.readTime):mt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=mg(this.serializer),r.addTarget=(function(o,l){let u;const h=l.target;if(u=cg(h)?{documents:E6(o,h)}:{query:S6(o,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=BS(o,l.resumeToken);const d=fg(o,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(mt.min())>0){u.readTime=Td(o,l.snapshotVersion.toTimestamp());const d=fg(o,l.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=A6(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=mg(this.serializer),r.removeTarget=e,this.q_(r)}}class pR extends QS{constructor(e,r,n,a,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Kt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Kt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=T6(e.writeResults,e.commitTime),n=Ui(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=mg(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>w6(this.serializer,n)))};this.q_(r)}}class gR{}class xR extends gR{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Je(Me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(e,hg(r,n),a,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Je(Me.UNKNOWN,o.toString())}))}Ho(e,r,n,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,hg(r,n),a,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Je(Me.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class vR{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ys(r),this.aa=!1):We("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Cl="RemoteStore";class _R{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{Bl(this)&&(We(Cl,"Restarting streams for network reachability change."),await(async function(h){const d=gt(h);d.Ea.add(4),await o0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await im(d)})(this))}))})),this.Ra=new vR(n,a)}}async function im(t){if(Bl(t))for(const e of t.da)await e(!0)}async function o0(t){for(const e of t.da)await e(!1)}function JS(t,e){const r=gt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),cx(r)?lx(r):uu(r).O_()&&ox(r,e))}function sx(t,e){const r=gt(t),n=uu(r);r.Ia.delete(e),n.O_()&&ZS(r,e),r.Ia.size===0&&(n.O_()?n.L_():Bl(r)&&r.Ra.set("Unknown"))}function ox(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}uu(t).Y_(e)}function ZS(t,e){t.Va.Ue(e),uu(t).Z_(e)}function lx(t){t.Va=new d6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),uu(t).start(),t.Ra.ua()}function cx(t){return Bl(t)&&!uu(t).x_()&&t.Ia.size>0}function Bl(t){return gt(t).Ea.size===0}function eb(t){t.Va=void 0}async function yR(t){t.Ra.set("Online")}async function wR(t){t.Ia.forEach(((e,r)=>{ox(t,e)}))}async function TR(t,e){eb(t),cx(t)?(t.Ra.ha(e),lx(t)):t.Ra.set("Unknown")}async function ER(t,e,r){if(t.Ra.set("Online"),e instanceof VS&&e.state===2&&e.cause)try{await(async function(a,o){const l=o.cause;for(const u of o.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){We(Cl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Sd(t,n)}else if(e instanceof od?t.Va.Ze(e):e instanceof PS?t.Va.st(e):t.Va.tt(e),!r.isEqual(mt.min()))try{const n=await $S(t.localStore);r.compareTo(n)>=0&&await(function(o,l){const u=o.Va.Tt(l);return u.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(d);p&&o.Ia.set(d,p.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,d)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(Cn.EMPTY_BYTE_STRING,p.snapshotVersion)),ZS(o,h);const v=new po(p.target,h,d,p.sequenceNumber);ox(o,v)})),o.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){We(Cl,"Failed to raise snapshot:",n),await Sd(t,n)}}async function Sd(t,e,r){if(!cu(e))throw e;t.Ea.add(1),await o0(t),t.Ra.set("Offline"),r||(r=()=>$S(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{We(Cl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await im(t)}))}function tb(t,e){return e().catch((r=>Sd(t,r,e)))}async function sm(t){const e=gt(t),r=No(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Xg;for(;SR(e);)try{const a=await iR(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,bR(e,a)}catch(a){await Sd(e,a)}rb(e)&&nb(e)}function SR(t){return Bl(t)&&t.Ta.length<10}function bR(t,e){t.Ta.push(e);const r=No(t);r.O_()&&r.X_&&r.ea(e.mutations)}function rb(t){return Bl(t)&&!No(t).x_()&&t.Ta.length>0}function nb(t){No(t).start()}async function AR(t){No(t).ra()}async function kR(t){const e=No(t);for(const r of t.Ta)e.ea(r.mutations)}async function CR(t,e,r){const n=t.Ta.shift(),a=Zg.from(n,e,r);await tb(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await sm(t)}async function NR(t,e){e&&No(t).X_&&await(async function(n,a){if((function(l){return u6(l)&&l!==Me.ABORTED})(a.code)){const o=n.Ta.shift();No(n).B_(),await tb(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a))),await sm(n)}})(t,e),rb(t)&&nb(t)}async function zw(t,e){const r=gt(t);r.asyncQueue.verifyOperationInProgress(),We(Cl,"RemoteStore received new credentials");const n=Bl(r);r.Ea.add(3),await o0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await im(r)}async function RR(t,e){const r=gt(t);e?(r.Ea.delete(2),await im(r)):e||(r.Ea.add(2),await o0(r),r.Ra.set("Unknown"))}function uu(t){return t.ma||(t.ma=(function(r,n,a){const o=gt(r);return o.sa(),new mR(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:yR.bind(null,t),t_:wR.bind(null,t),r_:TR.bind(null,t),H_:ER.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),cx(t)?lx(t):t.Ra.set("Unknown")):(await t.ma.stop(),eb(t))}))),t.ma}function No(t){return t.fa||(t.fa=(function(r,n,a){const o=gt(r);return o.sa(),new pR(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:AR.bind(null,t),r_:NR.bind(null,t),ta:kR.bind(null,t),na:CR.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await sm(t)):(await t.fa.stop(),t.Ta.length>0&&(We(Cl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class ux{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new To,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const l=Date.now()+n,u=new ux(e,r,l,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Je(Me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fx(t,e){if(ys("AsyncQueue",`${e}: ${t}`),cu(t))return new Je(Me.UNAVAILABLE,`${e}: ${t}`);throw t}class Bc{static emptySet(e){return new Bc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||rt.comparator(r.key,n.key):(r,n)=>rt.comparator(r.key,n.key),this.keyedMap=df(),this.sortedSet=new br(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Bc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Bc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class Hw{constructor(){this.ga=new br(rt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):lt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class eu{constructor(e,r,n,a,o,l,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,o){const l=[];return r.forEach((u=>{l.push({type:0,doc:u})})),new eu(e,r,Bc.emptySet(r),l,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class IR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class DR{constructor(){this.queries=Gw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=gt(r),o=a.queries;a.queries=Gw(),o.forEach(((l,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new Je(Me.ABORTED,"Firestore shutting down"))}}function Gw(){return new Vl((t=>SS(t)),Zd)}async function ab(t,e){const r=gt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.ba()&&e.Da()&&(n=2):(o=new IR,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(a,!0);break;case 1:o.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=fx(l,`Initialization of query '${Oc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&hx(r)}async function ib(t,e){const r=gt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?a=e.Da()?0:1:!o.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function OR(t,e){const r=gt(t);let n=!1;for(const a of e){const o=a.query,l=r.queries.get(o);if(l){for(const u of l.Sa)u.Fa(a)&&(n=!0);l.wa=a}}n&&hx(r)}function FR(t,e,r){const n=gt(t),a=n.queries.get(e);if(a)for(const o of a.Sa)o.onError(r);n.queries.delete(e)}function hx(t){t.Ca.forEach((e=>{e.next()}))}var xg,qw;(qw=xg||(xg={})).Ma="default",qw.Cache="cache";class sb{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new eu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=eu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xg.Cache}}class ob{constructor(e){this.key=e}}class lb{constructor(e){this.key=e}}class MR{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Rt(),this.mutatedKeys=Rt(),this.eu=bS(e),this.tu=new Bc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Hw,a=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((p,v)=>{const _=a.get(p),w=em(this.query,v)?v:null,S=!!_&&this.mutatedKeys.has(_.key),E=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let A=!1;_&&w?_.data.isEqual(w.data)?S!==E&&(n.track({type:3,doc:w}),A=!0):this.su(_,w)||(n.track({type:2,doc:w}),A=!0,(h&&this.eu(w,h)>0||d&&this.eu(w,d)<0)&&(u=!0)):!_&&w?(n.track({type:0,doc:w}),A=!0):_&&!w&&(n.track({type:1,doc:_}),A=!0,(h||d)&&(u=!0)),A&&(w?(l=l.add(w),o=E?o.add(p):o.delete(p)):(l=l.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),o=o.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Cs:u,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((p,v)=>(function(w,S){const E=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt(20277,{Rt:A})}};return E(w)-E(S)})(p.type,v.type)||this.eu(p.doc,v.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],h=this.Xa.size===0&&this.current&&!a?1:0,d=h!==this.Za;return this.Za=h,l.length!==0||d?{snapshot:new eu(this.query,e.tu,o,l,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Hw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Rt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new lb(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new ob(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Rt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return eu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const dx="SyncEngine";class LR{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class PR{constructor(e){this.key=e,this.hu=!1}}class VR{constructor(e,r,n,a,o,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Vl((u=>SS(u)),Zd),this.Iu=new Map,this.Eu=new Set,this.du=new br(rt.comparator),this.Au=new Map,this.Ru=new rx,this.Vu={},this.mu=new Map,this.fu=Zc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function BR(t,e,r=!0){const n=mb(t);let a;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.lu()):a=await cb(n,e,r,!0),a}async function UR(t,e){const r=mb(t);await cb(r,e,!0,!1)}async function cb(t,e,r,n){const a=await sR(t.localStore,Bi(e)),o=a.targetId,l=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await jR(t,e,o,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&JS(t.remoteStore,a),u}async function jR(t,e,r,n,a){t.pu=(v,_,w)=>(async function(E,A,L,U){let N=A.view.ru(L);N.Cs&&(N=await Pw(E.localStore,A.query,!1).then((({documents:k})=>A.view.ru(k,N))));const Q=U&&U.targetChanges.get(A.targetId),re=U&&U.targetMismatches.get(A.targetId)!=null,ee=A.view.applyChanges(N,E.isPrimaryClient,Q,re);return Ww(E,A.targetId,ee.au),ee.snapshot})(t,v,_,w);const o=await Pw(t.localStore,e,!0),l=new MR(e,o.Qs),u=l.ru(o.documents),h=s0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=l.applyChanges(u,t.isPrimaryClient,h);Ww(t,r,d.au);const p=new LR(e,r,l);return t.Tu.set(e,p),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function zR(t,e,r){const n=gt(t),a=n.Tu.get(e),o=n.Iu.get(a.targetId);if(o.length>1)return n.Iu.set(a.targetId,o.filter((l=>!Zd(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await pg(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&sx(n.remoteStore,a.targetId),vg(n,a.targetId)})).catch(lu)):(vg(n,a.targetId),await pg(n.localStore,a.targetId,!0))}async function HR(t,e){const r=gt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),sx(r.remoteStore,n.targetId))}async function GR(t,e,r){const n=QR(t);try{const a=await(function(l,u){const h=gt(l),d=gr.now(),p=u.reduce(((w,S)=>w.add(S.key)),Rt());let v,_;return h.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let S=ws(),E=Rt();return h.Ns.getEntries(w,p).next((A=>{S=A,S.forEach(((L,U)=>{U.isValidDocument()||(E=E.add(L))}))})).next((()=>h.localDocuments.getOverlayedDocuments(w,S))).next((A=>{v=A;const L=[];for(const U of u){const N=i6(U,v.get(U.key).overlayedDocument);N!=null&&L.push(new Po(U.key,N,xS(N.value.mapValue),vi.exists(!0)))}return h.mutationQueue.addMutationBatch(w,d,L,u)})).next((A=>{_=A;const L=A.applyToLocalDocumentSet(v,E);return h.documentOverlayCache.saveOverlays(w,A.batchId,L)}))})).then((()=>({batchId:_.batchId,changes:kS(v)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(l,u,h){let d=l.Vu[l.currentUser.toKey()];d||(d=new br(Nt)),d=d.insert(u,h),l.Vu[l.currentUser.toKey()]=d})(n,a.batchId,r),await l0(n,a.changes),await sm(n.remoteStore)}catch(a){const o=fx(a,"Failed to persist write");r.reject(o)}}async function ub(t,e){const r=gt(t);try{const n=await nR(r.localStore,e);e.targetChanges.forEach(((a,o)=>{const l=r.Au.get(o);l&&(Kt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.hu=!0:a.modifiedDocuments.size>0?Kt(l.hu,14607):a.removedDocuments.size>0&&(Kt(l.hu,42227),l.hu=!1))})),await l0(r,n,e)}catch(n){await lu(n)}}function Xw(t,e,r){const n=gt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((o,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(l,u){const h=gt(l);h.onlineState=u;let d=!1;h.queries.forEach(((p,v)=>{for(const _ of v.Sa)_.va(u)&&(d=!0)})),d&&hx(h)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function qR(t,e,r){const n=gt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),o=a&&a.key;if(o){let l=new br(rt.comparator);l=l.insert(o,Bn.newNoDocument(o,mt.min()));const u=Rt().add(o),h=new nm(mt.min(),new Map,new br(Nt),l,u);await ub(n,h),n.du=n.du.remove(o),n.Au.delete(e),mx(n)}else await pg(n.localStore,e,!1).then((()=>vg(n,e,r))).catch(lu)}async function XR(t,e){const r=gt(t),n=e.batch.batchId;try{const a=await rR(r.localStore,e);hb(r,n,null),fb(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await l0(r,a)}catch(a){await lu(a)}}async function WR(t,e,r){const n=gt(t);try{const a=await(function(l,u){const h=gt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next((v=>(Kt(v!==null,37113),p=v.keys(),h.mutationQueue.removeMutationBatch(d,v)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(n.localStore,e);hb(n,e,r),fb(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await l0(n,a)}catch(a){await lu(a)}}function fb(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function hb(t,e,r){const n=gt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function vg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||db(t,n)}))}function db(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(sx(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),mx(t))}function Ww(t,e,r){for(const n of r)n instanceof ob?(t.Ru.addReference(n.key,e),KR(t,n)):n instanceof lb?(We(dx,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||db(t,n.key)):lt(19791,{wu:n})}function KR(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(We(dx,"New document in limbo: "+r),t.Eu.add(n),mx(t))}function mx(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new rt(pr.fromString(e)),n=t.fu.next();t.Au.set(n,new PR(r)),t.du=t.du.insert(r,n),JS(t.remoteStore,new po(Bi(Jd(r.path)),n,"TargetPurposeLimboResolution",Kd.ce))}}async function l0(t,e,r){const n=gt(t),a=[],o=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{l.push(n.pu(h,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const p=d?!d.fromCache:r?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){a.push(d);const p=ax.As(h.targetId,d);o.push(p)}})))})),await Promise.all(l),n.Pu.H_(a),await(async function(h,d){const p=gt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>Oe.forEach(d,(_=>Oe.forEach(_.Es,(w=>p.persistence.referenceDelegate.addReference(v,_.targetId,w))).next((()=>Oe.forEach(_.ds,(w=>p.persistence.referenceDelegate.removeReference(v,_.targetId,w)))))))))}catch(v){if(!cu(v))throw v;We(ix,"Failed to update sequence numbers: "+v)}for(const v of d){const _=v.targetId;if(!v.fromCache){const w=p.Ms.get(_),S=w.snapshotVersion,E=w.withLastLimboFreeSnapshotVersion(S);p.Ms=p.Ms.insert(_,E)}}})(n.localStore,o))}async function $R(t,e){const r=gt(t);if(!r.currentUser.isEqual(e)){We(dx,"User change. New user:",e.toKey());const n=await KS(r.localStore,e);r.currentUser=e,(function(o,l){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new Je(Me.CANCELLED,l))}))})),o.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await l0(r,n.Ls)}}function YR(t,e){const r=gt(t),n=r.Au.get(e);if(n&&n.hu)return Rt().add(n.key);{let a=Rt();const o=r.Iu.get(e);if(!o)return a;for(const l of o){const u=r.Tu.get(l);a=a.unionWith(u.view.nu)}return a}}function mb(t){const e=gt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ub.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qR.bind(null,e),e.Pu.H_=OR.bind(null,e.eventManager),e.Pu.yu=FR.bind(null,e.eventManager),e}function QR(t){const e=gt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WR.bind(null,e),e}class bd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=am(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return tR(this.persistence,new J6,e.initialUser,this.serializer)}Cu(e){return new WS(nx.mi,this.serializer)}Du(e){return new lR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bd.provider={build:()=>new bd};class JR extends bd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Kt(this.persistence.referenceDelegate instanceof Ed,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new P6(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?ca.withCacheSize(this.cacheSizeBytes):ca.DEFAULT;return new WS((n=>Ed.mi(n,r)),this.serializer)}}class _g{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Xw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=$R.bind(null,this.syncEngine),await RR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new DR})()}createDatastore(e){const r=am(e.databaseInfo.databaseId),n=(function(o){return new dR(o)})(e.databaseInfo);return(function(o,l,u,h){return new xR(o,l,u,h)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,o,l,u){return new _R(n,a,o,l,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>Xw(this.syncEngine,r,0)),(function(){return Uw.v()?new Uw:new cR})())}createSyncEngine(e,r){return(function(a,o,l,u,h,d,p){const v=new VR(a,o,l,u,h,d);return p&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=gt(r);We(Cl,"RemoteStore shutting down."),n.Ea.add(5),await o0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_g.provider={build:()=>new _g};class pb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ys("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const Ro="FirestoreClient";class ZR{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Mn.UNAUTHENTICATED,this.clientId=Gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async l=>{We(Ro,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(We(Ro,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new To;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=fx(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Mp(t,e){t.asyncQueue.verifyOperationInProgress(),We(Ro,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await KS(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Kw(t,e){t.asyncQueue.verifyOperationInProgress();const r=await eI(t);We(Ro,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>zw(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>zw(e.remoteStore,a))),t._onlineComponents=e}async function eI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){We(Ro,"Using user provided OfflineComponentProvider");try{await Mp(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Me.FAILED_PRECONDITION||a.code===Me.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;$c("Error using user provided cache. Falling back to memory cache: "+r),await Mp(t,new bd)}}else We(Ro,"Using default OfflineComponentProvider"),await Mp(t,new JR(void 0));return t._offlineComponents}async function gb(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(We(Ro,"Using user provided OnlineComponentProvider"),await Kw(t,t._uninitializedComponentsProvider._online)):(We(Ro,"Using default OnlineComponentProvider"),await Kw(t,new _g))),t._onlineComponents}function tI(t){return gb(t).then((e=>e.syncEngine))}async function yg(t){const e=await gb(t),r=e.eventManager;return r.onListen=BR.bind(null,e.syncEngine),r.onUnlisten=zR.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=UR.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=HR.bind(null,e.syncEngine),r}function rI(t,e,r={}){const n=new To;return t.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,d){const p=new pb({next:_=>{p.Nu(),l.enqueueAndForget((()=>ib(o,v)));const w=_.docs.has(u);!w&&_.fromCache?d.reject(new Je(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&_.fromCache&&h&&h.source==="server"?d.reject(new Je(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),v=new sb(Jd(u.path),p,{includeMetadataChanges:!0,qa:!0});return ab(o,v)})(await yg(t),t.asyncQueue,e,r,n))),n.promise}function xb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const $w=new Map;const vb="firestore.googleapis.com",Yw=!0;class Qw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Je(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vb,this.ssl=Yw}else this.host=e.host,this.ssl=e.ssl??Yw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<M6)throw new Je(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xb(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Je(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Je(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Je(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class om{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Je(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Je(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new lN;switch(n.type){case"firstParty":return new hN(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Je(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=$w.get(r);n&&(We("ComponentProvider","Removing Datastore"),$w.delete(r),n.terminate())})(this),Promise.resolve()}}function nI(t,e,r,n={}){t=xi(t,om);const a=iu(e),o=t._getSettings(),l={...o,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(qE(`https://${u}`),XE("Firestore",!0)),o.host!==vb&&o.host!==u&&$c("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:a,emulatorOptions:n};if(!bl(h,l)&&(t._setSettings(h),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=Mn.MOCK_USER;else{d=OC(n.mockUserToken,t._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new Je(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Mn(v)}t._authCredentials=new cN(new iS(d,p))}}class lm{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lm(this.firestore,e,this._query)}}class Pr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Eo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pr(this.firestore,e,this._key)}toJSON(){return{type:Pr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(a0(r,Pr._jsonSchema))return new Pr(e,n||null,new rt(pr.fromString(r.referencePath)))}}Pr._jsonSchemaVersion="firestore/documentReference/1.0",Pr._jsonSchema={type:Qr("string",Pr._jsonSchemaVersion),referencePath:Qr("string")};class Eo extends lm{constructor(e,r,n){super(e,r,Jd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pr(this.firestore,null,new rt(e))}withConverter(e){return new Eo(this.firestore,e,this._path)}}function _b(t,e,...r){if(t=kn(t),sS("collection","path",e),t instanceof om){const n=pr.fromString(e,...r);return fw(n),new Eo(t,null,n)}{if(!(t instanceof Pr||t instanceof Eo))throw new Je(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pr.fromString(e,...r));return fw(n),new Eo(t.firestore,null,n)}}function Ln(t,e,...r){if(t=kn(t),arguments.length===1&&(e=Gg.newId()),sS("doc","path",e),t instanceof om){const n=pr.fromString(e,...r);return uw(n),new Pr(t,null,new rt(n))}{if(!(t instanceof Pr||t instanceof Eo))throw new Je(Me.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pr.fromString(e,...r));return uw(n),new Pr(t.firestore,t instanceof Eo?t.converter:null,new rt(n))}}const Jw="AsyncQueue";class Zw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new YS(this,"async_queue_retry"),this._c=()=>{const n=Fp();n&&We(Jw,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Fp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Fp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new To;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!cu(e))throw e;We(Jw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ys("INTERNAL UNHANDLED ERROR: ",eT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=ux.createAndSchedule(this,e,r,n,(o=>this.hc(o)));return this.tc.push(a),a}uc(){this.nc&&lt(47125,{Pc:eT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function eT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function tT(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const o of n)if(o in a&&typeof a[o]=="function")return!0;return!1})(t,["next","error","complete"])}class Nl extends om{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new Zw,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zw(e),this._firestoreClient=void 0,await e}}}function cm(t,e){const r=typeof t=="object"?t:$E(),n=typeof t=="string"?t:gd,a=zg(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=IC("firestore");o&&nI(a,...o)}return a}function px(t){if(t._terminated)throw new Je(Me.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||aI(t),t._firestoreClient}function aI(t){const e=t._freezeSettings(),r=(function(a,o,l,u){return new NN(a,o,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,xb(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ZR(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const o=a?._online.build();return{_offline:a?._offline.build(o),_online:o}})(t._componentsProvider))}class $a{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $a(Cn.fromBase64String(e))}catch(r){throw new Je(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new $a(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$a._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(a0(e,$a._jsonSchema))return $a.fromBase64String(e.bytes)}}$a._jsonSchemaVersion="firestore/bytes/1.0",$a._jsonSchema={type:Qr("string",$a._jsonSchemaVersion),bytes:Qr("string")};class um{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Je(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class gx{constructor(e){this._methodName=e}}class ji{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Je(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Je(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Nt(this._lat,e._lat)||Nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ji._jsonSchemaVersion}}static fromJSON(e){if(a0(e,ji._jsonSchema))return new ji(e.latitude,e.longitude)}}ji._jsonSchemaVersion="firestore/geoPoint/1.0",ji._jsonSchema={type:Qr("string",ji._jsonSchemaVersion),latitude:Qr("number"),longitude:Qr("number")};class zi{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(a0(e,zi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new zi(e.vectorValues);throw new Je(Me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zi._jsonSchemaVersion="firestore/vectorValue/1.0",zi._jsonSchema={type:Qr("string",zi._jsonSchemaVersion),vectorValues:Qr("object")};const iI=/^__.*__$/;class sI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Po(e,this.data,this.fieldMask,r,this.fieldTransforms):new i0(e,this.data,r,this.fieldTransforms)}}class yb{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Po(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function wb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt(40011,{Ac:t})}}class xx{constructor(e,r,n,a,o,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new xx({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ad(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(wb(this.Ac)&&iI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class oI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||am(e)}Cc(e,r,n,a=!1){return new xx({Ac:e,methodName:r,Dc:n,path:bn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tb(t){const e=t._freezeSettings(),r=am(t._databaseId);return new oI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function lI(t,e,r,n,a,o={}){const l=t.Cc(o.merge||o.mergeFields?2:0,e,r,a);vx("Data must be an object, but it was:",l,n);const u=Eb(n,l);let h,d;if(o.merge)h=new Ra(l.fieldMask),d=l.fieldTransforms;else if(o.mergeFields){const p=[];for(const v of o.mergeFields){const _=wg(e,v,r);if(!l.contains(_))throw new Je(Me.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);bb(p,_)||p.push(_)}h=new Ra(p),d=l.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,d=l.fieldTransforms;return new sI(new ua(u),h,d)}class fm extends gx{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fm}}function cI(t,e,r,n){const a=t.Cc(1,e,r);vx("Data must be an object, but it was:",a,n);const o=[],l=ua.empty();Lo(n,((h,d)=>{const p=_x(e,h,r);d=kn(d);const v=a.yc(p);if(d instanceof fm)o.push(p);else{const _=hm(d,v);_!=null&&(o.push(p),l.set(p,_))}}));const u=new Ra(o);return new yb(l,u,a.fieldTransforms)}function uI(t,e,r,n,a,o){const l=t.Cc(1,e,r),u=[wg(e,n,r)],h=[a];if(o.length%2!=0)throw new Je(Me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)u.push(wg(e,o[_])),h.push(o[_+1]);const d=[],p=ua.empty();for(let _=u.length-1;_>=0;--_)if(!bb(d,u[_])){const w=u[_];let S=h[_];S=kn(S);const E=l.yc(w);if(S instanceof fm)d.push(w);else{const A=hm(S,E);A!=null&&(d.push(w),p.set(w,A))}}const v=new Ra(d);return new yb(p,v,l.fieldTransforms)}function hm(t,e){if(Sb(t=kn(t)))return vx("Unsupported field value:",e,t),Eb(t,e);if(t instanceof gx)return(function(n,a){if(!wb(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const o=[];let l=0;for(const u of n){let h=hm(u,a.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(t,e)}return(function(n,a){if((n=kn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return ZN(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=gr.fromDate(n);return{timestampValue:Td(a.serializer,o)}}if(n instanceof gr){const o=new gr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Td(a.serializer,o)}}if(n instanceof ji)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof $a)return{bytesValue:BS(a.serializer,n._byteString)};if(n instanceof Pr){const o=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw a.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:tx(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof zi)return(function(l,u){return{mapValue:{fields:{[pS]:{stringValue:gS},[xd]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Qg(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${qg(n)}`)})(t,e)}function Eb(t,e){const r={};return cS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Lo(t,((n,a)=>{const o=hm(a,e.mc(n));o!=null&&(r[n]=o)})),{mapValue:{fields:r}}}function Sb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gr||t instanceof ji||t instanceof $a||t instanceof Pr||t instanceof gx||t instanceof zi)}function vx(t,e,r){if(!Sb(r)||!oS(r)){const n=qg(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function wg(t,e,r){if((e=kn(e))instanceof um)return e._internalPath;if(typeof e=="string")return _x(t,e);throw Ad("Field path arguments must be of type string or ",t,!1,void 0,r)}const fI=new RegExp("[~\\*/\\[\\]]");function _x(t,e,r){if(e.search(fI)>=0)throw Ad(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new um(...e.split("."))._internalPath}catch{throw Ad(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ad(t,e,r,n,a){const o=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${n}`),l&&(h+=` in document ${a}`),h+=")"),new Je(Me.INVALID_ARGUMENT,u+t+h)}function bb(t,e){return t.some((r=>r.isEqual(e)))}class Ab{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Pr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(kb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class hI extends Ab{data(){return super.data()}}function kb(t,e){return typeof e=="string"?_x(t,e):e instanceof um?e._internalPath:e._delegate._internalPath}function dI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Je(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mI{convertValue(e,r="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw lt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Lo(e,((a,o)=>{n[a]=this.convertValue(o,r)})),n}convertVectorValue(e){const r=e.fields?.[xd].arrayValue?.values?.map((n=>Lr(n.doubleValue)));return new zi(r)}convertGeoPoint(e){return new ji(Lr(e.latitude),Lr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Yd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Mf(e));default:return null}}convertTimestamp(e){const r=Ao(e);return new gr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pr.fromString(e);Kt(qS(n),9688,{name:e});const a=new Lf(n.get(1),n.get(3)),o=new rt(n.popFirst(5));return a.isEqual(r)||ys(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}function pI(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class pf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yl extends Ab{constructor(e,r,n,a,o,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ld(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(kb("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Je(Me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=yl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}yl._jsonSchemaVersion="firestore/documentSnapshot/1.0",yl._jsonSchema={type:Qr("string",yl._jsonSchemaVersion),bundleSource:Qr("string","DocumentSnapshot"),bundleName:Qr("string"),bundle:Qr("string")};class ld extends yl{data(e={}){return super.data(e)}}class Uc{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new pf(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new ld(this._firestore,this._userDataWriter,n.key,n,new pf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Je(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,o){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map((u=>{const h=new ld(a._firestore,a._userDataWriter,u.doc.key,u.doc,new pf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new ld(a._firestore,a._userDataWriter,u.doc.key,u.doc,new pf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,p=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),p=l.indexOf(u.doc.key)),{type:gI(u.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Je(Me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Uc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt(61501,{type:t})}}function xI(t){t=xi(t,Pr);const e=xi(t.firestore,Nl);return rI(px(e),t._key).then((r=>Rb(e,t,r)))}Uc._jsonSchemaVersion="firestore/querySnapshot/1.0",Uc._jsonSchema={type:Qr("string",Uc._jsonSchemaVersion),bundleSource:Qr("string","QuerySnapshot"),bundleName:Qr("string"),bundle:Qr("string")};class Cb extends mI{constructor(e){super(),this.firestore=e}convertBytes(e){return new $a(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Pr(this.firestore,null,r)}}function xl(t,e,r){t=xi(t,Pr);const n=xi(t.firestore,Nl),a=pI(t.converter,e,r);return yx(n,[lI(Tb(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,vi.none())])}function vI(t,e,r,...n){t=xi(t,Pr);const a=xi(t.firestore,Nl),o=Tb(a);let l;return l=typeof(e=kn(e))=="string"||e instanceof um?uI(o,"updateDoc",t._key,e,r,n):cI(o,"updateDoc",t._key,e),yx(a,[l.toMutation(t._key,vi.exists(!0))])}function Nb(t){return yx(xi(t.firestore,Nl),[new Jg(t._key,vi.none())])}function vl(t,...e){t=kn(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||tT(e[n])||(r=e[n++]);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(tT(e[n])){const h=e[n];e[n]=h.next?.bind(h),e[n+1]=h.error?.bind(h),e[n+2]=h.complete?.bind(h)}let o,l,u;if(t instanceof Pr)l=xi(t.firestore,Nl),u=Jd(t._key.path),o={next:h=>{e[n]&&e[n](Rb(l,t,h))},error:e[n+1],complete:e[n+2]};else{const h=xi(t,lm);l=xi(h.firestore,Nl),u=h._query;const d=new Cb(l);o={next:p=>{e[n]&&e[n](new Uc(l,d,h,p))},error:e[n+1],complete:e[n+2]},dI(t._query)}return(function(d,p,v,_){const w=new pb(_),S=new sb(p,w,v);return d.asyncQueue.enqueueAndForget((async()=>ab(await yg(d),S))),()=>{w.Nu(),d.asyncQueue.enqueueAndForget((async()=>ib(await yg(d),S)))}})(px(l),u,a,o)}function yx(t,e){return(function(n,a){const o=new To;return n.asyncQueue.enqueueAndForget((async()=>GR(await tI(n),a,o))),o.promise})(px(t),e)}function Rb(t,e,r){const n=r.docs.get(e._key),a=new Cb(t);return new yl(t,a,e._key,n,new pf(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(a){ou=a})(su),Kc(new Al("firestore",((n,{instanceIdentifier:a,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new Nl(new uN(n.getProvider("auth-internal")),new dN(l,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Je(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lf(d.options.projectId,p)})(l,a),l);return o={useFetchStreams:r,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),yo(sw,ow,e),yo(sw,ow,"esm2020")})();function Ib(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _I=Ib,Db=new t0("auth","Firebase",Ib());const kd=new Ug("@firebase/auth");function yI(t,...e){kd.logLevel<=Ct.WARN&&kd.warn(`Auth (${su}): ${t}`,...e)}function cd(t,...e){kd.logLevel<=Ct.ERROR&&kd.error(`Auth (${su}): ${t}`,...e)}function Ts(t,...e){throw wx(t,...e)}function Hi(t,...e){return wx(t,...e)}function Ob(t,e,r){const n={..._I(),[e]:r};return new t0("auth","Firebase",n).create(e,{appName:t.name})}function So(t){return Ob(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Db.create(t,...e)}function dt(t,e,...r){if(!t)throw wx(e,...r)}function ds(t){const e="INTERNAL ASSERTION FAILED: "+t;throw cd(e),new Error(e)}function Es(t,e){t||ds(e)}function Tg(){return typeof self<"u"&&self.location?.href||""}function wI(){return rT()==="http:"||rT()==="https:"}function rT(){return typeof self<"u"&&self.location?.protocol||null}function TI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wI()||BC()||"connection"in navigator)?navigator.onLine:!0}function EI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class c0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Es(r>e,"Short delay should be less than long delay!"),this.isMobile=LC()||UC()}get(){return TI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Tx(t,e){Es(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class Fb{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ds("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ds("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ds("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const SI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const bI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],AI=new c0(3e4,6e4);function dm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function fu(t,e,r,n,a={}){return Mb(t,a,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const u=r0({key:t.config.apiKey,...l}).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:h,...o};return VC()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&iu(t.emulatorConfig.host)&&(d.credentials="include"),Fb.fetch()(await Pb(t,t.config.apiHost,r,u),d)})}async function Mb(t,e,r){t._canInitEmulator=!1;const n={...SI,...e};try{const a=new kI(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw Hh(t,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hh(t,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Hh(t,"email-already-in-use",l);if(h==="USER_DISABLED")throw Hh(t,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Ob(t,p,d);Ts(t,p)}}catch(a){if(a instanceof bs)throw a;Ts(t,"network-request-failed",{message:String(a)})}}async function Lb(t,e,r,n,a={}){const o=await fu(t,e,r,n,a);return"mfaPendingCredential"in o&&Ts(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Pb(t,e,r,n){const a=`${e}${r}?${n}`,o=t,l=o.config.emulator?Tx(t.config,a):`${t.config.apiScheme}://${a}`;return bI.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}class kI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Hi(this.auth,"network-request-failed")),AI.get())})}}function Hh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Hi(t,e,n);return a.customData._tokenResponse=r,a}async function CI(t,e){return fu(t,"POST","/v1/accounts:delete",e)}async function Cd(t,e){return fu(t,"POST","/v1/accounts:lookup",e)}function Sf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function NI(t,e=!1){const r=kn(t),n=await r.getIdToken(e),a=Ex(n);dt(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,l=o?.sign_in_provider;return{claims:a,token:n,authTime:Sf(Lp(a.auth_time)),issuedAtTime:Sf(Lp(a.iat)),expirationTime:Sf(Lp(a.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Lp(t){return Number(t)*1e3}function Ex(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return cd("JWT malformed, contained fewer than 3 sections"),null;try{const a=jE(r);return a?JSON.parse(a):(cd("Failed to decode base64 JWT payload"),null)}catch(a){return cd("Caught error parsing JWT payload as JSON",a?.toString()),null}}function nT(t){const e=Ex(t);return dt(e,"internal-error"),dt(typeof e.exp<"u","internal-error"),dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Uf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof bs&&RI(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function RI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class II{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sf(this.lastLoginAt),this.creationTime=Sf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Nd(t){const e=t.auth,r=await t.getIdToken(),n=await Uf(t,Cd(e,{idToken:r}));dt(n?.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const o=a.providerUserInfo?.length?Vb(a.providerUserInfo):[],l=OI(t.providerData,o),u=t.isAnonymous,h=!(t.email&&a.passwordHash)&&!l?.length,d=u?h:!1,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function DI(t){const e=kn(t);await Nd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OI(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function Vb(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function FI(t,e){const r=await Mb(t,{},async()=>{const n=r0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,l=await Pb(t,a,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&iu(t.emulatorConfig.host)&&(h.credentials="include"),Fb.fetch()(l,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function MI(t,e){return fu(t,"POST","/v2/accounts:revokeToken",dm(t,e))}class jc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dt(e.idToken,"internal-error"),dt(typeof e.idToken<"u","internal-error"),dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){dt(e.length!==0,"internal-error");const r=nT(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await FI(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,l=new jc;return n&&(dt(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(dt(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),o&&(dt(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jc,this.toJSON())}_performRefresh(){return ds("not implemented")}}function lo(t,e){dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class mi{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new II(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Eg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Uf(this,this.stsTokenManager.getToken(this.auth,e));return dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return NI(this,e)}reload(){return DI(this)}_assign(e){this!==e&&(dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new mi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Nd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(di(this.auth.app))return Promise.reject(So(this.auth));const e=await this.getIdToken();return await Uf(this,CI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,o=r.phoneNumber??void 0,l=r.photoURL??void 0,u=r.tenantId??void 0,h=r._redirectEventId??void 0,d=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:S,stsTokenManager:E}=r;dt(v&&E,e,"internal-error");const A=jc.fromJSON(this.name,E);dt(typeof v=="string",e,"internal-error"),lo(n,e.name),lo(a,e.name),dt(typeof _=="boolean",e,"internal-error"),dt(typeof w=="boolean",e,"internal-error"),lo(o,e.name),lo(l,e.name),lo(u,e.name),lo(h,e.name),lo(d,e.name),lo(p,e.name);const L=new mi({uid:v,auth:e,email:a,emailVerified:_,displayName:n,isAnonymous:w,photoURL:l,phoneNumber:o,tenantId:u,stsTokenManager:A,createdAt:d,lastLoginAt:p});return S&&Array.isArray(S)&&(L.providerData=S.map(U=>({...U}))),h&&(L._redirectEventId=h),L}static async _fromIdTokenResponse(e,r,n=!1){const a=new jc;a.updateFromServerResponse(r);const o=new mi({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Nd(o),o}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];dt(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?Vb(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!o?.length,u=new jc;u.updateFromIdToken(n);const h=new mi({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!o?.length};return Object.assign(h,d),h}}const aT=new Map;function ms(t){Es(t instanceof Function,"Expected a class definition");let e=aT.get(t);return e?(Es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,aT.set(t,e),e)}class Bb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Bb.type="NONE";const iT=Bb;function ud(t,e,r){return`firebase:${t}:${e}:${r}`}class zc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=ud(this.userKey,a.apiKey,o),this.fullPersistenceKey=ud("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Cd(this.auth,{idToken:e}).catch(()=>{});return r?mi._fromGetAccountInfoResponse(this.auth,r,e):null}return mi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new zc(ms(iT),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=a[0]||ms(iT);const l=ud(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const p=await d._get(l);if(p){let v;if(typeof p=="string"){const _=await Cd(e,{idToken:p}).catch(()=>{});if(!_)break;v=await mi._fromGetAccountInfoResponse(e,_,p)}else v=mi._fromJSON(e,p);d!==o&&(u=v),o=d;break}}catch{}const h=a.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new zc(o,e,n):(o=h[0],u&&await o._set(l,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(l)}catch{}})),new zc(o,e,n))}}function sT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ub(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qb(e))return"Blackberry";if(Xb(e))return"Webos";if(jb(e))return"Safari";if((e.includes("chrome/")||zb(e))&&!e.includes("edge/"))return"Chrome";if(Gb(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Ub(t=Hn()){return/firefox\//i.test(t)}function jb(t=Hn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zb(t=Hn()){return/crios\//i.test(t)}function Hb(t=Hn()){return/iemobile/i.test(t)}function Gb(t=Hn()){return/android/i.test(t)}function qb(t=Hn()){return/blackberry/i.test(t)}function Xb(t=Hn()){return/webos/i.test(t)}function Sx(t=Hn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function LI(t=Hn()){return Sx(t)&&!!window.navigator?.standalone}function PI(){return jC()&&document.documentMode===10}function Wb(t=Hn()){return Sx(t)||Gb(t)||Xb(t)||qb(t)||/windows phone/i.test(t)||Hb(t)}function Kb(t,e=[]){let r;switch(t){case"Browser":r=sT(Hn());break;case"Worker":r=`${sT(Hn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${su}/${n}`}class VI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((l,u)=>{try{const h=e(o);l(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function BI(t,e={}){return fu(t,"GET","/v2/passwordPolicy",dm(t,e))}const UI=6;class jI{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??UI,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class zI{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oT(this),this.idTokenSubscription=new oT(this),this.beforeStateQueue=new VI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Db,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ms(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await zc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Cd(this,{idToken:e}),n=await mi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(di(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&u?.user&&(n=u.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Nd(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(di(this.app))return Promise.reject(So(this));const r=e?kn(e):null;return r&&dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return di(this.app)?Promise.reject(So(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return di(this.app)?Promise.reject(So(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ms(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await BI(this),r=new jI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new t0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await MI(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ms(e)||this._popupRedirectResolver;dt(r,this,"argument-error"),this.redirectPersistenceManager=await zc.create(this,[ms(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,a);return()=>{l=!0,h()}}else{const h=e.addObserver(r);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Kb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(di(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&yI(`Error while retrieving App Check token: ${e.error}`),e?.token}}function mm(t){return kn(t)}class oT{constructor(e){this.auth=e,this.observer=null,this.addObserver=$C(r=>this.observer=r)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let bx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function HI(t){bx=t}function GI(t){return bx.loadJS(t)}function qI(){return bx.gapiScript}function XI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function WI(t,e){const r=zg(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(bl(o,e??{}))return a;Ts(a,"already-initialized")}return r.initialize({options:e})}function KI(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(ms);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function $I(t,e,r){const n=mm(t);dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,o=$b(e),{host:l,port:u}=YI(e),h=u===null?"":`:${u}`,d={url:`${o}//${l}${h}/`},p=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){dt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),dt(bl(d,n.config.emulator)&&bl(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,iu(l)?(qE(`${o}//${l}${h}`),XE("Auth",!0)):QI()}function $b(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function YI(t){const e=$b(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const o=a[1];return{host:o,port:lT(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:lT(l)}}}function lT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function QI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Yb{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ds("not implemented")}_getIdTokenResponse(e){return ds("not implemented")}_linkToIdToken(e,r){return ds("not implemented")}_getReauthenticationResolver(e){return ds("not implemented")}}async function Hc(t,e){return Lb(t,"POST","/v1/accounts:signInWithIdp",dm(t,e))}const JI="http://localhost";class Rl extends Yb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Rl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ts("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...o}=r;if(!n||!a)return null;const l=new Rl(n,a);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return Hc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Hc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Hc(e,r)}buildRequest(){const e={requestUri:JI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=r0(r)}return e}}class Qb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class u0 extends Qb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class uo extends u0{constructor(){super("facebook.com")}static credential(e){return Rl._fromParams({providerId:uo.PROVIDER_ID,signInMethod:uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uo.credentialFromTaggedObject(e)}static credentialFromError(e){return uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return uo.credential(e.oauthAccessToken)}catch{return null}}}uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";uo.PROVIDER_ID="facebook.com";class fo extends u0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Rl._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return fo.credential(r,n)}catch{return null}}}fo.GOOGLE_SIGN_IN_METHOD="google.com";fo.PROVIDER_ID="google.com";class ho extends u0{constructor(){super("github.com")}static credential(e){return Rl._fromParams({providerId:ho.PROVIDER_ID,signInMethod:ho.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ho.credentialFromTaggedObject(e)}static credentialFromError(e){return ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ho.credential(e.oauthAccessToken)}catch{return null}}}ho.GITHUB_SIGN_IN_METHOD="github.com";ho.PROVIDER_ID="github.com";class mo extends u0{constructor(){super("twitter.com")}static credential(e,r){return Rl._fromParams({providerId:mo.PROVIDER_ID,signInMethod:mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return mo.credentialFromTaggedObject(e)}static credentialFromError(e){return mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return mo.credential(r,n)}catch{return null}}}mo.TWITTER_SIGN_IN_METHOD="twitter.com";mo.PROVIDER_ID="twitter.com";async function ZI(t,e){return Lb(t,"POST","/v1/accounts:signUp",dm(t,e))}class Io{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await mi._fromIdTokenResponse(e,n,a),l=cT(n);return new Io({user:o,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=cT(n);return new Io({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function cT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function eD(t){if(di(t.app))return Promise.reject(So(t));const e=mm(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Io({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await ZI(e,{returnSecureToken:!0}),n=await Io._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}class Rd extends bs{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Rd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Rd(e,r,n,a)}}function Jb(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Rd._fromErrorAndOperation(t,o,e,n):o})}async function tD(t,e,r=!1){const n=await Uf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Io._forOperation(t,"link",n)}async function rD(t,e,r=!1){const{auth:n}=t;if(di(n.app))return Promise.reject(So(n));const a="reauthenticate";try{const o=await Uf(t,Jb(n,a,e,t),r);dt(o.idToken,n,"internal-error");const l=Ex(o.idToken);dt(l,n,"internal-error");const{sub:u}=l;return dt(t.uid===u,n,"user-mismatch"),Io._forOperation(t,a,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ts(n,"user-mismatch"),o}}async function nD(t,e,r=!1){if(di(t.app))return Promise.reject(So(t));const n="signIn",a=await Jb(t,n,e),o=await Io._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}function aD(t,e,r,n){return kn(t).onIdTokenChanged(e,r,n)}function iD(t,e,r){return kn(t).beforeAuthStateChanged(e,r)}function sD(t,e,r,n){return kn(t).onAuthStateChanged(e,r,n)}function oD(t){return kn(t).signOut()}const Id="__sak";class Zb{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Id,"1"),this.storage.removeItem(Id),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const lD=1e3,cD=10;class e4 extends Zb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Wb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);PI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,cD):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},lD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}e4.type="LOCAL";const uD=e4;class t4 extends Zb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}t4.type="SESSION";const r4=t4;function fD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class pm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new pm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,l=this.handlersMap[a];if(!l?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async d=>d(r.origin,o)),h=await fD(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pm.receivers=[];function Ax(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class hD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,l;return new Promise((u,h)=>{const d=Ax("",20);a.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(v){const _=v;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(_.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function Gi(){return window}function dD(t){Gi().location.href=t}function n4(){return typeof Gi().WorkerGlobalScope<"u"&&typeof Gi().importScripts=="function"}async function mD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function pD(){return navigator?.serviceWorker?.controller||null}function gD(){return n4()?self:null}const a4="firebaseLocalStorageDb",xD=1,Dd="firebaseLocalStorage",i4="fbase_key";class f0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function gm(t,e){return t.transaction([Dd],e?"readwrite":"readonly").objectStore(Dd)}function vD(){const t=indexedDB.deleteDatabase(a4);return new f0(t).toPromise()}function Sg(){const t=indexedDB.open(a4,xD);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Dd,{keyPath:i4})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Dd)?e(n):(n.close(),await vD(),e(await Sg()))})})}async function uT(t,e,r){const n=gm(t,!0).put({[i4]:e,value:r});return new f0(n).toPromise()}async function _D(t,e){const r=gm(t,!1).get(e),n=await new f0(r).toPromise();return n===void 0?null:n.value}function fT(t,e){const r=gm(t,!0).delete(e);return new f0(r).toPromise()}const yD=800,wD=3;class s4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>wD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return n4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pm._getInstance(gD()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await mD(),!this.activeServiceWorker)return;this.sender=new hD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||pD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sg();return await uT(e,Id,"1"),await fT(e,Id),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>uT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>_D(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>fT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=gm(a,!1).getAll();return new f0(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}s4.type="LOCAL";const TD=s4;new c0(3e4,6e4);function ED(t,e){return e?ms(e):(dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class kx extends Yb{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Hc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Hc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function SD(t){return nD(t.auth,new kx(t),t.bypassAuthState)}function bD(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),rD(r,new kx(t),t.bypassAuthState)}async function AD(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),tD(r,new kx(t),t.bypassAuthState)}class o4{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SD;case"linkViaPopup":case"linkViaRedirect":return AD;case"reauthViaPopup":case"reauthViaRedirect":return bD;default:Ts(this.auth,"internal-error")}}resolve(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const kD=new c0(2e3,1e4);class Pc extends o4{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,Pc.currentPopupAction&&Pc.currentPopupAction.cancel(),Pc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return dt(e,this.auth,"internal-error"),e}async onExecution(){Es(this.filter.length===1,"Popup operations only handle one event");const e=Ax();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Hi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Hi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kD.get())};e()}}Pc.currentPopupAction=null;const CD="pendingRedirect",fd=new Map;class ND extends o4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=fd.get(this.auth._key());if(!e){try{const n=await RD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}fd.set(this.auth._key(),e)}return this.bypassAuthState||fd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RD(t,e){const r=OD(e),n=DD(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function ID(t,e){fd.set(t._key(),e)}function DD(t){return ms(t._redirectPersistence)}function OD(t){return ud(CD,t.config.apiKey,t.name)}async function FD(t,e,r=!1){if(di(t.app))return Promise.reject(So(t));const n=mm(t),a=ED(n,e),l=await new ND(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const MD=600*1e3;class LD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!PD(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!l4(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Hi(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MD&&this.cachedEventUids.clear(),this.cachedEventUids.has(hT(e))}saveEventToCache(e){this.cachedEventUids.add(hT(e)),this.lastProcessedEventTime=Date.now()}}function hT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function l4({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function PD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return l4(t);default:return!1}}async function VD(t,e={}){return fu(t,"GET","/v1/projects",e)}const BD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,UD=/^https?/;async function jD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await VD(t);for(const r of e)try{if(zD(r))return}catch{}Ts(t,"unauthorized-domain")}function zD(t){const e=Tg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!UD.test(r))return!1;if(BD.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const HD=new c0(3e4,6e4);function dT(){const t=Gi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function GD(t){return new Promise((e,r)=>{function n(){dT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dT(),r(Hi(t,"network-request-failed"))},timeout:HD.get()})}if(Gi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Gi().gapi?.load)n();else{const a=XI("iframefcb");return Gi()[a]=()=>{gapi.load?n():r(Hi(t,"network-request-failed"))},GI(`${qI()}?onload=${a}`).catch(o=>r(o))}}).catch(e=>{throw hd=null,e})}let hd=null;function qD(t){return hd=hd||GD(t),hd}const XD=new c0(5e3,15e3),WD="__/auth/iframe",KD="emulator/auth/iframe",$D={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},YD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function QD(t){const e=t.config;dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Tx(e,KD):`https://${t.config.authDomain}/${WD}`,n={apiKey:e.apiKey,appName:t.name,v:su},a=YD.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${r0(n).slice(1)}`}async function JD(t){const e=await qD(t),r=Gi().gapi;return dt(r,t,"internal-error"),e.open({where:document.body,url:QD(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$D,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const l=Hi(t,"network-request-failed"),u=Gi().setTimeout(()=>{o(l)},XD.get());function h(){Gi().clearTimeout(u),a(n)}n.ping(h).then(h,()=>{o(l)})}))}const ZD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},e8=500,t8=600,r8="_blank",n8="http://localhost";class mT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function a8(t,e,r,n=e8,a=t8){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...ZD,width:n.toString(),height:a.toString(),top:o,left:l},d=Hn().toLowerCase();r&&(u=zb(d)?r8:r),Ub(d)&&(e=e||n8,h.scrollbars="yes");const p=Object.entries(h).reduce((_,[w,S])=>`${_}${w}=${S},`,"");if(LI(d)&&u!=="_self")return i8(e||"",u),new mT(null);const v=window.open(e||"",u,p);dt(v,t,"popup-blocked");try{v.focus()}catch{}return new mT(v)}function i8(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const s8="__/auth/handler",o8="emulator/auth/handler",l8=encodeURIComponent("fac");async function pT(t,e,r,n,a,o){dt(t.config.authDomain,t,"auth-domain-config-required"),dt(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:su,eventId:a};if(e instanceof Qb){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",KC(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries({}))l[p]=v}if(e instanceof u0){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(l.scopes=p.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await t._getAppCheckToken(),d=h?`#${l8}=${encodeURIComponent(h)}`:"";return`${c8(t)}?${r0(u).slice(1)}${d}`}function c8({config:t}){return t.emulator?Tx(t,o8):`https://${t.authDomain}/${s8}`}const Pp="webStorageSupport";class u8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=r4,this._completeRedirectFn=FD,this._overrideRedirectResult=ID}async _openPopup(e,r,n,a){Es(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await pT(e,r,n,Tg(),a);return a8(e,o,Ax())}async _openRedirect(e,r,n,a){await this._originValidation(e);const o=await pT(e,r,n,Tg(),a);return dD(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(Es(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await JD(e),n=new LD(e);return r.register("authEvent",a=>(dt(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Pp,{type:Pp},a=>{const o=a?.[0]?.[Pp];o!==void 0&&r(!!o),Ts(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=jD(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Wb()||jb()||Sx()}}const f8=u8;var gT="@firebase/auth",xT="1.12.0";class h8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function d8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function m8(t){Kc(new Al("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;dt(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Kb(t)},d=new zI(n,a,o,h);return KI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Kc(new Al("auth-internal",e=>{const r=mm(e.getProvider("auth").getImmediate());return(n=>new h8(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),yo(gT,xT,d8(t)),yo(gT,xT,"esm2020")}const p8=300,g8=GE("authIdTokenMaxAge")||p8;let vT=null;const x8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>g8)return;const a=r?.token;vT!==a&&(vT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function c4(t=$E()){const e=zg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=WI(t,{popupRedirectResolver:f8,persistence:[TD,uD,r4]}),n=GE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=x8(o.toString());iD(r,l,()=>l(r.currentUser)),aD(r,u=>l(u))}}const a=zE("auth");return a&&$I(r,`http://${a}`),r}function v8(){return document.getElementsByTagName("head")?.[0]??document}HI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=Hi("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",v8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});m8("Browser");const _8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),y8=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),_T=t=>{const e=y8(t);return e.charAt(0).toUpperCase()+e.slice(1)},u4=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),w8=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var T8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const E8=Be.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:l,...u},h)=>Be.createElement("svg",{ref:h,...T8,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:u4("lucide",a),...!o&&!w8(u)&&{"aria-hidden":"true"},...u},[...l.map(([d,p])=>Be.createElement(d,p)),...Array.isArray(o)?o:[o]]));const ct=(t,e)=>{const r=Be.forwardRef(({className:n,...a},o)=>Be.createElement(E8,{ref:o,iconNode:e,className:u4(`lucide-${_8(_T(t))}`,`lucide-${t}`,n),...a}));return r.displayName=_T(t),r};const S8=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],b8=ct("archive",S8);const A8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],k8=ct("arrow-right",A8);const C8=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Cx=ct("calendar",C8);const N8=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],f4=ct("chart-column",N8);const R8=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],I8=ct("chart-pie",R8);const D8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],h4=ct("check",D8);const O8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Nx=ct("chevron-down",O8);const F8=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],d4=ct("chevron-left",F8);const M8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],m4=ct("chevron-right",M8);const L8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],p4=ct("circle-alert",L8);const P8=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],V8=ct("circle-check-big",P8);const B8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],U8=ct("circle-check",B8);const j8=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],g4=ct("clipboard-list",j8);const z8=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],H8=ct("clipboard",z8);const G8=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],q8=ct("clock",G8);const X8=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],W8=ct("cloud-upload",X8);const K8=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],$8=ct("cloud",K8);const Y8=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],x4=ct("copy",Y8);const Q8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],bg=ct("download",Q8);const J8=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Z8=ct("eye-off",J8);const eO=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tO=ct("eye",eO);const rO=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],nO=ct("facebook",rO);const aO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],v4=ct("file-spreadsheet",aO);const iO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],sO=ct("file-up",iO);const oO=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],lO=ct("list",oO);const cO=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],yT=ct("loader-circle",cO);const uO=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],fO=ct("log-out",uO);const hO=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],dO=ct("monitor",hO);const mO=[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],pO=ct("package-check",mO);const gO=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ag=ct("pen-line",gO);const xO=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],vO=ct("phone",xO);const _O=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],yO=ct("pin-off",_O);const wO=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],wT=ct("pin",wO);const TO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Od=ct("plus",TO);const EO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],SO=ct("refresh-cw",EO);const bO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],kg=ct("search",bO);const AO=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Rx=ct("settings",AO);const kO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],_4=ct("shield-check",kO);const CO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],NO=ct("shield",CO);const RO=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],IO=ct("shopping-cart",RO);const DO=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],OO=ct("smartphone",DO);const FO=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Il=ct("trash-2",FO);const MO=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],LO=ct("trending-down",MO);const PO=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],VO=ct("trending-up",PO);const BO=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],y4=ct("triangle-alert",BO);const UO=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],TT=ct("truck",UO);const jO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],zO=ct("upload",jO);const HO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],GO=ct("user",HO);const qO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],xm=ct("x",qO),XO={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},w4=n0(XO),hl=c4(w4),ET=cm(w4),WO=typeof __app_id<"u"?__app_id:"kho-suon-muoi-official-system-v1",ST=({isLeft:t})=>y.jsxs("svg",{className:`absolute inset-0 w-full h-full pointer-events-none z-10 ${t?"":"scale-x-[-1]"}`,viewBox:"0 0 400 600",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",style:{opacity:1},children:[y.jsxs("defs",{children:[y.jsxs("linearGradient",{id:"flow-grad-orange",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[y.jsx("stop",{offset:"0%",stopColor:"#ff5e00",stopOpacity:"0"}),y.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"1"}),y.jsx("stop",{offset:"100%",stopColor:"#ff5e00",stopOpacity:"0"})]}),y.jsxs("linearGradient",{id:"flow-grad-cyan",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[y.jsx("stop",{offset:"0%",stopColor:"#00f2ff",stopOpacity:"0"}),y.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"1"}),y.jsx("stop",{offset:"100%",stopColor:"#00f2ff",stopOpacity:"0"})]}),y.jsxs("linearGradient",{id:"flow-grad-purple",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[y.jsx("stop",{offset:"0%",stopColor:"#d400ff",stopOpacity:"0"}),y.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"1"}),y.jsx("stop",{offset:"100%",stopColor:"#d400ff",stopOpacity:"0"})]}),y.jsxs("filter",{id:"glow-circuit",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[y.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),y.jsxs("feMerge",{children:[y.jsx("feMergeNode",{in:"coloredBlur"}),y.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),y.jsxs("filter",{id:"static-glow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[y.jsx("feGaussianBlur",{stdDeviation:"0.5",result:"blur"}),y.jsx("feFlood",{floodColor:"#555",result:"color"}),y.jsx("feComposite",{in:"color",in2:"blur",operator:"in",result:"coloredBlur"}),y.jsxs("feMerge",{children:[y.jsx("feMergeNode",{in:"coloredBlur"}),y.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),y.jsx("pattern",{id:"grid-dots",x:"0",y:"0",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:y.jsx("rect",{x:"0",y:"0",width:"1.5",height:"1.5",fill:"#333",opacity:"0.8"})})]}),y.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid-dots)"}),y.jsxs("g",{stroke:"#444",strokeWidth:"2",fill:"none",opacity:"0.7",filter:"url(#static-glow)",strokeLinecap:"round",strokeLinejoin:"round",children:[y.jsx("path",{d:"M20 0 V 40 L 40 60 H 60 L 70 50 L 80 60 L 90 50 L 100 60 L 110 50 L 120 60 H 150 L 200 110 V 200 L 250 250 H 400"}),y.jsx("path",{d:"M0 150 H 30 L 80 200 H 120 L 150 230 H 400"}),y.jsx("path",{d:"M0 160 H 25 L 75 210 H 115 L 145 240 H 400"}),y.jsx("path",{d:"M0 300 H 50 L 80 270 H 120 L 150 300 H 200 L 230 330 H 280 L 310 300 H 400",strokeWidth:"3"}),y.jsx("path",{d:"M50 600 V 550 L 100 500 H 150 L 200 450 V 400 L 250 350 H 400"}),y.jsx("path",{d:"M180 0 V 50 L 150 80 H 100"}),y.jsx("path",{d:"M350 0 V 100 L 300 150 H 250"}),y.jsx("path",{d:"M0 450 H 40 L 80 490 V 550"}),y.jsx("path",{d:"M350 600 V 500 L 320 470 H 280"}),y.jsx("path",{d:"M200 500 H 220 L 225 495 L 230 505 L 235 495 L 240 505 L 245 500 H 280 L 320 460"})]}),y.jsxs("g",{filter:"url(#glow-circuit)",children:[y.jsxs("g",{fill:"#ff5e00",children:[y.jsx("circle",{cx:"200",cy:"110",r:"4"}),y.jsx("rect",{x:"76",y:"266",width:"8",height:"8",transform:"rotate(45 80 270)"}),y.jsx("circle",{cx:"200",cy:"450",r:"4"}),y.jsx("circle",{cx:"10",cy:"290",r:"2.5"})," ",y.jsx("circle",{cx:"10",cy:"300",r:"2.5"})," ",y.jsx("circle",{cx:"10",cy:"310",r:"2.5"})]}),y.jsxs("g",{fill:"#00f2ff",children:[y.jsx("circle",{cx:"150",cy:"230",r:"3"}),y.jsx("circle",{cx:"100",cy:"500",r:"4"}),y.jsx("circle",{cx:"390",cy:"290",r:"2.5"})," ",y.jsx("circle",{cx:"390",cy:"300",r:"2.5"})," ",y.jsx("circle",{cx:"390",cy:"310",r:"2.5"}),y.jsx("circle",{cx:"250",cy:"250",r:"3"})]}),y.jsxs("g",{fill:"#d400ff",children:[y.jsx("circle",{cx:"145",cy:"240",r:"3"}),y.jsx("rect",{x:"226",y:"326",width:"8",height:"8",transform:"rotate(45 230 330)"})]})]}),y.jsxs("g",{strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow-circuit)",children:[y.jsx("path",{d:"M20 0 V 40 L 40 60 H 60 L 70 50 L 80 60 L 90 50 L 100 60 L 110 50 L 120 60 H 150 L 200 110 V 200 L 250 250 H 400",stroke:"url(#flow-grad-orange)",className:"circuit-flow-complex-slow"}),y.jsx("path",{d:"M0 150 H 30 L 80 200 H 120 L 150 230 H 400",stroke:"url(#flow-grad-cyan)",className:"circuit-flow-complex-medium delay-1"}),y.jsx("path",{d:"M0 160 H 25 L 75 210 H 115 L 145 240 H 400",stroke:"url(#flow-grad-purple)",className:"circuit-flow-complex-medium delay-2"}),y.jsx("path",{d:"M0 300 H 50 L 80 270 H 120 L 150 300 H 200 L 230 330 H 280 L 310 300 H 400",stroke:"url(#flow-grad-orange)",className:"circuit-flow-complex-fast"}),y.jsx("path",{d:"M50 600 V 550 L 100 500 H 150 L 200 450 V 400 L 250 350 H 400",stroke:"url(#flow-grad-cyan)",className:"circuit-flow-complex-slow delay-1"}),y.jsx("path",{d:"M180 0 V 50 L 150 80 H 100",stroke:"url(#flow-grad-purple)",className:"circuit-flow-fast"}),y.jsx("path",{d:"M350 0 V 100 L 300 150 H 250",stroke:"url(#flow-grad-cyan)",className:"circuit-flow-medium delay-2"}),y.jsx("path",{d:"M200 500 H 220 L 225 495 L 230 505 L 235 495 L 240 505 L 245 500 H 280 L 320 460",stroke:"url(#flow-grad-orange)",className:"circuit-flow-medium"})]})]}),KO=({onComplete:t=()=>console.log("Login Success"),onLogoClick:e=()=>console.log("Logo Clicked"),onLogout:r=()=>console.log("Logged out"),onNavigate:n,currentView:a,isFinished:o=!1,setUsername:l=h=>console.log("Username:",h),setExpiryDate:u=h=>console.log("Expiry:",h)})=>{const[h,d]=Be.useState(""),[p,v]=Be.useState(""),[_,w]=Be.useState(!1),[S,E]=Be.useState(""),[A,L]=Be.useState(!1),[U,N]=Be.useState(null),[Q,re]=Be.useState(!1),[ee,k]=Be.useState(0),I=Be.useRef(null);Be.useEffect(()=>{if((async()=>{if(hl)try{await eD(hl)}catch(ie){console.error("Auth failed:",ie),w(!0),E("Li kt ni h thng")}})(),hl){const ie=sD(hl,N);return()=>ie()}},[]),Be.useEffect(()=>{!o&&I.current&&I.current.focus()},[o]);const R=()=>{o&&(re(!Q),e())},O=async()=>{try{hl&&await oD(hl),r&&r(),re(!1),window.location.reload()}catch(ve){console.error("Li ng xut:",ve),window.location.reload()}},F=(ve,ie)=>{k(1),setTimeout(()=>k(2),500),setTimeout(()=>k(3),1e3),setTimeout(()=>k(4),1100),setTimeout(()=>{k(5),l(ve),u(ie),t()},2e3)},D=async ve=>{ve.preventDefault();const ie=h.trim(),Ce=p.trim();if(!U&&hl){w(!0),E("ang kt ni...");return}if(!ie||!Ce){w(!0),E("Vui lng nhp thng tin."),setTimeout(()=>w(!1),2e3);return}L(!0),w(!1),E("");try{if(!ET)throw new Error("Database Offline");const K=Ln(ET,"artifacts",WO,"public","data","license_keys",ie),M=await xI(K);if(M.exists()){const q=M.data();if(String(q.password||"").trim()!==Ce)throw new Error("MT KHU KHNG NG");const J=new Date;if(q.expiryDate){const le=new Date(q.expiryDate);if(J>le)throw new Error("TI KHON HT HN")}if(q.status&&q.status!=="active")throw new Error("TI KHON B KHA");F(ie,q.expiryDate)}else throw new Error("TI KHON KHNG TN TI")}catch(K){L(!1),w(!0),E(K.message||"LI KT NI"),setTimeout(()=>w(!1),2e3)}},V=o?"50px":"220px",Te=_?"#ff0033":ee>0?"#ff5e00":"#f59e0b",oe=ee>=3?"open":"",Y=ee>=4?"open":"",ne=ee>=1&&ee<3?"energized":"";return y.jsxs("div",{className:`fixed inset-0 z-50 overflow-hidden ${o?"pointer-events-none":"pointer-events-auto"} ${_?"animate-shake-glitch":""}`,children:[y.jsx("style",{children:`
                /* --- CSS FIX LI AUTOFILL B TRNG --- */
                input:-webkit-autofill,
                input:-webkit-autofill:hover, 
                input:-webkit-autofill:focus, 
                input:-webkit-autofill:active {
                    -webkit-box-shadow: 0 0 0 30px black inset !important;
                    -webkit-text-fill-color: white !important;
                    transition: background-color 5000s ease-in-out 0s;
                }

                .metal-bg { background-color: #050505; background-image: linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111), linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111), radial-gradient(circle at 50% 50%, #1a1a1a, #000); background-position: 0 0, 10px 10px, 0 0; background-size: 20px 20px, 20px 20px, 100% 100%; box-shadow: inset 0 0 100px #000; }
                .inner-metal-bg { background: repeating-linear-gradient(-45deg, #151515, #151515 10px, #111 10px, #111 20px); box-shadow: inset 0 0 50px #000; }
                @keyframes circuit-loop { from { stroke-dashoffset: 1200; } to { stroke-dashoffset: 0; } }
                .circuit-flow-complex-fast { stroke-dasharray: 150 1050; animation: circuit-loop 5s linear infinite; }
                .circuit-flow-complex-medium { stroke-dasharray: 200 1000; animation: circuit-loop 7s linear infinite; }
                .circuit-flow-complex-slow { stroke-dasharray: 250 950; animation: circuit-loop 10s linear infinite; }
                .circuit-flow-fast { stroke-dasharray: 100 500; animation: circuit-loop 6s linear infinite; }
                .circuit-flow-medium { stroke-dasharray: 120 480; animation: circuit-loop 8s linear infinite; }
                .delay-1 { animation-delay: 2s; } .delay-2 { animation-delay: 4s; }
                @keyframes spin-rev { from { transform: rotate(360deg); } to { transform: rotate(0deg); } }
                @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
                .animate-spin-slow { animation: spin-slow 8s linear infinite; }
                .animate-spin-slow-reverse { animation: spin-rev 12s linear infinite; }
                .door-panel { position: absolute; top: 0; bottom: 0; width: 50%; transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); z-index: 40; display: flex; align-items: center; justify-content: center; border-top: 5px solid #222; border-bottom: 5px solid #222; overflow: hidden; }
                .door-left { left: 0; border-right: 4px solid #333; -webkit-mask-image: radial-gradient(circle at 100% 50%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 100% 50%, transparent 115px, black 116px); }
                .door-left.energized::after { content: ''; position: absolute; top: 0; bottom: 0; right: 0; width: 4px; background: linear-gradient(to bottom, transparent 20%, #00f2ff 50%, transparent 80%); box-shadow: 0 0 15px #00f2ff; z-index: 60; opacity: 1; transition: all 0.5s ease; }
                .door-left::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 100% 50%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .door-right { right: 0; border-left: 4px solid #333; -webkit-mask-image: radial-gradient(circle at 0% 50%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 0% 50%, transparent 115px, black 116px); }
                .door-right.energized::after { content: ''; position: absolute; top: 0; bottom: 0; left: 0; width: 4px; background: linear-gradient(to bottom, transparent 20%, #00f2ff 50%, transparent 80%); box-shadow: 0 0 15px #00f2ff; z-index: 60; opacity: 1; transition: all 0.5s ease; }
                .door-right::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 0% 50%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .door-left.open { transform: translateX(-100%); } .door-right.open { transform: translateX(100%); }
                .inner-door { position: absolute; left: 0; right: 0; height: 50%; z-index: 39; transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); display: flex; justify-content: center; align-items: flex-end; border-left: 5px solid #222; border-right: 5px solid #222; }
                .inner-door-top { top: 0; border-bottom: 2px solid #ff7b00; align-items: flex-end; -webkit-mask-image: radial-gradient(circle at 50% 100%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 50% 100%, transparent 115px, black 116px); }
                .inner-door-top::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 50% 100%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .inner-door-bottom { bottom: 0; border-top: 2px solid #ff7b00; align-items: flex-start; -webkit-mask-image: radial-gradient(circle at 50% 0%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 50% 0%, transparent 115px, black 116px); }
                .inner-door-bottom::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 50% 0%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .inner-door-top.open { transform: translateY(-100%); } .inner-door-bottom.open { transform: translateY(100%); }
                .clamp { position: absolute; width: 80px; height: 140px; background: #1a1a1a; border: 1px solid #444; z-index: 45; transition: all 0.6s cubic-bezier(0.68, -0.6, 0.32, 1.6); display: flex; flex-direction: column; align-items: center; justify-content: space-evenly; }
                .clamp-left { left: 50%; top: 50%; transform: translate(-100%, -50%); border-radius: 12px 0 0 12px; border-right: 4px solid #000; }
                .clamp-right { left: 50%; top: 50%; transform: translate(0, -50%); border-radius: 0 12px 12px 0; border-left: 4px solid #000; }
                .unlocked .clamp-left { transform: translate(-350px, -50%) scale(0.9); opacity: 0; }
                .unlocked .clamp-right { transform: translate(350px, -50%) scale(0.9); opacity: 0; }
                .data-overlay { background: linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px); background-size: 100% 3px; animation: data-scroll 5s linear infinite; pointer-events: none; }
                @keyframes data-scroll { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } }
                @keyframes shake-glitch { 0%, 100% { transform: translate(0); } 20% { transform: translate(-5px, 5px); } 80% { transform: translate(5px, 5px); } }
                .animate-shake-glitch { animation: shake-glitch 0.3s cubic-bezier(.36,.07,.19,.97) both; }
                @keyframes heat-pulse { 0%, 100% { box-shadow: 0 0 20px ${Te}40, inset 0 0 10px ${Te}20; border-color: ${Te}80; } 50% { box-shadow: 0 0 50px ${Te}, inset 0 0 30px ${Te}60; border-color: #ffaa00; } }
                .animate-heat-glow { animation: heat-pulse 2s infinite; }
                @keyframes spin-turbo { 0% { transform: rotate(0deg); } 100% { transform: rotate(720deg); } }
                .animate-spin-turbo { animation: spin-turbo 1s cubic-bezier(0.5, 0, 1, 1) forwards; transform-origin: 100px 100px; }
                .logo-container { transition: all 1.2s cubic-bezier(0.77, 0, 0.175, 1); }
                .logo-container.minimized { top: 15px; left: 20px; transform: translate(0, 0) scale(1) !important; }
            `}),y.jsxs("div",{className:`door-panel door-left metal-bg ${oe} ${ne}`,children:[y.jsx(ST,{isLeft:!0}),y.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-gradient-to-l from-orange-500/20 to-transparent z-20"}),y.jsxs("div",{className:"flex flex-col gap-6 opacity-30 w-full pl-20 z-20",children:[y.jsx("div",{className:"text-white/20 text-6xl font-black rotate-90 origin-left whitespace-nowrap",children:"SECTOR 09"}),y.jsx("div",{className:"w-full h-1 bg-white/10"})]})]}),y.jsxs("div",{className:`door-panel door-right metal-bg ${oe} ${ne}`,children:[y.jsx(ST,{isLeft:!1}),y.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-gradient-to-r from-orange-500/20 to-transparent z-20"}),y.jsxs("div",{className:"flex flex-col gap-6 opacity-30 w-full pr-20 items-end z-20",children:[y.jsx("div",{className:"text-white/20 text-6xl font-black -rotate-90 origin-right whitespace-nowrap",children:"ARMORY"}),y.jsx("div",{className:"w-full h-1 bg-white/10"})]})]}),y.jsxs("div",{className:`inner-door inner-door-top inner-metal-bg ${Y}`,children:[y.jsx("div",{className:"w-full h-4 bg-orange-500/50 blur-sm mb-2"}),y.jsx("div",{className:"absolute bottom-4 text-orange-500/50 font-mono tracking-[1em] text-xs",children:"SYSTEM INITIALIZING"})]}),y.jsxs("div",{className:`inner-door inner-door-bottom inner-metal-bg ${Y}`,children:[y.jsx("div",{className:"w-full h-4 bg-orange-500/50 blur-sm mt-2"}),y.jsx("div",{className:"absolute top-4 text-orange-500/50 font-mono tracking-[1em] text-xs",children:"DATA DECRYPTED"})]}),ee>=3&&!o&&y.jsx("div",{className:"absolute inset-0 z-30 data-overlay opacity-50"}),y.jsxs("div",{className:`absolute top-1/2 left-1/2 w-0 h-0 z-[45] flex items-center justify-center transition-opacity duration-300 ${ee>=3?"opacity-0":"opacity-100"}`,children:[y.jsx("div",{className:`clamp clamp-left ${ee>=2?"unlocked":""}`,children:y.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[y.jsx("div",{className:`w-2 h-2 rounded-full ${ee>=1?"bg-orange-500 animate-ping":"bg-red-900"}`}),y.jsx("div",{className:"w-1 h-8 bg-black/50"})]})}),y.jsx("div",{className:`clamp clamp-right ${ee>=2?"unlocked":""}`,children:y.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[y.jsx("div",{className:`w-2 h-2 rounded-full ${ee>=1?"bg-orange-500 animate-ping":"bg-red-900"}`}),y.jsx("div",{className:"w-1 h-8 bg-black/50"})]})})]}),y.jsx("div",{className:`absolute bottom-[15%] left-1/2 -translate-x-1/2 w-full flex justify-center flex-col items-center z-[50] transition-all duration-500 ${ee>0?"opacity-0 translate-y-10 pointer-events-none":"opacity-100"}`,children:y.jsxs("form",{onSubmit:D,className:"flex flex-col items-center gap-4",children:[y.jsx("div",{className:"relative group w-80",children:y.jsxs("div",{className:"relative flex items-center bg-black rounded border border-neutral-700 focus-within:border-orange-500 transition-colors shadow-2xl",children:[y.jsx(GO,{className:"w-5 h-5 text-neutral-500 ml-4"}),y.jsx("input",{ref:I,type:"text",value:h,onChange:ve=>d(ve.target.value),placeholder:"M TRUY CP",className:"bg-transparent border-none outline-none text-white placeholder-neutral-600 px-4 py-3.5 w-full font-mono tracking-[0.2em] text-center font-bold",autoComplete:"off"})]})}),y.jsx("div",{className:"relative group w-80",children:y.jsxs("div",{className:`relative flex items-center bg-black rounded border transition-colors shadow-2xl ${_?"border-red-600":"border-neutral-700 focus-within:border-orange-500"}`,children:[y.jsx(NO,{className:`w-5 h-5 ml-4 ${_?"text-red-500":"text-neutral-500"}`}),y.jsx("input",{type:"password",value:p,onChange:ve=>v(ve.target.value),placeholder:"MT KHU",className:`bg-transparent border-none outline-none px-4 py-3.5 w-full font-mono tracking-[0.2em] text-center font-bold ${_?"text-red-500 placeholder-red-800":"text-white placeholder-neutral-600"}`,autoComplete:"off"}),y.jsx("button",{type:"submit",disabled:A,className:"absolute right-1 p-2 transition-colors disabled:opacity-50 text-neutral-500 hover:text-white",children:y.jsx(k8,{className:"w-5 h-5"})})]})}),y.jsxs("div",{className:"h-6 mt-1",children:[A&&y.jsx("div",{className:"text-orange-500 text-xs font-mono animate-pulse tracking-[0.2em] bg-black/50 px-2 py-1 rounded",children:"ANG XC THC..."}),_&&y.jsxs("div",{className:"text-[#ff0033] text-xs font-bold font-mono flex items-center gap-2 animate-bounce tracking-widest uppercase bg-black/50 px-2 py-1 rounded",children:[y.jsx(p4,{className:"w-3 h-3"})," ",S]})]})]})}),y.jsx("div",{onClick:R,className:`logo-container fixed z-[60] flex items-center justify-center bg-[#0a0a0a] rounded-full 
                ${o?"minimized cursor-pointer hover:scale-110 border-2 pointer-events-auto":"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none border-4"}
                ${_?"animate-shake-glitch":""}
                animate-heat-glow
                `,style:{width:V,height:V,borderColor:Te},children:y.jsx("div",{className:"relative w-full h-full p-2 flex items-center justify-center overflow-hidden rounded-full",children:y.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full overflow-visible z-10",fill:"none",stroke:Te,strokeLinecap:"round",strokeLinejoin:"round",children:[y.jsx("circle",{cx:"100",cy:"100",r:"95",stroke:"#333",strokeWidth:"4"}),y.jsx("path",{d:"M100 5 L100 15 M100 185 L100 195 M5 100 L15 100 M185 100 L195 100",stroke:"#444",strokeWidth:"3"}),y.jsxs("g",{className:ee>=1?"animate-spin-turbo":"",style:{transformOrigin:"100px 100px"},children:[y.jsx("circle",{cx:"100",cy:"100",r:"85",stroke:"#444",strokeWidth:"2",strokeDasharray:"20 10"}),y.jsx("path",{d:"M100 20 L100 30 M170 100 L180 100 M100 170 L100 180 M20 100 L30 100",stroke:"#555",strokeWidth:"4"})]}),y.jsxs("g",{style:{transformOrigin:"100px 100px",animation:"spin-rev 12s linear infinite"},children:[y.jsx("circle",{cx:"100",cy:"100",r:"70",stroke:"#333",strokeWidth:"1",strokeDasharray:"5 5"}),y.jsx("path",{d:"M100 30 L110 40 L90 40 Z",fill:"#222",stroke:"none"}),y.jsx("path",{d:"M100 30 L110 40 L90 40 Z",fill:"#222",stroke:"none",transform:"rotate(120, 100, 100)"}),y.jsx("path",{d:"M100 30 L110 40 L90 40 Z",fill:"#222",stroke:"none",transform:"rotate(240, 100, 100)"})]}),y.jsxs("g",{style:{transformOrigin:"100px 100px",animation:"spin-slow 8s linear infinite"},children:[y.jsx("circle",{cx:"100",cy:"100",r:"50",stroke:Te,strokeWidth:"1",strokeDasharray:"2 4"}),[0,60,120,180,240,300].map(ve=>y.jsx("path",{d:"M100 55 L105 65 H95 Z",fill:Te,transform:`rotate(${ve}, 100, 100)`},ve))]}),y.jsxs("g",{style:{transformOrigin:"100px 100px",animation:"spin-rev 4s linear infinite"},children:[y.jsx("path",{d:"M100 65 L115 85 L85 85 Z",stroke:Te,strokeWidth:"2",fill:"none"}),y.jsx("path",{d:"M100 65 L115 85 L85 85 Z",stroke:Te,strokeWidth:"2",fill:"none",transform:"rotate(120, 100, 100)"}),y.jsx("path",{d:"M100 65 L115 85 L85 85 Z",stroke:Te,strokeWidth:"2",fill:"none",transform:"rotate(240, 100, 100)"})]}),y.jsx("circle",{cx:"100",cy:"100",r:"25",fill:Te,fillOpacity:"0.2"}),y.jsx("circle",{cx:"100",cy:"100",r:"15",fill:Te,className:"animate-pulse"})]})})}),o&&Q&&y.jsx("div",{className:"fixed top-[70px] left-[20px] z-[70] w-64 animate-in fade-in slide-in-from-top-5 duration-300 pointer-events-auto",children:y.jsxs("div",{className:"bg-black/95 border border-orange-500/50 rounded-lg p-2 shadow-[0_0_20px_rgba(255,94,0,0.3)] backdrop-blur-md",children:[y.jsxs("div",{className:"px-4 py-2 border-b border-white/10 mb-2 flex justify-between items-center",children:[y.jsx("span",{className:"text-[10px] text-orange-500 font-mono tracking-widest uppercase",children:"H THNG"}),y.jsx("button",{onClick:()=>re(!1),className:"text-gray-500 hover:text-white transition-colors font-mono text-xs",children:"[NG]"})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("button",{onClick:()=>{n&&n("inventory"),re(!1)},className:`group flex items-center gap-3 w-full px-4 py-3 text-left hover:bg-orange-500/10 rounded transition-colors ${a==="inventory"?"text-white bg-orange-500/20":"text-gray-300"}`,children:[y.jsx(g4,{className:"w-4 h-4 text-orange-500 group-hover:scale-110 transition-transform"}),y.jsx("span",{className:"font-mono text-sm tracking-wider",children:"KIM K KHO"})]}),y.jsxs("button",{onClick:()=>{n&&n("incoming"),re(!1)},className:`group flex items-center gap-3 w-full px-4 py-3 text-left hover:bg-orange-500/10 rounded transition-colors ${a==="incoming"?"text-white bg-orange-500/20":"text-gray-300"}`,children:[y.jsx(IO,{className:"w-4 h-4 text-orange-500 group-hover:scale-110 transition-transform"}),y.jsx("span",{className:"font-mono text-sm tracking-wider",children:"KIM T HNG"})]}),y.jsxs("button",{onClick:()=>{n&&n("forecast"),re(!1)},className:`group flex items-center gap-3 w-full px-4 py-3 text-left hover:bg-orange-500/10 rounded transition-colors ${a==="forecast"?"text-white bg-orange-500/20":"text-gray-300"}`,children:[y.jsx(VO,{className:"w-4 h-4 text-orange-500 group-hover:scale-110 transition-transform"}),y.jsx("span",{className:"font-mono text-sm tracking-wider",children:"D BO DOANH S"})]}),y.jsx("div",{className:"h-px bg-white/10 my-1"}),y.jsxs("button",{onClick:O,className:"group flex items-center gap-3 w-full px-4 py-3 text-left bg-red-900/20 hover:bg-red-600 rounded transition-all duration-300 text-red-400 hover:text-white border border-transparent hover:border-red-500",children:[y.jsx(fO,{className:"w-4 h-4 group-hover:rotate-180 transition-transform duration-500"}),y.jsx("span",{className:"font-mono text-sm tracking-wider font-bold",children:"NG XUT"})]})]})]})}),o&&y.jsx("div",{className:"absolute transition-all duration-1000 ease-in-out whitespace-nowrap z-[60] left-20 top-6 ml-4 opacity-100",children:y.jsxs("div",{className:"flex flex-col",children:[y.jsx("span",{className:"font-bold text-white font-mono tracking-widest text-lg drop-shadow-[0_0_5px_rgba(255,165,0,0.5)]",children:"KHO SN MI"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),y.jsx("span",{className:"text-[10px] text-orange-500 font-mono tracking-widest uppercase",children:a==="inventory"?"Inventory Online":a==="incoming"?"Orders Online":"Forecast Online"})]})]})})]})},$O={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},T4=n0($O);c4(T4);const Sa=cm(T4);var Fd={};Fd.version="0.18.5";var E4=1252,YO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ix={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Dx=function(t){YO.indexOf(t)!=-1&&(E4=Ix[0]=t)};function QO(){Dx(1252)}var pi=function(t){Dx(t)};function Ox(){pi(1200),QO()}function bT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function JO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function S4(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var gf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?JO(t.slice(2)):e==254&&r==255?S4(t.slice(2)):e==65279?t.slice(1):t},Gh=function(e){return String.fromCharCode(e)},AT=function(e){return String.fromCharCode(e)},jf,go="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zf(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),l=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),e+=go.charAt(o)+go.charAt(l)+go.charAt(u)+go.charAt(h);return e}function Ia(t){var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=go.indexOf(t.charAt(d++)),l=go.indexOf(t.charAt(d++)),r=o<<2|l>>4,e+=String.fromCharCode(r),u=go.indexOf(t.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=go.indexOf(t.charAt(d++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),As=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Do(t){return Tt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function kT(t){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ca=function(e){return Tt?As(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function vm(t){if(typeof ArrayBuffer>"u")return Ca(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Vo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ZO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Fx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Fx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var mn=Tt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:As(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function eF(t){for(var e=[],r=0,n=t.length+250,a=Do(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Do(65535),n=65530)}return e.push(a.slice(0,r)),mn(e)}var Zn=/\u0000/g,xf=/[\u0001-\u0006]/g;function Gc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function gi(t,e){var r=""+t;return r.length>=e?r:Cr("0",e-r.length)+r}function Mx(t,e){var r=""+t;return r.length>=e?r:Cr(" ",e-r.length)+r}function Md(t,e){var r=""+t;return r.length>=e?r:r+Cr(" ",e-r.length)}function tF(t,e){var r=""+Math.round(t);return r.length>=e?r:Cr("0",e-r.length)+r}function rF(t,e){var r=""+t;return r.length>=e?r:Cr("0",e-r.length)+r}var CT=Math.pow(2,32);function Nc(t,e){if(t>CT||t<-CT)return tF(t,e);var r=Math.round(t);return rF(r,e)}function Ld(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var NT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function nF(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},RT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},aF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Pd(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,l=1,u=0,h=1,d=0,p=0,v=Math.floor(a);d<e&&(v=Math.floor(a),u=v*l+o,p=v*d+h,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=o):(p=d,u=l)),!r)return[0,n*u,p];var _=Math.floor(n*u/p);return[_,n*u-_*p,p]}function _l(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=uF(h,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var b4=new Date(1899,11,31,0,0,0),iF=b4.getTime(),sF=new Date(1900,2,1,0,0,0);function A4(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=sF&&(r+=1440*60*1e3),(r-(iF+(t.getTimezoneOffset()-b4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Lx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function oF(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function lF(t){var e=t<0?12:11,r=Lx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function cF(t){var e=Lx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Hf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=lF(t):e===10?r=t.toFixed(10).substr(0,12):r=cF(t),Lx(oF(r.toUpperCase()))}function Dl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Hf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Qa(14,A4(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function uF(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function fF(t,e,r,n){var a="",o=0,l=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return Vp[r.m-1][1];case 5:return Vp[r.m-1][0];default:return Vp[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return NT[r.q][0];default:return NT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?gi(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=gi(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?gi(h,d):"";return p}function xo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var k4=/%/g;function hF(t,e,r){var n=e.replace(k4,""),a=e.length-n.length;return gs(t,n,r*Math.pow(10,2*a))+Cr("%",a)}function dF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return gs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function C4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+C4(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var N4=/# (\?+)( ?)\/( ?)(\d+)/;function mF(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),l=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(l===0?Cr(" ",t[1].length+1+t[4].length):Mx(l,t[1].length)+t[2]+"/"+t[3]+gi(u,t[4].length))}function pF(t,e,r){return r+(e===0?"":""+e)+Cr(" ",t[1].length+2+t[4].length)}var R4=/^#*0*\.([0#]+)/,I4=/\).*[0#]/,D4=/\(###\) ###\\?-####/;function Qn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function IT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function DT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function gF(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function xF(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ga(t,e,r){if(t.charCodeAt(0)===40&&!e.match(I4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ga("n",n,r):"("+Ga("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return dF(t,e,r);if(e.indexOf("%")!==-1)return hF(t,e,r);if(e.indexOf("E")!==-1)return C4(e,r);if(e.charCodeAt(0)===36)return"$"+Ga(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Nc(h,e.length);if(e.match(/^[#?]+$/))return a=Nc(r,0),a==="0"&&(a=""),a.length>e.length?a:Qn(e.substr(0,e.length-a.length))+a;if(o=e.match(N4))return mF(o,h,d);if(e.match(/^#+0+$/))return d+Nc(h,e.length-e.indexOf("0"));if(o=e.match(R4))return a=IT(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Qn(o[1])).replace(/\.$/,"."+Qn(o[1])).replace(/\.(\d*)$/,function(S,E){return"."+E+Cr("0",Qn(o[1]).length-E.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+IT(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+xo(Nc(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ga(t,e,-r):xo(""+(Math.floor(r)+gF(r,o[1].length)))+"."+gi(DT(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Ga(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Gc(Ga(t,e.replace(/[\\-]/g,""),r)),l=0,Gc(Gc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(D4))return a=Ga(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Pd(h,Math.pow(10,l)-1,!1),a=""+d,p=gs("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Md(u[2],l),p.length<o[4].length&&(p=Qn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Pd(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Mx(u[1],l)+o[2]+"/"+o[3]+Md(u[2],l):Cr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=Nc(r,0),e.length<=a.length?a:Qn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Qn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=DT(r,o[1].length),r<0?"-"+Ga(t,e,-r):xo(xF(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?gi(0,3-S.length):"")+S})+"."+gi(l,o[1].length);switch(e){case"###,##0.00":return Ga(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=xo(Nc(h,0));return w!=="0"?d+w:"";case"###,###.00":return Ga(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ga(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function vF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return gs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function _F(t,e,r){var n=e.replace(k4,""),a=e.length-n.length;return gs(t,n,r*Math.pow(10,2*a))+Cr("%",a)}function O4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+O4(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(I4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fi("n",n,r):"("+Fi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return vF(t,e,r);if(e.indexOf("%")!==-1)return _F(t,e,r);if(e.indexOf("E")!==-1)return O4(e,r);if(e.charCodeAt(0)===36)return"$"+Fi(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+gi(h,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Qn(e.substr(0,e.length-a.length))+a;if(o=e.match(N4))return pF(o,h,d);if(e.match(/^#+0+$/))return d+gi(h,e.length-e.indexOf("0"));if(o=e.match(R4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Qn(o[1])).replace(/\.$/,"."+Qn(o[1])),a=a.replace(/\.(\d*)$/,function(S,E){return"."+E+Cr("0",Qn(o[1]).length-E.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+xo(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fi(t,e,-r):xo(""+r)+"."+Cr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Fi(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Gc(Fi(t,e.replace(/[\\-]/g,""),r)),l=0,Gc(Gc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(D4))return a=Fi(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Pd(h,Math.pow(10,l)-1,!1),a=""+d,p=gs("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Md(u[2],l),p.length<o[4].length&&(p=Qn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Pd(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Mx(u[1],l)+o[2]+"/"+o[3]+Md(u[2],l):Cr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Qn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Qn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fi(t,e,-r):xo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?gi(0,3-S.length):"")+S})+"."+gi(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=xo(""+h);return w!=="0"?d+w:"";default:if(e.match(/\.[0#?]*$/))return Fi(t,e.slice(0,e.lastIndexOf(".")),r)+Qn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function gs(t,e,r){return(r|0)===r?Fi(t,e,r):Ga(t,e,r)}function yF(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var F4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function hu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ld(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(F4))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function wF(t,e,r,n){for(var a=[],o="",l=0,u="",h="t",d,p,v,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!Ld(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var w=t.charAt(++l),S=w==="("||w===")"?w:"t";a[a.length]={t:S,v:w},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=_l(e,r,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=_l(e,r),d==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var E={t:u,v:u};if(d==null&&(d=_l(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",l+=5,_="h"):(E.t="t",++l),d==null&&E.t==="T")return"";a[a.length]=E,h=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(F4)){if(d==null&&(d=_l(e,r),d==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",hu(t)||(a[a.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},h=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var A=0,L=0,U;for(l=a.length-1,h="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,h="h",A<1&&(A=1);break;case"s":(U=a[l].v.match(/\.0+$/))&&(L=Math.max(L,U[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":h=a[l].t;break;case"m":h==="s"&&(a[l].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&a[l].v.match(/[Hh]/)&&(A=1),A<2&&a[l].v.match(/[Mm]/)&&(A=2),A<3&&a[l].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var N="",Q;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=fF(a[l].t.charCodeAt(0),a[l].v,d,L),a[l].t="t";break;case"n":case"?":for(Q=l+1;a[Q]!=null&&((u=a[Q].t)==="?"||u==="D"||(u===" "||u==="t")&&a[Q+1]!=null&&(a[Q+1].t==="?"||a[Q+1].t==="t"&&a[Q+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[Q].v==="/"||a[Q].v===" "&&a[Q+1]!=null&&a[Q+1].t=="?"));)a[l].v+=a[Q].v,a[Q]={v:"",t:";"},++Q;N+=a[l].v,l=Q-1;break;case"G":a[l].t="t",a[l].v=Dl(e,r);break}var re="",ee,k;if(N.length>0){N.charCodeAt(0)==40?(ee=e<0&&N.charCodeAt(0)===45?-e:e,k=gs("n",N,ee)):(ee=e<0&&n>1?-e:e,k=gs("n",N,ee),ee<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),Q=k.length-1;var I=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){I=l;break}var R=a.length;if(I===a.length&&k.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(Q>=a[l].v.length-1?(Q-=a[l].v.length,a[l].v=k.substr(Q+1,a[l].v.length)):Q<0?a[l].v="":(a[l].v=k.substr(0,Q+1),Q=-1),a[l].t="t",R=l);Q>=0&&R<a.length&&(a[R].v=k.substr(0,Q+1)+a[R].v)}else if(I!==a.length&&k.indexOf("E")===-1){for(Q=k.indexOf(".")-1,l=I;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")-1:a[l].v.length-1,re=a[l].v.substr(p+1);p>=0;--p)Q>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(re=k.charAt(Q--)+re);a[l].v=re,a[l].t="t",R=l}for(Q>=0&&R<a.length&&(a[R].v=k.substr(0,Q+1)+a[R].v),Q=k.indexOf(".")+1,l=I;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==I)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")+1:0,re=a[l].v.substr(0,p);p<a[l].v.length;++p)Q<k.length&&(re+=k.charAt(Q++));a[l].v=re,a[l].t="t",R=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(ee=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=gs(a[l].t,a[l].v,ee),a[l].t="t");var O="";for(l=0;l!==a.length;++l)a[l]!=null&&(O+=a[l].v);return O}var OT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function FT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function TF(t,e){var r=yF(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(OT),u=r[1].match(OT);return FT(e,l)?[n,r[0]]:FT(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,o]}function Qa(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:st)[t],n==null&&(n=r.table&&r.table[RT[t]]||st[RT[t]]),n==null&&(n=aF[t]||"General");break}if(Ld(n,0))return Dl(e,r);e instanceof Date&&(e=A4(e,r.date1904));var a=TF(n,e);if(Ld(a[1]))return Dl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return wF(a[1],e,r,a[0])}function xs(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(st[r]==null){e<0&&(e=r);continue}if(st[r]==t){e=r;break}}e<0&&(e=391)}return st[e]=t,e}function _m(t){for(var e=0;e!=392;++e)t[e]!==void 0&&xs(t[e],e)}function du(){st=nF()}var EF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},M4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function SF(t){var e=typeof t=="number"?st[t]:t;return e=e.replace(M4,"(\\d+)"),new RegExp("^"+e+"$")}function bF(t,e,r){var n=-1,a=-1,o=-1,l=-1,u=-1,h=-1;(e.match(M4)||[]).forEach(function(v,_){var w=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=w;break;case"d":o=w;break;case"h":l=w;break;case"s":h=w;break;case"m":l>=0?u=w:a=w;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&u==-1&&h==-1?d:n==-1&&a==-1&&o==-1?p:d+"T"+p}var AF=(function(){var t={};t.version="1.2.0";function e(){for(var k=0,I=new Array(256),R=0;R!=256;++R)k=R,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,I[R]=k;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(k){var I=0,R=0,O=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)F[O]=k[O];for(O=0;O!=256;++O)for(R=k[O],I=256+O;I<4096;I+=256)R=F[I]=R>>>8^k[R&255];var D=[];for(O=1;O!=16;++O)D[O-1]=typeof Int32Array<"u"?F.subarray(O*256,O*256+256):F.slice(O*256,O*256+256);return D}var a=n(r),o=a[0],l=a[1],u=a[2],h=a[3],d=a[4],p=a[5],v=a[6],_=a[7],w=a[8],S=a[9],E=a[10],A=a[11],L=a[12],U=a[13],N=a[14];function Q(k,I){for(var R=I^-1,O=0,F=k.length;O<F;)R=R>>>8^r[(R^k.charCodeAt(O++))&255];return~R}function re(k,I){for(var R=I^-1,O=k.length-15,F=0;F<O;)R=N[k[F++]^R&255]^U[k[F++]^R>>8&255]^L[k[F++]^R>>16&255]^A[k[F++]^R>>>24]^E[k[F++]]^S[k[F++]]^w[k[F++]]^_[k[F++]]^v[k[F++]]^p[k[F++]]^d[k[F++]]^h[k[F++]]^u[k[F++]]^l[k[F++]]^o[k[F++]]^r[k[F++]];for(O+=15;F<O;)R=R>>>8^r[(R^k[F++])&255];return~R}function ee(k,I){for(var R=I^-1,O=0,F=k.length,D=0,V=0;O<F;)D=k.charCodeAt(O++),D<128?R=R>>>8^r[(R^D)&255]:D<2048?(R=R>>>8^r[(R^(192|D>>6&31))&255],R=R>>>8^r[(R^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,V=k.charCodeAt(O++)&1023,R=R>>>8^r[(R^(240|D>>8&7))&255],R=R>>>8^r[(R^(128|D>>2&63))&255],R=R>>>8^r[(R^(128|V>>6&15|(D&3)<<4))&255],R=R>>>8^r[(R^(128|V&63))&255]):(R=R>>>8^r[(R^(224|D>>12&15))&255],R=R>>>8^r[(R^(128|D>>6&63))&255],R=R>>>8^r[(R^(128|D&63))&255]);return~R}return t.table=r,t.bstr=Q,t.buf=re,t.str=ee,t})(),tt=(function(){var e={};e.version="1.2.1";function r(P,W){for(var j=P.split("/"),H=W.split("/"),X=0,Z=0,he=Math.min(j.length,H.length);X<he;++X){if(Z=j[X].length-H[X].length)return Z;if(j[X]!=H[X])return j[X]<H[X]?-1:1}return j.length-H.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var W=P.lastIndexOf("/");return W===-1?P:P.slice(0,W+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var W=P.lastIndexOf("/");return W===-1?P:P.slice(W+1)}function o(P,W){typeof W=="string"&&(W=new Date(W));var j=W.getHours();j=j<<6|W.getMinutes(),j=j<<5|W.getSeconds()>>>1,P.write_shift(2,j);var H=W.getFullYear()-1980;H=H<<4|W.getMonth()+1,H=H<<5|W.getDate(),P.write_shift(2,H)}function l(P){var W=P.read_shift(2)&65535,j=P.read_shift(2)&65535,H=new Date,X=j&31;j>>>=5;var Z=j&15;j>>>=4,H.setMilliseconds(0),H.setFullYear(j+1980),H.setMonth(Z-1),H.setDate(X);var he=W&31;W>>>=5;var Ae=W&63;return W>>>=6,H.setHours(W),H.setMinutes(Ae),H.setSeconds(he<<1),H}function u(P){Sn(P,0);for(var W={},j=0;P.l<=P.length-4;){var H=P.read_shift(2),X=P.read_shift(2),Z=P.l+X,he={};H===21589&&(j=P.read_shift(1),j&1&&(he.mtime=P.read_shift(4)),X>5&&(j&2&&(he.atime=P.read_shift(4)),j&4&&(he.ctime=P.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3))),P.l=Z,W[H]=he}return W}var h;function d(){return h||(h={})}function p(P,W){if(P[0]==80&&P[1]==75)return ln(P,W);if((P[0]|32)==109&&(P[1]|32)==105)return ei(P,W);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var j=3,H=512,X=0,Z=0,he=0,Ae=0,de=0,ge=[],pe=P.slice(0,512);Sn(pe,0);var Pe=v(pe);switch(j=Pe[0],j){case 3:H=512;break;case 4:H=4096;break;case 0:if(Pe[1]==0)return ln(P,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}H!==512&&(pe=P.slice(0,H),Sn(pe,28));var Ve=P.slice(0,H);_(pe,j);var qe=pe.read_shift(4,"i");if(j===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);pe.l+=4,he=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Ae=pe.read_shift(4,"i"),X=pe.read_shift(4,"i"),de=pe.read_shift(4,"i"),Z=pe.read_shift(4,"i");for(var Le=-1,Ge=0;Ge<109&&(Le=pe.read_shift(4,"i"),!(Le<0));++Ge)ge[Ge]=Le;var Ye=w(P,H);A(de,Z,Ye,H,ge);var Yt=U(Ye,he,ge,H);Yt[he].name="!Directory",X>0&&Ae!==V&&(Yt[Ae].name="!MiniFAT"),Yt[ge[0]].name="!FAT",Yt.fat_addrs=ge,Yt.ssz=H;var Qt={},ur=[],Rn=[],ri=[];N(he,Yt,Ye,ur,X,Qt,Rn,Ae),S(Rn,ri,ur),ur.shift();var ni={FileIndex:Rn,FullPaths:ri};return W&&W.raw&&(ni.raw={header:Ve,sectors:Ye}),ni}function v(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(Te,"Header Signature: "),P.l+=16;var W=P.read_shift(2,"u");return[P.read_shift(2,"u"),W]}function _(P,W){var j=9;switch(P.l+=2,j=P.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function w(P,W){for(var j=Math.ceil(P.length/W)-1,H=[],X=1;X<j;++X)H[X-1]=P.slice(X*W,(X+1)*W);return H[j-1]=P.slice(j*W),H}function S(P,W,j){for(var H=0,X=0,Z=0,he=0,Ae=0,de=j.length,ge=[],pe=[];H<de;++H)ge[H]=pe[H]=H,W[H]=j[H];for(;Ae<pe.length;++Ae)H=pe[Ae],X=P[H].L,Z=P[H].R,he=P[H].C,ge[H]===H&&(X!==-1&&ge[X]!==X&&(ge[H]=ge[X]),Z!==-1&&ge[Z]!==Z&&(ge[H]=ge[Z])),he!==-1&&(ge[he]=H),X!==-1&&H!=ge[H]&&(ge[X]=ge[H],pe.lastIndexOf(X)<Ae&&pe.push(X)),Z!==-1&&H!=ge[H]&&(ge[Z]=ge[H],pe.lastIndexOf(Z)<Ae&&pe.push(Z));for(H=1;H<de;++H)ge[H]===H&&(Z!==-1&&ge[Z]!==Z?ge[H]=ge[Z]:X!==-1&&ge[X]!==X&&(ge[H]=ge[X]));for(H=1;H<de;++H)if(P[H].type!==0){if(Ae=H,Ae!=ge[Ae])do Ae=ge[Ae],W[H]=W[Ae]+"/"+W[H];while(Ae!==0&&ge[Ae]!==-1&&Ae!=ge[Ae]);ge[H]=-1}for(W[0]+="/",H=1;H<de;++H)P[H].type!==2&&(W[H]+="/")}function E(P,W,j){for(var H=P.start,X=P.size,Z=[],he=H;j&&X>0&&he>=0;)Z.push(W.slice(he*D,he*D+D)),X-=D,he=pl(j,he*4);return Z.length===0?Se(0):mn(Z).slice(0,P.size)}function A(P,W,j,H,X){var Z=V;if(P===V){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var he=j[P],Ae=(H>>>2)-1;if(!he)return;for(var de=0;de<Ae&&(Z=pl(he,de*4))!==V;++de)X.push(Z);A(pl(he,H-4),W-1,j,H,X)}}function L(P,W,j,H,X){var Z=[],he=[];X||(X=[]);var Ae=H-1,de=0,ge=0;for(de=W;de>=0;){X[de]=!0,Z[Z.length]=de,he.push(P[de]);var pe=j[Math.floor(de*4/H)];if(ge=de*4&Ae,H<4+ge)throw new Error("FAT boundary crossed: "+de+" 4 "+H);if(!P[pe])break;de=pl(P[pe],ge)}return{nodes:Z,data:XT([he])}}function U(P,W,j,H){var X=P.length,Z=[],he=[],Ae=[],de=[],ge=H-1,pe=0,Pe=0,Ve=0,qe=0;for(pe=0;pe<X;++pe)if(Ae=[],Ve=pe+W,Ve>=X&&(Ve-=X),!he[Ve]){de=[];var Le=[];for(Pe=Ve;Pe>=0;){Le[Pe]=!0,he[Pe]=!0,Ae[Ae.length]=Pe,de.push(P[Pe]);var Ge=j[Math.floor(Pe*4/H)];if(qe=Pe*4&ge,H<4+qe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+H);if(!P[Ge]||(Pe=pl(P[Ge],qe),Le[Pe]))break}Z[Ve]={nodes:Ae,data:XT([de])}}return Z}function N(P,W,j,H,X,Z,he,Ae){for(var de=0,ge=H.length?2:0,pe=W[P].data,Pe=0,Ve=0,qe;Pe<pe.length;Pe+=128){var Le=pe.slice(Pe,Pe+128);Sn(Le,64),Ve=Le.read_shift(2),qe=Hx(Le,0,Ve-ge),H.push(qe);var Ge={name:qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},Ye=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ye!==0&&(Ge.ct=Q(Le,Le.l-8));var Yt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Yt!==0&&(Ge.mt=Q(Le,Le.l-8)),Ge.start=Le.read_shift(4,"i"),Ge.size=Le.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=V,Ge.name=""),Ge.type===5?(de=Ge.start,X>0&&de!==V&&(W[de].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",W[Ge.start]===void 0&&(W[Ge.start]=L(j,Ge.start,W.fat_addrs,W.ssz)),W[Ge.start].name=Ge.name,Ge.content=W[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:de!==V&&Ge.start!==V&&W[de]&&(Ge.content=E(Ge,W[de].data,(W[Ae]||{}).data))),Ge.content&&Sn(Ge.content,0),Z[qe]=Ge,he.push(Ge)}}function Q(P,W){return new Date((ka(P,W+4)/1e7*Math.pow(2,32)+ka(P,W)/1e7-11644473600)*1e3)}function re(P,W){return d(),p(h.readFileSync(P),W)}function ee(P,W){var j=W&&W.type;switch(j||Tt&&Buffer.isBuffer(P)&&(j="buffer"),j||"base64"){case"file":return re(P,W);case"base64":return p(Ca(Ia(P)),W);case"binary":return p(Ca(P),W)}return p(P,W)}function k(P,W){var j=W||{},H=j.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=H+"/",P.FileIndex[0]={name:H,type:5}),j.CLSID&&(P.FileIndex[0].clsid=j.CLSID),I(P)}function I(P){var W="Sh33tJ5";if(!tt.find(P,"/"+W)){var j=Se(4);j[0]=55,j[1]=j[3]=50,j[2]=54,P.FileIndex.push({name:W,type:2,content:j,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+W),R(P)}}function R(P,W){k(P);for(var j=!1,H=!1,X=P.FullPaths.length-1;X>=0;--X){var Z=P.FileIndex[X];switch(Z.type){case 0:H?j=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Z.R*Z.L*Z.C)&&(j=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!W)){var he=new Date(1987,1,19),Ae=0,de=Object.create?Object.create(null):{},ge=[];for(X=0;X<P.FullPaths.length;++X)de[P.FullPaths[X]]=!0,P.FileIndex[X].type!==0&&ge.push([P.FullPaths[X],P.FileIndex[X]]);for(X=0;X<ge.length;++X){var pe=n(ge[X][0]);H=de[pe],H||(ge.push([pe,{name:a(pe).replace("/",""),type:1,clsid:Y,ct:he,mt:he,content:null}]),de[pe]=!0)}for(ge.sort(function(qe,Le){return r(qe[0],Le[0])}),P.FullPaths=[],P.FileIndex=[],X=0;X<ge.length;++X)P.FullPaths[X]=ge[X][0],P.FileIndex[X]=ge[X][1];for(X=0;X<ge.length;++X){var Pe=P.FileIndex[X],Ve=P.FullPaths[X];if(Pe.name=a(Ve).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||Y,X===0)Pe.C=ge.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Ve.slice(-1)=="/"){for(Ae=X+1;Ae<ge.length&&n(P.FullPaths[Ae])!=Ve;++Ae);for(Pe.C=Ae>=ge.length?-1:Ae,Ae=X+1;Ae<ge.length&&n(P.FullPaths[Ae])!=n(Ve);++Ae);Pe.R=Ae>=ge.length?-1:Ae,Pe.type=1}else n(P.FullPaths[X+1]||"")==n(Ve)&&(Pe.R=X+1),Pe.type=2}}}function O(P,W){var j=W||{};if(j.fileType=="mad")return jo(P,j);if(R(P),j.fileType==="zip")return Gt(P,j);var H=(function(qe){for(var Le=0,Ge=0,Ye=0;Ye<qe.FileIndex.length;++Ye){var Yt=qe.FileIndex[Ye];if(Yt.content){var Qt=Yt.content.length;Qt>0&&(Qt<4096?Le+=Qt+63>>6:Ge+=Qt+511>>9)}}for(var ur=qe.FullPaths.length+3>>2,Rn=Le+7>>3,ri=Le+127>>7,ni=Rn+Ge+ur+ri,pa=ni+127>>7,Rs=pa<=109?0:Math.ceil((pa-109)/127);ni+pa+Rs+127>>7>pa;)Rs=++pa<=109?0:Math.ceil((pa-109)/127);var In=[1,Rs,pa,ri,ur,Ge,Le,0];return qe.FileIndex[0].size=Le<<6,In[7]=(qe.FileIndex[0].start=In[0]+In[1]+In[2]+In[3]+In[4]+In[5])+(In[6]+7>>3),In})(P),X=Se(H[7]<<9),Z=0,he=0;{for(Z=0;Z<8;++Z)X.write_shift(1,oe[Z]);for(Z=0;Z<8;++Z)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),Z=0;Z<3;++Z)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,H[2]),X.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:V),X.write_shift(4,H[3]),X.write_shift(-4,H[1]?H[0]-1:V),X.write_shift(4,H[1]),Z=0;Z<109;++Z)X.write_shift(-4,Z<H[2]?H[1]+Z:-1)}if(H[1])for(he=0;he<H[1];++he){for(;Z<236+he*127;++Z)X.write_shift(-4,Z<H[2]?H[1]+Z:-1);X.write_shift(-4,he===H[1]-1?V:he+1)}var Ae=function(qe){for(he+=qe;Z<he-1;++Z)X.write_shift(-4,Z+1);qe&&(++Z,X.write_shift(-4,V))};for(he=Z=0,he+=H[1];Z<he;++Z)X.write_shift(-4,ne.DIFSECT);for(he+=H[2];Z<he;++Z)X.write_shift(-4,ne.FATSECT);Ae(H[3]),Ae(H[4]);for(var de=0,ge=0,pe=P.FileIndex[0];de<P.FileIndex.length;++de)pe=P.FileIndex[de],pe.content&&(ge=pe.content.length,!(ge<4096)&&(pe.start=he,Ae(ge+511>>9)));for(Ae(H[6]+7>>3);X.l&511;)X.write_shift(-4,ne.ENDOFCHAIN);for(he=Z=0,de=0;de<P.FileIndex.length;++de)pe=P.FileIndex[de],pe.content&&(ge=pe.content.length,!(!ge||ge>=4096)&&(pe.start=he,Ae(ge+63>>6)));for(;X.l&511;)X.write_shift(-4,ne.ENDOFCHAIN);for(Z=0;Z<H[4]<<2;++Z){var Pe=P.FullPaths[Z];if(!Pe||Pe.length===0){for(de=0;de<17;++de)X.write_shift(4,0);for(de=0;de<3;++de)X.write_shift(4,-1);for(de=0;de<12;++de)X.write_shift(4,0);continue}pe=P.FileIndex[Z],Z===0&&(pe.start=pe.size?pe.start-1:V);var Ve=Z===0&&j.root||pe.name;if(ge=2*(Ve.length+1),X.write_shift(64,Ve,"utf16le"),X.write_shift(2,ge),X.write_shift(1,pe.type),X.write_shift(1,pe.color),X.write_shift(-4,pe.L),X.write_shift(-4,pe.R),X.write_shift(-4,pe.C),pe.clsid)X.write_shift(16,pe.clsid,"hex");else for(de=0;de<4;++de)X.write_shift(4,0);X.write_shift(4,pe.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,pe.start),X.write_shift(4,pe.size),X.write_shift(4,0)}for(Z=1;Z<P.FileIndex.length;++Z)if(pe=P.FileIndex[Z],pe.size>=4096)if(X.l=pe.start+1<<9,Tt&&Buffer.isBuffer(pe.content))pe.content.copy(X,X.l,0,pe.size),X.l+=pe.size+511&-512;else{for(de=0;de<pe.size;++de)X.write_shift(1,pe.content[de]);for(;de&511;++de)X.write_shift(1,0)}for(Z=1;Z<P.FileIndex.length;++Z)if(pe=P.FileIndex[Z],pe.size>0&&pe.size<4096)if(Tt&&Buffer.isBuffer(pe.content))pe.content.copy(X,X.l,0,pe.size),X.l+=pe.size+63&-64;else{for(de=0;de<pe.size;++de)X.write_shift(1,pe.content[de]);for(;de&63;++de)X.write_shift(1,0)}if(Tt)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function F(P,W){var j=P.FullPaths.map(function(de){return de.toUpperCase()}),H=j.map(function(de){var ge=de.split("/");return ge[ge.length-(de.slice(-1)=="/"?2:1)]}),X=!1;W.charCodeAt(0)===47?(X=!0,W=j[0].slice(0,-1)+W):X=W.indexOf("/")!==-1;var Z=W.toUpperCase(),he=X===!0?j.indexOf(Z):H.indexOf(Z);if(he!==-1)return P.FileIndex[he];var Ae=!Z.match(xf);for(Z=Z.replace(Zn,""),Ae&&(Z=Z.replace(xf,"!")),he=0;he<j.length;++he)if((Ae?j[he].replace(xf,"!"):j[he]).replace(Zn,"")==Z||(Ae?H[he].replace(xf,"!"):H[he]).replace(Zn,"")==Z)return P.FileIndex[he];return null}var D=64,V=-2,Te="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(P,W,j){d();var H=O(P,j);h.writeFileSync(W,H)}function ie(P){for(var W=new Array(P.length),j=0;j<P.length;++j)W[j]=String.fromCharCode(P[j]);return W.join("")}function Ce(P,W){var j=O(P,W);switch(W&&W.type||"buffer"){case"file":return d(),h.writeFileSync(W.filename,j),j;case"binary":return typeof j=="string"?j:ie(j);case"base64":return zf(typeof j=="string"?j:ie(j));case"buffer":if(Tt)return Buffer.isBuffer(j)?j:As(j);case"array":return typeof j=="string"?Ca(j):j}return j}var K;function M(P){try{var W=P.InflateRaw,j=new W;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)K=P;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function q(P,W){if(!K)return en(P,W);var j=K.InflateRaw,H=new j,X=H._processChunk(P.slice(P.l),H._finishFlushFlag);return P.l+=H.bytesRead,X}function G(P){return K?K.deflateRawSync(P):ut(P)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(P){var W=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(W>>16|W>>8|W)&255}for(var Ee=typeof Uint8Array<"u",Ie=Ee?new Uint8Array(256):[],nt=0;nt<256;++nt)Ie[nt]=be(nt);function te(P,W){var j=Ie[P&255];return W<=8?j>>>8-W:(j=j<<8|Ie[P>>8&255],W<=16?j>>>16-W:(j=j<<8|Ie[P>>16&255],j>>>24-W))}function Ft(P,W){var j=W&7,H=W>>>3;return(P[H]|(j<=6?0:P[H+1]<<8))>>>j&3}function ht(P,W){var j=W&7,H=W>>>3;return(P[H]|(j<=5?0:P[H+1]<<8))>>>j&7}function It(P,W){var j=W&7,H=W>>>3;return(P[H]|(j<=4?0:P[H+1]<<8))>>>j&15}function at(P,W){var j=W&7,H=W>>>3;return(P[H]|(j<=3?0:P[H+1]<<8))>>>j&31}function je(P,W){var j=W&7,H=W>>>3;return(P[H]|(j<=1?0:P[H+1]<<8))>>>j&127}function $t(P,W,j){var H=W&7,X=W>>>3,Z=(1<<j)-1,he=P[X]>>>H;return j<8-H||(he|=P[X+1]<<8-H,j<16-H)||(he|=P[X+2]<<16-H,j<24-H)||(he|=P[X+3]<<24-H),he&Z}function Dt(P,W,j){var H=W&7,X=W>>>3;return H<=5?P[X]|=(j&7)<<H:(P[X]|=j<<H&255,P[X+1]=(j&7)>>8-H),W+3}function Ut(P,W,j){var H=W&7,X=W>>>3;return j=(j&1)<<H,P[X]|=j,W+1}function Ur(P,W,j){var H=W&7,X=W>>>3;return j<<=H,P[X]|=j&255,j>>>=8,P[X+1]=j,W+8}function Za(P,W,j){var H=W&7,X=W>>>3;return j<<=H,P[X]|=j&255,j>>>=8,P[X+1]=j&255,P[X+2]=j>>>8,W+16}function Xn(P,W){var j=P.length,H=2*j>W?2*j:W+5,X=0;if(j>=W)return P;if(Tt){var Z=kT(H);if(P.copy)P.copy(Z);else for(;X<P.length;++X)Z[X]=P[X];return Z}else if(Ee){var he=new Uint8Array(H);if(he.set)he.set(P);else for(;X<j;++X)he[X]=P[X];return he}return P.length=H,P}function Lt(P){for(var W=new Array(P),j=0;j<P;++j)W[j]=0;return W}function Jr(P,W,j){var H=1,X=0,Z=0,he=0,Ae=0,de=P.length,ge=Ee?new Uint16Array(32):Lt(32);for(Z=0;Z<32;++Z)ge[Z]=0;for(Z=de;Z<j;++Z)P[Z]=0;de=P.length;var pe=Ee?new Uint16Array(de):Lt(de);for(Z=0;Z<de;++Z)ge[X=P[Z]]++,H<X&&(H=X),pe[Z]=0;for(ge[0]=0,Z=1;Z<=H;++Z)ge[Z+16]=Ae=Ae+ge[Z-1]<<1;for(Z=0;Z<de;++Z)Ae=P[Z],Ae!=0&&(pe[Z]=ge[Ae+16]++);var Pe=0;for(Z=0;Z<de;++Z)if(Pe=P[Z],Pe!=0)for(Ae=te(pe[Z],H)>>H-Pe,he=(1<<H+4-Pe)-1;he>=0;--he)W[Ae|he<<Pe]=Pe&15|Z<<4;return H}var gn=Ee?new Uint16Array(512):Lt(512),Wn=Ee?new Uint16Array(32):Lt(32);if(!Ee){for(var Pt=0;Pt<512;++Pt)gn[Pt]=0;for(Pt=0;Pt<32;++Pt)Wn[Pt]=0}(function(){for(var P=[],W=0;W<32;W++)P.push(5);Jr(P,Wn,32);var j=[];for(W=0;W<=143;W++)j.push(8);for(;W<=255;W++)j.push(9);for(;W<=279;W++)j.push(7);for(;W<=287;W++)j.push(8);Jr(j,gn,288)})();var Nn=(function(){for(var W=Ee?new Uint8Array(32768):[],j=0,H=0;j<ye.length-1;++j)for(;H<ye[j+1];++H)W[H]=j;for(;H<32768;++H)W[H]=29;var X=Ee?new Uint8Array(259):[];for(j=0,H=0;j<le.length-1;++j)for(;H<le[j+1];++H)X[H]=j;function Z(Ae,de){for(var ge=0;ge<Ae.length;){var pe=Math.min(65535,Ae.length-ge),Pe=ge+pe==Ae.length;for(de.write_shift(1,+Pe),de.write_shift(2,pe),de.write_shift(2,~pe&65535);pe-- >0;)de[de.l++]=Ae[ge++]}return de.l}function he(Ae,de){for(var ge=0,pe=0,Pe=Ee?new Uint16Array(32768):[];pe<Ae.length;){var Ve=Math.min(65535,Ae.length-pe);if(Ve<10){for(ge=Dt(de,ge,+(pe+Ve==Ae.length)),ge&7&&(ge+=8-(ge&7)),de.l=ge/8|0,de.write_shift(2,Ve),de.write_shift(2,~Ve&65535);Ve-- >0;)de[de.l++]=Ae[pe++];ge=de.l*8;continue}ge=Dt(de,ge,+(pe+Ve==Ae.length)+2);for(var qe=0;Ve-- >0;){var Le=Ae[pe];qe=(qe<<5^Le)&32767;var Ge=-1,Ye=0;if((Ge=Pe[qe])&&(Ge|=pe&-32768,Ge>pe&&(Ge-=32768),Ge<pe))for(;Ae[Ge+Ye]==Ae[pe+Ye]&&Ye<250;)++Ye;if(Ye>2){Le=X[Ye],Le<=22?ge=Ur(de,ge,Ie[Le+1]>>1)-1:(Ur(de,ge,3),ge+=5,Ur(de,ge,Ie[Le-23]>>5),ge+=3);var Yt=Le<8?0:Le-4>>2;Yt>0&&(Za(de,ge,Ye-le[Le]),ge+=Yt),Le=W[pe-Ge],ge=Ur(de,ge,Ie[Le]>>3),ge-=3;var Qt=Le<4?0:Le-2>>1;Qt>0&&(Za(de,ge,pe-Ge-ye[Le]),ge+=Qt);for(var ur=0;ur<Ye;++ur)Pe[qe]=pe&32767,qe=(qe<<5^Ae[pe])&32767,++pe;Ve-=Ye-1}else Le<=143?Le=Le+48:ge=Ut(de,ge,1),ge=Ur(de,ge,Ie[Le]),Pe[qe]=pe&32767,++pe}ge=Ur(de,ge,0)-1}return de.l=(ge+7)/8|0,de.l}return function(de,ge){return de.length<8?Z(de,ge):he(de,ge)}})();function ut(P){var W=Se(50+Math.floor(P.length*1.1)),j=Nn(P,W);return W.slice(0,j)}var ar=Ee?new Uint16Array(32768):Lt(32768),Zr=Ee?new Uint16Array(32768):Lt(32768),De=Ee?new Uint16Array(128):Lt(128),Xe=1,Ke=1;function Ze(P,W){var j=at(P,W)+257;W+=5;var H=at(P,W)+1;W+=5;var X=It(P,W)+4;W+=4;for(var Z=0,he=Ee?new Uint8Array(19):Lt(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,ge=Ee?new Uint8Array(8):Lt(8),pe=Ee?new Uint8Array(8):Lt(8),Pe=he.length,Ve=0;Ve<X;++Ve)he[J[Ve]]=Z=ht(P,W),de<Z&&(de=Z),ge[Z]++,W+=3;var qe=0;for(ge[0]=0,Ve=1;Ve<=de;++Ve)pe[Ve]=qe=qe+ge[Ve-1]<<1;for(Ve=0;Ve<Pe;++Ve)(qe=he[Ve])!=0&&(Ae[Ve]=pe[qe]++);var Le=0;for(Ve=0;Ve<Pe;++Ve)if(Le=he[Ve],Le!=0){qe=Ie[Ae[Ve]]>>8-Le;for(var Ge=(1<<7-Le)-1;Ge>=0;--Ge)De[qe|Ge<<Le]=Le&7|Ve<<3}var Ye=[];for(de=1;Ye.length<j+H;)switch(qe=De[je(P,W)],W+=qe&7,qe>>>=3){case 16:for(Z=3+Ft(P,W),W+=2,qe=Ye[Ye.length-1];Z-- >0;)Ye.push(qe);break;case 17:for(Z=3+ht(P,W),W+=3;Z-- >0;)Ye.push(0);break;case 18:for(Z=11+je(P,W),W+=7;Z-- >0;)Ye.push(0);break;default:Ye.push(qe),de<qe&&(de=qe);break}var Yt=Ye.slice(0,j),Qt=Ye.slice(j);for(Ve=j;Ve<286;++Ve)Yt[Ve]=0;for(Ve=H;Ve<30;++Ve)Qt[Ve]=0;return Xe=Jr(Yt,ar,286),Ke=Jr(Qt,Zr,30),W}function _r(P,W){if(P[0]==3&&!(P[1]&3))return[Do(W),2];for(var j=0,H=0,X=kT(W||1<<18),Z=0,he=X.length>>>0,Ae=0,de=0;(H&1)==0;){if(H=ht(P,j),j+=3,H>>>1)H>>1==1?(Ae=9,de=5):(j=Ze(P,j),Ae=Xe,de=Ke);else{j&7&&(j+=8-(j&7));var ge=P[j>>>3]|P[(j>>>3)+1]<<8;if(j+=32,ge>0)for(!W&&he<Z+ge&&(X=Xn(X,Z+ge),he=X.length);ge-- >0;)X[Z++]=P[j>>>3],j+=8;continue}for(;;){!W&&he<Z+32767&&(X=Xn(X,Z+32767),he=X.length);var pe=$t(P,j,Ae),Pe=H>>>1==1?gn[pe]:ar[pe];if(j+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)X[Z++]=Pe;else{if(Pe==256)break;Pe-=257;var Ve=Pe<8?0:Pe-4>>2;Ve>5&&(Ve=0);var qe=Z+le[Pe];Ve>0&&(qe+=$t(P,j,Ve),j+=Ve),pe=$t(P,j,de),Pe=H>>>1==1?Wn[pe]:Zr[pe],j+=Pe&15,Pe>>>=4;var Le=Pe<4?0:Pe-2>>1,Ge=ye[Pe];for(Le>0&&(Ge+=$t(P,j,Le),j+=Le),!W&&he<qe&&(X=Xn(X,qe+100),he=X.length);Z<qe;)X[Z]=X[Z-Ge],++Z}}}return W?[X,j+7>>>3]:[X.slice(0,Z),j+7>>>3]}function en(P,W){var j=P.slice(P.l||0),H=_r(j,W);return P.l+=H[1],H[0]}function jr(P,W){if(P)typeof console<"u"&&console.error(W);else throw new Error(W)}function ln(P,W){var j=P;Sn(j,0);var H=[],X=[],Z={FileIndex:H,FullPaths:X};k(Z,{root:W.root});for(var he=j.length-4;(j[he]!=80||j[he+1]!=75||j[he+2]!=5||j[he+3]!=6)&&he>=0;)--he;j.l=he+4,j.l+=4;var Ae=j.read_shift(2);j.l+=6;var de=j.read_shift(4);for(j.l=de,he=0;he<Ae;++he){j.l+=20;var ge=j.read_shift(4),pe=j.read_shift(4),Pe=j.read_shift(2),Ve=j.read_shift(2),qe=j.read_shift(2);j.l+=8;var Le=j.read_shift(4),Ge=u(j.slice(j.l+Pe,j.l+Pe+Ve));j.l+=Pe+Ve+qe;var Ye=j.l;j.l=Le+4,ea(j,ge,pe,Z,Ge),j.l=Ye}return Z}function ea(P,W,j,H,X){P.l+=2;var Z=P.read_shift(2),he=P.read_shift(2),Ae=l(P);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var de=P.read_shift(4),ge=P.read_shift(4),pe=P.read_shift(4),Pe=P.read_shift(2),Ve=P.read_shift(2),qe="",Le=0;Le<Pe;++Le)qe+=String.fromCharCode(P[P.l++]);if(Ve){var Ge=u(P.slice(P.l,P.l+Ve));(Ge[21589]||{}).mt&&(Ae=Ge[21589].mt),((X||{})[21589]||{}).mt&&(Ae=X[21589].mt)}P.l+=Ve;var Ye=P.slice(P.l,P.l+ge);switch(he){case 8:Ye=q(P,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Yt=!1;Z&8&&(de=P.read_shift(4),de==134695760&&(de=P.read_shift(4),Yt=!0),ge=P.read_shift(4),pe=P.read_shift(4)),ge!=W&&jr(Yt,"Bad compressed size: "+W+" != "+ge),pe!=j&&jr(Yt,"Bad uncompressed size: "+j+" != "+pe),qt(H,qe,Ye,{unsafe:!0,mt:Ae})}function Gt(P,W){var j=W||{},H=[],X=[],Z=Se(1),he=j.compression?8:0,Ae=0,de=0,ge=0,pe=0,Pe=0,Ve=P.FullPaths[0],qe=Ve,Le=P.FileIndex[0],Ge=[],Ye=0;for(de=1;de<P.FullPaths.length;++de)if(qe=P.FullPaths[de].slice(Ve.length),Le=P.FileIndex[de],!(!Le.size||!Le.content||qe=="Sh33tJ5")){var Yt=pe,Qt=Se(qe.length);for(ge=0;ge<qe.length;++ge)Qt.write_shift(1,qe.charCodeAt(ge)&127);Qt=Qt.slice(0,Qt.l),Ge[Pe]=AF.buf(Le.content,0);var ur=Le.content;he==8&&(ur=G(ur)),Z=Se(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,Ae),Z.write_shift(2,he),Le.mt?o(Z,Le.mt):Z.write_shift(4,0),Z.write_shift(-4,Ge[Pe]),Z.write_shift(4,ur.length),Z.write_shift(4,Le.content.length),Z.write_shift(2,Qt.length),Z.write_shift(2,0),pe+=Z.length,H.push(Z),pe+=Qt.length,H.push(Qt),pe+=ur.length,H.push(ur),Z=Se(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,Ae),Z.write_shift(2,he),Z.write_shift(4,0),Z.write_shift(-4,Ge[Pe]),Z.write_shift(4,ur.length),Z.write_shift(4,Le.content.length),Z.write_shift(2,Qt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Yt),Ye+=Z.l,X.push(Z),Ye+=Qt.length,X.push(Qt),++Pe}return Z=Se(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,Pe),Z.write_shift(2,Pe),Z.write_shift(4,Ye),Z.write_shift(4,pe),Z.write_shift(2,0),mn([mn(H),mn(X),Z])}var Ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tr(P,W){if(P.ctype)return P.ctype;var j=P.name||"",H=j.match(/\.([^\.]+)$/);return H&&Ir[H[1]]||W&&(H=(j=W).match(/[\.\\]([^\.\\])+$/),H&&Ir[H[1]])?Ir[H[1]]:"application/octet-stream"}function tn(P){for(var W=zf(P),j=[],H=0;H<W.length;H+=76)j.push(W.slice(H,H+76));return j.join(`\r
`)+`\r
`}function Ns(P){var W=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var pe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],H=W.split(`\r
`),X=0;X<H.length;++X){var Z=H[X];if(Z.length==0){j.push("");continue}for(var he=0;he<Z.length;){var Ae=76,de=Z.slice(he,he+Ae);de.charAt(Ae-1)=="="?Ae--:de.charAt(Ae-2)=="="?Ae-=2:de.charAt(Ae-3)=="="&&(Ae-=3),de=Z.slice(he,he+Ae),he+=Ae,he<Z.length&&(de+="="),j.push(de)}}return j.join(`\r
`)}function wi(P){for(var W=[],j=0;j<P.length;++j){for(var H=P[j];j<=P.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+P[++j];W.push(H)}for(var X=0;X<W.length;++X)W[X]=W[X].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return Ca(W.join(`\r
`))}function cn(P,W,j){for(var H="",X="",Z="",he,Ae=0;Ae<10;++Ae){var de=W[Ae];if(!de||de.match(/^\s*$/))break;var ge=de.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":H=ge[2].trim();break;case"content-type":Z=ge[2].trim();break;case"content-transfer-encoding":X=ge[2].trim();break}}switch(++Ae,X.toLowerCase()){case"base64":he=Ca(Ia(W.slice(Ae).join("")));break;case"quoted-printable":he=wi(W.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var pe=qt(P,H.slice(j.length),he,{unsafe:!0});Z&&(pe.ctype=Z)}function ei(P,W){if(ie(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=W&&W.root||"",H=(Tt&&Buffer.isBuffer(P)?P.toString("binary"):ie(P)).split(`\r
`),X=0,Z="";for(X=0;X<H.length;++X)if(Z=H[X],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),j||(j=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),Z.slice(0,j.length)!=j););var he=(H[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ae="--"+(he[1]||""),de=[],ge=[],pe={FileIndex:de,FullPaths:ge};k(pe);var Pe,Ve=0;for(X=0;X<H.length;++X){var qe=H[X];qe!==Ae&&qe!==Ae+"--"||(Ve++&&cn(pe,H.slice(Pe,X),j),Pe=X)}return pe}function jo(P,W){var j=W||{},H=j.boundary||"SheetJS";H="------="+H;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Z=P.FullPaths[0],he=Z,Ae=P.FileIndex[0],de=1;de<P.FullPaths.length;++de)if(he=P.FullPaths[de].slice(Z.length),Ae=P.FileIndex[de],!(!Ae.size||!Ae.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var ge=Ae.content,pe=Tt&&Buffer.isBuffer(ge)?ge.toString("binary"):ie(ge),Pe=0,Ve=Math.min(1024,pe.length),qe=0,Le=0;Le<=Ve;++Le)(qe=pe.charCodeAt(Le))>=32&&qe<128&&++Pe;var Ge=Pe>=Ve*4/5;X.push(H),X.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+he),X.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),X.push("Content-Type: "+Tr(Ae,he)),X.push(""),X.push(Ge?Ns(pe):tn(pe))}return X.push(H+`--\r
`),X.join(`\r
`)}function ti(P){var W={};return k(W,P),W}function qt(P,W,j,H){var X=H&&H.unsafe;X||k(P);var Z=!X&&tt.find(P,W);if(!Z){var he=P.FullPaths[0];W.slice(0,he.length)==he?he=W:(he.slice(-1)!="/"&&(he+="/"),he=(he+W).replace("//","/")),Z={name:a(W),type:2},P.FileIndex.push(Z),P.FullPaths.push(he),X||tt.utils.cfb_gc(P)}return Z.content=j,Z.size=j?j.length:0,H&&(H.CLSID&&(Z.clsid=H.CLSID),H.mt&&(Z.mt=H.mt),H.ct&&(Z.ct=H.ct)),Z}function Kn(P,W){k(P);var j=tt.find(P,W);if(j){for(var H=0;H<P.FileIndex.length;++H)if(P.FileIndex[H]==j)return P.FileIndex.splice(H,1),P.FullPaths.splice(H,1),!0}return!1}function da(P,W,j){k(P);var H=tt.find(P,W);if(H){for(var X=0;X<P.FileIndex.length;++X)if(P.FileIndex[X]==H)return P.FileIndex[X].name=a(j),P.FullPaths[X]=j,!0}return!1}function ma(P){R(P,!0)}return e.find=F,e.read=ee,e.parse=p,e.write=Ce,e.writeFile=ve,e.utils={cfb_new:ti,cfb_add:qt,cfb_del:Kn,cfb_mov:da,cfb_gc:ma,ReadShift:bf,CheckField:nA,prep_blob:Sn,bconcat:mn,use_zlib:M,_deflateRaw:ut,_inflateRaw:en,consts:ne},e})();function kF(t){return typeof t=="string"?vm(t):Array.isArray(t)?ZO(t):t}function h0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=vm(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Pi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([kF(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Vo(e)),u.write(e),u.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function CF(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Rr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function MT(t,e){for(var r=[],n=Rr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function ym(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function wm(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function NF(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Vd=new Date(1899,11,30,0,0,0);function on(t,e){var r=t.getTime(),n=Vd.getTime()+(t.getTimezoneOffset()-Vd.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var L4=new Date,RF=Vd.getTime()+(L4.getTimezoneOffset()-Vd.getTimezoneOffset())*6e4,LT=L4.getTimezoneOffset();function Tm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+RF),e.getTimezoneOffset()!==LT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-LT)*6e4),e}function IF(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var PT=new Date("2017-02-19T19:06:09.000Z"),P4=isNaN(PT.getFullYear())?new Date("2/19/17"):PT,DF=P4.getFullYear()==2017;function xr(t,e){var r=new Date(t);if(DF)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(P4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Ol(t,e){if(Tt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Pi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Pi(S4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Pi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Pi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function Cr(t,e){for(var r="";r.length<e;)r+=t;return r}function _i(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var OF=["january","february","march","april","may","june","july","august","september","october","november","december"];function tu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&OF.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var FF=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}})();function V4(t){return t?t.content&&t.type?Ol(t.content,!0):t.data?gf(t.data):t.asNodeBuffer&&Tt?gf(t.asNodeBuffer().toString("binary")):t.asBinary?gf(t.asBinary()):t._data&&t._data.getContent?gf(Ol(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function B4(t){if(!t)return null;if(t.data)return bT(t.data);if(t.asNodeBuffer&&Tt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?bT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function MF(t){return t&&t.name.slice(-4)===".bin"?B4(t):V4(t)}function Wa(t,e){for(var r=t.FullPaths||Rr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Px(t,e){var r=Wa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function $r(t,e,r){if(!r)return MF(Px(t,e));if(!e)return null;try{return $r(t,e)}catch{return null}}function Na(t,e,r){if(!r)return V4(Px(t,e));if(!e)return null;try{return Na(t,e)}catch{return null}}function LF(t,e,r){return B4(Px(t,e))}function VT(t){for(var e=t.FullPaths||Rr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Tt?n=As(r):n=eF(r),tt.utils.cfb_add(t,e,n)}tt.utils.cfb_add(t,e,r)}else t.file(e,r)}function Vx(){return tt.utils.cfb_new()}function U4(t,e){switch(e.type){case"base64":return tt.read(t,{type:"base64"});case"binary":return tt.read(t,{type:"binary"});case"buffer":case"array":return tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function vf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,PF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,BT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VF=/<[^>]*>/g,qn=Br.match(BT)?BT:VF,BF=/<\w*:/,UF=/<(\/?)\w+:/;function ft(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(PF),u=0,h="",d=0,p="",v="",_=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(_=(a=v.charCodeAt(o+1))==34||a==39?1:0,h=v.slice(o+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var w=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[w]&&p.slice(u-3,u)=="ext")continue;n[w]=h,n[w.toLowerCase()]=h}}return n}function Wi(t){return t.replace(UF,"<$1")}var j4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bx=ym(j4),Vt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,h){return j4[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}})(),Ux=/[&<>'"]/g,jF=/[\u0000-\u0008\u000b-\u001f]/g;function nr(t){var e=t+"";return e.replace(Ux,function(r){return Bx[r]}).replace(jF,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function UT(t){return nr(t).replace(/ /g,"_x0020_")}var z4=/[\u0000-\u001f]/g;function jx(t){var e=t+"";return e.replace(Ux,function(r){return Bx[r]}).replace(/\n/g,"<br/>").replace(z4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function zF(t){var e=t+"";return e.replace(Ux,function(r){return Bx[r]}).replace(z4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jT=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function HF(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function mr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bp(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function zT(t){var e=Do(2*t.length),r,n,a=1,o=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function HT(t){return As(t,"binary").toString("utf8")}var qh="foo bar baz",cr=Tt&&(HT(qh)==Bp(qh)&&HT||zT(qh)==Bp(qh)&&zT)||Bp,Pi=Tt?function(t){return As(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Gf=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),H4=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),GF=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),qF=/<\/?(?:vt:)?variant>/g,XF=/<(?:vt:)([^>]*)>([\s\S]*)</;function GT(t,e){var r=ft(t),n=t.match(GF(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(qF,"").match(XF);l&&a.push({v:cr(l[2]),t:l[1]})}),a}var G4=/(^\s|\s$|\n)/;function An(t,e){return"<"+t+(e.match(G4)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function qf(t){return Rr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ue(t,e,r){return"<"+t+(r!=null?qf(r):"")+(e!=null?(e.match(G4)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Cg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function WF(t,e){switch(typeof t){case"string":var r=Ue("vt:lpwstr",nr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((t|0)==t?"vt:i4":"vt:r8",nr(String(t)));case"boolean":return Ue("vt:bool",t?"true":"false")}if(t instanceof Date)return Ue("vt:filetime",Cg(t));throw new Error("Unable to serialize "+t)}function zx(t){if(Tt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return cr(Vo(Fx(t)));throw new Error("Bad input format: expected Buffer or string")}var Xf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,an={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ul=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Aa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function KF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function $F(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=n?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var qT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},XT=Tt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:As(e)})):qT(t)}:qT,WT=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(ps(t,a)));return n.join("").replace(Zn,"")},Hx=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Zn,""):WT(t,e,r)}:WT,KT=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},q4=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):KT(t,e,r)}:KT,$T=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Lc(t,a)));return n.join("")},d0=Tt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):$T(e,r,n)}:$T,X4=function(t,e){var r=ka(t,e);return r>0?d0(t,e+4,e+4+r-1):""},W4=X4,K4=function(t,e){var r=ka(t,e);return r>0?d0(t,e+4,e+4+r-1):""},$4=K4,Y4=function(t,e){var r=2*ka(t,e);return r>0?d0(t,e+4,e+4+r-1):""},Q4=Y4,J4=function(e,r){var n=ka(e,r);return n>0?Hx(e,r+4,r+4+n):""},Z4=J4,eA=function(t,e){var r=ka(t,e);return r>0?d0(t,e+4,e+4+r):""},tA=eA,rA=function(t,e){return KF(t,e)},Bd=rA,Gx=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Tt&&(W4=function(e,r){if(!Buffer.isBuffer(e))return X4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},$4=function(e,r){if(!Buffer.isBuffer(e))return K4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Q4=function(e,r){if(!Buffer.isBuffer(e))return Y4(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Z4=function(e,r){if(!Buffer.isBuffer(e))return J4(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},tA=function(e,r){if(!Buffer.isBuffer(e))return eA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Bd=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):rA(e,r)},Gx=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Lc=function(t,e){return t[e]},ps=function(t,e){return t[e+1]*256+t[e]},YF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ka=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},pl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},QF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function bf(t,e){var r="",n,a,o=[],l,u,h,d;switch(e){case"dbcs":if(d=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(ps(this,d)),d+=2;t*=2;break;case"utf8":r=d0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Hx(this,this.l,this.l+t);break;case"wstr":return bf.call(this,t,"dbcs");case"lpstr-ansi":r=W4(this,this.l),t=4+ka(this,this.l);break;case"lpstr-cp":r=$4(this,this.l),t=4+ka(this,this.l);break;case"lpwstr":r=Q4(this,this.l),t=4+2*ka(this,this.l);break;case"lpp4":t=4+ka(this,this.l),r=Z4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ka(this,this.l),r=tA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Lc(this,this.l+t++))!==0;)o.push(Gh(l));r=o.join("");break;case"_wstr":for(t=0,r="";(l=ps(this,this.l+t))!==0;)o.push(Gh(l)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Lc(this,d),this.l=d+1,u=bf.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Gh(ps(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Lc(this,d),this.l=d+1,u=bf.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Gh(Lc(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=Lc(this,this.l),this.l++,n;case 2:return n=(e==="i"?YF:ps)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?pl:QF)(this,this.l),this.l+=4,n):(a=ka(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Bd(this,this.l):a=Bd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=q4(this,this.l,t);break}}return this.l+=t,r}var JF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},ZF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},eM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function tM(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)eM(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,JF(this,e,this.l);break;case 8:if(n=8,r==="f"){$F(this,e,this.l);break}case 16:break;case-4:n=4,ZF(this,e,this.l);break}return this.l+=n,this}function nA(t,e){var r=q4(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=bf,t.chk=nA,t.write_shift=tM}function Gn(t,e){t.l+=e}function Se(t){var e=Do(t);return Sn(e,0),e}function ks(t,e,r){if(t){var n,a,o;Sn(t,t.l||0);for(var l=t.length,u=0,h=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=Jf[u]||Jf[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;h=t.l+o;var p=d.f&&d.f(t,o,r);if(t.l=h,e(p,d,u))return}}}function fa(){var t=[],e=Tt?256:2048,r=function(d){var p=Se(d);return Sn(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},l=function(){return a(),mn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:l,_bufs:t}}function Fe(t,e,r,n){var a=+e,o;if(!isNaN(a)){n||(n=Jf[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=t.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Gx(r)&&t.push(r)}}function Af(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function YT(t,e,r){var n=vr(t);return n.s=Af(n.s,e.s,r),n.e=Af(n.e,e.s,r),n}function kf(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=aM(r)),!t.rRel&&t.rRel!=null&&(r=rM(r)),r}function Up(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Er(t.s.c)+":"+(t.e.cRel?"":"$")+Er(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Vr(t.s.r)+":"+(t.e.rRel?"":"$")+Vr(t.e.r):kf(t.s,e.biff)+":"+kf(t.e,e.biff)}function qx(t){return parseInt(nM(t),10)-1}function Vr(t){return""+(t+1)}function rM(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nM(t){return t.replace(/\$(\d+)$/,"$1")}function Xx(t){for(var e=iM(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Er(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function aM(t){return t.replace(/^([A-Z])/,"$$$1")}function iM(t){return t.replace(/^\$([A-Z])/,"$1")}function sM(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ha(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function _t(t,e){return typeof e>"u"||typeof e=="number"?_t(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function QT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Qa(t.z,r?on(e):e)}catch{}try{return t.w=Qa((t.XF||{}).numFmtId||(r?14:0),r?on(e):e)}catch{return""+e}}function Ss(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Cs[t.v]||t.v:e==null?QT(t,t.v):QT(t,e))}function Bo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function aA(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?Sr(n.origin):n.origin;l=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Bt(o["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(d.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var w={v:e[v][_]},S=l+v,E=u+_;if(d.s.r>S&&(d.s.r=S),d.s.c>E&&(d.s.c=E),d.e.r<S&&(d.e.r=S),d.e.c<E&&(d.e.c=E),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))w=e[v][_];else if(Array.isArray(w.v)&&(w.f=e[v][_][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(n.nullError)w.t="e",w.v=0;else if(n.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=n.dateNF||st[14],n.cellDates?(w.t="d",w.w=Qa(w.z,on(w.v))):(w.t="n",w.v=on(w.v),w.w=Qa(w.z,w.v))):w.t="s";if(a)o[S]||(o[S]=[]),o[S][E]&&o[S][E].z&&(w.z=o[S][E].z),o[S][E]=w;else{var A=ot({c:E,r:S});o[A]&&o[A].z&&(w.z=o[A].z),o[A]=w}}}return d.s.c<1e7&&(o["!ref"]=_t(d)),o}function mu(t,e){return aA(null,t,e)}function oM(t){return t.read_shift(4,"i")}function yi(t,e){return e||(e=Se(4)),e.write_shift(4,t),e}function zn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function pn(t,e){var r=!1;return e==null&&(r=!0,e=Se(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function lM(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function cM(t,e){return e||(e=Se(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Wx(t,e){var r=t.l,n=t.read_shift(1),a=zn(t),o=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(lM(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function uM(t,e){var r=!1;return e==null&&(r=!0,e=Se(15+4*t.t.length)),e.write_shift(1,0),pn(t.t,e),r?e.slice(0,e.l):e}var fM=Wx;function hM(t,e){var r=!1;return e==null&&(r=!0,e=Se(23+4*t.t.length)),e.write_shift(1,1),pn(t.t,e),e.write_shift(4,1),cM({},e),r?e.slice(0,e.l):e}function Ja(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function jl(t,e){return e==null&&(e=Se(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function zl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Hl(t,e){return e==null&&(e=Se(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var dM=zn,iA=pn;function Kx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Ud(t,e){var r=!1;return e==null&&(r=!0,e=Se(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var mM=zn,Ng=Kx,$x=Ud;function Yx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Bd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):pl(e,0)>>2;return r?a/100:a}function sA(t,e){e==null&&(e=Se(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function oA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function pM(t,e){return e||(e=Se(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Gl=oA,pu=pM;function jn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Fl(t,e){return(e||Se(8)).write_shift(8,t,"f")}function gM(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=wl[a];d&&(e.rgb=Kf(d));break;case 2:e.rgb=Kf([l,u,h]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function jd(t,e){if(e||(e=Se(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function xM(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function vM(t,e){e||(e=Se(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function lA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function _M(t){return lA(t,1)}function yM(t){return lA(t,2)}var Qx=2,la=3,Xh=11,JT=12,zd=19,Wh=64,wM=65,TM=71,EM=4108,SM=4126,dn=80,cA=81,bM=[dn,cA],Rg={1:{n:"CodePage",t:Qx},2:{n:"Category",t:dn},3:{n:"PresentationFormat",t:dn},4:{n:"ByteCount",t:la},5:{n:"LineCount",t:la},6:{n:"ParagraphCount",t:la},7:{n:"SlideCount",t:la},8:{n:"NoteCount",t:la},9:{n:"HiddenCount",t:la},10:{n:"MultimediaClipCount",t:la},11:{n:"ScaleCrop",t:Xh},12:{n:"HeadingPairs",t:EM},13:{n:"TitlesOfParts",t:SM},14:{n:"Manager",t:dn},15:{n:"Company",t:dn},16:{n:"LinksUpToDate",t:Xh},17:{n:"CharacterCount",t:la},19:{n:"SharedDoc",t:Xh},22:{n:"HyperlinksChanged",t:Xh},23:{n:"AppVersion",t:la,p:"version"},24:{n:"DigSig",t:wM},26:{n:"ContentType",t:dn},27:{n:"ContentStatus",t:dn},28:{n:"Language",t:dn},29:{n:"Version",t:dn},255:{},2147483648:{n:"Locale",t:zd},2147483651:{n:"Behavior",t:zd},1919054434:{}},Ig={1:{n:"CodePage",t:Qx},2:{n:"Title",t:dn},3:{n:"Subject",t:dn},4:{n:"Author",t:dn},5:{n:"Keywords",t:dn},6:{n:"Comments",t:dn},7:{n:"Template",t:dn},8:{n:"LastAuthor",t:dn},9:{n:"RevNumber",t:dn},10:{n:"EditTime",t:Wh},11:{n:"LastPrinted",t:Wh},12:{n:"CreatedDate",t:Wh},13:{n:"ModifiedDate",t:Wh},14:{n:"PageCount",t:la},15:{n:"WordCount",t:la},16:{n:"CharCount",t:la},17:{n:"Thumbnail",t:TM},18:{n:"Application",t:dn},19:{n:"DocSecurity",t:la},255:{},2147483648:{n:"Locale",t:zd},2147483651:{n:"Behavior",t:zd},1919054434:{}},ZT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function kM(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var CM=kM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wl=vr(CM),Cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},uA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Dg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Kh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Jx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function NM(t){var e=Jx();if(!t||!t.match)return e;var r={};if((t.match(qn)||[]).forEach(function(n){var a=ft(n);switch(a[0].replace(BF,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Dg[a.ContentType]]!==void 0&&e[Dg[a.ContentType]].push(a.PartName);break}}),e.xmlns!==an.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function fA(t,e){var r=NF(Dg),n=[],a;n[n.length]=Br,n[n.length]=Ue("Types",null,{xmlns:an.CT,"xmlns:xsd":an.xsd,"xmlns:xsi":an.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Ue("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){t[h]&&t[h].length>0&&(a=t[h][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Kh[h][e.bookType]||Kh[h].xlsx}))},l=function(h){(t[h]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Kh[h][e.bookType]||Kh[h].xlsx})})},u=function(h){(t[h]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Wf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Cf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(qn)||[]).forEach(function(a){var o=ft(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:vf(o.Target,e);r[u]=l,n[o.Id]=l}}),r["!id"]=n,r}function qc(t){var e=[Br,Ue("Relationships",null,{xmlns:an.RELS})];return Rr(t["!id"]).forEach(function(r){e[e.length]=Ue("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function rr(t,e,r,n,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[Et.HLINK,Et.XPATH,Et.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var RM="application/vnd.oasis.opendocument.spreadsheet";function IM(t,e){for(var r=zx(t),n,a;n=Xf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ft(n[0],!1),a.path=="/"&&a.type!==RM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function DM(t){var e=[Br];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function eE(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function OM(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function FM(t){var e=[Br];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(eE(t[r][0],t[r][1])),e.push(OM("",t[r][0]));return e.push(eE("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function hA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Fd.version+"</meta:generator></office:meta></office:document-meta>"}var Ya=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MM=(function(){for(var t=new Array(Ya.length),e=0;e<Ya.length;++e){var r=Ya[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function dA(t){var e={};t=cr(t);for(var r=0;r<Ya.length;++r){var n=Ya[r],a=t.match(MM[r]);a!=null&&a.length>0&&(e[n[1]]=Vt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=xr(e[n[1]]))}return e}function jp(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=nr(e),n[n.length]=r?Ue(t,e,r):An(t,e))}function mA(t,e){var r=e||{},n=[Br,Ue("cp:coreProperties",null,{"xmlns:cp":an.CORE_PROPS,"xmlns:dc":an.dc,"xmlns:dcterms":an.dcterms,"xmlns:dcmitype":an.dcmitype,"xmlns:xsi":an.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&jp("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Cg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&jp("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Cg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var o=0;o!=Ya.length;++o){var l=Ya[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&jp(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Tl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],pA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function gA(t,e,r,n){var a=[];if(typeof t=="string")a=GT(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(p){return{v:p}}));var l=typeof e=="string"?GT(e,n).map(function(p){return p.v}):e,u=0,h=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=l.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=l.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=l.slice(u,u+h);break}u+=h}}function LM(t,e,r){var n={};return e||(e={}),t=cr(t),Tl.forEach(function(a){var o=(t.match(Gf(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=Vt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&gA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function xA(t){var e=[],r=Ue;return t||(t={}),t.Application="SheetJS",e[e.length]=Br,e[e.length]=Ue("Properties",null,{xmlns:an.EXT_PROPS,"xmlns:vt":an.vt}),Tl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=nr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+nr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var PM=/<[^>]+>[^<]*/g;function VM(t,e){var r={},n="",a=t.match(PM);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=ft(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Vt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var h=l.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Vt(p);break;case"bool":r[n]=mr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=xr(p);break;case"cy":case"error":r[n]=Vt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,h)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function vA(t){var e=[Br,Ue("Properties",null,{xmlns:an.CUST_PROPS,"xmlns:vt":an.vt})];if(!t)return e.join("");var r=1;return Rr(t).forEach(function(a){++r,e[e.length]=Ue("property",WF(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:nr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Og={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},zp;function BM(t,e,r){zp||(zp=ym(Og)),e=zp[e]||e,t[e]=r}function UM(t,e){var r=[];return Rr(Og).map(function(n){for(var a=0;a<Ya.length;++a)if(Ya[a][1]==n)return Ya[a];for(a=0;a<Tl.length;++a)if(Tl[a][1]==n)return Tl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];n[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(An(Og[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Aa.o})}function jM(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Rr(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var l=0;l<Ya.length;++l)if(o==Ya[l][1])return;for(l=0;l<Tl.length;++l)if(o==Tl[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=t[o],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),a.push(Ue(UT(o),u,{"dt:dt":h}))}}),e&&Rr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Ue(UT(o),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Aa.o+'">'+a.join("")+"</"+n+">"}function Zx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zM(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),a+=o);var l=Se(8);return l.write_shift(4,n),l.write_shift(4,a),l}function _A(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function yA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function wA(t,e,r){return e===31?yA(t):_A(t,e,r)}function Fg(t,e,r){return wA(t,e,r===!1?0:4)}function HM(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return wA(t,e,0)}function GM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Zn,""),t.l-a&2&&(t.l+=2)}return r}function qM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Zn,"");return r}function XM(t){var e=t.l,r=Hd(t,cA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Hd(t,la);return[r,n]}function WM(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(XM(t));return r}function tE(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Zn,"").replace(xf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function TA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function KM(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Hd(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==JT&&n!==e&&bM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===JT?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return _A(t,n,4).replace(Zn,"");case 31:return yA(t);case 64:return Zx(t);case 65:return TA(t);case 71:return KM(t);case 80:return Fg(t,n,!o.raw).replace(Zn,"");case 81:return HM(t,n).replace(Zn,"");case 4108:return WM(t);case 4126:case 4127:return n==4127?GM(t):qM(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function rE(t,e){var r=Se(4),n=Se(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Se(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=zM(e);break;case 31:case 80:for(n=Se(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return mn([r,n])}function nE(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0,u=0,h=-1,d={};for(l=0;l!=a;++l){var p=t.read_shift(4),v=t.read_shift(4);o[l]=[p,v+r]}o.sort(function(U,N){return U[1]-N[1]});var _={};for(l=0;l!=a;++l){if(t.l!==o[l][1]){var w=!0;if(l>0&&e)switch(e[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,w=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],w=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],w=!1);break}if((!e||l==0)&&t.l<=o[l][1]&&(w=!1,t.l=o[l][1]),w)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(e){var S=e[o[l][0]];if(_[S.n]=Hd(t,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:pi(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(o[l][0]===1){if(u=_.CodePage=Hd(t,Qx),pi(u),h!==-1){var E=t.l;t.l=o[h][1],d=tE(t,u),t.l=E}}else if(o[l][0]===0){if(u===0){h=l,t.l=o[l+1][1];continue}d=tE(t,u)}else{var A=d[o[l][0]],L;switch(t[t.l]){case 65:t.l+=4,L=TA(t);break;case 30:t.l+=4,L=Fg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,L=Fg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,L=t.read_shift(4,"i");break;case 19:t.l+=4,L=t.read_shift(4);break;case 5:t.l+=4,L=t.read_shift(8,"f");break;case 11:t.l+=4,L=Mr(t,4);break;case 64:t.l+=4,L=xr(Zx(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[A]=L}}return t.l=r+n,_}var EA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $M(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function aE(t,e,r){var n=Se(8),a=[],o=[],l=8,u=0,h=Se(8),d=Se(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),o.push(h),a.push(d),l+=8+h.length,!e){d=Se(8),d.write_shift(4,0),a.unshift(d);var p=[Se(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(h=Se(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=mn(p),o.unshift(h),l+=8+h.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(EA.indexOf(t[u][0])>-1||pA.indexOf(t[u][0])>-1)&&t[u][1]!=null){var _=t[u][1],w=0;if(e){w=+e[t[u][0]];var S=r[w];if(S.p=="version"&&typeof _=="string"){var E=_.split(".");_=(+E[0]<<16)+(+E[1]||0)}h=rE(S.t,_)}else{var A=$M(_);A==-1&&(A=31,_=String(_)),h=rE(A,_)}o.push(h),d=Se(8),d.write_shift(4,e?w:2+u),a.push(d),l+=8+h.length}var L=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,L),L+=o[u].length;return n.write_shift(4,l),n.write_shift(4,o.length),mn([n].concat(a).concat(o))}function iE(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var a,o,l,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==tt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),h=n.read_shift(4));var v=nE(n,e),_={SystemIdentifier:d};for(var w in v)_[w]=v[w];if(_.FMTID=o,a===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var S;try{S=nE(n,null)}catch{}for(w in S)_[w]=S[w];return _.FMTID=[o,l],_}function sE(t,e,r,n,a,o){var l=Se(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var h=aE(t,r,n);if(u.push(h),a){var d=aE(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+h.length),u.push(d)}return mn(u)}function co(t,e){return t.read_shift(e),null}function YM(t,e){e||(e=Se(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function QM(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Mr(t,e){return t.read_shift(e)===1}function Jn(t,e){return e||(e=Se(2)),e.write_shift(2,+!!t),e}function Yr(t){return t.read_shift(2,"u")}function Ka(t,e){return e||(e=Se(2)),e.write_shift(2,t),e}function SA(t,e){return QM(t,e,Yr)}function JM(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function bA(t,e,r){return r||(r=Se(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function m0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function ZM(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,u,h={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),n&&(t.l+=u),h.t=p,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function e9(t){var e=t.t||"",r=Se(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Se(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return mn(a)}function Ml(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function p0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ml(t,n,r)}function ql(t,e,r){if(r.biff>5)return p0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function AA(t,e,r){return r||(r=Se(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function t9(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function r9(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Zn,"");return n&&(t.l+=24),a}function n9(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(Zn,"");return r+l}function a9(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return r9(t);case"0303000000000000c000000000000046":return n9(t);default:throw new Error("Unsupported Moniker "+r)}}function $h(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Zn,""):"";return r}function oE(t,e){e||(e=Se(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function i9(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,l,u,h,d="",p,v;a&16&&(o=$h(t,r-t.l)),a&128&&(l=$h(t,r-t.l)),(a&257)===257&&(u=$h(t,r-t.l)),(a&257)===1&&(h=a9(t,r-t.l)),a&8&&(d=$h(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(v=Zx(t)),t.l=r;var _=l||u||h||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var w={Target:_};return p&&(w.guid=p),v&&(w.time=v),o&&(w.Tooltip=o),w}function s9(t){var e=Se(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),o=a>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(o==28)n=n.slice(1),oE(n,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),o&8&&oE(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)e.write_shift(1,n.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function kA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function CA(t,e){var r=kA(t);return r[3]=0,r}function Ki(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ll(t,e,r,n){return n||(n=Se(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function o9(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function l9(t,e,r){return e===0?"":ql(t,e,r)}function c9(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,o,l]}function NA(t){var e=t.read_shift(2),r=Yx(t);return[e,r]}function u9(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=m0(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Em(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function RA(t,e){return e||(e=Se(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function IA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var f9=IA;function DA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function h9(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function d9(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Fn(t){t.l+=2,t.l+=t.read_shift(2)}var m9={0:Fn,4:Fn,5:Fn,6:Fn,7:d9,8:Fn,9:Fn,10:Fn,11:Fn,12:Fn,13:h9,14:Fn,15:Fn,16:Fn,17:Fn,18:Fn,19:Fn,20:Fn,21:DA};function p9(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(m9[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Yh(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ev(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Se(a);return o.write_shift(2,n),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function g9(t,e){return e===0||t.read_shift(2),1200}function x9(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=ql(t,0,r);return t.read_shift(e+n-t.l),a}function v9(t,e){var r=!e||e.biff==8,n=Se(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _9(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function y9(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=m0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function w9(t,e){var r=!e||e.biff>=8?2:1,n=Se(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function T9(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0;l!=a&&t.l<r;++l)o.push(ZM(t));return o.Count=n,o.Unique=a,o}function E9(t,e){var r=Se(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=e9(t[a]);var o=mn([r].concat(n));return o.parts=[r.length].concat(n.map(function(l){return l.length})),o}function S9(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function b9(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function A9(t){var e=o9(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function k9(t){return t.read_shift(2),t.read_shift(4)}function lE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function C9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:u,Selected:h,TabRatio:d}}function N9(){var t=Se(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function R9(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function I9(t){var e=Se(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function D9(){}function O9(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=m0(t,0,r),n}function F9(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,o=Se(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}function M9(t){var e=Ki(t);return e.isst=t.read_shift(4),e}function L9(t,e,r,n){var a=Se(10);return Ll(t,e,n,a),a.write_shift(4,r),a}function P9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Ki(t);r.biff==2&&t.l++;var o=p0(t,n-t.l,r);return a.val=o,a}function V9(t,e,r,n,a){var o=!a||a.biff==8,l=Se(8+ +o+(1+o)*r.length);return Ll(t,e,n,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function B9(t,e,r){var n=t.read_shift(2),a=ql(t,0,r);return[n,a]}function U9(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var j9=ql;function cE(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:h}}}function z9(t,e){var r=e.biff==8||!e.biff?4:2,n=Se(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function H9(t){var e=t.read_shift(2),r=t.read_shift(2),n=NA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function G9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(NA(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function q9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function X9(t,e,r,n){var a={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return a.patternType=AM[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function W9(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=X9(t,e,n.fStyle,r),n}function uE(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function K9(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function $9(t){var e=Se(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function fE(t,e,r){var n=Ki(t);(r.biff==2||e==9)&&++t.l;var a=JM(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Y9(t,e,r,n,a,o){var l=Se(8);return Ll(t,e,n,l),bA(r,o,l),l}function Q9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ki(t),a=jn(t);return n.val=a,n}function J9(t,e,r,n){var a=Se(14);return Ll(t,e,n,a),Fl(r,a),a}var hE=l9;function Z9(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=Ml(t,o),u=[];n>t.l;)u.push(p0(t));return[o,a,l,u]}function dE(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=u9(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var e7=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mE(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Ml(t,l,r);a&32&&(d=e7[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:pB(t,p,r,u);return{chKey:o,Name:d,itab:h,rgce:v}}function OA(t,e,r){if(r.biff<8)return t7(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(c9(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function t7(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=m0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function r7(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=Ml(t,n,r),l=Ml(t,a,r);return[o,l]}function n7(t,e,r){var n=IA(t);t.l++;var a=t.read_shift(1);return e-=8,[gB(t,e,r),a,n]}function pE(t,e,r){var n=f9(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,dB(t,e,r)]}function a7(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function i7(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=ql(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,o]}}function s7(t,e,r){return i7(t,e,r)}function o7(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Em(t));return r}function l7(t){var e=Se(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)RA(t[r],e);return e}function c7(t,e,r){if(r&&r.biff<8)return f7(t,e,r);var n=DA(t),a=p9(t,e-22,n[1]);return{cmo:n,ft:a}}var u7={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function f7(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((u7[n]||Gn)(t,e,r)),{cmo:[a,n,o],ft:l}}function h7(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=t9(t,6,r);var u=t.read_shift(2);t.read_shift(2),Yr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],v=Ml(t,t.lens[d+1]-t.lens[d]-1);if(a+=v,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function d7(t,e){var r=Em(t);t.l+=16;var n=i9(t,e-24);return[r,n]}function m7(t){var e=Se(24),r=Sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return mn([e,s9(t[1])])}function p7(t,e){t.read_shift(2);var r=Em(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Zn,""),[r,n]}function g7(t){var e=t[1].Tooltip,r=Se(10+2*(e.length+1));r.write_shift(2,2048);var n=Sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function x7(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ZT[r]||r,r=t.read_shift(2),e[1]=ZT[r]||r,e}function v7(t){return t||(t=Se(4)),t.write_shift(2,1),t.write_shift(2,1),t}function _7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(CA(t));return r}function y7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(CA(t));return r}function w7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function FA(t,e,r){if(!r.cellStyles)return Gn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:o,w:l,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function T7(t,e){var r=Se(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function E7(t,e){var r={};return e<32||(t.l+=16,r.header=jn(t),r.footer=jn(t),t.l+=2),r}function S7(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function b7(t){for(var e=Se(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var A7=Ki,k7=SA,C7=p0;function N7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function R7(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ki(t);++t.l;var a=ql(t,e-7,r);return n.t="str",n.val=a,n}function I7(t){var e=Ki(t);++t.l;var r=jn(t);return e.t="n",e.val=r,e}function D7(t,e,r){var n=Se(15);return _0(n,t,e),n.write_shift(8,r,"f"),n}function O7(t){var e=Ki(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function F7(t,e,r){var n=Se(9);return _0(n,t,e),n.write_shift(2,r),n}function M7(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function L7(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function P7(t,e,r){var n=t.l+e,a=Ki(t),o=t.read_shift(2),l=Ml(t,o,r);return t.l=n,a.t="str",a.val=l,a}var V7=[2,3,48,49,131,139,140,245],Mg=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=ym({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],p=Do(1);switch(h.type){case"base64":p=Ca(Ia(u));break;case"binary":p=Ca(u);break;case"buffer":case"array":p=u;break}Sn(p,0);var v=p.read_shift(1),_=!!(v&136),w=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:w=!0,_=!0;break;case 49:w=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var E=0,A=521;v==2&&(E=p.read_shift(2)),p.l+=3,v!=2&&(E=p.read_shift(4)),E>1048576&&(E=1e6),v!=2&&(A=p.read_shift(2));var L=p.read_shift(2),U=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(U=t[p[p.l]]),p.l+=1,p.l+=2),S&&(p.l+=36);for(var N=[],Q={},re=Math.min(p.length,v==2?521:A-10-(w?264:0)),ee=S?32:11;p.l<re&&p[p.l]!=13;)switch(Q={},Q.name=jf.utils.decode(U,p.slice(p.l,p.l+ee)).replace(/[\u0000\r\n].*$/g,""),p.l+=ee,Q.type=String.fromCharCode(p.read_shift(1)),v!=2&&!S&&(Q.offset=p.read_shift(4)),Q.len=p.read_shift(1),v==2&&(Q.offset=p.read_shift(2)),Q.dec=p.read_shift(1),Q.name.length&&N.push(Q),v!=2&&(p.l+=S?13:14),Q.type){case"B":(!w||Q.len!=8)&&h.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Q.type)}if(p[p.l]!==13&&(p.l=A-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=A;var k=0,I=0;for(d[0]=[],I=0;I!=N.length;++I)d[0][I]=N[I].name;for(;E-- >0;){if(p[p.l]===42){p.l+=L;continue}for(++p.l,d[++k]=[],I=0,I=0;I!=N.length;++I){var R=p.slice(p.l,p.l+N[I].len);p.l+=N[I].len,Sn(R,0);var O=jf.utils.decode(U,R);switch(N[I].type){case"C":O.trim().length&&(d[k][I]=O.replace(/\s+$/,""));break;case"D":O.length===8?d[k][I]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):d[k][I]=O;break;case"F":d[k][I]=parseFloat(O.trim());break;case"+":case"I":d[k][I]=S?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":d[k][I]=!0;break;case"N":case"F":d[k][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[k][I]="##MEMO##"+(S?parseInt(O.trim(),10):R.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(d[k][I]=+O||0);break;case"@":d[k][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[k][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[k][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][I]=-R.read_shift(-8,"f");break;case"B":if(w&&N[I].len==8){d[k][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=N[I].len;break;case"0":if(N[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[I].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=N,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=mu(r(u,d),d);return p["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,p}function a(u,h){try{return Bo(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,h){var d=h||{};if(+d.codepage>=0&&pi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=fa(),v=Xd(u,{header:1,raw:!0,cellDates:!0}),_=v[0],w=v.slice(1),S=u["!cols"]||[],E=0,A=0,L=0,U=1;for(E=0;E<_.length;++E){if(((S[E]||{}).DBF||{}).name){_[E]=S[E].DBF.name,++L;continue}if(_[E]!=null){if(++L,typeof _[E]=="number"&&(_[E]=_[E].toString(10)),typeof _[E]!="string")throw new Error("DBF Invalid column name "+_[E]+" |"+typeof _[E]+"|");if(_.indexOf(_[E])!==E){for(A=0;A<1024;++A)if(_.indexOf(_[E]+"_"+A)==-1){_[E]+="_"+A;break}}}}var N=Bt(u["!ref"]),Q=[],re=[],ee=[];for(E=0;E<=N.e.c-N.s.c;++E){var k="",I="",R=0,O=[];for(A=0;A<w.length;++A)w[A][E]!=null&&O.push(w[A][E]);if(O.length==0||_[E]==null){Q[E]="?";continue}for(A=0;A<O.length;++A){switch(typeof O[A]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=O[A]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(O[A]).length),k=k&&k!=I?"C":I}R>250&&(R=250),I=((S[E]||{}).DBF||{}).type,I=="C"&&S[E].DBF.len>R&&(R=S[E].DBF.len),k=="B"&&I=="N"&&(k="N",ee[E]=S[E].DBF.dec,R=S[E].DBF.len),re[E]=k=="C"||I=="N"?R:o[k]||0,U+=re[E],Q[E]=k}var F=p.next(32);for(F.write_shift(4,318902576),F.write_shift(4,w.length),F.write_shift(2,296+32*L),F.write_shift(2,U),E=0;E<4;++E)F.write_shift(4,0);for(F.write_shift(4,0|(+e[E4]||3)<<8),E=0,A=0;E<_.length;++E)if(_[E]!=null){var D=p.next(32),V=(_[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,V,"sbcs"),D.write_shift(1,Q[E]=="?"?"C":Q[E],"sbcs"),D.write_shift(4,A),D.write_shift(1,re[E]||o[Q[E]]||0),D.write_shift(1,ee[E]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),A+=re[E]||o[Q[E]]||0}var Te=p.next(264);for(Te.write_shift(4,13),E=0;E<65;++E)Te.write_shift(4,0);for(E=0;E<w.length;++E){var oe=p.next(U);for(oe.write_shift(1,0),A=0;A<_.length;++A)if(_[A]!=null)switch(Q[A]){case"L":oe.write_shift(1,w[E][A]==null?63:w[E][A]?84:70);break;case"B":oe.write_shift(8,w[E][A]||0,"f");break;case"N":var Y="0";for(typeof w[E][A]=="number"&&(Y=w[E][A].toFixed(ee[A]||0)),L=0;L<re[A]-Y.length;++L)oe.write_shift(1,32);oe.write_shift(1,Y,"sbcs");break;case"D":w[E][A]?(oe.write_shift(4,("0000"+w[E][A].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(w[E][A].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+w[E][A].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(w[E][A]!=null?w[E][A]:"").slice(0,re[A]);for(oe.write_shift(1,ne,"sbcs"),L=0;L<re[A]-ne.length;++L)oe.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),MA=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Rr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,w){var S=t[w];return typeof S=="number"?AT(S):S},n=function(_,w,S){var E=w.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return E==59?_:AT(E)};t["|"]=254;function a(_,w){switch(w.type){case"base64":return o(Ia(_),w);case"binary":return o(_,w);case"buffer":return o(Tt&&Buffer.isBuffer(_)?_.toString("binary"):Vo(_),w);case"array":return o(Ol(_),w)}throw new Error("Unrecognized type "+w.type)}function o(_,w){var S=_.split(/[\n\r]+/),E=-1,A=-1,L=0,U=0,N=[],Q=[],re=null,ee={},k=[],I=[],R=[],O=0,F;for(+w.codepage>=0&&pi(+w.codepage);L!==S.length;++L){O=0;var D=S[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),V=D.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),Te=V[0],oe;if(D.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&Q.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,ne=!1,ve=!1,ie=!1,Ce=-1,K=-1;for(U=1;U<V.length;++U)switch(V[U].charAt(0)){case"A":break;case"X":A=parseInt(V[U].slice(1))-1,ne=!0;break;case"Y":for(E=parseInt(V[U].slice(1))-1,ne||(A=0),F=N.length;F<=E;++F)N[F]=[];break;case"K":oe=V[U].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(_i(oe))?isNaN(tu(oe).getDate())||(oe=xr(oe)):(oe=_i(oe),re!==null&&hu(re)&&(oe=Tm(oe))),Y=!0;break;case"E":ie=!0;var M=Xc(V[U].slice(1),{r:E,c:A});N[E][A]=[N[E][A],M];break;case"S":ve=!0,N[E][A]=[N[E][A],"S5S"];break;case"G":break;case"R":Ce=parseInt(V[U].slice(1))-1;break;case"C":K=parseInt(V[U].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+D)}if(Y&&(N[E][A]&&N[E][A].length==2?N[E][A][0]=oe:N[E][A]=oe,re=null),ve){if(ie)throw new Error("SYLK shared formula cannot have own formula");var q=Ce>-1&&N[Ce][K];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");N[E][A][1]=ZA(q[1],{r:E-Ce,c:A-K})}break;case"F":var G=0;for(U=1;U<V.length;++U)switch(V[U].charAt(0)){case"X":A=parseInt(V[U].slice(1))-1,++G;break;case"Y":for(E=parseInt(V[U].slice(1))-1,F=N.length;F<=E;++F)N[F]=[];break;case"M":O=parseInt(V[U].slice(1))/20;break;case"F":break;case"G":break;case"P":re=Q[parseInt(V[U].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=V[U].slice(1).split(" "),F=parseInt(R[0],10);F<=parseInt(R[1],10);++F)O=parseInt(R[2],10),I[F-1]=O===0?{hidden:!0}:{wch:O},Oo(I[F-1]);break;case"C":A=parseInt(V[U].slice(1))-1,I[A]||(I[A]={});break;case"R":E=parseInt(V[U].slice(1))-1,k[E]||(k[E]={}),O>0?(k[E].hpt=O,k[E].hpx=nu(O)):O===0&&(k[E].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+D)}G<1&&(re=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(ee["!rows"]=k),I.length>0&&(ee["!cols"]=I),w&&w.sheetRows&&(N=N.slice(0,w.sheetRows)),[N,ee]}function l(_,w){var S=a(_,w),E=S[0],A=S[1],L=mu(E,w);return Rr(A).forEach(function(U){L[U]=A[U]}),L}function u(_,w){return Bo(l(_,w),w)}function h(_,w,S,E){var A="C;Y"+(S+1)+";X"+(E+1)+";K";switch(_.t){case"n":A+=_.v||0,_.f&&!_.F&&(A+=";E"+sv(_.f,{r:S,c:E}));break;case"b":A+=_.v?"TRUE":"FALSE";break;case"e":A+=_.w||_.v;break;case"d":A+='"'+(_.w||_.v)+'"';break;case"s":A+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function d(_,w){w.forEach(function(S,E){var A="F;W"+(E+1)+" "+(E+1)+" ";S.hidden?A+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=$f(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Yf(S.wpx)),typeof S.wch=="number"&&(A+=Math.round(S.wch))),A.charAt(A.length-1)!=" "&&_.push(A)})}function p(_,w){w.forEach(function(S,E){var A="F;";S.hidden?A+="M0;":S.hpt?A+="M"+20*S.hpt+";":S.hpx&&(A+="M"+20*Qf(S.hpx)+";"),A.length>2&&_.push(A+"R"+(E+1))})}function v(_,w){var S=["ID;PWXL;N;E"],E=[],A=Bt(_["!ref"]),L,U=Array.isArray(_),N=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&d(S,_["!cols"]),_["!rows"]&&p(S,_["!rows"]),S.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var Q=A.s.r;Q<=A.e.r;++Q)for(var re=A.s.c;re<=A.e.c;++re){var ee=ot({r:Q,c:re});L=U?(_[Q]||[])[re]:_[ee],!(!L||L.v==null&&(!L.f||L.F))&&E.push(h(L,_,Q,re))}return S.join(N)+N+E.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:l,from_sheet:v}})(),LA=(function(){function t(o,l){switch(l.type){case"base64":return e(Ia(o),l);case"binary":return e(o,l);case"buffer":return e(Tt&&Buffer.isBuffer(o)?o.toString("binary"):Vo(o),l);case"array":return e(Ol(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),h=-1,d=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],d=0;continue}if(!(h<0)){var _=u[p].trim().split(","),w=_[0],S=_[1];++p;for(var E=u[p]||"";(E.match(/["]/g)||[]).length&1&&p<u.length-1;)E+=`
`+u[++p];switch(E=E.trim(),+w){case-1:if(E==="BOT"){v[++h]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?v[h][d]=!0:E==="FALSE"?v[h][d]=!1:isNaN(_i(S))?isNaN(tu(S).getDate())?v[h][d]=S:v[h][d]=xr(S):v[h][d]=_i(S),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),v[h][d++]=E!==""?E:null;break}if(E==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(o,l){return mu(t(o,l),l)}function n(o,l){return Bo(r(o,l),l)}var a=(function(){var o=function(h,d,p,v,_){h.push(d),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},l=function(h,d,p,v){h.push(d+","+p),h.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var d=[],p=Bt(h["!ref"]),v,_=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,p.e.r-p.s.r+1,""),o(d,"TUPLES",0,p.e.c-p.s.c+1,""),o(d,"DATA",0,0,"");for(var w=p.s.r;w<=p.e.r;++w){l(d,-1,0,"BOT");for(var S=p.s.c;S<=p.e.c;++S){var E=ot({r:w,c:S});if(v=_?(h[w]||[])[S]:h[E],!v){l(d,1,0,"");continue}switch(v.t){case"n":var A=v.w;!A&&v.v!=null&&(A=v.v),A==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,A,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Qa(v.z||st[14],on(xr(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var L=`\r
`,U=d.join(L);return U}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),PA=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var w=v.split(`
`),S=-1,E=-1,A=0,L=[];A!==w.length;++A){var U=w[A].trim().split(":");if(U[0]==="cell"){var N=Sr(U[1]);if(L.length<=N.r)for(S=L.length;S<=N.r;++S)L[S]||(L[S]=[]);switch(S=N.r,E=N.c,U[2]){case"t":L[S][E]=t(U[3]);break;case"v":L[S][E]=+U[3];break;case"vtf":var Q=U[U.length-1];case"vtc":U[3]==="nl"?L[S][E]=!!+U[4]:L[S][E]=+U[4],U[2]=="vtf"&&(L[S][E]=[L[S][E],Q])}}}return _&&_.sheetRows&&(L=L.slice(0,_.sheetRows)),L}function n(v,_){return mu(r(v,_),_)}function a(v,_){return Bo(n(v,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var _=[],w=[],S,E="",A=ha(v["!ref"]),L=Array.isArray(v),U=A.s.r;U<=A.e.r;++U)for(var N=A.s.c;N<=A.e.c;++N)if(E=ot({r:U,c:N}),S=L?(v[U]||[])[N]:v[E],!(!S||S.v==null||S.t==="z")){switch(w=["cell",E,"t"],S.t){case"s":case"str":w.push(e(S.v));break;case"n":S.f?(w[2]="vtf",w[3]="n",w[4]=S.v,w[5]=e(S.f)):(w[2]="v",w[3]=S.v);break;case"b":w[2]="vt"+(S.f?"f":"c"),w[3]="nl",w[4]=S.v?"1":"0",w[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var Q=on(xr(S.v));w[2]="vtc",w[3]="nd",w[4]=""+Q,w[5]=S.w||Qa(S.z||st[14],Q);break;case"e":continue}_.push(w.join(":"))}return _.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[o,l,u,l,d(v),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}})(),ru=(function(){function t(p,v,_,w,S){S.raw?v[_][w]=p:p===""||(p==="TRUE"?v[_][w]=!0:p==="FALSE"?v[_][w]=!1:isNaN(_i(p))?isNaN(tu(p).getDate())?v[_][w]=p:v[_][w]=xr(p):v[_][w]=_i(p))}function e(p,v){var _=v||{},w=[];if(!p||p.length===0)return w;for(var S=p.split(/[\r\n]/),E=S.length-1;E>=0&&S[E].length===0;)--E;for(var A=10,L=0,U=0;U<=E;++U)L=S[U].indexOf(" "),L==-1?L=S[U].length:L++,A=Math.max(A,L);for(U=0;U<=E;++U){w[U]=[];var N=0;for(t(S[U].slice(0,A).trim(),w,U,N,_),N=1;N<=(S[U].length-A)/10+1;++N)t(S[U].slice(A+(N-1)*10,A+N*10).trim(),w,U,N,_)}return _.sheetRows&&(w=w.slice(0,_.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var v={},_=!1,w=0,S=0;w<p.length;++w)(S=p.charCodeAt(w))==34?_=!_:!_&&S in r&&(v[S]=(v[S]||0)+1);S=[];for(w in v)Object.prototype.hasOwnProperty.call(v,w)&&S.push([v[w],w]);if(!S.length){v=n;for(w in v)Object.prototype.hasOwnProperty.call(v,w)&&S.push([v[w],w])}return S.sort(function(E,A){return E[0]-A[0]||n[E[1]]-n[A[1]]}),r[S.pop()[1]]||44}function o(p,v){var _=v||{},w="",S=_.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(w=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(w=p.charAt(4),p=p.slice(6)):w=a(p.slice(0,1024)):_&&_.FS?w=_.FS:w=a(p.slice(0,1024));var A=0,L=0,U=0,N=0,Q=0,re=w.charCodeAt(0),ee=!1,k=0,I=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var R=_.dateNF!=null?SF(_.dateNF):null;function O(){var F=p.slice(N,Q),D={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)D.t="z";else if(_.raw)D.t="s",D.v=F;else if(F.trim().length===0)D.t="s",D.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(D.t="s",D.v=F.slice(2,-1).replace(/""/g,'"')):ZP(F)?(D.t="n",D.f=F.slice(1)):(D.t="s",D.v=F);else if(F=="TRUE")D.t="b",D.v=!0;else if(F=="FALSE")D.t="b",D.v=!1;else if(!isNaN(U=_i(F)))D.t="n",_.cellText!==!1&&(D.w=F),D.v=U;else if(!isNaN(tu(F).getDate())||R&&F.match(R)){D.z=_.dateNF||st[14];var V=0;R&&F.match(R)&&(F=bF(F,_.dateNF,F.match(R)||[]),V=1),_.cellDates?(D.t="d",D.v=xr(F,V)):(D.t="n",D.v=on(xr(F,V))),_.cellText!==!1&&(D.w=Qa(D.z,D.v instanceof Date?on(D.v):D.v)),_.cellNF||delete D.z}else D.t="s",D.v=F;if(D.t=="z"||(_.dense?(S[A]||(S[A]=[]),S[A][L]=D):S[ot({c:L,r:A})]=D),N=Q+1,I=p.charCodeAt(N),E.e.c<L&&(E.e.c=L),E.e.r<A&&(E.e.r=A),k==re)++L;else if(L=0,++A,_.sheetRows&&_.sheetRows<=A)return!0}e:for(;Q<p.length;++Q)switch(k=p.charCodeAt(Q)){case 34:I===34&&(ee=!ee);break;case re:case 10:case 13:if(!ee&&O())break e;break}return Q-N>0&&O(),S["!ref"]=_t(E),S}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):mu(e(p,v),v)}function u(p,v){var _="",w=v.type=="string"?[0,0,0,0]:mv(p,v);switch(v.type){case"base64":_=Ia(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof jf<"u"||(_=Tt&&Buffer.isBuffer(p)?p.toString("binary"):Vo(p));break;case"array":_=Ol(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return w[0]==239&&w[1]==187&&w[2]==191?_=cr(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=cr(_):v.type=="binary"&&typeof jf<"u",_.slice(0,19)=="socialcalc:version:"?PA.to_sheet(v.type=="string"?_:cr(_),v):l(_,v)}function h(p,v){return Bo(u(p,v),v)}function d(p){for(var v=[],_=Bt(p["!ref"]),w,S=Array.isArray(p),E=_.s.r;E<=_.e.r;++E){for(var A=[],L=_.s.c;L<=_.e.c;++L){var U=ot({r:E,c:L});if(w=S?(p[E]||[])[L]:p[U],!w||w.v==null){A.push("          ");continue}for(var N=(w.w||(Ss(w),w.w)||"").slice(0,10);N.length<10;)N+=" ";A.push(N+(L===0?" ":""))}v.push(A.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function B7(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=MA.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return ru.to_workbook(t,e)}}var El=(function(){function t(M,q,G){if(M){Sn(M,M.l||0);for(var J=G.Enum||Ce;M.l<M.length;){var le=M.read_shift(2),ye=J[le]||J[65535],be=M.read_shift(2),Ee=M.l+be,Ie=ye.f&&ye.f(M,be,G);if(M.l=Ee,q(Ie,ye,le))return}}}function e(M,q){switch(q.type){case"base64":return r(Ca(Ia(M)),q);case"binary":return r(Ca(M),q);case"buffer":case"array":return r(M,q)}throw"Unsupported type "+q.type}function r(M,q){if(!M)return M;var G=q||{},J=G.dense?[]:{},le="Sheet1",ye="",be=0,Ee={},Ie=[],nt=[],te={s:{r:0,c:0},e:{r:0,c:0}},Ft=G.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)G.Enum=Ce,t(M,function(je,$t,Dt){switch(Dt){case 0:G.vers=je,je>=4096&&(G.qpro=!0);break;case 6:te=je;break;case 204:je&&(ye=je);break;case 222:ye=je;break;case 15:case 51:G.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:Dt==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=G.dateNF||st[14],G.cellDates&&(je[1].t="d",je[1].v=Tm(je[1].v))),G.qpro&&je[3]>be&&(J["!ref"]=_t(te),Ee[le]=J,Ie.push(le),J=G.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},be=je[3],le=ye||"Sheet"+(be+1),ye="");var Ut=G.dense?(J[je[0].r]||[])[je[0].c]:J[ot(je[0])];if(Ut){Ut.t=je[1].t,Ut.v=je[1].v,je[1].z!=null&&(Ut.z=je[1].z),je[1].f!=null&&(Ut.f=je[1].f);break}G.dense?(J[je[0].r]||(J[je[0].r]=[]),J[je[0].r][je[0].c]=je[1]):J[ot(je[0])]=je[1];break}},G);else if(M[2]==26||M[2]==14)G.Enum=K,M[2]==14&&(G.qpro=!0,M.l=0),t(M,function(je,$t,Dt){switch(Dt){case 204:le=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>be&&(J["!ref"]=_t(te),Ee[le]=J,Ie.push(le),J=G.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},be=je[3],le="Sheet"+(be+1)),Ft>0&&je[0].r>=Ft)break;G.dense?(J[je[0].r]||(J[je[0].r]=[]),J[je[0].r][je[0].c]=je[1]):J[ot(je[0])]=je[1],te.e.c<je[0].c&&(te.e.c=je[0].c),te.e.r<je[0].r&&(te.e.r=je[0].r);break;case 27:je[14e3]&&(nt[je[14e3][0]]=je[14e3][1]);break;case 1537:nt[je[0]]=je[1],je[0]==be&&(le=je[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(J["!ref"]=_t(te),Ee[ye||le]=J,Ie.push(ye||le),!nt.length)return{SheetNames:Ie,Sheets:Ee};for(var ht={},It=[],at=0;at<nt.length;++at)Ee[Ie[at]]?(It.push(nt[at]||Ie[at]),ht[nt[at]]=Ee[nt[at]]||Ee[Ie[at]]):(It.push(nt[at]),ht[nt[at]]={"!ref":"A1"});return{SheetNames:It,Sheets:ht}}function n(M,q){var G=q||{};if(+G.codepage>=0&&pi(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var J=fa(),le=Bt(M["!ref"]),ye=Array.isArray(M),be=[];ze(J,0,o(1030)),ze(J,6,h(le));for(var Ee=Math.min(le.e.r,8191),Ie=le.s.r;Ie<=Ee;++Ie)for(var nt=Vr(Ie),te=le.s.c;te<=le.e.c;++te){Ie===le.s.r&&(be[te]=Er(te));var Ft=be[te]+nt,ht=ye?(M[Ie]||[])[te]:M[Ft];if(!(!ht||ht.t=="z"))if(ht.t=="n")(ht.v|0)==ht.v&&ht.v>=-32768&&ht.v<=32767?ze(J,13,w(Ie,te,ht.v)):ze(J,14,E(Ie,te,ht.v));else{var It=Ss(ht);ze(J,15,v(Ie,te,It.slice(0,239)))}}return ze(J,1),J.end()}function a(M,q){var G=q||{};if(+G.codepage>=0&&pi(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var J=fa();ze(J,0,l(M));for(var le=0,ye=0;le<M.SheetNames.length;++le)(M.Sheets[M.SheetNames[le]]||{})["!ref"]&&ze(J,27,ie(M.SheetNames[le],ye++));var be=0;for(le=0;le<M.SheetNames.length;++le){var Ee=M.Sheets[M.SheetNames[le]];if(!(!Ee||!Ee["!ref"])){for(var Ie=Bt(Ee["!ref"]),nt=Array.isArray(Ee),te=[],Ft=Math.min(Ie.e.r,8191),ht=Ie.s.r;ht<=Ft;++ht)for(var It=Vr(ht),at=Ie.s.c;at<=Ie.e.c;++at){ht===Ie.s.r&&(te[at]=Er(at));var je=te[at]+It,$t=nt?(Ee[ht]||[])[at]:Ee[je];if(!(!$t||$t.t=="z"))if($t.t=="n")ze(J,23,O(ht,at,be,$t.v));else{var Dt=Ss($t);ze(J,22,k(ht,at,be,Dt.slice(0,239)))}}++be}}return ze(J,1),J.end()}function o(M){var q=Se(2);return q.write_shift(2,M),q}function l(M){var q=Se(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var G=0,J=0,le=0,ye=0;ye<M.SheetNames.length;++ye){var be=M.SheetNames[ye],Ee=M.Sheets[be];if(!(!Ee||!Ee["!ref"])){++le;var Ie=ha(Ee["!ref"]);G<Ie.e.r&&(G=Ie.e.r),J<Ie.e.c&&(J=Ie.e.c)}}return G>8191&&(G=8191),q.write_shift(2,G),q.write_shift(1,le),q.write_shift(1,J),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function u(M,q,G){var J={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&G.qpro?(J.s.c=M.read_shift(1),M.l++,J.s.r=M.read_shift(2),J.e.c=M.read_shift(1),M.l++,J.e.r=M.read_shift(2),J):(J.s.c=M.read_shift(2),J.s.r=M.read_shift(2),q==12&&G.qpro&&(M.l+=2),J.e.c=M.read_shift(2),J.e.r=M.read_shift(2),q==12&&G.qpro&&(M.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function h(M){var q=Se(8);return q.write_shift(2,M.s.c),q.write_shift(2,M.s.r),q.write_shift(2,M.e.c),q.write_shift(2,M.e.r),q}function d(M,q,G){var J=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(J[0].c=M.read_shift(1),J[3]=M.read_shift(1),J[0].r=M.read_shift(2),M.l+=2):(J[2]=M.read_shift(1),J[0].c=M.read_shift(2),J[0].r=M.read_shift(2)),J}function p(M,q,G){var J=M.l+q,le=d(M,q,G);if(le[1].t="s",G.vers==20768){M.l++;var ye=M.read_shift(1);return le[1].v=M.read_shift(ye,"utf8"),le}return G.qpro&&M.l++,le[1].v=M.read_shift(J-M.l,"cstr"),le}function v(M,q,G){var J=Se(7+G.length);J.write_shift(1,255),J.write_shift(2,q),J.write_shift(2,M),J.write_shift(1,39);for(var le=0;le<J.length;++le){var ye=G.charCodeAt(le);J.write_shift(1,ye>=128?95:ye)}return J.write_shift(1,0),J}function _(M,q,G){var J=d(M,q,G);return J[1].v=M.read_shift(2,"i"),J}function w(M,q,G){var J=Se(7);return J.write_shift(1,255),J.write_shift(2,q),J.write_shift(2,M),J.write_shift(2,G,"i"),J}function S(M,q,G){var J=d(M,q,G);return J[1].v=M.read_shift(8,"f"),J}function E(M,q,G){var J=Se(13);return J.write_shift(1,255),J.write_shift(2,q),J.write_shift(2,M),J.write_shift(8,G,"f"),J}function A(M,q,G){var J=M.l+q,le=d(M,q,G);if(le[1].v=M.read_shift(8,"f"),G.qpro)M.l=J;else{var ye=M.read_shift(2);Q(M.slice(M.l,M.l+ye),le),M.l+=ye}return le}function L(M,q,G){var J=q&32768;return q&=-32769,q=(J?M:0)+(q>=8192?q-16384:q),(J?"":"$")+(G?Er(q):Vr(q))}var U={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Q(M,q){Sn(M,0);for(var G=[],J=0,le="",ye="",be="",Ee="";M.l<M.length;){var Ie=M[M.l++];switch(Ie){case 0:G.push(M.read_shift(8,"f"));break;case 1:ye=L(q[0].c,M.read_shift(2),!0),le=L(q[0].r,M.read_shift(2),!1),G.push(ye+le);break;case 2:{var nt=L(q[0].c,M.read_shift(2),!0),te=L(q[0].r,M.read_shift(2),!1);ye=L(q[0].c,M.read_shift(2),!0),le=L(q[0].r,M.read_shift(2),!1),G.push(nt+te+":"+ye+le)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(M.read_shift(2));break;case 6:{for(var Ft="";Ie=M[M.l++];)Ft+=String.fromCharCode(Ie);G.push('"'+Ft.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:Ee=G.pop(),be=G.pop(),G.push(["AND","OR"][Ie-20]+"("+be+","+Ee+")");break;default:if(Ie<32&&N[Ie])Ee=G.pop(),be=G.pop(),G.push(be+N[Ie]+Ee);else if(U[Ie]){if(J=U[Ie][1],J==69&&(J=M[M.l++]),J>G.length){console.error("WK1 bad formula parse 0x"+Ie.toString(16)+":|"+G.join("|")+"|");return}var ht=G.slice(-J);G.length-=J,G.push(U[Ie][0]+"("+ht.join(",")+")")}else return Ie<=7?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=24?console.error("WK1 unsupported op "+Ie.toString(16)):Ie<=30?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=115?console.error("WK1 unsupported function opcode "+Ie.toString(16)):console.error("WK1 unrecognized opcode "+Ie.toString(16))}}G.length==1?q[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function re(M){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=M.read_shift(2),q[3]=M[M.l++],q[0].c=M[M.l++],q}function ee(M,q){var G=re(M);return G[1].t="s",G[1].v=M.read_shift(q-4,"cstr"),G}function k(M,q,G,J){var le=Se(6+J.length);le.write_shift(2,M),le.write_shift(1,G),le.write_shift(1,q),le.write_shift(1,39);for(var ye=0;ye<J.length;++ye){var be=J.charCodeAt(ye);le.write_shift(1,be>=128?95:be)}return le.write_shift(1,0),le}function I(M,q){var G=re(M);G[1].v=M.read_shift(2);var J=G[1].v>>1;if(G[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return G[1].v=J,G}function R(M,q){var G=re(M),J=M.read_shift(4),le=M.read_shift(4),ye=M.read_shift(2);if(ye==65535)return J===0&&le===3221225472?(G[1].t="e",G[1].v=15):J===0&&le===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var be=ye&32768;return ye=(ye&32767)-16446,G[1].v=(1-be*2)*(le*Math.pow(2,ye+32)+J*Math.pow(2,ye)),G}function O(M,q,G,J){var le=Se(14);if(le.write_shift(2,M),le.write_shift(1,G),le.write_shift(1,q),J==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var ye=0,be=0,Ee=0,Ie=0;return J<0&&(ye=1,J=-J),be=Math.log2(J)|0,J/=Math.pow(2,be-31),Ie=J>>>0,(Ie&2147483648)==0&&(J/=2,++be,Ie=J>>>0),J-=Ie,Ie|=2147483648,Ie>>>=0,J*=Math.pow(2,32),Ee=J>>>0,le.write_shift(4,Ee),le.write_shift(4,Ie),be+=16383+(ye?32768:0),le.write_shift(2,be),le}function F(M,q){var G=R(M);return M.l+=q-14,G}function D(M,q){var G=re(M),J=M.read_shift(4);return G[1].v=J>>6,G}function V(M,q){var G=re(M),J=M.read_shift(8,"f");return G[1].v=J,G}function Te(M,q){var G=V(M);return M.l+=q-10,G}function oe(M,q){return M[M.l+q-1]==0?M.read_shift(q,"cstr"):""}function Y(M,q){var G=M[M.l++];G>q-1&&(G=q-1);for(var J="";J.length<G;)J+=String.fromCharCode(M[M.l++]);return J}function ne(M,q,G){if(!(!G.qpro||q<21)){var J=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var le=M.read_shift(q-21,"cstr");return[J,le]}}function ve(M,q){for(var G={},J=M.l+q;M.l<J;){var le=M.read_shift(2);if(le==14e3){for(G[le]=[0,""],G[le][0]=M.read_shift(2);M[M.l];)G[le][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return G}function ie(M,q){var G=Se(5+M.length);G.write_shift(2,14e3),G.write_shift(2,q);for(var J=0;J<M.length;++J){var le=M.charCodeAt(J);G[G.l++]=le>127?95:le}return G[G.l++]=0,G}var Ce={0:{n:"BOF",f:Yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ee},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function U7(t){var e={},r=t.match(qn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=ft(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=Ix[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var j7=(function(){var t=Gf("t"),e=Gf("rPr");function r(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Vt(l[1])},h=o.match(e);return h&&(u.s=U7(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),z7=(function(){var e=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),l.push("</"+h+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),H7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,G7=/<(?:\w+:)?r>/,q7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Vt(cr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=cr(t),r&&(n.h=jx(n.t))):t.match(G7)&&(n.r=cr(t),n.t=Vt(cr((t.replace(q7,"").match(H7)||[]).join("").replace(qn,""))),r&&(n.h=z7(j7(n.r)))),n):{t:""}}var X7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,W7=/<(?:\w+:)?(?:si|sstItem)>/g,K7=/<\/(?:\w+:)?(?:si|sstItem)>/;function $7(t,e){var r=[],n="";if(!t)return r;var a=t.match(X7);if(a){n=a[2].replace(W7,"").split(K7);for(var o=0;o!=n.length;++o){var l=tv(n[o].trim(),e);l!=null&&(r[r.length]=l)}a=ft(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Y7=/^\s|\s$|[\t\n\r]/;function VA(t,e){if(!e.bookSST)return"";var r=[Br];r[r.length]=Ue("sst",null,{xmlns:Ul[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(Y7)&&(o+=' xml:space="preserve"'),o+=">"+nr(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Q7(t){return[t.read_shift(4),t.read_shift(4)]}function J7(t,e){var r=[],n=!1;return ks(t,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function Z7(t,e){return e||(e=Se(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var eL=uM;function tL(t){var e=fa();Fe(e,159,Z7(t));for(var r=0;r<t.length;++r)Fe(e,19,eL(t[r]));return Fe(e,160),e.end()}function BA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function vs(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function rL(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=vs(t,4),e.U=vs(t,4),e.W=vs(t,4),e}function nL(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function aL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(nL(t));return e}function iL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function sL(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=vs(t,4),e.U=vs(t,4),e.W=vs(t,4),e}function oL(t){var e=sL(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function UA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function jA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function lL(t){var e=vs(t);switch(e.Minor){case 2:return[e.Minor,cL(t)];case 3:return[e.Minor,uL()];case 4:return[e.Minor,fL(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function cL(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=UA(t,r),a=jA(t,t.length-t.l);return{t:"Std",h:n,v:a}}function uL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fL(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(qn,function(o){var l=ft(o);switch(Wi(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function hL(t,e){var r={},n=r.EncryptionVersionInfo=vs(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=UA(t,a),e-=a,r.EncryptionVerifier=jA(t,e),r}function dL(t){var e={},r=e.EncryptionVersionInfo=vs(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function rv(t){var e=0,r,n=BA(t),a=n.length+1,o,l,u,h,d;for(r=Do(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^l;return e^52811}var zA=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},o=function(l){for(var u=e[l.length-1],h=104,d=l.length-1;d>=0;--d)for(var p=l[d],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(l){for(var u=BA(l),h=o(u),d=u.length,p=Do(16),v=0;v!=16;++v)p[v]=0;var _,w,S;for((d&1)===1&&(_=h>>8,p[d]=a(t[0],_),--d,_=h&255,w=u[u.length-1],p[d]=a(w,_));d>0;)--d,_=h>>8,p[d]=a(u[d],_),--d,_=h&255,p[d]=a(u[d],_);for(d=15,S=15-u.length;S>0;)_=h>>8,p[d]=a(t[S],_),--d,--S,_=h&255,p[d]=a(u[d],_),--d,--S;return p}})(),mL=function(t,e,r,n,a){a||(a=e),n||(n=zA(t));var o,l;for(o=0;o!=e.length;++o)l=e[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},pL=function(t){var e=0,r=zA(t);return function(n){var a=mL("",n,e,r);return e=a[1],a[0]}};function gL(t,e,r,n){var a={key:Yr(t),verificationBytes:Yr(t)};return r.password&&(a.verifier=rv(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=pL(r.password)),a}function xL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=dL(t):n.Data=hL(t,e),n}function vL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?xL(t,e-2,n):gL(t,r.biff>=8?e:e-2,r,n),n}var HA=(function(){function t(a,o){switch(o.type){case"base64":return e(Ia(a),o);case"binary":return e(a,o);case"buffer":return e(Tt&&Buffer.isBuffer(a)?a.toString("binary"):Vo(a),o);case"array":return e(Ol(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,w=0,S,E=-1;S=_.exec(p);){switch(S[0]){case"\\cell":var A=p.slice(w,_.lastIndex-S[0].length);if(A[0]==" "&&(A=A.slice(1)),++E,A.length){var L={v:A,t:"s"};Array.isArray(u)?u[v][E]=L:u[ot({r:v,c:E})]=L}break}w=_.lastIndex}E>d.e.c&&(d.e.c=E)}),u["!ref"]=_t(d),u}function r(a,o){return Bo(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=Bt(a["!ref"]),u,h=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=ot({r:d,c:p});u=h?(a[d]||[])[p]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Ss(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function _L(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Kf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function yL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),l=a-o;if(l===0)return[0,0,e];var u=0,h=0,d=a+o;switch(h=l/(d>1?2-d:d),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,h,d/2]}function wL(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,l[0]+=a,l[1]+=h;break;case 1:h=a*(2-u),l[0]+=h,l[1]+=a;break;case 2:h=a*(u-2),l[1]+=a,l[2]+=h;break;case 3:h=a*(4-u),l[1]+=h,l[2]+=a;break;case 4:h=a*(u-4),l[2]+=a,l[0]+=h;break;case 5:h=a*(6-u),l[2]+=h,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function Gd(t,e){if(e===0)return t;var r=yL(_L(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Kf(wL(r))}var GA=6,TL=15,EL=1,Un=GA;function $f(t){return Math.floor((t+Math.round(128/Un)/256)*Un)}function Yf(t){return Math.floor((t-5)/Un*100+.5)/100}function qd(t){return Math.round((t*Un+5)/Un*256)/256}function Hp(t){return qd(Yf($f(t)))}function nv(t){var e=Math.abs(t-Hp(t)),r=Un;if(e>.005)for(Un=EL;Un<TL;++Un)Math.abs(t-Hp(t))<=e&&(e=Math.abs(t-Hp(t)),r=Un);Un=r}function Oo(t){t.width?(t.wpx=$f(t.width),t.wch=Yf(t.wpx),t.MDW=Un):t.wpx?(t.wch=Yf(t.wpx),t.width=qd(t.wch),t.MDW=Un):typeof t.wch=="number"&&(t.width=qd(t.wch),t.wpx=$f(t.width),t.MDW=Un),t.customWidth&&delete t.customWidth}var SL=96,qA=SL;function Qf(t){return t*96/qA}function nu(t){return t*qA/96}var bL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AL(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(qn)||[]).forEach(function(l){var u=ft(l);switch(Wi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=mr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=mr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function kL(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(qn)||[]).forEach(function(l){var u=ft(l);switch(Wi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function CL(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(qn)||[]).forEach(function(l){var u=ft(l);switch(Wi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=cr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?mr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?mr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?mr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?mr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?mr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?mr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?mr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Ix[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=mr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=wl[a.color.index];a.color.index==81&&(h=wl[1]),h||(h=wl[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Gd(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function NL(t,e,r){e.NumberFmt=[];for(var n=Rr(st),a=0;a<n.length;++a)e.NumberFmt[n[a]]=st[n[a]];var o=t[0].match(qn);if(o)for(a=0;a<o.length;++a){var l=ft(o[a]);switch(Wi(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Vt(cr(l.formatCode)),h=parseInt(l.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}xs(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function RL(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:n,formatCode:nr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Qh=["numFmtId","fillId","fontId","borderId","xfId"],Jh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function IL(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(qn)||[]).forEach(function(o){var l=ft(o),u=0;switch(Wi(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<Qh.length;++u)n[Qh[u]]&&(n[Qh[u]]=parseInt(n[Qh[u]],10));for(u=0;u<Jh.length;++u)n[Jh[u]]&&(n[Jh[u]]=mr(n[Jh[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};l.vertical&&(h.vertical=l.vertical),l.horizontal&&(h.horizontal=l.horizontal),l.textRotation!=null&&(h.textRotation=l.textRotation),l.indent&&(h.indent=l.indent),l.wrapText&&(h.wrapText=mr(l.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function DL(t){var e=[];return e[e.length]=Ue("cellXfs",null),t.forEach(function(r){e[e.length]=Ue("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var OL=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&NL(v,p,d),(v=u.match(a))&&CL(v,p,h,d),(v=u.match(n))&&kL(v,p,h,d),(v=u.match(o))&&AL(v,p,h,d),(v=u.match(r))&&IL(v,p,d),p}})();function XA(t,e){var r=[Br,Ue("styleSheet",null,{xmlns:Ul[0],"xmlns:vt":an.vt})],n;return t.SSF&&(n=RL(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=DL(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function FL(t,e){var r=t.read_shift(2),n=zn(t);return[r,n]}function ML(t,e,r){r||(r=Se(6+4*e.length)),r.write_shift(2,t),pn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function LL(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=xM(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=gM(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zn(t),n}function PL(t,e){e||(e=Se(153)),e.write_shift(2,t.sz*20),vM(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),jd(t.color,e);var n=0;return n=2,e.write_shift(1,n),pn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var VL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gp,BL=Gn;function gE(t,e){e||(e=Se(84)),Gp||(Gp=ym(VL));var r=Gp[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(jd({auto:1},e),jd({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function UL(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function WA(t,e,r){r||(r=Se(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ff(t,e){return e||(e=Se(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var jL=Gn;function zL(t,e){return e||(e=Se(51)),e.write_shift(1,0),ff(null,e),ff(null,e),ff(null,e),ff(null,e),ff(null,e),e.length>e.l?e.slice(0,e.l):e}function HL(t,e){return e||(e=Se(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ud(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function GL(t,e,r){var n=Se(2052);return n.write_shift(4,t),Ud(e,n),Ud(r,n),n.length>n.l?n.slice(0,n.l):n}function qL(t,e,r){var n={};n.NumberFmt=[];for(var a in st)n.NumberFmt[a]=st[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return ks(t,function(h,d,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],xs(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=Gd(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(d.T>0)o.push(p);else if(d.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function XL(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Fe(t,615,yi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Fe(t,44,ML(a,e[a]))}),Fe(t,616))}}function WL(t){var e=1;Fe(t,611,yi(e)),Fe(t,43,PL({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(t,612)}function KL(t){var e=2;Fe(t,603,yi(e)),Fe(t,45,gE({patternType:"none"})),Fe(t,45,gE({patternType:"gray125"})),Fe(t,604)}function $L(t){var e=1;Fe(t,613,yi(e)),Fe(t,46,zL()),Fe(t,614)}function YL(t){var e=1;Fe(t,626,yi(e)),Fe(t,47,WA({numFmtId:0},65535)),Fe(t,627)}function QL(t,e){Fe(t,617,yi(e.length)),e.forEach(function(r){Fe(t,47,WA(r,0))}),Fe(t,618)}function JL(t){var e=1;Fe(t,619,yi(e)),Fe(t,48,HL({xfId:0,name:"Normal"})),Fe(t,620)}function ZL(t){var e=0;Fe(t,505,yi(e)),Fe(t,506)}function eP(t){var e=0;Fe(t,508,GL(e,"TableStyleMedium9","PivotStyleMedium4")),Fe(t,509)}function tP(t,e){var r=fa();return Fe(r,278),XL(r,t.SSF),WL(r),KL(r),$L(r),YL(r),QL(r,e.cellXfs),JL(r),ZL(r),eP(r),Fe(r,279),r.end()}var rP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function nP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(qn)||[]).forEach(function(a){var o=ft(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[rP.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function aP(){}function iP(){}var sP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,oP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,lP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function cP(t,e,r){e.themeElements={};var n;[["clrScheme",sP,nP],["fontScheme",oP,aP],["fmtScheme",lP,iP]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var uP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function KA(t,e){(!t||t.length===0)&&(t=av());var r,n={};if(!(r=t.match(uP)))throw new Error("themeElements not found in theme");return cP(r[0],n,e),n.raw=t,n}function av(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Br];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fP(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=U4(o,{type:"array"})}catch{return}var u=Na(l,"theme/theme/theme1.xml",!0);if(u)return KA(u,r)}}function hP(t){return t.read_shift(4)}function dP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=mP(t,4);break;case 2:e.xclrValue=kA(t);break;case 3:e.xclrValue=hP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function mP(t,e){return Gn(t,e)}function pP(t,e){return Gn(t,e)}function gP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=dP(t);break;case 6:n[1]=pP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function xP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(gP(t,r-t.l));return{ixfe:n,ext:o}}function vP(t,e){e.forEach(function(r){r[0]})}function _P(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:zn(t)}}function yP(t){var e=Se(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),pn(t.name,e),e.slice(0,e.l)}function wP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function TP(t){var e=Se(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function EP(t,e){var r=Se(8+2*e.length);return r.write_shift(4,t),pn(e,r),r.slice(0,r.l)}function SP(t){return t.l+=4,t.read_shift(4)!=0}function bP(t,e){var r=Se(8);return r.write_shift(4,t),r.write_shift(4,1),r}function AP(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return ks(t,function(h,d,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function kP(){var t=fa();return Fe(t,332),Fe(t,334,yi(1)),Fe(t,335,yP({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(t,336),Fe(t,339,EP(1,"XLDAPR")),Fe(t,52),Fe(t,35,yi(514)),Fe(t,4096,yi(0)),Fe(t,4097,Ka(1)),Fe(t,36),Fe(t,53),Fe(t,340),Fe(t,337,bP(1)),Fe(t,51,TP([[1,0]])),Fe(t,338),Fe(t,333),t.end()}function CP(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,l;return t.replace(qn,function(u){var h=ft(u);switch(Wi(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function $A(){var t=[Br];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function NP(t){var e=[];if(!t)return e;var r=1;return(t.match(qn)||[]).forEach(function(n){var a=ft(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function RP(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function IP(t,e,r){var n=[];return ks(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function DP(t,e,r,n){if(!t)return t;var a=n||{},o=!1;ks(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function OP(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Vc=1024;function YA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Aa.v,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:mv":Aa.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Vc<t*1e3;)Vc+=1e3;return e.forEach(function(o){var l=Sr(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",h,u),p={on:"t",obscured:"t"};++Vc,a=a.concat(["<v:shape"+qf({id:"_x0000_s"+Vc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,p),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",An("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),An("x:AutoFill","False"),An("x:Row",String(l.r)),An("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function xE(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(l){var u=Sr(l.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[l.ref]=o;var h=Bt(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=_t(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:r};l.h&&(p.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function FP(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=ft(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Sr(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&tv(v[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function QA(t){var e=[Br,Ue("comments",null,{xmlns:Ul[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var o=nr(a.a);r.indexOf(o)==-1&&(r.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(a=r.indexOf(nr(h.a))),o.push(h.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(An("t",nr(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(An("t",nr(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function MP(t,e){var r=[],n=!1,a={},o=0;return t.replace(qn,function(u,h){var d=ft(u);switch(Wi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":a.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function LP(t,e,r){var n=[Br,Ue("ThreadedComments",null,{xmlns:an.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var h={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=h.id:h.parentId=o,l.ID=h.id,l.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Ue("threadedComment",An("text",l.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function PP(t,e){var r=[],n=!1;return t.replace(qn,function(o){var l=ft(o);switch(Wi(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function VP(t){var e=[Br,Ue("personList",null,{xmlns:an.TCMNT,"xmlns:x":Ul[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function BP(t){var e={};e.iauthor=t.read_shift(4);var r=Gl(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function UP(t,e){return e==null&&(e=Se(36)),e.write_shift(4,t[1].iauthor),pu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var jP=zn;function zP(t){return pn(t.slice(0,54))}function HP(t,e){var r=[],n=[],a={},o=!1;return ks(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function GP(t){var e=fa(),r=[];return Fe(e,628),Fe(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Fe(e,632,zP(a.a)))})}),Fe(e,631),Fe(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:Sr(n[0]),e:Sr(n[0])};Fe(e,635,UP([o,a])),a.t&&a.t.length>0&&Fe(e,637,hM(a)),Fe(e,636),delete a.iauthor})}),Fe(e,634),Fe(e,629),e.end()}var qP="application/vnd.ms-office.vbaProject";function XP(t){var e=tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),tt.write(e)}function WP(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&tt.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var JA=["xlsb","xlsm","xlam","biff8","xla"];function KP(){return{"!type":"dialog"}}function $P(){return{"!type":"dialog"}}function YP(){return{"!type":"macro"}}function QP(){return{"!type":"macro"}}var Xc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,l){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,a+(u?"":"$")+Er(p)+(h?"":"$")+Vr(d)}return function(a,o){return e=o,a.replace(t,r)}})(),iv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sv=(function(){return function(e,r){return e.replace(iv,function(n,a,o,l,u,h){var d=Xx(l)-(o?0:r.c),p=qx(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=d==0?"":o?d+1:"["+d+"]";return a+"R"+v+"C"+_})}})();function ZA(t,e){return t.replace(iv,function(r,n,a,o,l,u){return n+(a=="$"?a+o:Er(Xx(o)+e.c))+(l=="$"?l+u:Vr(qx(u)+e.r))})}function JP(t,e,r){var n=ha(e),a=n.s,o=Sr(r),l={r:o.r-a.r,c:o.c-a.c};return ZA(t,l)}function ZP(t){return t.length!=1}function vE(t){return t.replace(/_xlfn\./g,"")}function Wr(t){t.l+=1}function Fo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ek(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tk(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),l=Fo(t),u=Fo(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function tk(t){var e=Fo(t),r=Fo(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function eV(t,e,r){if(r.biff<8)return tk(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=Fo(t),l=Fo(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function rk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return tV(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Fo(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function tV(t){var e=Fo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function rV(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function nV(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return aV(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function aV(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function iV(t,e,r){var n=(t[t.l++]&96)>>5,a=ek(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function sV(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=ek(t,o,r);return[n,a,l]}function oV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function lV(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function cV(t,e,r){var n=(t[t.l++]&96)>>5,a=eV(t,e-1,r);return[n,a]}function uV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _E(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function fV(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function hV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function dV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function mV(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function pV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function nk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function gV(t){return t.read_shift(2),nk(t)}function xV(t){return t.read_shift(2),nk(t)}function vV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=rk(t,0,r);return[n,a]}function _V(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=nV(t,0,r);return[n,a]}function yV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=rk(t,0,r);return[n,a,o]}function wV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[SB[a],sk[a],n]}function TV(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:EV(t);return[a,(o[0]===0?sk:EB)[o[1]]]}function EV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function SV(t,e,r){t.l+=r&&r.biff==2?3:4}function bV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function AV(t){return t.l++,Cs[t.read_shift(1)]}function kV(t){return t.l++,t.read_shift(2)}function CV(t){return t.l++,t.read_shift(1)!==0}function NV(t){return t.l++,jn(t)}function RV(t,e,r){return t.l++,m0(t,e-1,r)}function IV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Cs[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=jn(t);break;case 2:r[1]=ql(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function DV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?Gl:Em)(t));return a}function OV(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=IV(t,r.biff);return l}function FV(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function MV(t,e,r){if(r.biff==5)return LV(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function LV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function PV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function VV(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function BV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function UV(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var jV=Gn,zV=Gn,HV=Gn;function g0(t,e,r){return t.l+=2,[rV(t)]}function ov(t){return t.l+=6,[]}var GV=g0,qV=ov,XV=ov,WV=g0;function ak(t){return t.l+=2,[Yr(t),t.read_shift(2)&1]}var KV=g0,$V=ak,YV=ov,QV=g0,JV=g0,ZV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),l=ZV[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:o}}function tB(t){return t.l+=2,[t.read_shift(4)]}function rB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function nB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function aB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function iB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function sB(t){return t.l+=4,[0,0]}var yE={1:{n:"PtgExp",f:bV},2:{n:"PtgTbl",f:HV},3:{n:"PtgAdd",f:Wr},4:{n:"PtgSub",f:Wr},5:{n:"PtgMul",f:Wr},6:{n:"PtgDiv",f:Wr},7:{n:"PtgPower",f:Wr},8:{n:"PtgConcat",f:Wr},9:{n:"PtgLt",f:Wr},10:{n:"PtgLe",f:Wr},11:{n:"PtgEq",f:Wr},12:{n:"PtgGe",f:Wr},13:{n:"PtgGt",f:Wr},14:{n:"PtgNe",f:Wr},15:{n:"PtgIsect",f:Wr},16:{n:"PtgUnion",f:Wr},17:{n:"PtgRange",f:Wr},18:{n:"PtgUplus",f:Wr},19:{n:"PtgUminus",f:Wr},20:{n:"PtgPercent",f:Wr},21:{n:"PtgParen",f:Wr},22:{n:"PtgMissArg",f:Wr},23:{n:"PtgStr",f:RV},26:{n:"PtgSheet",f:rB},27:{n:"PtgEndSheet",f:nB},28:{n:"PtgErr",f:AV},29:{n:"PtgBool",f:CV},30:{n:"PtgInt",f:kV},31:{n:"PtgNum",f:NV},32:{n:"PtgArray",f:uV},33:{n:"PtgFunc",f:wV},34:{n:"PtgFuncVar",f:TV},35:{n:"PtgName",f:FV},36:{n:"PtgRef",f:vV},37:{n:"PtgArea",f:iV},38:{n:"PtgMemArea",f:PV},39:{n:"PtgMemErr",f:jV},40:{n:"PtgMemNoMem",f:zV},41:{n:"PtgMemFunc",f:VV},42:{n:"PtgRefErr",f:BV},43:{n:"PtgAreaErr",f:oV},44:{n:"PtgRefN",f:_V},45:{n:"PtgAreaN",f:cV},46:{n:"PtgMemAreaN",f:aB},47:{n:"PtgMemNoMemN",f:iB},57:{n:"PtgNameX",f:MV},58:{n:"PtgRef3d",f:yV},59:{n:"PtgArea3d",f:sV},60:{n:"PtgRefErr3d",f:UV},61:{n:"PtgAreaErr3d",f:lV},255:{}},oB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lB={1:{n:"PtgElfLel",f:ak},2:{n:"PtgElfRw",f:QV},3:{n:"PtgElfCol",f:GV},6:{n:"PtgElfRwV",f:JV},7:{n:"PtgElfColV",f:WV},10:{n:"PtgElfRadical",f:KV},11:{n:"PtgElfRadicalS",f:YV},13:{n:"PtgElfColS",f:qV},15:{n:"PtgElfColSV",f:XV},16:{n:"PtgElfRadicalLel",f:$V},25:{n:"PtgList",f:eB},29:{n:"PtgSxName",f:tB},255:{}},cB={0:{n:"PtgAttrNoop",f:sB},1:{n:"PtgAttrSemi",f:pV},2:{n:"PtgAttrIf",f:dV},4:{n:"PtgAttrChoose",f:fV},8:{n:"PtgAttrGoto",f:hV},16:{n:"PtgAttrSum",f:SV},32:{n:"PtgAttrBaxcel",f:_E},33:{n:"PtgAttrBaxcel",f:_E},64:{n:"PtgAttrSpace",f:gV},65:{n:"PtgAttrSpaceSemi",f:xV},128:{n:"PtgAttrIfError",f:mV},255:{}};function x0(t,e,r,n){if(n.biff<8)return Gn(t,e);for(var a=t.l+e,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=OV(t,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=DV(t,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&o.push(Gn(t,e)),o}function v0(t,e,r){for(var n=t.l+e,a,o,l=[];n!=t.l;)e=n-t.l,o=t[t.l],a=yE[o]||yE[oB[o]],(o===24||o===25)&&(a=(o===24?lB:cB)[t[t.l+1]]),!a||!a.f?Gn(t,e):l.push([a.n,a.f(t,e,r)]);return l}function uB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var l=n[o];l?l[0]===2?a.push('"'+l[1].replace(/"/g,'""')+'"'):a.push(l[1]):a.push("")}e.push(a.join(","))}return e.join(";")}var fB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ik(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function wE(t,e,r){var n=ik(t,e,r);return n=="#REF"?n:hB(n,r)}function Vn(t,e,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],h,d,p,v=0,_=0,w,S="";if(!t[0]||!t[0][0])return"";for(var E=-1,A="",L=0,U=t[0].length;L<U;++L){var N=t[0][L];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),E>=0){switch(t[0][E][1][0]){case 0:A=Cr(" ",t[0][E][1][1]);break;case 1:A=Cr("\r",t[0][E][1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}d=d+A,E=-1}u.push(d+fB[N[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Af(N[1][1],l,a),u.push(kf(p,o));break;case"PtgRefN":p=r?Af(N[1][1],r,a):N[1][1],u.push(kf(p,o));break;case"PtgRef3d":v=N[1][1],p=Af(N[1][2],l,a),S=wE(n,v,a),u.push(S+"!"+kf(p,o));break;case"PtgFunc":case"PtgFuncVar":var Q=N[1][0],re=N[1][1];Q||(Q=0),Q&=127;var ee=Q==0?[]:u.slice(-Q);u.length-=Q,re==="User"&&(re=ee.shift()),u.push(re+"("+ee.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":w=YT(N[1][1],r?{s:r}:l,a),u.push(Up(w,a));break;case"PtgArea":w=YT(N[1][1],l,a),u.push(Up(w,a));break;case"PtgArea3d":v=N[1][1],w=N[1][2],S=wE(n,v,a),u.push(S+"!"+Up(w,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=N[1][2];var k=(n.names||[])[_-1]||(n[0]||[])[_],I=k?k.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var R=N[1][1];_=N[1][2];var O;if(a.biff<=5)R<0&&(R=-R),n[R]&&(O=n[R][_]);else{var F="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][_]&&n[R][_].itab>0&&(F=n.SheetNames[n[R][_].itab-1]+"!"):F=n.SheetNames[_-1]+"!"),n[R]&&n[R][_])F+=n[R][_].Name;else if(n[0]&&n[0][_])F+=n[0][_].Name;else{var D=(ik(n,R,a)||"").split(";;");D[_-1]?F=D[_-1]:F+="SH33TJSERRX"}u.push(F);break}O||(O={Name:"SH33TJSERRY"}),u.push(O.Name);break;case"PtgParen":var V="(",Te=")";if(E>=0){switch(A="",t[0][E][1][0]){case 2:V=Cr(" ",t[0][E][1][1])+V;break;case 3:V=Cr("\r",t[0][E][1][1])+V;break;case 4:Te=Cr(" ",t[0][E][1][1])+Te;break;case 5:Te=Cr("\r",t[0][E][1][1])+Te;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}E=-1}u.push(V+u.pop()+Te);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:N[1][1],r:N[1][0]};var oe={c:r.c,r:r.r};if(n.sharedf[ot(p)]){var Y=n.sharedf[ot(p)];u.push(Vn(Y,l,oe,n,a))}else{var ne=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Vn(d[1],l,oe,n,a)),ne=!0;break}ne||u.push(N[1])}break;case"PtgArray":u.push("{"+uB(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&E>=0&&ve.indexOf(t[0][L][0])==-1){N=t[0][E];var ie=!0;switch(N[1][0]){case 4:ie=!1;case 0:A=Cr(" ",N[1][1]);break;case 5:ie=!1;case 1:A=Cr("\r",N[1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((ie?A:"")+u.pop()+(ie?"":A)),E=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function dB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Gn(t,e-2)];var u=v0(t,l,r);return e!==l+a&&(o=x0(t,e-l-a,u,r)),t.l=n,[u,o]}function mB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Gn(t,e-2)];var u=v0(t,l,r);return e!==l+a&&(o=x0(t,e-l-a,u,r)),t.l=n,[u,o]}function pB(t,e,r,n){var a=t.l+e,o=v0(t,n,r),l;return a!==t.l&&(l=x0(t,a-t.l,o,r)),[o,l]}function gB(t,e,r){var n=t.l+e,a,o=t.read_shift(2),l=v0(t,o,r);return o==65535?[[],Gn(t,e-2)]:(e!==o+2&&(a=x0(t,n-o-2,l,r)),[l,a])}function xB(t){var e;if(ps(t,t.l+6)!==65535)return[jn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function vB(t){if(t==null){var e=Se(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Fl(t);return Fl(0)}function qp(t,e,r){var n=t.l+e,a=Ki(t);r.biff==2&&++t.l;var o=xB(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=mB(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function _B(t,e,r,n,a){var o=Ll(e,r,a),l=vB(t.v),u=Se(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=Se(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var v=mn([o,l,u,d]);return v}function Sm(t,e,r){var n=t.read_shift(4),a=v0(t,n,r),o=t.read_shift(4),l=o>0?x0(t,o,a,r):null;return[a,l]}var yB=Sm,bm=Sm,wB=Sm,TB=Sm,EB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},SB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function bB(t){var e="of:="+t.replace(iv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Xp(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function AB(t){return t.replace(/\./,"!")}var Nf={},Wc={},Rf=typeof Map<"u";function lv(t,e,r){var n=0,a=t.length;if(r){if(Rf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var o=Rf?r.get(e):r[e];n<o.length;++n)if(t[o[n]].t===e)return t.Count++,o[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Rf?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Am(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Un=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Yf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=qd(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Sl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Uo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){xs(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===n)return a;return t[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function ok(t,e,r,n,a,o){try{n.cellNF&&(t.z=st[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=xr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(st[e]==null&&xs(EF[e]||"General",e),t.t==="e")t.w=t.w||Cs[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Hf(t.v);else if(t.t==="d"){var l=on(t.v);(l|0)===l?t.w=l.toString(10):t.w=Hf(l)}else{if(t.v===void 0)return"";t.w=Dl(t.v,Wc)}else t.t==="d"?t.w=Qa(e,on(t.v),Wc):t.w=Qa(e,t.v,Wc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Gd(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Gd(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function kB(t,e,r){if(t&&t["!ref"]){var n=Bt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function CB(t,e){var r=Bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=_t(r))}var NB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IB=/<(?:\w:)?hyperlink [^>]*>/mg,DB=/"(\w*:\w*)"/,OB=/<(?:\w:)?col\b[^>]*[\/]?>/g,FB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MB=/<(?:\w:)?pageMargins[^>]*\/>/g,lk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,LB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function VB(t,e,r,n,a,o,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",v=t.match(RB);v?(d=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):d=p=t;var _=d.match(lk);_?cv(_[0],u,a,r):(_=d.match(LB))&&UB(_[0],_[1]||"",u,a,r);var w=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var S=d.slice(w,w+50).match(DB);S&&CB(u,S[1])}var E=d.match(PB);E&&E[1]&&ZB(E[1],a);var A=[];if(e.cellStyles){var L=d.match(OB);L&&KB(A,L)}v&&rU(v[1],u,e,h,o,l);var U=p.match(FB);U&&(u["!autofilter"]=YB(U[0]));var N=[],Q=p.match(NB);if(Q)for(w=0;w!=Q.length;++w)N[w]=Bt(Q[w].slice(Q[w].indexOf('"')+1));var re=p.match(IB);re&&qB(u,re,n);var ee=p.match(MB);if(ee&&(u["!margins"]=XB(ft(ee[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=_t(h)),e.sheetRows>0&&u["!ref"]){var k=Bt(u["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>h.e.r&&(k.e.r=h.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>h.e.c&&(k.e.c=h.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(k))}return A.length>0&&(u["!cols"]=A),N.length>0&&(u["!merges"]=N),u}function BB(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+_t(t[r])+'"/>';return e+"</mergeCells>"}function cv(t,e,r,n){var a=ft(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Vt(cr(a.codeName)))}function UB(t,e,r,n,a){cv(t.slice(0,t.indexOf(">")),r,n,a)}function jB(t,e,r,n,a){var o=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}o=!0,l.codeName=Pi(nr(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ue("outlinePr",null,d)}!o&&!u||(a[a.length]=Ue("sheetPr",u,l))}var zB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],HB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function GB(t){var e={sheet:1};return zB.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),HB.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=rv(t.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function qB(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=ft(cr(e[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Vt(o.location))):(o.Target="#"+Vt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Bt(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=ot({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=o)}}}function XB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function WB(t){return Sl(t),Ue("pageMargins",null,t)}function KB(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=ft(e[n],!0);a.hidden&&(a.hidden=mr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,nv(a.width)),Oo(a);o<=l;)t[o++]=vr(a)}}function $B(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Ue("col",null,Am(a,n)));return r[r.length]="</cols>",r.join("")}function YB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function QB(t,e,r,n){var a=typeof t.ref=="string"?t.ref:_t(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ha(a);l.s.r==l.e.r&&(l.e.r=ha(e["!ref"]).e.r,a=_t(l));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}var JB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ZB(t,e){e.Views||(e.Views=[{}]),(t.match(JB)||[]).forEach(function(r,n){var a=ft(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),mr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function eU(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function tU(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Cs[t.v];break;case"d":n&&n.cellDates?a=xr(t.v,-1).toISOString():(t=vr(t),t.t="n",a=""+(t.v=on(xr(t.v)))),typeof t.z>"u"&&(t.z=st[14]);break;default:a=t.v;break}var u=An("v",nr(a)),h={r:e},d=Uo(n.cellXfs,t,n);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=An("v",""+lv(n.Strings,t.v,n.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=o&&(t.t=o,t.v=l),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ue("f",nr(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),Ue("c",u,h)}var rU=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Gf("v"),l=Gf("f");return function(h,d,p,v,_,w){for(var S=0,E="",A=[],L=[],U=0,N=0,Q=0,re="",ee,k,I=0,R=0,O,F,D=0,V=0,Te=Array.isArray(w.CellXf),oe,Y=[],ne=[],ve=Array.isArray(d),ie=[],Ce={},K=!1,M=!!p.sheetStubs,q=h.split(e),G=0,J=q.length;G!=J;++G){E=q[G].trim();var le=E.length;if(le!==0){var ye=0;e:for(S=0;S<le;++S)switch(E[S]){case">":if(E[S-1]!="/"){++S;break e}if(p&&p.cellStyles){if(k=ft(E.slice(ye,S),!0),I=k.r!=null?parseInt(k.r,10):I+1,R=-1,p.sheetRows&&p.sheetRows<I)continue;Ce={},K=!1,k.ht&&(K=!0,Ce.hpt=parseFloat(k.ht),Ce.hpx=nu(Ce.hpt)),k.hidden=="1"&&(K=!0,Ce.hidden=!0),k.outlineLevel!=null&&(K=!0,Ce.level=+k.outlineLevel),K&&(ie[I-1]=Ce)}break;case"<":ye=S;break}if(ye>=S)break;if(k=ft(E.slice(ye,S),!0),I=k.r!=null?parseInt(k.r,10):I+1,R=-1,!(p.sheetRows&&p.sheetRows<I)){v.s.r>I-1&&(v.s.r=I-1),v.e.r<I-1&&(v.e.r=I-1),p&&p.cellStyles&&(Ce={},K=!1,k.ht&&(K=!0,Ce.hpt=parseFloat(k.ht),Ce.hpx=nu(Ce.hpt)),k.hidden=="1"&&(K=!0,Ce.hidden=!0),k.outlineLevel!=null&&(K=!0,Ce.level=+k.outlineLevel),K&&(ie[I-1]=Ce)),A=E.slice(S).split(t);for(var be=0;be!=A.length&&A[be].trim().charAt(0)=="<";++be);for(A=A.slice(be),S=0;S!=A.length;++S)if(E=A[S].trim(),E.length!==0){if(L=E.match(r),U=S,N=0,Q=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,L!=null&&L.length===2){for(U=0,re=L[1],N=0;N!=re.length&&!((Q=re.charCodeAt(N)-64)<1||Q>26);++N)U=26*U+Q;--U,R=U}else++R;for(N=0;N!=E.length&&E.charCodeAt(N)!==62;++N);if(++N,k=ft(E.slice(0,N),!0),k.r||(k.r=ot({r:I-1,c:R})),re=E.slice(N),ee={t:""},(L=re.match(o))!=null&&L[1]!==""&&(ee.v=Vt(L[1])),p.cellFormula){if((L=re.match(l))!=null&&L[1]!==""){if(ee.f=Vt(cr(L[1])).replace(/\r\n/g,`
`),p.xlfn||(ee.f=vE(ee.f)),L[0].indexOf('t="array"')>-1)ee.F=(re.match(a)||[])[1],ee.F.indexOf(":")>-1&&Y.push([Bt(ee.F),ee.F]);else if(L[0].indexOf('t="shared"')>-1){F=ft(L[0]);var Ee=Vt(cr(L[1]));p.xlfn||(Ee=vE(Ee)),ne[parseInt(F.si,10)]=[F,Ee,k.r]}}else(L=re.match(/<f[^>]*\/>/))&&(F=ft(L[0]),ne[F.si]&&(ee.f=JP(ne[F.si][1],ne[F.si][2],k.r)));var Ie=Sr(k.r);for(N=0;N<Y.length;++N)Ie.r>=Y[N][0].s.r&&Ie.r<=Y[N][0].e.r&&Ie.c>=Y[N][0].s.c&&Ie.c<=Y[N][0].e.c&&(ee.F=Y[N][1])}if(k.t==null&&ee.v===void 0)if(ee.f||ee.F)ee.v=0,ee.t="n";else if(M)ee.t="z";else continue;else ee.t=k.t||"n";switch(v.s.c>R&&(v.s.c=R),v.e.c<R&&(v.e.c=R),ee.t){case"n":if(ee.v==""||ee.v==null){if(!M)continue;ee.t="z"}else ee.v=parseFloat(ee.v);break;case"s":if(typeof ee.v>"u"){if(!M)continue;ee.t="z"}else O=Nf[parseInt(ee.v,10)],ee.v=O.t,ee.r=O.r,p.cellHTML&&(ee.h=O.h);break;case"str":ee.t="s",ee.v=ee.v!=null?cr(ee.v):"",p.cellHTML&&(ee.h=jx(ee.v));break;case"inlineStr":L=re.match(n),ee.t="s",L!=null&&(O=tv(L[1]))?(ee.v=O.t,p.cellHTML&&(ee.h=O.h)):ee.v="";break;case"b":ee.v=mr(ee.v);break;case"d":p.cellDates?ee.v=xr(ee.v,1):(ee.v=on(xr(ee.v,1)),ee.t="n");break;case"e":(!p||p.cellText!==!1)&&(ee.w=ee.v),ee.v=uA[ee.v];break}if(D=V=0,oe=null,Te&&k.s!==void 0&&(oe=w.CellXf[k.s],oe!=null&&(oe.numFmtId!=null&&(D=oe.numFmtId),p.cellStyles&&oe.fillId!=null&&(V=oe.fillId))),ok(ee,D,V,p,_,w),p.cellDates&&Te&&ee.t=="n"&&hu(st[D])&&(ee.t="d",ee.v=Tm(ee.v)),k.cm&&p.xlmeta){var nt=(p.xlmeta.Cell||[])[+k.cm-1];nt&&nt.type=="XLDAPR"&&(ee.D=!0)}if(ve){var te=Sr(k.r);d[te.r]||(d[te.r]=[]),d[te.r][te.c]=ee}else d[k.r]=ee}}}}ie.length>0&&(d["!rows"]=ie)}})();function nU(t,e,r,n){var a=[],o=[],l=Bt(t["!ref"]),u="",h,d="",p=[],v=0,_=0,w=t["!rows"],S=Array.isArray(t),E={r:d},A,L=-1;for(_=l.s.c;_<=l.e.c;++_)p[_]=Er(_);for(v=l.s.r;v<=l.e.r;++v){for(o=[],d=Vr(v),_=l.s.c;_<=l.e.c;++_){h=p[_]+d;var U=S?(t[v]||[])[_]:t[h];U!==void 0&&(u=tU(U,h,t,e))!=null&&o.push(u)}(o.length>0||w&&w[v])&&(E={r:d},w&&w[v]&&(A=w[v],A.hidden&&(E.hidden=1),L=-1,A.hpx?L=Qf(A.hpx):A.hpt&&(L=A.hpt),L>-1&&(E.ht=L,E.customHeight=1),A.level&&(E.outlineLevel=A.level)),a[a.length]=Ue("row",o.join(""),E))}if(w)for(;v<w.length;++v)w&&w[v]&&(E={r:v+1},A=w[v],A.hidden&&(E.hidden=1),L=-1,A.hpx?L=Qf(A.hpx):A.hpt&&(L=A.hpt),L>-1&&(E.ht=L,E.customHeight=1),A.level&&(E.outlineLevel=A.level),a[a.length]=Ue("row","",E));return a.join("")}function ck(t,e,r,n){var a=[Br,Ue("worksheet",null,{xmlns:Ul[0],"xmlns:r":an.r})],o=r.SheetNames[t],l=0,u="",h=r.Sheets[o];h==null&&(h={});var d=h["!ref"]||"A1",p=Bt(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=_t(p)}n||(n={}),h["!comments"]=[];var v=[];jB(h,r,t,e,a),a[a.length]=Ue("dimension",null,{ref:d}),a[a.length]=eU(h,e,t,r),e.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(a[a.length]=$B(h,h["!cols"])),a[l=a.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=nU(h,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),h["!protect"]&&(a[a.length]=GB(h["!protect"])),h["!autofilter"]!=null&&(a[a.length]=QB(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(a[a.length]=BB(h["!merges"]));var _=-1,w,S=-1;return h["!links"].length>0&&(a[a.length]="<hyperlinks>",h["!links"].forEach(function(E){E[1].Target&&(w={ref:E[0]},E[1].Target.charAt(0)!="#"&&(S=rr(n,-1,nr(E[1].Target).replace(/#.*$/,""),Et.HLINK),w["r:id"]="rId"+S),(_=E[1].Target.indexOf("#"))>-1&&(w.location=nr(E[1].Target.slice(_+1))),E[1].Tooltip&&(w.tooltip=nr(E[1].Tooltip)),a[a.length]=Ue("hyperlink",null,w))}),a[a.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(a[a.length]=WB(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=An("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(S=rr(n,-1,"../drawings/drawing"+(t+1)+".xml",Et.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+S}),h["!drawing"]=v),h["!comments"].length>0&&(S=rr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Et.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+S}),h["!legacy"]=S),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function aU(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function iU(t,e,r){var n=Se(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var o=320;a.hpx?o=Qf(a.hpx)*20:a.hpt&&(o=a.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,_=-1,w=p<<10;w<p+1<<10;++w){d.c=w;var S=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ot(d)];S&&(v<0&&(v=w),_=w)}v<0||(++u,n.write_shift(4,v),n.write_shift(4,_))}var E=n.l;return n.l=h,n.write_shift(4,u),n.l=E,n.length>n.l?n.slice(0,n.l):n}function sU(t,e,r,n){var a=iU(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Fe(t,0,a)}var oU=Gl,lU=pu;function cU(){}function uU(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=dM(t),r}function fU(t,e,r){r==null&&(r=Se(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return jd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),iA(t,r),r.slice(0,r.l)}function hU(t){var e=Ja(t);return[e]}function dU(t,e,r){return r==null&&(r=Se(8)),jl(e,r)}function mU(t){var e=zl(t);return[e]}function pU(t,e,r){return r==null&&(r=Se(4)),Hl(e,r)}function gU(t){var e=Ja(t),r=t.read_shift(1);return[e,r,"b"]}function xU(t,e,r){return r==null&&(r=Se(9)),jl(e,r),r.write_shift(1,t.v?1:0),r}function vU(t){var e=zl(t),r=t.read_shift(1);return[e,r,"b"]}function _U(t,e,r){return r==null&&(r=Se(5)),Hl(e,r),r.write_shift(1,t.v?1:0),r}function yU(t){var e=Ja(t),r=t.read_shift(1);return[e,r,"e"]}function wU(t,e,r){return r==null&&(r=Se(9)),jl(e,r),r.write_shift(1,t.v),r}function TU(t){var e=zl(t),r=t.read_shift(1);return[e,r,"e"]}function EU(t,e,r){return r==null&&(r=Se(8)),Hl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function SU(t){var e=Ja(t),r=t.read_shift(4);return[e,r,"s"]}function bU(t,e,r){return r==null&&(r=Se(12)),jl(e,r),r.write_shift(4,e.v),r}function AU(t){var e=zl(t),r=t.read_shift(4);return[e,r,"s"]}function kU(t,e,r){return r==null&&(r=Se(8)),Hl(e,r),r.write_shift(4,e.v),r}function CU(t){var e=Ja(t),r=jn(t);return[e,r,"n"]}function NU(t,e,r){return r==null&&(r=Se(16)),jl(e,r),Fl(t.v,r),r}function uk(t){var e=zl(t),r=jn(t);return[e,r,"n"]}function RU(t,e,r){return r==null&&(r=Se(12)),Hl(e,r),Fl(t.v,r),r}function IU(t){var e=Ja(t),r=Yx(t);return[e,r,"n"]}function DU(t,e,r){return r==null&&(r=Se(12)),jl(e,r),sA(t.v,r),r}function OU(t){var e=zl(t),r=Yx(t);return[e,r,"n"]}function FU(t,e,r){return r==null&&(r=Se(8)),Hl(e,r),sA(t.v,r),r}function MU(t){var e=Ja(t),r=Wx(t);return[e,r,"is"]}function LU(t){var e=Ja(t),r=zn(t);return[e,r,"str"]}function PU(t,e,r){return r==null&&(r=Se(12+4*t.v.length)),jl(e,r),pn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function VU(t){var e=zl(t),r=zn(t);return[e,r,"str"]}function BU(t,e,r){return r==null&&(r=Se(8+4*t.v.length)),Hl(e,r),pn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function UU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=bm(t,n-t.l,r);l[3]=Vn(u,null,a,r.supbooks,r)}else t.l=n;return l}function jU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=bm(t,n-t.l,r);l[3]=Vn(u,null,a,r.supbooks,r)}else t.l=n;return l}function zU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=jn(t),l=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=bm(t,n-t.l,r);l[3]=Vn(u,null,a,r.supbooks,r)}else t.l=n;return l}function HU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=zn(t),l=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=bm(t,n-t.l,r);l[3]=Vn(u,null,a,r.supbooks,r)}else t.l=n;return l}var GU=Gl,qU=pu;function XU(t,e){return e==null&&(e=Se(4)),e.write_shift(4,t),e}function WU(t,e){var r=t.l+e,n=Gl(t),a=Kx(t),o=zn(t),l=zn(t),u=zn(t);t.l=r;var h={rfx:n,relId:a,loc:o,display:u};return l&&(h.Tooltip=l),h}function KU(t,e){var r=Se(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));pu({s:Sr(t[0]),e:Sr(t[0])},r),$x("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return pn(a||"",r),pn(t[1].Tooltip||"",r),pn("",r),r.slice(0,r.l)}function $U(){}function YU(t,e,r){var n=t.l+e,a=oA(t),o=t.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=yB(t,n-t.l,r);l[1]=u}else t.l=n;return l}function QU(t,e,r){var n=t.l+e,a=Gl(t),o=[a];if(r.cellFormula){var l=TB(t,n-t.l,r);o[1]=l,t.l=n}else t.l=n;return o}function JU(t,e,r){r==null&&(r=Se(18));var n=Am(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var fk=["left","right","top","bottom","header","footer"];function ZU(t){var e={};return fk.forEach(function(r){e[r]=jn(t)}),e}function ej(t,e){return e==null&&(e=Se(48)),Sl(t),fk.forEach(function(r){Fl(t[r],e)}),e}function tj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function rj(t,e,r){r==null&&(r=Se(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function nj(t){var e=Se(24);return e.write_shift(4,4),e.write_shift(4,1),pu(t,e),e}function aj(t,e){return e==null&&(e=Se(66)),e.write_shift(2,t.password?rv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function ij(){}function sj(){}function oj(t,e,r,n,a,o,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,w,S,E,A,L,U,N,Q,re,ee=[];u.biff=12,u["!row"]=0;var k=0,I=!1,R=[],O={},F=u.supbooks||a.supbooks||[[]];if(F.sharedf=O,F.arrayf=R,F.SheetNames=a.SheetNames||a.Sheets.map(function(ve){return ve.name}),!u.supbooks&&(u.supbooks=F,a.Names))for(var D=0;D<a.Names.length;++D)F[0][D+1]=a.Names[D];var V=[],Te=[],oe=!1;Jf[16]={n:"BrtShortReal",f:uk};var Y;if(ks(t,function(ie,Ce,K){if(!_)switch(K){case 148:d=ie;break;case 0:w=ie,u.sheetRows&&u.sheetRows<=w.r&&(_=!0),Q=Vr(A=w.r),u["!row"]=w.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=nu(ie.hpt)),Te[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:ie[2]},ie[2]){case"n":S.v=ie[1];break;case"s":N=Nf[ie[1]],S.v=N.t,S.r=N.r;break;case"b":S.v=!!ie[1];break;case"e":S.v=ie[1],u.cellText!==!1&&(S.w=Cs[S.v]);break;case"str":S.t="s",S.v=ie[1];break;case"is":S.t="s",S.v=ie[1].t;break}if((E=l.CellXf[ie[0].iStyleRef])&&ok(S,E.numFmtId,null,u,o,l),L=ie[0].c==-1?L+1:ie[0].c,u.dense?(h[A]||(h[A]=[]),h[A][L]=S):h[Er(L)+Q]=S,u.cellFormula){for(I=!1,k=0;k<R.length;++k){var M=R[k];w.r>=M[0].s.r&&w.r<=M[0].e.r&&L>=M[0].s.c&&L<=M[0].e.c&&(S.F=_t(M[0]),I=!0)}!I&&ie.length>3&&(S.f=ie[3])}if(p.s.r>w.r&&(p.s.r=w.r),p.s.c>L&&(p.s.c=L),p.e.r<w.r&&(p.e.r=w.r),p.e.c<L&&(p.e.c=L),u.cellDates&&E&&S.t=="n"&&hu(st[E.numFmtId])){var q=_l(S.v);q&&(S.t="d",S.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}Y&&(Y.type=="XLDAPR"&&(S.D=!0),Y=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;S={t:"z",v:void 0},L=ie[0].c==-1?L+1:ie[0].c,u.dense?(h[A]||(h[A]=[]),h[A][L]=S):h[Er(L)+Q]=S,p.s.r>w.r&&(p.s.r=w.r),p.s.c>L&&(p.s.c=L),p.e.r<w.r&&(p.e.r=w.r),p.e.c<L&&(p.e.c=L),Y&&(Y.type=="XLDAPR"&&(S.D=!0),Y=void 0);break;case 176:ee.push(ie);break;case 49:Y=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var G=n["!id"][ie.relId];for(G?(ie.Target=G.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=G):ie.relId==""&&(ie.Target="#"+ie.loc),A=ie.rfx.s.r;A<=ie.rfx.e.r;++A)for(L=ie.rfx.s.c;L<=ie.rfx.e.c;++L)u.dense?(h[A]||(h[A]=[]),h[A][L]||(h[A][L]={t:"z",v:void 0}),h[A][L].l=ie):(U=ot({c:L,r:A}),h[U]||(h[U]={t:"z",v:void 0}),h[U].l=ie);break;case 426:if(!u.cellFormula)break;R.push(ie),re=u.dense?h[A][L]:h[Er(L)+Q],re.f=Vn(ie[1],p,{r:w.r,c:L},F,u),re.F=_t(ie[0]);break;case 427:if(!u.cellFormula)break;O[ot(ie[0].s)]=ie[1],re=u.dense?h[A][L]:h[Er(L)+Q],re.f=Vn(ie[1],p,{r:w.r,c:L},F,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)V[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},oe||(oe=!0,nv(ie.w/256)),Oo(V[ie.e+1]);break;case 161:h["!autofilter"]={ref:_t(ie)};break;case 476:h["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(h["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Ce.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=_t(d||p)),u.sheetRows&&h["!ref"]){var ne=Bt(h["!ref"]);u.sheetRows<=+ne.e.r&&(ne.e.r=u.sheetRows-1,ne.e.r>p.e.r&&(ne.e.r=p.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>p.e.c&&(ne.e.c=p.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),h["!fullref"]=h["!ref"],h["!ref"]=_t(ne))}return ee.length>0&&(h["!merges"]=ee),V.length>0&&(h["!cols"]=V),Te.length>0&&(h["!rows"]=Te),h}function lj(t,e,r,n,a,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||st[14],e.v=on(xr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var h={r,c:n};switch(h.s=Uo(a.cellXfs,e,a),e.l&&o["!links"].push([ot(h),e.l]),e.c&&o["!comments"].push([ot(h),e.c]),e.t){case"s":case"str":return a.bookSST?(u=lv(a.Strings,e.v,a.revStrings),h.t="s",h.v=u,l?Fe(t,18,kU(e,h)):Fe(t,7,bU(e,h))):(h.t="str",l?Fe(t,17,BU(e,h)):Fe(t,6,PU(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Fe(t,13,FU(e,h)):Fe(t,2,DU(e,h)):l?Fe(t,16,RU(e,h)):Fe(t,5,NU(e,h)),!0;case"b":return h.t="b",l?Fe(t,15,_U(e,h)):Fe(t,4,xU(e,h)),!0;case"e":return h.t="e",l?Fe(t,14,EU(e,h)):Fe(t,3,wU(e,h)),!0}return l?Fe(t,12,pU(e,h)):Fe(t,1,dU(e,h)),!0}function cj(t,e,r,n){var a=Bt(e["!ref"]||"A1"),o,l="",u=[];Fe(t,145);var h=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=d;++p){l=Vr(p),sU(t,e,a,p);var v=!1;if(p<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){p===a.s.r&&(u[_]=Er(_)),o=u[_]+l;var w=h?(e[p]||[])[_]:e[o];if(!w){v=!1;continue}v=lj(t,w,p,_,n,e,v)}}Fe(t,146)}function uj(t,e){!e||!e["!merges"]||(Fe(t,177,XU(e["!merges"].length)),e["!merges"].forEach(function(r){Fe(t,176,qU(r))}),Fe(t,178))}function fj(t,e){!e||!e["!cols"]||(Fe(t,390),e["!cols"].forEach(function(r,n){r&&Fe(t,60,JU(n,r))}),Fe(t,391))}function hj(t,e){!e||!e["!ref"]||(Fe(t,648),Fe(t,649,nj(Bt(e["!ref"]))),Fe(t,650))}function dj(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=rr(r,-1,n[1].Target.replace(/#.*$/,""),Et.HLINK);Fe(t,494,KU(n,a))}}),delete e["!links"]}function mj(t,e,r,n){if(e["!comments"].length>0){var a=rr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Et.VML);Fe(t,551,$x("rId"+a)),e["!legacy"]=a}}function pj(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:_t(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=ha(o);u.s.r==u.e.r&&(u.e.r=ha(e["!ref"]).e.r,o=_t(u));for(var h=0;h<l.length;++h){var d=l[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+o;break}}h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Fe(t,161,pu(Bt(o))),Fe(t,162)}}function gj(t,e,r){Fe(t,133),Fe(t,137,rj(e,r)),Fe(t,138),Fe(t,134)}function xj(t,e){e["!protect"]&&Fe(t,535,aj(e["!protect"]))}function vj(t,e,r,n){var a=fa(),o=r.SheetNames[t],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var h=Bt(l["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Fe(a,129),(r.vbaraw||l["!outline"])&&Fe(a,147,fU(u,l["!outline"])),Fe(a,148,lU(h)),gj(a,l,r.Workbook),fj(a,l),cj(a,l,t,e),xj(a,l),pj(a,l,r,t),uj(a,l),dj(a,l,n),l["!margins"]&&Fe(a,476,ej(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&hj(a,l),mj(a,l,t,n),Fe(a,130),a.end()}function _j(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=Vt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function yj(t,e,r,n,a,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=_j(v);p.s.r=p.s.c=0,p.e.c=u,d=Er(u),_[0].forEach(function(w,S){l[d+Vr(S)]={t:"n",v:w,z:_[1]},h=S}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(l["!ref"]=_t(p)),l}function wj(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(lk);return u&&cv(u[0],o,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function Tj(t,e){t.l+=10;var r=zn(t);return{name:r}}function Ej(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ks(t,function(h,d,p){switch(p){case 550:o["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var uv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Sj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],bj=[],Aj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function EE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=mr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function SE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=mr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function hk(t){SE(t.WBProps,uv),SE(t.CalcPr,Aj),EE(t.WBView,Sj),EE(t.Sheets,bj),Wc.date1904=mr(t.WBProps.date1904)}function kj(t){return!t.Workbook||!t.Workbook.WBProps?"false":mr(t.Workbook.WBProps.date1904)?"true":"false"}var Cj="][*?/\\".split("");function dk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Cj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Nj(t,e,r){t.forEach(function(n,a){dk(n);for(var o=0;o<a;++o)if(n==t[o])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Rj(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Nj(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)kB(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Ij=/<\w+:workbook/;function Dj(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(t.replace(qn,function(h,d){var p=ft(h);switch(Wi(p[0])){case"<?xml":break;case"<workbook":h.match(Ij)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uv.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=mr(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=cr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Vt(cr(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=cr(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),mr(p.hidden||"0")&&(o.Hidden=!0),l=d+h.length;break;case"</definedName>":o.Ref=Vt(cr(t.slice(l,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),Ul.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return hk(r),r}function mk(t){var e=[Br];e[e.length]=Ue("workbook",null,{xmlns:Ul[0],"xmlns:r":an.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(uv.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ue("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var l={name:nr(t.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Ue("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(e[e.length]=Ue("definedName",nr(u.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Oj(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ng(t),r.name=zn(t),r}function Fj(t,e){return e||(e=Se(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),$x(t.strRelID,e),pn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Mj(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?zn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Lj(t,e){e||(e=Se(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),iA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Pj(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Vj(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=mM(t),l=wB(t,0,r),u=Kx(t);t.l=n;var h={Name:o,Ptg:l};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function Bj(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Jf[16]={n:"BrtFRTArchID$",f:Pj},ks(t,function(h,d,p){switch(p){case 156:l.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Vn(h.Ptg,null,null,l,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,h]):l[0]=[p,h],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(h),l.XTI=l.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),hk(r),r.Names=o,r.supbooks=l,r}function Uj(t,e){Fe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Fe(t,156,Fj(a))}Fe(t,144)}function jj(t,e){e||(e=Se(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return pn("SheetJS",e),pn(Fd.version,e),pn(Fd.version,e),pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function zj(t,e){e||(e=Se(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Hj(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&o==-1&&(o=n);o>a||(Fe(t,135),Fe(t,158,zj(a)),Fe(t,136))}}function Gj(t,e){var r=fa();return Fe(r,131),Fe(r,128,jj()),Fe(r,153,Lj(t.Workbook&&t.Workbook.WBProps||null)),Hj(r,t),Uj(r,t),Fe(r,132),r.end()}function qj(t,e,r){return e.slice(-4)===".bin"?Bj(t,r):Dj(t,r)}function Xj(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?oj(t,n,r,a,o,l,u):VB(t,n,r,a,o,l,u)}function Wj(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?Ej(t,n,r,a,o):wj(t,n,r,a,o)}function Kj(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?YP():QP()}function $j(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?KP():$P()}function Yj(t,e,r,n){return e.slice(-4)===".bin"?qL(t,r,n):OL(t,r,n)}function Qj(t,e,r){return KA(t,r)}function Jj(t,e,r){return e.slice(-4)===".bin"?J7(t,r):$7(t,r)}function Zj(t,e,r){return e.slice(-4)===".bin"?HP(t,r):FP(t,r)}function ez(t,e,r){return e.slice(-4)===".bin"?IP(t):NP(t)}function tz(t,e,r,n){return r.slice(-4)===".bin"?DP(t,e,r,n):void 0}function rz(t,e,r){return e.slice(-4)===".bin"?AP(t,e,r):CP(t,e,r)}function nz(t,e,r){return(e.slice(-4)===".bin"?Gj:mk)(t)}function az(t,e,r,n,a){return(e.slice(-4)===".bin"?vj:ck)(t,r,n,a)}function iz(t,e,r){return(e.slice(-4)===".bin"?tP:XA)(t,r)}function sz(t,e,r){return(e.slice(-4)===".bin"?tL:VA)(t,r)}function oz(t,e,r){return(e.slice(-4)===".bin"?GP:QA)(t)}function lz(t){return(t.slice(-4)===".bin"?kP:$A)()}var pk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function hi(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(pk),o,l,u,h;if(a)for(h=0;h!=a.length;++h)o=a[h].match(gk),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function cz(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(pk),a,o,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(gk),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var If;function uz(t,e){var r=If[t]||Vt(t);return r==="General"?Dl(e):Qa(r,e)}function fz(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=xr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Vt(e)]=a}function hz(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Cs[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Hf(t.v):t.w=Dl(t.v):t.w=uz(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=If[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&hu(n)){var a=_l(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function dz(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=bL[n.Pattern]||n.Pattern)}t[e.ID]=e}function mz(t,e,r,n,a,o,l,u,h,d){var p="General",v=n.StyleID,_={};d=d||{};var w=[],S=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&w.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mr(t);break;case"String":n.t="s",n.r=jT(Vt(t)),n.v=t.indexOf("<")>-1?Vt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(xr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Vt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=uA[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=jT(e||t));break}if(hz(n,p,d),d.cellFormula!==!1)if(n.Formula){var E=Vt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=Xc(E,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Xc("RC:RC",a):n.ArrayRange&&(n.F=Xc(n.ArrayRange,a),h.push([Bt(n.F),n.F]))}else for(S=0;S<h.length;++S)a.r>=h[S][0].s.r&&a.r<=h[S][0].e.r&&a.c>=h[S][0].s.c&&a.c<=h[S][0].e.c&&(n.F=h[S][1]);d.cellStyles&&(w.forEach(function(A){!_.patternType&&A.patternType&&(_.patternType=A.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function pz(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Wp(t,e){var r=e||{};du();var n=gf(zx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=cr(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=vr(r);return l.type="string",ru.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($t){a.indexOf("<"+$t)>=0&&(o=!0)}),o)return eH(n,r);If={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},v=[],_=r.dense?[]:{},w="",S={},E={},A=hi('<Data ss:Type="String">'),L=0,U=0,N=0,Q={s:{r:2e6,c:2e6},e:{r:0,c:0}},re={},ee={},k="",I=0,R=[],O={},F={},D=0,V=[],Te=[],oe={},Y=[],ne,ve=!1,ie=[],Ce=[],K={},M=0,q=0,G={Sheets:[],WBProps:{date1904:!1}},J={};Xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";u=Xf.exec(n);)switch(u[3]=(le=u[3]).toLowerCase()){case"data":if(le=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?mz(n.slice(L,u.index),k,A,h[h.length-1][0]=="comment"?oe:S,{c:U,r:N},re,Y[U],E,ie,r):(k="",A=hi(u[0]),L=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Te.length>0&&(S.c=Te),(!r.sheetRows||r.sheetRows>N)&&S.v!==void 0&&(r.dense?(_[N]||(_[N]=[]),_[N][U]=S):_[Er(U)+Vr(N)]=S),S.HRef&&(S.l={Target:Vt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(M=U+(parseInt(S.MergeAcross,10)|0),q=N+(parseInt(S.MergeDown,10)|0),R.push({s:{c:U,r:N},e:{c:M,r:q}})),!r.sheetStubs)S.MergeAcross?U=M+1:++U;else if(S.MergeAcross||S.MergeDown){for(var ye=U;ye<=M;++ye)for(var be=N;be<=q;++be)(ye>U||be>N)&&(r.dense?(_[be]||(_[be]=[]),_[be][ye]={t:"z"}):_[Er(ye)+Vr(be)]={t:"z"});U=M+1}else++U;else S=cz(u[0]),S.Index&&(U=+S.Index-1),U<Q.s.c&&(Q.s.c=U),U>Q.e.c&&(Q.e.c=U),u[0].slice(-2)==="/>"&&++U,Te=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<Q.s.r&&(Q.s.r=N),N>Q.e.r&&(Q.e.r=N),u[0].slice(-2)==="/>"&&(E=hi(u[0]),E.Index&&(N=+E.Index-1)),U=0,++N):(E=hi(u[0]),E.Index&&(N=+E.Index-1),K={},(E.AutoFitHeight=="0"||E.Height)&&(K.hpx=parseInt(E.Height,10),K.hpt=Qf(K.hpx),Ce[N]=K),E.Hidden=="1"&&(K.hidden=!0,Ce[N]=K));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));v.push(w),Q.s.r<=Q.e.r&&Q.s.c<=Q.e.c&&(_["!ref"]=_t(Q),r.sheetRows&&r.sheetRows<=Q.e.r&&(_["!fullref"]=_["!ref"],Q.e.r=r.sheetRows-1,_["!ref"]=_t(Q))),R.length&&(_["!merges"]=R),Y.length>0&&(_["!cols"]=Y),Ce.length>0&&(_["!rows"]=Ce),p[w]=_}else Q={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=U=0,h.push([u[3],!1]),d=hi(u[0]),w=Vt(d.Name),_=r.dense?[]:{},R=[],ie=[],Ce=[],J={name:w,Hidden:0},G.Sheets.push(J);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),Y=[],ve=!1}break;case"style":u[1]==="/"?dz(re,ee,r):ee=hi(u[0]);break;case"numberformat":ee.nf=Vt(hi(u[0]).Format||"General"),If[ee.nf]&&(ee.nf=If[ee.nf]);for(var Ee=0;Ee!=392&&st[Ee]!=ee.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(st[Ee]==null){xs(ee.nf,Ee);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ne=hi(u[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!ve&&ne.wpx>10){ve=!0,Un=GA;for(var Ie=0;Ie<Y.length;++Ie)Y[Ie]&&Oo(Y[Ie])}ve&&Oo(ne),Y[ne.Index-1||Y.length]=ne;for(var nt=0;nt<+ne.Span;++nt)Y[Y.length]=vr(ne);break;case"namedrange":if(u[1]==="/")break;G.Names||(G.Names=[]);var te=ft(u[0]),Ft={Name:te.Name,Ref:Xc(te.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Ft.Sheet=G.Sheets.length-1),G.Names.push(Ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?k+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;ee.Interior=hi(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?BM(O,le,n.slice(D,u.index)):D=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));pz(oe),Te.push(oe)}else h.push([u[3],!1]),d=hi(u[0]),oe={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ht=hi(u[0]);_["!autofilter"]={ref:Xc(ht.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return NE(n,r);var It=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:It=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:It=!1}break;case"excelworkbook":switch(u[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:It=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:It=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(D,u.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else D=u.index+u[0].length;break;case"header":_["!margins"]||Sl(_["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(_["!margins"].header=+ft(u[0]).Margin);break;case"footer":_["!margins"]||Sl(_["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(_["!margins"].footer=+ft(u[0]).Margin);break;case"pagemargins":var at=ft(u[0]);_["!margins"]||Sl(_["!margins"]={},"xlml"),isNaN(+at.Top)||(_["!margins"].top=+at.Top),isNaN(+at.Left)||(_["!margins"].left=+at.Left),isNaN(+at.Right)||(_["!margins"].right=+at.Right),isNaN(+at.Bottom)||(_["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:It=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:It=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:It=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:It=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:It=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:It=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:It=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:It=!1}break;case"smarttags":break;default:It=!1;break}if(It||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?fz(F,le,V,n.slice(D,u.index)):(V=u,D=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=p),je.SheetNames=v,je.Workbook=G,je.SSF=vr(st),je.Props=O,je.Custprops=F,je}function Lg(t,e){switch(hv(e=e||{}),e.type||"base64"){case"base64":return Wp(Ia(t),e);case"binary":case"buffer":case"file":return Wp(t,e);case"array":return Wp(Vo(t),e)}}function gz(t,e){var r=[];return t.Props&&r.push(UM(t.Props,e)),t.Custprops&&r.push(jM(t.Props,t.Custprops)),r.join("")}function xz(){return""}function vz(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var o=[];o.push(Ue("NumberFormat",null,{"ss:Format":nr(st[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Ue("Style",o.join(""),l))}),Ue("Styles",r.join(""))}function xk(t){return Ue("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+sv(t.Ref,{r:0,c:0})})}function _z(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(xk(a)))}return Ue("Names",r.join(""))}function yz(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(xk(u)))}return o.join("")}function wz(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(An("ProtectContents","True")),t["!protect"].objects&&a.push(An("ProtectObjects","True")),t["!protect"].scenarios&&a.push(An("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(An("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(An("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Aa.x})}function Tz(t){return t.map(function(e){var r=HF(e.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":e.a})}).join("")}function Ez(t,e,r,n,a,o,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+nr(sv(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var h=Sr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==l.r?"":"["+(h.r-l.r)+"]")+"C"+(h.c==l.c?"":"["+(h.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=nr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=nr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=l.c||d[p].s.r!=l.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var v="",_="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",_=String(t.v);break;case"b":v="Boolean",_=t.v?"1":"0";break;case"e":v="Error",_=Cs[t.v];break;case"d":v="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||st[14]);break;case"s":v="String",_=zF(t.v||"");break}var w=Uo(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+w),u["ss:Index"]=l.c+1;var S=t.v!=null?_:"",E=t.t=="z"?"":'<Data ss:Type="'+v+'">'+S+"</Data>";return(t.c||[]).length>0&&(E+=Tz(t.c)),Ue("Cell",E,u)}function Sz(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=nu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function bz(t,e,r,n){if(!t["!ref"])return"";var a=Bt(t["!ref"]),o=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(A,L){Oo(A);var U=!!A.width,N=Am(L,A),Q={"ss:Index":L+1};U&&(Q["ss:Width"]=$f(N.width)),A.hidden&&(Q["ss:Hidden"]="1"),u.push(Ue("Column",null,Q))});for(var h=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var p=[Sz(d,(t["!rows"]||[])[d])],v=a.s.c;v<=a.e.c;++v){var _=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>d)&&!(o[l].e.c<v)&&!(o[l].e.r<d)){(o[l].s.c!=v||o[l].s.r!=d)&&(_=!0);break}if(!_){var w={r:d,c:v},S=ot(w),E=h?(t[d]||[])[v]:t[S];p.push(Ez(E,S,t,e,r,n,w))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function Az(t,e,r){var n=[],a=r.SheetNames[t],o=r.Sheets[a],l=o?yz(o,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?bz(o,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(wz(o,e,t,r)),n.join("")}function kz(t,e){e||(e={}),t.SSF||(t.SSF=vr(st)),t.SSF&&(du(),_m(t.SSF),e.revssf=wm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Uo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(gz(t,e)),r.push(xz()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ue("Worksheet",Az(n,e,t),{"ss:Name":nr(t.SheetNames[n])}));return r[2]=vz(t,e),r[3]=_z(t),Br+Ue("Workbook",r.join(""),{xmlns:Aa.ss,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:ss":Aa.ss,"xmlns:dt":Aa.dt,"xmlns:html":Aa.html})}function Cz(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=_M(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=yM(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Nz=[60,1084,2066,2165,2175];function Rz(t,e,r,n,a){var o=n,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var h=ps(r,r.l),d=Pg[h],p=0;d!=null&&Nz.indexOf(h)>-1;)o=ps(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+o),l.push(u),r.l+=4+o,d=Pg[h=ps(r,r.l)];var v=mn(l);Sn(v,0);var _=0;v.lens=[];for(var w=0;w<l.length;++w)v.lens.push(_),_+=l[w].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,a)}function Oi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=st[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Cs[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Hf(t.v):t.w=Dl(t.v):t.w=Qa(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&hu(st[n]||String(n))){var a=_l(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Zh(t,e,r){return{v:t,ixfe:e,t:r}}function Iz(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},l={},u=null,h=[],d="",p={},v,_="",w,S,E,A,L={},U=[],N,Q,re=[],ee=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},R=function(ut){return ut<8?wl[ut]:ut<64&&ee[ut-8]||wl[ut]},O=function(ut,ar,Zr){var De=ar.XF.data;if(!(!De||!De.patternType||!Zr||!Zr.cellStyles)){ar.s={},ar.s.patternType=De.patternType;var Xe;(Xe=Kf(R(De.icvFore)))&&(ar.s.fgColor={rgb:Xe}),(Xe=Kf(R(De.icvBack)))&&(ar.s.bgColor={rgb:Xe})}},F=function(ut,ar,Zr){if(!(K>1)&&!(Zr.sheetRows&&ut.r>=Zr.sheetRows)){if(Zr.cellStyles&&ar.XF&&ar.XF.data&&O(ut,ar,Zr),delete ar.ixfe,delete ar.XF,v=ut,_=ot(ut),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<l.s.r&&(l.s.r=ut.r),ut.c<l.s.c&&(l.s.c=ut.c),ut.r+1>l.e.r&&(l.e.r=ut.r+1),ut.c+1>l.e.c&&(l.e.c=ut.c+1),Zr.cellFormula&&ar.f){for(var De=0;De<U.length;++De)if(!(U[De][0].s.c>ut.c||U[De][0].s.r>ut.r)&&!(U[De][0].e.c<ut.c||U[De][0].e.r<ut.r)){ar.F=_t(U[De][0]),(U[De][0].s.c!=ut.c||U[De][0].s.r!=ut.r)&&delete ar.f,ar.f&&(ar.f=""+Vn(U[De][1],l,ut,ie,D));break}}Zr.dense?(a[ut.r]||(a[ut.r]=[]),a[ut.r][ut.c]=ar):a[_]=ar}},D={enc:!1,sbcch:0,snames:[],sharedf:L,arrayf:U,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var V,Te=[],oe=[],Y=[],ne=[],ve=!1,ie=[];ie.SheetNames=D.snames,ie.sharedf=D.sharedf,ie.arrayf=D.arrayf,ie.names=[],ie.XTI=[];var Ce=0,K=0,M=0,q=[],G=[],J;D.codepage=1200,pi(1200);for(var le=!1;t.l<t.length-1;){var ye=t.l,be=t.read_shift(2);if(be===0&&Ce===10)break;var Ee=t.l===t.length?0:t.read_shift(2),Ie=Pg[be];if(Ie&&Ie.f){if(e.bookSheets&&Ce===133&&be!==133)break;if(Ce=be,Ie.r===2||Ie.r==12){var nt=t.read_shift(2);if(Ee-=2,!D.enc&&nt!==be&&((nt&255)<<8|nt>>8)!==be)throw new Error("rt mismatch: "+nt+"!="+be);Ie.r==12&&(t.l+=10,Ee-=10)}var te={};if(be===10?te=Ie.f(t,Ee,D):te=Rz(be,Ie,t,Ee,D),K==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(be){case 34:r.opts.Date1904=k.WBProps.date1904=te;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=te,!e.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=te;break;case 66:var Ft=Number(te);switch(Ft){case 21010:Ft=1200;break;case 32768:Ft=1e4;break;case 32769:Ft=1252;break}pi(D.codepage=Ft),le=!0;break;case 317:D.rrtabid=te;break;case 25:D.winlocked=te;break;case 439:r.opts.RefreshAll=te;break;case 12:r.opts.CalcCount=te;break;case 16:r.opts.CalcDelta=te;break;case 17:r.opts.CalcIter=te;break;case 13:r.opts.CalcMode=te;break;case 14:r.opts.CalcPrecision=te;break;case 95:r.opts.CalcSaveRecalc=te;break;case 15:D.CalcRefMode=te;break;case 2211:r.opts.FullCalc=te;break;case 129:te.fDialog&&(a["!type"]="dialog"),te.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),te.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:re.push(te);break;case 430:ie.push([te]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(te);break;case 24:case 536:J={Name:te.Name,Ref:Vn(te.rgce,l,null,ie,D)},te.itab>0&&(J.Sheet=te.itab-1),ie.names.push(J),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(G[te.itab-1]={ref:_t(te.rgce[0][0][1][2])});break;case 22:D.ExternCount=te;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(te),ie.XTI=ie.XTI.concat(te);break;case 2196:if(D.biff<8)break;J!=null&&(J.Comment=te[1]);break;case 18:a["!protect"]=te;break;case 19:te!==0&&D.WTF&&console.error("Password verifier: "+te);break;case 133:o[te.pos]=te,D.snames.push(te.name);break;case 10:{if(--K)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=_t(l),e.sheetRows&&e.sheetRows<=l.e.r){var ht=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=_t(l),l.e.r=ht}l.e.r++,l.e.c++}Te.length>0&&(a["!merges"]=Te),oe.length>0&&(a["!objects"]=oe),Y.length>0&&(a["!cols"]=Y),ne.length>0&&(a["!rows"]=ne),k.Sheets.push(I)}d===""?p=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),D.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(D.biff=5,le=!0,pi(D.codepage=28591)),D.biff==8&&te.BIFFVer==0&&te.dt==16&&(D.biff=2),K++)break;if(a=e.dense?[]:{},D.biff<8&&!le&&(le=!0,pi(D.codepage=e.codepage||1252)),D.biff<5||te.BIFFVer==0&&te.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var It={pos:t.l-Ee,name:d};o[It.pos]=It,D.snames.push(d)}else d=(o[ye]||{name:""}).name;te.dt==32&&(a["!type"]="chart"),te.dt==64&&(a["!type"]="macro"),Te=[],oe=[],D.arrayf=U=[],Y=[],ne=[],ve=!1,I={Hidden:(o[ye]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[te.r]||[])[te.c]:a[ot({c:te.c,r:te.r})])&&++te.c,N={ixfe:te.ixfe,XF:re[te.ixfe]||{},v:te.val,t:"n"},M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:te.c,r:te.r},N,e);break;case 5:case 517:N={ixfe:te.ixfe,XF:re[te.ixfe],v:te.val,t:te.t},M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:te.c,r:te.r},N,e);break;case 638:N={ixfe:te.ixfe,XF:re[te.ixfe],v:te.rknum,t:"n"},M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:te.c,r:te.r},N,e);break;case 189:for(var at=te.c;at<=te.C;++at){var je=te.rkrec[at-te.c][0];N={ixfe:je,XF:re[je],v:te.rkrec[at-te.c][1],t:"n"},M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:at,r:te.r},N,e)}break;case 6:case 518:case 1030:{if(te.val=="String"){u=te;break}if(N=Zh(te.val,te.cell.ixfe,te.tt),N.XF=re[N.ixfe],e.cellFormula){var $t=te.formula;if($t&&$t[0]&&$t[0][0]&&$t[0][0][0]=="PtgExp"){var Dt=$t[0][0][1][0],Ut=$t[0][0][1][1],Ur=ot({r:Dt,c:Ut});L[Ur]?N.f=""+Vn(te.formula,l,te.cell,ie,D):N.F=((e.dense?(a[Dt]||[])[Ut]:a[Ur])||{}).F}else N.f=""+Vn(te.formula,l,te.cell,ie,D)}M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F(te.cell,N,e),u=te}break;case 7:case 519:if(u)u.val=te,N=Zh(te,u.cell.ixfe,"s"),N.XF=re[N.ixfe],e.cellFormula&&(N.f=""+Vn(u.formula,l,u.cell,ie,D)),M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F(u.cell,N,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{U.push(te);var Za=ot(te[0].s);if(w=e.dense?(a[te[0].s.r]||[])[te[0].s.c]:a[Za],e.cellFormula&&w){if(!u||!Za||!w)break;w.f=""+Vn(te[1],l,te[0],ie,D),w.F=_t(te[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;L[ot(u.cell)]=te[0],w=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ot(u.cell)],(w||{}).f=""+Vn(te[0],l,v,ie,D)}}break;case 253:N=Zh(h[te.isst].t,te.ixfe,"s"),h[te.isst].h&&(N.h=h[te.isst].h),N.XF=re[N.ixfe],M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:te.c,r:te.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:te.ixfe,XF:re[te.ixfe],t:"z"},M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:te.c,r:te.r},N,e));break;case 190:if(e.sheetStubs)for(var Xn=te.c;Xn<=te.C;++Xn){var Lt=te.ixfe[Xn-te.c];N={ixfe:Lt,XF:re[Lt],t:"z"},M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:Xn,r:te.r},N,e)}break;case 214:case 516:case 4:N=Zh(te.val,te.ixfe,"s"),N.XF=re[N.ixfe],M>0&&(N.z=q[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),F({c:te.c,r:te.r},N,e);break;case 0:case 512:K===1&&(l=te);break;case 252:h=te;break;case 1054:if(D.biff==4){q[M++]=te[1];for(var Jr=0;Jr<M+163&&st[Jr]!=te[1];++Jr);Jr>=163&&xs(te[1],M+163)}else xs(te[1],te[0]);break;case 30:{q[M++]=te;for(var gn=0;gn<M+163&&st[gn]!=te;++gn);gn>=163&&xs(te,M+163)}break;case 229:Te=Te.concat(te);break;case 93:oe[te.cmo[0]]=D.lastobj=te;break;case 438:D.lastobj.TxO=te;break;case 127:D.lastobj.ImData=te;break;case 440:for(A=te[0].s.r;A<=te[0].e.r;++A)for(E=te[0].s.c;E<=te[0].e.c;++E)w=e.dense?(a[A]||[])[E]:a[ot({c:E,r:A})],w&&(w.l=te[1]);break;case 2048:for(A=te[0].s.r;A<=te[0].e.r;++A)for(E=te[0].s.c;E<=te[0].e.c;++E)w=e.dense?(a[A]||[])[E]:a[ot({c:E,r:A})],w&&w.l&&(w.l.Tooltip=te[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;w=e.dense?(a[te[0].r]||[])[te[0].c]:a[ot(te[0])];var Wn=oe[te[2]];w||(e.dense?(a[te[0].r]||(a[te[0].r]=[]),w=a[te[0].r][te[0].c]={t:"z"}):w=a[ot(te[0])]={t:"z"},l.e.r=Math.max(l.e.r,te[0].r),l.s.r=Math.min(l.s.r,te[0].r),l.e.c=Math.max(l.e.c,te[0].c),l.s.c=Math.min(l.s.c,te[0].c)),w.c||(w.c=[]),S={a:te[1],t:Wn.TxO.t},w.c.push(S)}break;case 2173:vP(re[te.ixfe],te.ext);break;case 125:{if(!D.cellStyles)break;for(;te.e>=te.s;)Y[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},ve||(ve=!0,nv(te.w/256)),Oo(Y[te.e+1])}break;case 520:{var Pt={};te.level!=null&&(ne[te.r]=Pt,Pt.level=te.level),te.hidden&&(ne[te.r]=Pt,Pt.hidden=!0),te.hpt&&(ne[te.r]=Pt,Pt.hpt=te.hpt,Pt.hpx=nu(te.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Sl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=te;break;case 161:a["!margins"]||Sl(a["!margins"]={}),a["!margins"].header=te.header,a["!margins"].footer=te.footer;break;case 574:te.RTL&&(k.Views[0].RTL=!0);break;case 146:ee=te;break;case 2198:V=te;break;case 140:Q=te;break;case 442:d?I.CodeName=te||I.name:k.WBProps.CodeName=te||"ThisWorkbook";break}}else Ie||console.error("Missing Info for XLS Record 0x"+be.toString(16)),t.l+=Ee}return r.SheetNames=Rr(o).sort(function(Nn,ut){return Number(Nn)-Number(ut)}).map(function(Nn){return o[Nn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&G.forEach(function(Nn,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=Nn}),r.Strings=h,r.SSF=vr(st),D.enc&&(r.Encryption=D.enc),V&&(r.Themes=V),r.Metadata={},Q!==void 0&&(r.Metadata.Country=Q),ie.names.length>0&&(k.Names=ie.names),r.Workbook=k,r}var Df={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Dz(t,e,r){var n=tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=iE(n,Rg,Df.DSI);for(var o in a)e[o]=a[o]}catch(d){if(r.WTF)throw d}var l=tt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=iE(l,Ig,Df.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(gA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Oz(t,e){var r=[],n=[],a=[],o=0,l,u=MT(Rg,"n"),h=MT(Ig,"n");if(t.Props)for(l=Rr(t.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Props[l[o]]]);if(t.Custprops)for(l=Rr(t.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Custprops[l[o]]]);var d=[];for(o=0;o<a.length;++o)EA.indexOf(a[o][0])>-1||pA.indexOf(a[o][0])>-1||a[o][1]!=null&&d.push(a[o]);n.length&&tt.utils.cfb_add(e,"/SummaryInformation",sE(n,Df.SI,h,Ig)),(r.length||d.length)&&tt.utils.cfb_add(e,"/DocumentSummaryInformation",sE(r,Df.DSI,u,Rg,d.length?d:null,Df.UDI))}function vk(t,e){e||(e={}),hv(e),Ox(),e.codepage&&Dx(e.codepage);var r,n;if(t.FullPaths){if(tt.find(t,"/encryption"))throw new Error("File is password-protected");r=tt.find(t,"!CompObj"),n=tt.find(t,"/Workbook")||tt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ca(Ia(t));break;case"binary":t=Ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var a,o;if(r&&Cz(r),e.bookProps&&!e.bookSheets)a={};else{var l=Tt?"buffer":"array";if(n&&n.content)a=Iz(n.content,e);else if((o=tt.find(t,"PerfectOffice_MAIN"))&&o.content)a=El.to_workbook(o.content,(e.type=l,e));else if((o=tt.find(t,"NativeContent_MAIN"))&&o.content)a=El.to_workbook(o.content,(e.type=l,e));else throw(o=tt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=XP(t))}var u={};return t.FullPaths&&Dz(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function Fz(t,e){var r=e||{},n=tt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,a,_k(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Oz(t,n),r.biff==8&&t.vbaraw&&WP(n,tt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Jf={0:{f:aU},1:{f:hU},2:{f:IU},3:{f:yU},4:{f:gU},5:{f:CU},6:{f:LU},7:{f:SU},8:{f:HU},9:{f:zU},10:{f:UU},11:{f:jU},12:{f:mU},13:{f:OU},14:{f:TU},15:{f:vU},16:{f:uk},17:{f:VU},18:{f:AU},19:{f:Wx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Vj},40:{},42:{},43:{f:LL},44:{f:FL},45:{f:BL},46:{f:jL},47:{f:UL},48:{},49:{f:oM},50:{},51:{f:wP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:FA},62:{f:MU},63:{f:RP},64:{f:ij},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:tj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uU},148:{f:oU,p:16},151:{f:$U},152:{},153:{f:Mj},154:{},155:{},156:{f:Oj},157:{},158:{},159:{T:1,f:Q7},160:{T:-1},161:{T:1,f:Gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_P},336:{T:-1},337:{f:SP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ng},357:{},358:{},359:{},360:{T:1},361:{},362:{f:OA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YU},427:{f:QU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ZU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:WU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ng},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jP},633:{T:1},634:{T:-1},635:{T:1,f:BP},636:{T:-1},637:{f:fM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Tj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:sj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pg={6:{f:qp},10:{f:co},12:{f:Yr},13:{f:Yr},14:{f:Mr},15:{f:Mr},16:{f:jn},17:{f:Mr},18:{f:Mr},19:{f:Yr},20:{f:hE},21:{f:hE},23:{f:OA},24:{f:mE},25:{f:Mr},26:{},27:{},28:{f:s7},29:{},34:{f:Mr},35:{f:dE},38:{f:jn},39:{f:jn},40:{f:jn},41:{f:jn},42:{f:Mr},43:{f:Mr},47:{f:vL},49:{f:O9},51:{f:Yr},60:{},61:{f:C9},64:{f:Mr},65:{f:D9},66:{f:Yr},77:{},80:{},81:{},82:{},85:{f:Yr},89:{},90:{},91:{},92:{f:x9},93:{f:c7},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:FA},128:{f:K9},129:{f:_9},130:{f:Yr},131:{f:Mr},132:{f:Mr},133:{f:y9},134:{},140:{f:x7},141:{f:Yr},144:{},146:{f:y7},151:{},152:{},153:{},154:{},155:{},156:{f:Yr},157:{},158:{},160:{f:k7},161:{f:E7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:G9},190:{f:q9},193:{f:co},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yr},220:{},221:{f:Mr},222:{},224:{f:W9},225:{f:g9},226:{f:co},227:{},229:{f:o7},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:T9},253:{f:M9},255:{f:S9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:SA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:co},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Z9},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:h7},439:{f:Mr},440:{f:d7},441:{},442:{f:p0},443:{},444:{f:Yr},445:{},446:{},448:{f:co},449:{f:k9,r:2},450:{f:co},512:{f:cE},513:{f:A7},515:{f:Q9},516:{f:P9},517:{f:fE},519:{f:C7},520:{f:b9},523:{},545:{f:pE},549:{f:lE},566:{},574:{f:R9},638:{f:H9},659:{},1048:{},1054:{f:B9},1084:{},1212:{f:n7},2048:{f:p7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:co},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:w7,r:12},2173:{f:xP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:r7,r:12},2197:{},2198:{f:fP,r:12},2199:{},2200:{},2201:{},2202:{f:a7,r:12},2203:{f:co},2204:{},2205:{},2206:{},2207:{},2211:{f:A9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:S7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cE},1:{},2:{f:O7},3:{f:I7},4:{f:R7},5:{f:fE},7:{f:M7},8:{},9:{f:Yh},11:{},22:{f:Yr},30:{f:j9},31:{},32:{},33:{f:pE},36:{},37:{f:lE},50:{f:L7},62:{},52:{},67:{},68:{f:Yr},69:{},86:{},126:{},127:{f:N7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:P7},223:{},234:{},354:{},421:{},518:{f:qp},521:{f:Yh},536:{f:mE},547:{f:dE},561:{},579:{},1030:{f:qp},1033:{f:Yh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(t,e,r,n){var a=e;if(!isNaN(a)){var o=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Gx(r)&&t.push(r)}}function Mz(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(t,e,r,a);var o=e;if(!isNaN(o)){for(var l=r.parts||[],u=0,h=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,o),p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<a;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function _0(t,e,r){return t||(t=Se(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Lz(t,e,r,n){var a=Se(9);return _0(a,t,e),bA(r,n||"b",a),a}function Pz(t,e,r){var n=Se(8+2*r.length);return _0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Vz(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?on(xr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?ze(t,2,F7(r,n,a)):ze(t,3,D7(r,n,a));return;case"b":case"e":ze(t,5,Lz(r,n,e.v,e.t));return;case"s":case"str":ze(t,4,Pz(r,n,(e.v||"").slice(0,255)));return}ze(t,1,_0(null,r,n))}function Bz(t,e,r,n){var a=Array.isArray(e),o=Bt(e["!ref"]||"A1"),l,u="",h=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=_t(o)}for(var d=o.s.r;d<=o.e.r;++d){u=Vr(d);for(var p=o.s.c;p<=o.e.c;++p){d===o.s.r&&(h[p]=Er(p)),l=h[p]+u;var v=a?(e[d]||[])[p]:e[l];v&&Vz(t,v,d,p)}}}function Uz(t,e){for(var r=e||{},n=fa(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,ev(t,16,r)),Bz(n,t.Sheets[t.SheetNames[a]],a,r),ze(n,10),n.end()}function jz(t,e,r){ze(t,49,F9({sz:12,name:"Arial"},r))}function zz(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&ze(t,1054,U9(a,e[a],r))})}function Hz(t,e){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(t,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),RA(Bt(e["!ref"]||"A1"),r),r.write_shift(4,4),ze(t,2152,r)}function Gz(t,e){for(var r=0;r<16;++r)ze(t,224,uE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ze(t,224,uE(n,0,e))})}function qz(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ze(t,440,m7(n)),n[1].Tooltip&&ze(t,2048,g7(n))}delete e["!links"]}function Xz(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&ze(t,125,T7(Am(a,n),a))})}}function Wz(t,e,r,n,a){var o=16+Uo(a.cellXfs,e,a);if(e.v==null&&!e.bf){ze(t,513,Ll(r,n,o));return}if(e.bf)ze(t,6,_B(e,r,n,a,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?on(xr(e.v)):e.v;ze(t,515,J9(r,n,l,o));break;case"b":case"e":ze(t,517,Y9(r,n,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var u=lv(a.Strings,e.v,a.revStrings);ze(t,253,L9(r,n,u,o))}else ze(t,516,V9(r,n,(e.v||"").slice(0,255),o,a));break;default:ze(t,513,Ll(r,n,o))}}function Kz(t,e,r){var n=fa(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},h=Array.isArray(o),d=e.biff==8,p,v="",_=[],w=Bt(o["!ref"]||"A1"),S=d?65536:16384;if(w.e.c>255||w.e.r>=S){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,S-1)}ze(n,2057,ev(r,16,e)),ze(n,13,Ka(1)),ze(n,12,Ka(100)),ze(n,15,Jn(!0)),ze(n,17,Jn(!1)),ze(n,16,Fl(.001)),ze(n,95,Jn(!0)),ze(n,42,Jn(!1)),ze(n,43,Jn(!1)),ze(n,130,Ka(1)),ze(n,128,$9()),ze(n,131,Jn(!1)),ze(n,132,Jn(!1)),d&&Xz(n,o["!cols"]),ze(n,512,z9(w,e)),d&&(o["!links"]=[]);for(var E=w.s.r;E<=w.e.r;++E){v=Vr(E);for(var A=w.s.c;A<=w.e.c;++A){E===w.s.r&&(_[A]=Er(A)),p=_[A]+v;var L=h?(o[E]||[])[A]:o[p];L&&(Wz(n,L,E,A,e),d&&L.l&&o["!links"].push([p,L.l]))}}var U=u.CodeName||u.name||a;return d&&ze(n,574,I9((l.Views||[])[0])),d&&(o["!merges"]||[]).length&&ze(n,229,l7(o["!merges"])),d&&qz(n,o),ze(n,442,AA(U)),d&&Hz(n,o),ze(n,10),n.end()}function $z(t,e,r){var n=fa(),a=(t||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,h=r.biff==5;if(ze(n,2057,ev(t,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,u?Ka(1200):null),ze(n,193,YM(2)),h&&ze(n,191),h&&ze(n,192),ze(n,226),ze(n,92,v9("SheetJS",r)),ze(n,66,Ka(u?1200:1252)),u&&ze(n,353,Ka(0)),u&&ze(n,448),ze(n,317,b7(t.SheetNames.length)),u&&t.vbaraw&&ze(n,211),u&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";ze(n,442,AA(d))}ze(n,156,Ka(17)),ze(n,25,Jn(!1)),ze(n,18,Jn(!1)),ze(n,19,Ka(0)),u&&ze(n,431,Jn(!1)),u&&ze(n,444,Ka(0)),ze(n,61,N9()),ze(n,64,Jn(!1)),ze(n,141,Ka(0)),ze(n,34,Jn(kj(t)=="true")),ze(n,14,Jn(!0)),u&&ze(n,439,Jn(!1)),ze(n,218,Ka(0)),jz(n,t,r),zz(n,t.SSF,r),Gz(n,r),u&&ze(n,352,Jn(!1));var p=n.end(),v=fa();u&&ze(v,140,v7()),u&&r.Strings&&Mz(v,252,E9(r.Strings)),ze(v,10);var _=v.end(),w=fa(),S=0,E=0;for(E=0;E<t.SheetNames.length;++E)S+=(u?12:11)+(u?2:1)*t.SheetNames[E].length;var A=p.length+S+_.length;for(E=0;E<t.SheetNames.length;++E){var L=o[E]||{};ze(w,133,w9({pos:A,hs:L.Hidden||0,dt:0,name:t.SheetNames[E]},r)),A+=e[E].length}var U=w.end();if(S!=U.length)throw new Error("BS8 "+S+" != "+U.length);var N=[];return p.length&&N.push(p),U.length&&N.push(U),_.length&&N.push(_),mn(N)}function Yz(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(du(),_m(t.SSF),r.revssf=wm(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,dv(r),r.cellXfs=[],Uo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=Kz(a,r,t);return n.unshift($z(t,n,r)),mn(n)}function _k(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ha(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return Yz(t,e);case 4:case 3:case 2:return Uz(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function bE(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=a.index,u=o&&o.index||t.length,h=FF(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,v=0,_=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(l=0;l<h.length;++l){var E=h[l].trim(),A=E.slice(0,3).toLowerCase();if(A=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(A!="<td"&&A!="<th")){var L=E.split(/<\/t[dh]>/i);for(u=0;u<L.length;++u){var U=L[u].trim();if(U.match(/<t[dh]/i)){for(var N=U,Q=0;N.charAt(0)=="<"&&(Q=N.indexOf(">"))>-1;)N=N.slice(Q+1);for(var re=0;re<S.length;++re){var ee=S[re];ee.s.c==p&&ee.s.r<d&&d<=ee.e.r&&(p=ee.e.c+1,re=-1)}var k=ft(U.slice(0,U.indexOf(">")));_=k.colspan?+k.colspan:1,((v=+k.rowspan)>1||_>1)&&S.push({s:{r:d,c:p},e:{r:d+(v||1)-1,c:p+_-1}});var I=k.t||k["data-t"]||"";if(!N.length){p+=_;continue}if(N=H4(N),w.s.r>d&&(w.s.r=d),w.e.r<d&&(w.e.r=d),w.s.c>p&&(w.s.c=p),w.e.c<p&&(w.e.c=p),!N.length){p+=_;continue}var R={t:"s",v:N};r.raw||!N.trim().length||I=="s"||(N==="TRUE"?R={t:"b",v:!0}:N==="FALSE"?R={t:"b",v:!1}:isNaN(_i(N))?isNaN(tu(N).getDate())||(R={t:"d",v:xr(N)},r.cellDates||(R={t:"n",v:on(R.v)}),R.z=r.dateNF||st[14]):R={t:"n",v:_i(N)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=R):n[ot({r:d,c:p})]=R,p+=_}}}}return n["!ref"]=_t(w),S.length&&(n["!merges"]=S),n}function Qz(t,e,r,n){for(var a=t["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,h=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,h=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var p=ot({r,c:l}),v=n.dense?(t[r]||[])[l]:t[p],_=v&&v.v!=null&&(v.h||jx(v.w||(Ss(v),v.w)||""))||"",w={};u>1&&(w.rowspan=u),h>1&&(w.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(w["data-t"]=v&&v.t||"z",v.v!=null&&(w["data-v"]=v.v),v.z!=null&&(w["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),w.id=(n.id||"sjs")+"-"+p,o.push(Ue("td",_,w))}}var S="<tr>";return S+o.join("")+"</tr>"}var Jz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zz="</body></html>";function eH(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Bo(bE(r[0],e),e);var n=gv();return r.forEach(function(a,o){xv(n,bE(a,e),"Sheet"+(o+1))}),n}function tH(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yk(t,e){var r=e||{},n=r.header!=null?r.header:Jz,a=r.footer!=null?r.footer:Zz,o=[n],l=ha(t["!ref"]);r.dense=Array.isArray(t),o.push(tH(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(Qz(t,l,u,r));return o.push("</table>"+a),o.join("")}function wk(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var p=ha(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var v=[],_=0,w=t["!rows"]||(t["!rows"]=[]),S=0,E=0,A=0,L=0,U=0,N=0;for(t["!cols"]||(t["!cols"]=[]);S<u.length&&E<h;++S){var Q=u[S];if(AE(Q)){if(n.display)continue;w[E]={hidden:!0}}var re=Q.children;for(A=L=0;A<re.length;++A){var ee=re[A];if(!(n.display&&AE(ee))){var k=ee.hasAttribute("data-v")?ee.getAttribute("data-v"):ee.hasAttribute("v")?ee.getAttribute("v"):H4(ee.innerHTML),I=ee.getAttribute("data-z")||ee.getAttribute("z");for(_=0;_<v.length;++_){var R=v[_];R.s.c==L+o&&R.s.r<E+a&&E+a<=R.e.r&&(L=R.e.c+1-o,_=-1)}N=+ee.getAttribute("colspan")||1,((U=+ee.getAttribute("rowspan")||1)>1||N>1)&&v.push({s:{r:E+a,c:L+o},e:{r:E+a+(U||1)-1,c:L+o+(N||1)-1}});var O={t:"s",v:k},F=ee.getAttribute("data-t")||ee.getAttribute("t")||"";k!=null&&(k.length==0?O.t=F||"z":n.raw||k.trim().length==0||F=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(_i(k))?isNaN(tu(k).getDate())||(O={t:"d",v:xr(k)},n.cellDates||(O={t:"n",v:on(O.v)}),O.z=n.dateNF||st[14]):O={t:"n",v:_i(k)})),O.z===void 0&&I!=null&&(O.z=I);var D="",V=ee.getElementsByTagName("A");if(V&&V.length)for(var Te=0;Te<V.length&&!(V[Te].hasAttribute("href")&&(D=V[Te].getAttribute("href"),D.charAt(0)!="#"));++Te);D&&D.charAt(0)!="#"&&(O.l={Target:D}),n.dense?(t[E+a]||(t[E+a]=[]),t[E+a][L+o]=O):t[ot({c:L+o,r:E+a})]=O,d.e.c<L+o&&(d.e.c=L+o),L+=N}}++E}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,E-1+a),t["!ref"]=_t(d),E>=h&&(t["!fullref"]=_t((d.e.r=u.length-S+E-1+a,d))),t}function Tk(t,e){var r=e||{},n=r.dense?[]:{};return wk(n,t,e)}function rH(t,e){return Bo(Tk(t,e),e)}function AE(t){var e="",r=nH(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function nH(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function aH(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Vt(e.replace(/<[^>]*>/g,""));return[r]}var kE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ek(t,e){var r=e||{},n=zx(t),a=[],o,l,u={name:""},h="",d=0,p,v,_={},w=[],S=r.dense?[]:{},E,A,L={value:""},U="",N=0,Q=[],re=-1,ee=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,R={},O=[],F={},D=0,V=0,Te=[],oe=1,Y=1,ne=[],ve={Names:[]},ie={},Ce=["",""],K=[],M={},q="",G=0,J=!1,le=!1,ye=0;for(Xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=Xf.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?S["!ref"]=_t(k):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(S["!fullref"]=S["!ref"],k.e.r=r.sheetRows-1,S["!ref"]=_t(k)),O.length&&(S["!merges"]=O),Te.length&&(S["!rows"]=Te),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),w.push(p.name),_[p.name]=S,le=!1):E[0].charAt(E[0].length-2)!=="/"&&(p=ft(E[0],!1),re=ee=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,S=r.dense?[]:{},O=[],Te=[],le=!0);break;case"table-row-group":E[1]==="/"?--I:++I;break;case"table-row":case"":if(E[1]==="/"){re+=oe,oe=1;break}if(v=ft(E[0],!1),v.?re=v.-1:re==-1&&(re=0),oe=+v["number-rows-repeated"]||1,oe<10)for(ye=0;ye<oe;++ye)I>0&&(Te[re+ye]={level:I});ee=-1;break;case"covered-table-cell":E[1]!=="/"&&++ee,r.sheetStubs&&(r.dense?(S[re]||(S[re]=[]),S[re][ee]={t:"z"}):S[ot({r:re,c:ee})]={t:"z"}),U="",Q=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++ee,L=ft(E[0],!1),Y=parseInt(L["number-columns-repeated"]||"1",10),A={t:"z",v:null},L.formula&&r.cellFormula!=!1&&(A.f=TE(Vt(L.formula))),(L.||L["value-type"])=="string"&&(A.t="s",A.v=Vt(L["string-value"]||""),r.dense?(S[re]||(S[re]=[]),S[re][ee]=A):S[ot({r:re,c:ee})]=A),ee+=Y-1;else if(E[1]!=="/"){++ee,U="",N=0,Q=[],Y=1;var be=oe?re+oe-1:re;if(ee>k.e.c&&(k.e.c=ee),ee<k.s.c&&(k.s.c=ee),re<k.s.r&&(k.s.r=re),be>k.e.r&&(k.e.r=be),L=ft(E[0],!1),K=[],M={},A={t:L.||L["value-type"],v:null},r.cellFormula)if(L.formula&&(L.formula=Vt(L.formula)),L["number-matrix-columns-spanned"]&&L["number-matrix-rows-spanned"]&&(D=parseInt(L["number-matrix-rows-spanned"],10)||0,V=parseInt(L["number-matrix-columns-spanned"],10)||0,F={s:{r:re,c:ee},e:{r:re+D-1,c:ee+V-1}},A.F=_t(F),ne.push([F,A.F])),L.formula)A.f=TE(L.formula);else for(ye=0;ye<ne.length;++ye)re>=ne[ye][0].s.r&&re<=ne[ye][0].e.r&&ee>=ne[ye][0].s.c&&ee<=ne[ye][0].e.c&&(A.F=ne[ye][1]);switch((L["number-columns-spanned"]||L["number-rows-spanned"])&&(D=parseInt(L["number-rows-spanned"],10)||0,V=parseInt(L["number-columns-spanned"],10)||0,F={s:{r:re,c:ee},e:{r:re+D-1,c:ee+V-1}},O.push(F)),L["number-columns-repeated"]&&(Y=parseInt(L["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=mr(L["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(L.value);break;case"percentage":A.t="n",A.v=parseFloat(L.value);break;case"currency":A.t="n",A.v=parseFloat(L.value);break;case"date":A.t="d",A.v=xr(L["date-value"]),r.cellDates||(A.t="n",A.v=on(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=IF(L["time-value"])/86400,r.cellDates&&(A.t="d",A.v=Tm(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(L.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",L["string-value"]!=null&&(U=Vt(L["string-value"]),Q=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(J=!1,A.t==="s"&&(A.v=U||"",Q.length&&(A.R=Q),J=N==0),ie.Target&&(A.l=ie),K.length>0&&(A.c=K,K=[]),U&&r.cellText!==!1&&(A.w=U),J&&(A.t="z",delete A.v),(!J||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=re))for(var Ee=0;Ee<oe;++Ee){if(Y=parseInt(L["number-columns-repeated"]||"1",10),r.dense)for(S[re+Ee]||(S[re+Ee]=[]),S[re+Ee][ee]=Ee==0?A:vr(A);--Y>0;)S[re+Ee][ee+Y]=vr(A);else for(S[ot({r:re+Ee,c:ee})]=A;--Y>0;)S[ot({r:re+Ee,c:ee+Y})]=vr(A);k.e.c<=ee&&(k.e.c=ee)}Y=parseInt(L["number-columns-repeated"]||"1",10),ee+=Y-1,Y=0,A={},U="",Q=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((o=a.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((o=a.pop())[0]!==E[3])throw"Bad state: "+o;M.t=U,Q.length&&(M.R=Q),M.a=q,K.push(M)}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);q="",G=0,U="",N=0,Q=[];break;case"creator":E[1]==="/"?q=n.slice(G,E.index):G=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((o=a.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);U="",N=0,Q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(R[u.name]=h,(o=a.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&(h="",u=ft(E[0],!1),a.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ft(E[0],!1),h+=kE[E[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ft(E[0],!1),h+=kE[E[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,E.index);break}else d=E.index+E[0].length;break;case"named-range":l=ft(E[0],!1),Ce=Xp(l["cell-range-address"]);var Ie={Name:l.name,Ref:Ce[0]+"!"+Ce[1]};le&&(Ie.Sheet=w.length),ve.Names.push(Ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(E[1]==="/"&&(!L||!L["string-value"])){var nt=aH(n.slice(N,E.index));U=(U.length>0?U+`
`:"")+nt[0]}else ft(E[0],!1),N=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{Ce=Xp(ft(E[0])["target-range-address"]),_[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ie=ft(E[0],!1),!ie.href)break;ie.Target=Vt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ce=Xp(ie.Target.slice(1)),ie.Target="#"+Ce[0]+"!"+Ce[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var te={Sheets:_,SheetNames:w,Workbook:ve};return r.bookSheets&&delete te.Sheets,te}function CE(t,e){e=e||{},Wa(t,"META-INF/manifest.xml")&&IM($r(t,"META-INF/manifest.xml"),e);var r=Na(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ek(cr(r),e);return Wa(t,"meta.xml")&&(n.Props=dA($r(t,"meta.xml"))),n}function NE(t,e){return Ek(t,e)}var iH=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+qf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Br+e}})(),RE=(function(){var t=function(o){return nr(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(o,l,u){var h=[];h.push('      <table:table table:name="'+nr(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,v=ha(o["!ref"]||"A1"),_=o["!merges"]||[],w=0,S=Array.isArray(o);if(o["!cols"])for(p=0;p<=v.e.c;++p)h.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var E="",A=o["!rows"]||[];for(d=0;d<v.s.r;++d)E=A[d]?' table:style-name="ro'+A[d].ods+'"':"",h.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=v.e.r;++d){for(E=A[d]?' table:style-name="ro'+A[d].ods+'"':"",h.push("        <table:table-row"+E+`>
`),p=0;p<v.s.c;++p)h.push(e);for(;p<=v.e.c;++p){var L=!1,U={},N="";for(w=0;w!=_.length;++w)if(!(_[w].s.c>p)&&!(_[w].s.r>d)&&!(_[w].e.c<p)&&!(_[w].e.r<d)){(_[w].s.c!=p||_[w].s.r!=d)&&(L=!0),U["table:number-columns-spanned"]=_[w].e.c-_[w].s.c+1,U["table:number-rows-spanned"]=_[w].e.r-_[w].s.r+1;break}if(L){h.push(r);continue}var Q=ot({r:d,c:p}),re=S?(o[d]||[])[p]:o[Q];if(re&&re.f&&(U["table:formula"]=nr(bB(re.f)),re.F&&re.F.slice(0,Q.length)==Q)){var ee=ha(re.F);U["table:number-matrix-columns-spanned"]=ee.e.c-ee.s.c+1,U["table:number-matrix-rows-spanned"]=ee.e.r-ee.s.r+1}if(!re){h.push(e);continue}switch(re.t){case"b":N=re.v?"TRUE":"FALSE",U["office:value-type"]="boolean",U["office:boolean-value"]=re.v?"true":"false";break;case"n":N=re.w||String(re.v||0),U["office:value-type"]="float",U["office:value"]=re.v||0;break;case"s":case"str":N=re.v==null?"":re.v,U["office:value-type"]="string";break;case"d":N=re.w||xr(re.v).toISOString(),U["office:value-type"]="date",U["office:date-value"]=xr(re.v).toISOString(),U["table:style-name"]="ce1";break;default:h.push(e);continue}var k=t(N);if(re.l&&re.l.Target){var I=re.l.Target;I=I.charAt(0)=="#"?"#"+AB(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),k=Ue("text:a",k,{"xlink:href":I.replace(/&/g,"&amp;")})}h.push("          "+Ue("table:table-cell",Ue("text:p",k,{}),U)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var v=d["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Oo(v),v.ods=u;var _=d["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++u}}});var h=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=h;var v=d["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var h=[Br],d=qf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=qf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+p+`>
`),h.push(hA().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),a(h,l),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)h.push(n(l.Sheets[l.SheetNames[v]],l,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function Sk(t,e){if(e.bookType=="fods")return RE(t,e);var r=Vx(),n="",a=[],o=[];return n="mimetype",wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",wt(r,n,RE(t,e)),a.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",wt(r,n,iH(t,e)),a.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",wt(r,n,Br+hA()),a.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",wt(r,n,FM(o)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",wt(r,n,DM(a)),r}function Pl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Vg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):cr(Vo(t))}function sH(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ca(Pi(t))}function oH(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Mo(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function IE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function lH(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function cH(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=r>=0?0:128}function Zf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function tr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Nr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ht(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=Zf(t,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Zf(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:o};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function Tn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(tr(n*8+a.type)),a.type==2&&e.push(tr(a.data.length)),e.push(a.data))})}),Mo(e)}function fv(t,e){return t?.map(function(r){return e(r.data)})||[]}function qa(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=Zf(t,n),o=Ht(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Nr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=Ht(u.data),d=Nr(h[3][0].data);l.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(l.merge=Nr(o[3][0].data)>>>0>0),r.push(l)}return r}function Rc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:tr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:tr(l.data.length)}],n[2].push({data:Tn(l.meta),type:2})});var o=Tn(n);e.push(tr(o.length)),e.push(o),a.forEach(function(l){return e.push(l)})}),Mo(e)}function uH(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Zf(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Mo(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(a.push(a[0].slice(-h)),d-=h;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-h,-h+d))}}var p=Mo(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Xa(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(uH(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Mo(e)}function Ic(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var o=tr(n),l=o.length;e.push(o),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Mo(e)}function fH(t,e,r,n){var a=Pl(t),o=a.getUint32(4,!0),l=(n>1?12:8)+IE(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,p=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=IE(o&(n>1?12288:4096))*4,o&16&&(h=a.getUint32(l,!0),l+=4),o&32&&(d=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:e[h]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function hH(t,e,r){var n=Pl(t),a=n.getUint32(8,!0),o=12,l=-1,u=-1,h=NaN,d=NaN,p=new Date(2001,0,1);a&1&&(h=lH(t,o),o+=16),a&2&&(d=n.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function Kp(t,e){var r=new Uint8Array(32),n=Pl(r),a=12,o=0;switch(r[0]=5,t.t){case"n":r[1]=2,cH(r,a,t.v),o|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,o,!0),r.slice(0,a)}function $p(t,e){var r=new Uint8Array(32),n=Pl(r),a=12,o=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,o,!0),r.slice(0,a)}function dH(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return fH(t,e,r,t[0]);case 5:return hH(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Pn(t){var e=Ht(t);return Zf(e[1][0].data)}function DE(t,e){var r=Ht(e.data),n=Nr(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=Ht(l.data),h=Nr(u[1][0].data)>>>0;switch(n){case 1:o[h]=Vg(u[3][0].data);break;case 8:{var d=t[Pn(u[9][0].data)][0],p=Ht(d.data),v=t[Pn(p[1][0].data)][0],_=Nr(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var w=Ht(v.data);o[h]=w[3].map(function(S){return Vg(S.data)}).join("")}break}}),o}function mH(t,e){var r,n,a,o,l,u,h,d,p,v,_,w,S,E,A=Ht(t),L=Nr(A[1][0].data)>>>0,U=Nr(A[2][0].data)>>>0,N=((n=(r=A[8])==null?void 0:r[0])==null?void 0:n.data)&&Nr(A[8][0].data)>0||!1,Q,re;if((o=(a=A[7])==null?void 0:a[0])!=null&&o.data&&e!=0)Q=(u=(l=A[7])==null?void 0:l[0])==null?void 0:u.data,re=(d=(h=A[6])==null?void 0:h[0])==null?void 0:d.data;else if((v=(p=A[4])==null?void 0:p[0])!=null&&v.data&&e!=1)Q=(w=(_=A[4])==null?void 0:_[0])==null?void 0:w.data,re=(E=(S=A[3])==null?void 0:S[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var ee=N?4:1,k=Pl(Q),I=[],R=0;R<Q.length/2;++R){var O=k.getUint16(R*2,!0);O<65535&&I.push([R,O])}if(I.length!=U)throw"Expected ".concat(U," cells, found ").concat(I.length);var F=[];for(R=0;R<I.length-1;++R)F[I[R][0]]=re.subarray(I[R][1]*ee,I[R+1][1]*ee);return I.length>=1&&(F[I[I.length-1][0]]=re.subarray(I[I.length-1][1]*ee)),{R:L,cells:F}}function pH(t,e){var r,n=Ht(e.data),a=(r=n?.[7])!=null&&r[0]?Nr(n[7][0].data)>>>0>0?1:0:-1,o=fv(n[5],function(l){return mH(l,a)});return{nrows:Nr(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(h,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=h}),l},[])}}function gH(t,e,r){var n,a=Ht(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Nr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Nr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=_t(o);var l=Ht(a[4][0].data),u=DE(t,t[Pn(l[4][0].data)][0]),h=(n=l[17])!=null&&n[0]?DE(t,t[Pn(l[17][0].data)][0]):[],d=Ht(l[3][0].data),p=0;d[1].forEach(function(v){var _=Ht(v.data),w=t[Pn(_[2][0].data)][0],S=Nr(w.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var E=pH(t,w);E.data.forEach(function(A,L){A.forEach(function(U,N){var Q=ot({r:p+L,c:N}),re=dH(U,u,h);re&&(r[Q]=re)})}),p+=E.nrows})}function xH(t,e){var r=Ht(e.data),n={"!ref":"A1"},a=t[Pn(r[2][0].data)],o=Nr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return gH(t,a[0],n),n}function vH(t,e){var r,n=Ht(e.data),a={name:(r=n[1])!=null&&r[0]?Vg(n[1][0].data):"",sheets:[]},o=fv(n[2],Pn);return o.forEach(function(l){t[l].forEach(function(u){var h=Nr(u.meta[1][0].data);h==6e3&&a.sheets.push(xH(t,u))})}),a}function _H(t,e){var r=gv(),n=Ht(e.data),a=fv(n[1],Pn);if(a.forEach(function(o){t[o].forEach(function(l){var u=Nr(l.meta[1][0].data);if(u==2){var h=vH(t,l);h.sheets.forEach(function(d,p){xv(r,d,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Yp(t){var e,r,n,a,o={},l=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=Xa(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=qa(d)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Nr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(h){o[h].forEach(function(d){var p=Nr(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return _H(o,u)}function yH(t,e,r){var n,a,o,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=t[8])==null?void 0:o[0])==null?void 0:l.data)&&Nr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Pl(t[7][0].data),p=0,v=[],_=Pl(t[4][0].data),w=0,S=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),_.setUint16(E*2,65535);continue}d.setUint16(E*2,p,!0),_.setUint16(E*2,w,!0);var A,L;switch(typeof e[E]){case"string":A=Kp({t:"s",v:e[E]},r),L=$p({t:"s",v:e[E]},r);break;case"number":A=Kp({t:"n",v:e[E]},r),L=$p({t:"n",v:e[E]},r);break;case"boolean":A=Kp({t:"b",v:e[E]},r),L=$p({t:"b",v:e[E]},r);break;default:throw new Error("Unsupported value "+e[E])}v.push(A),p+=A.length,S.push(L),w+=L.length,++h}for(t[2][0].data=tr(h);E<t[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),_.setUint16(E*2,65535,!0);return t[6][0].data=Mo(v),t[3][0].data=Mo(S),h}function wH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ha(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(_t(n)));var o=Xd(r,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(q){return q.forEach(function(G){typeof G=="string"&&l.push(G)})});var u={},h=[],d=tt.read(e.numbers,{type:"base64"});d.FileIndex.map(function(q,G){return[q,d.FullPaths[G]]}).forEach(function(q){var G=q[0],J=q[1];if(G.type==2&&G.name.match(/\.iwa/)){var le=G.content,ye=Xa(le),be=qa(ye);be.forEach(function(Ee){h.push(Ee.id),u[Ee.id]={deps:[],location:J,type:Nr(Ee.messages[0].meta[1][0].data)}})}}),h.sort(function(q,G){return q-G});var p=h.filter(function(q){return q>1}).map(function(q){return[q,tr(q)]});d.FileIndex.map(function(q,G){return[q,d.FullPaths[G]]}).forEach(function(q){var G=q[0];if(q[1],!!G.name.match(/\.iwa/)){var J=qa(Xa(G.content));J.forEach(function(le){le.messages.forEach(function(ye){p.forEach(function(be){le.messages.some(function(Ee){return Nr(Ee.meta[1][0].data)!=11006&&oH(Ee.data,be[1])})&&u[be[0]].deps.push(le.id)})})})}});for(var v=tt.find(d,u[1].location),_=qa(Xa(v.content)),w,S=0;S<_.length;++S){var E=_[S];E.id==1&&(w=E)}var A=Pn(Ht(w.messages[0].data)[1][0].data);for(v=tt.find(d,u[A].location),_=qa(Xa(v.content)),S=0;S<_.length;++S)E=_[S],E.id==A&&(w=E);for(A=Pn(Ht(w.messages[0].data)[2][0].data),v=tt.find(d,u[A].location),_=qa(Xa(v.content)),S=0;S<_.length;++S)E=_[S],E.id==A&&(w=E);for(A=Pn(Ht(w.messages[0].data)[2][0].data),v=tt.find(d,u[A].location),_=qa(Xa(v.content)),S=0;S<_.length;++S)E=_[S],E.id==A&&(w=E);var L=Ht(w.messages[0].data);{L[6][0].data=tr(n.e.r+1),L[7][0].data=tr(n.e.c+1);var U=Pn(L[46][0].data),N=tt.find(d,u[U].location),Q=qa(Xa(N.content));{for(var re=0;re<Q.length&&Q[re].id!=U;++re);if(Q[re].id!=U)throw"Bad ColumnRowUIDMapArchive";var ee=Ht(Q[re].messages[0].data);ee[1]=[],ee[2]=[],ee[3]=[];for(var k=0;k<=n.e.c;++k){var I=[];I[1]=I[2]=[{type:0,data:tr(k+420690)}],ee[1].push({type:2,data:Tn(I)}),ee[2].push({type:0,data:tr(k)}),ee[3].push({type:0,data:tr(k)})}ee[4]=[],ee[5]=[],ee[6]=[];for(var R=0;R<=n.e.r;++R)I=[],I[1]=I[2]=[{type:0,data:tr(R+726270)}],ee[4].push({type:2,data:Tn(I)}),ee[5].push({type:0,data:tr(R)}),ee[6].push({type:0,data:tr(R)});Q[re].messages[0].data=Tn(ee)}N.content=Ic(Rc(Q)),N.size=N.content.length,delete L[46];var O=Ht(L[4][0].data);{O[7][0].data=tr(n.e.r+1);var F=Ht(O[1][0].data),D=Pn(F[2][0].data);N=tt.find(d,u[D].location),Q=qa(Xa(N.content));{if(Q[0].id!=D)throw"Bad HeaderStorageBucket";var V=Ht(Q[0].messages[0].data);for(R=0;R<o.length;++R){var Te=Ht(V[2][0].data);Te[1][0].data=tr(R),Te[4][0].data=tr(o[R].length),V[2][R]={type:V[2][0].type,data:Tn(Te)}}Q[0].messages[0].data=Tn(V)}N.content=Ic(Rc(Q)),N.size=N.content.length;var oe=Pn(O[2][0].data);N=tt.find(d,u[oe].location),Q=qa(Xa(N.content));{if(Q[0].id!=oe)throw"Bad HeaderStorageBucket";for(V=Ht(Q[0].messages[0].data),k=0;k<=n.e.c;++k)Te=Ht(V[2][0].data),Te[1][0].data=tr(k),Te[4][0].data=tr(n.e.r+1),V[2][k]={type:V[2][0].type,data:Tn(Te)};Q[0].messages[0].data=Tn(V)}N.content=Ic(Rc(Q)),N.size=N.content.length;var Y=Pn(O[4][0].data);(function(){for(var q=tt.find(d,u[Y].location),G=qa(Xa(q.content)),J,le=0;le<G.length;++le){var ye=G[le];ye.id==Y&&(J=ye)}var be=Ht(J.messages[0].data);{be[3]=[];var Ee=[];l.forEach(function(te,Ft){Ee[1]=[{type:0,data:tr(Ft)}],Ee[2]=[{type:0,data:tr(1)}],Ee[3]=[{type:2,data:sH(te)}],be[3].push({type:2,data:Tn(Ee)})})}J.messages[0].data=Tn(be);var Ie=Rc(G),nt=Ic(Ie);q.content=nt,q.size=q.content.length})();var ne=Ht(O[3][0].data);{var ve=ne[1][0];delete ne[2];var ie=Ht(ve.data);{var Ce=Pn(ie[2][0].data);(function(){for(var q=tt.find(d,u[Ce].location),G=qa(Xa(q.content)),J,le=0;le<G.length;++le){var ye=G[le];ye.id==Ce&&(J=ye)}var be=Ht(J.messages[0].data);{delete be[6],delete ne[7];var Ee=new Uint8Array(be[5][0].data);be[5]=[];for(var Ie=0,nt=0;nt<=n.e.r;++nt){var te=Ht(Ee);Ie+=yH(te,o[nt],l),te[1][0].data=tr(nt),be[5].push({data:Tn(te),type:2})}be[1]=[{type:0,data:tr(n.e.c+1)}],be[2]=[{type:0,data:tr(n.e.r+1)}],be[3]=[{type:0,data:tr(Ie)}],be[4]=[{type:0,data:tr(n.e.r+1)}]}J.messages[0].data=Tn(be);var Ft=Rc(G),ht=Ic(Ft);q.content=ht,q.size=q.content.length})()}ve.data=Tn(ie)}O[3][0].data=Tn(ne)}L[4][0].data=Tn(O)}w.messages[0].data=Tn(L);var K=Rc(_),M=Ic(K);return v.content=M,v.size=v.content.length,d}function bk(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function hv(t){bk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function dv(t){bk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function TH(t){return Et.WS.indexOf(t)>-1?"sheet":t==Et.CS?"chart":t==Et.DS?"dialog":t==Et.MS?"macro":t&&t.length?t:"sheet"}function EH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,TH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function SH(t,e,r,n,a,o,l,u,h,d,p,v){try{o[n]=Cf(Na(t,r,!0),e);var _=$r(t,e),w;switch(u){case"sheet":w=Xj(_,e,a,h,o[n],d,p,v);break;case"chart":if(w=Wj(_,e,a,h,o[n],d,p,v),!w||!w["!drawel"])break;var S=vf(w["!drawel"].Target,e),E=Wf(S),A=OP(Na(t,S,!0),Cf(Na(t,E,!0),S)),L=vf(A,S),U=Wf(L);w=yj(Na(t,L,!0),L,h,Cf(Na(t,U,!0),L),d,w);break;case"macro":w=Kj(_,e,a,h,o[n],d,p,v);break;case"dialog":w=$j(_,e,a,h,o[n],d,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=w;var N=[];o&&o[n]&&Rr(o[n]).forEach(function(Q){var re="";if(o[n][Q].Type==Et.CMNT){re=vf(o[n][Q].Target,e);var ee=Zj($r(t,re,!0),re,h);if(!ee||!ee.length)return;xE(w,ee,!1)}o[n][Q].Type==Et.TCMNT&&(re=vf(o[n][Q].Target,e),N=N.concat(MP($r(t,re,!0),h)))}),N&&N.length&&xE(w,N,!0,h.people||[])}catch(Q){if(h.WTF)throw Q}}function Ha(t){return t.charAt(0)=="/"?t.slice(1):t}function bH(t,e){if(du(),e=e||{},hv(e),Wa(t,"META-INF/manifest.xml")||Wa(t,"objectdata.xml"))return CE(t,e);if(Wa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Yp<"u"){if(t.FileIndex)return Yp(t);var r=tt.utils.cfb_new();return VT(t).forEach(function(Te){wt(r,Te,LF(t,Te))}),Yp(r)}throw new Error("Unsupported NUMBERS file")}if(!Wa(t,"[Content_Types].xml"))throw Wa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=VT(t),a=NM(Na(t,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",$r(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!$r(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(Nf=[],a.sst)try{Nf=Jj($r(t,Ha(a.sst)),a.sst,e)}catch(Te){if(e.WTF)throw Te}e.cellStyles&&a.themes.length&&(h=Qj(Na(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=Yj($r(t,Ha(a.style)),a.style,h,e))}a.links.map(function(Te){try{var oe=Cf(Na(t,Wf(Ha(Te))),Te);return tz($r(t,Ha(Te)),oe,Te,e)}catch{}});var p=qj($r(t,Ha(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=$r(t,Ha(a.coreprops[0]),!0),_&&(v=dA(_)),a.extprops.length!==0&&(_=$r(t,Ha(a.extprops[0]),!0),_&&LM(_,v,e)));var w={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Na(t,Ha(a.custprops[0]),!0),_&&(w=VM(_,e)));var S={};if((e.bookSheets||e.bookProps)&&(p.Sheets?l=p.Sheets.map(function(oe){return oe.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(S.Props=v,S.Custprops=w),e.bookSheets&&typeof l<"u"&&(S.SheetNames=l),e.bookSheets?S.SheetNames:e.bookProps))return S;l={};var E={};e.bookDeps&&a.calcchain&&(E=ez($r(t,Ha(a.calcchain)),a.calcchain));var A=0,L={},U,N;{var Q=p.Sheets;v.Worksheets=Q.length,v.SheetNames=[];for(var re=0;re!=Q.length;++re)v.SheetNames[re]=Q[re].name}var ee=o?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Wa(t,I)||(I="xl/_rels/workbook."+ee+".rels");var R=Cf(Na(t,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=rz($r(t,Ha(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=PP($r(t,Ha(a.people[0])),e)),R&&(R=EH(R,p.Sheets));var O=$r(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=v.Worksheets;++A){var F="sheet";if(R&&R[A]?(U="xl/"+R[A][1].replace(/[\/]?xl\//,""),Wa(t,U)||(U=R[A][1]),Wa(t,U)||(U=I.replace(/_rels\/.*$/,"")+R[A][1]),F=R[A][2]):(U="xl/worksheets/sheet"+(A+1-O)+"."+ee,U=U.replace(/sheet0\./,"sheet.")),N=U.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(A!=e.sheets)continue e;break;case"string":if(v.SheetNames[A].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,V=0;V!=e.sheets.length;++V)typeof e.sheets[V]=="number"&&e.sheets[V]==A&&(D=1),typeof e.sheets[V]=="string"&&e.sheets[V].toLowerCase()==v.SheetNames[A].toLowerCase()&&(D=1);if(!D)continue e}}SH(t,U,N,v.SheetNames[A],A,L,l,F,e,p,h,d)}return S={Directory:a,Workbook:p,Props:v,Custprops:w,Deps:E,Sheets:l,SheetNames:v.SheetNames,Strings:Nf,Styles:d,Themes:h,SSF:vr(st)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(Te,oe){Te=Te.replace(/^Root Entry[\/]/,""),S.keys.push(Te),S.files[Te]=t.FileIndex[oe]}))),e&&e.bookVBA&&(a.vba.length>0?S.vbaraw=$r(t,Ha(a.vba[0]),!0):a.defaults&&a.defaults.bin===qP&&(S.vbaraw=$r(t,"xl/vbaProject.bin",!0))),S}function AH(t,e){var r=e||{},n="Workbook",a=tt.find(t,n);try{if(n="/!DataSpaces/Version",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(rL(a.content),n="/!DataSpaces/DataSpaceMap",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=aL(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=iL(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);oL(a.content)}catch{}if(n="/EncryptionInfo",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=lL(a.content);if(n="/EncryptedPackage",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function kH(t,e){return e.bookType=="ods"?Sk(t,e):e.bookType=="numbers"?wH(t,e):e.bookType=="xlsb"?CH(t,e):NH(t,e)}function CH(t,e){Vc=1024,t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(du(),_m(t.SSF),e.revssf=wm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=JA.indexOf(e.bookType)>-1,a=Jx();dv(e=e||{});var o=Vx(),l="",u=0;if(e.cellXfs=[],Uo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",wt(o,l,mA(t.Props,e)),a.coreprops.push(l),rr(e.rels,2,l,Et.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,wt(o,l,xA(t.Props)),a.extprops.push(l),rr(e.rels,3,l,Et.EXT_PROPS),t.Custprops!==t.Props&&Rr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",wt(o,l,vA(t.Custprops)),a.custprops.push(l),rr(e.rels,4,l,Et.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,wt(o,l,az(u-1,l,e,t,p)),a.sheets.push(l),rr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Et.WS[0]),v){var w=v["!comments"],S=!1,E="";w&&w.length>0&&(E="xl/comments"+u+"."+r,wt(o,E,oz(w,E)),a.comments.push(E),rr(p,-1,"../comments"+u+"."+r,Et.CMNT),S=!0),v["!legacy"]&&S&&wt(o,"xl/drawings/vmlDrawing"+u+".vml",YA(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&wt(o,Wf(l),qc(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,wt(o,l,sz(e.Strings,l,e)),a.strs.push(l),rr(e.wbrels,-1,"sharedStrings."+r,Et.SST)),l="xl/workbook."+r,wt(o,l,nz(t,l)),a.workbooks.push(l),rr(e.rels,1,l,Et.WB),l="xl/theme/theme1.xml",wt(o,l,av(t.Themes,e)),a.themes.push(l),rr(e.wbrels,-1,"theme/theme1.xml",Et.THEME),l="xl/styles."+r,wt(o,l,iz(t,l,e)),a.styles.push(l),rr(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",wt(o,l,t.vbaraw),a.vba.push(l),rr(e.wbrels,-1,"vbaProject.bin",Et.VBA)),l="xl/metadata."+r,wt(o,l,lz(l)),a.metadata.push(l),rr(e.wbrels,-1,"metadata."+r,Et.XLMETA),wt(o,"[Content_Types].xml",fA(a,e)),wt(o,"_rels/.rels",qc(e.rels)),wt(o,"xl/_rels/workbook."+r+".rels",qc(e.wbrels)),delete e.revssf,delete e.ssf,o}function NH(t,e){Vc=1024,t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(du(),_m(t.SSF),e.revssf=wm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=JA.indexOf(e.bookType)>-1,a=Jx();dv(e=e||{});var o=Vx(),l="",u=0;if(e.cellXfs=[],Uo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",wt(o,l,mA(t.Props,e)),a.coreprops.push(l),rr(e.rels,2,l,Et.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,wt(o,l,xA(t.Props)),a.extprops.push(l),rr(e.rels,3,l,Et.EXT_PROPS),t.Custprops!==t.Props&&Rr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",wt(o,l,vA(t.Custprops)),a.custprops.push(l),rr(e.rels,4,l,Et.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},_=t.Sheets[t.SheetNames[u-1]],w=(_||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,wt(o,l,ck(u-1,e,t,v)),a.sheets.push(l),rr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Et.WS[0]),_){var S=_["!comments"],E=!1,A="";if(S&&S.length>0){var L=!1;S.forEach(function(U){U[1].forEach(function(N){N.T==!0&&(L=!0)})}),L&&(A="xl/threadedComments/threadedComment"+u+"."+r,wt(o,A,LP(S,p,e)),a.threadedcomments.push(A),rr(v,-1,"../threadedComments/threadedComment"+u+"."+r,Et.TCMNT)),A="xl/comments"+u+"."+r,wt(o,A,QA(S)),a.comments.push(A),rr(v,-1,"../comments"+u+"."+r,Et.CMNT),E=!0}_["!legacy"]&&E&&wt(o,"xl/drawings/vmlDrawing"+u+".vml",YA(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&wt(o,Wf(l),qc(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,wt(o,l,VA(e.Strings,e)),a.strs.push(l),rr(e.wbrels,-1,"sharedStrings."+r,Et.SST)),l="xl/workbook."+r,wt(o,l,mk(t)),a.workbooks.push(l),rr(e.rels,1,l,Et.WB),l="xl/theme/theme1.xml",wt(o,l,av(t.Themes,e)),a.themes.push(l),rr(e.wbrels,-1,"theme/theme1.xml",Et.THEME),l="xl/styles."+r,wt(o,l,XA(t,e)),a.styles.push(l),rr(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",wt(o,l,t.vbaraw),a.vba.push(l),rr(e.wbrels,-1,"vbaProject.bin",Et.VBA)),l="xl/metadata."+r,wt(o,l,$A()),a.metadata.push(l),rr(e.wbrels,-1,"metadata."+r,Et.XLMETA),p.length>1&&(l="xl/persons/person.xml",wt(o,l,VP(p)),a.people.push(l),rr(e.wbrels,-1,"persons/person.xml",Et.PEOPLE)),wt(o,"[Content_Types].xml",fA(a,e)),wt(o,"_rels/.rels",qc(e.rels)),wt(o,"xl/_rels/workbook."+r+".rels",qc(e.wbrels)),delete e.revssf,delete e.ssf,o}function mv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ia(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function RH(t,e){return tt.find(t,"EncryptedPackage")?AH(t,e):vk(t,e)}function IH(t,e){var r,n=t,a=e||{};return a.type||(a.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r=U4(n,a),bH(r,a)}function Ak(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lg(t.slice(r),e);default:break e}return ru.to_workbook(t,e)}function DH(t,e){var r="",n=mv(t,e);switch(e.type){case"base64":r=Ia(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ol(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=cr(r)),e.type="binary",Ak(r,e)}function OH(t,e){var r=t;return e.type=="base64"&&(r=Ia(r)),r=jf.utils.decode(1200,r.slice(2),"str"),e.type="binary",Ak(r,e)}function FH(t){return t.match(/[^\x00-\x7F]/)?Pi(t):t}function Qp(t,e,r,n){return n?(r.type="string",ru.to_workbook(t,r)):ru.to_workbook(e,r)}function au(t,e){Ox();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return au(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Wc={},r.dateNF&&(Wc.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",n=CF(t),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=FH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=vr(r),r.type="array",au(Fx(n),r)}switch((a=mv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return RH(tt.read(n,r),r);break;case 9:if(a[1]<=8)return vk(n,r);break;case 60:return Lg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return B7(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return LA.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?IH(n,r):Qp(t,n,r,o);case 239:return a[3]===60?Lg(n,r):Qp(t,n,r,o);case 255:if(a[1]===254)return OH(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return El.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return El.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Mg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return HA.to_workbook(n,r);break;case 10:case 13:case 32:return DH(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return V7.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Mg.to_workbook(n,r):Qp(t,n,r,o)}function kk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return h0(e.file,tt.write(t,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return tt.write(t,e)}function MH(t,e){var r=vr(e||{}),n=kH(t,r);return LH(n,r)}function LH(t,e){var r={},n=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?tt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(vm(a))}return e.password&&typeof encrypt_agile<"u"?kk(encrypt_agile(a,e.password),e):e.type==="file"?h0(e.file,a):e.type=="string"?cr(a):a}function PH(t,e){var r=e||{},n=Fz(t,r);return kk(n,r)}function Mi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return zf(Pi(n));case"binary":return Pi(n);case"string":return t;case"file":return h0(e.file,n,"utf8");case"buffer":return Tt?As(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function VH(t,e){switch(e.type){case"base64":return zf(t);case"binary":return t;case"string":return t;case"file":return h0(e.file,t,"binary");case"buffer":return Tt?As(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ed(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?zf(r):e.type=="string"?cr(r):r;case"file":return h0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Ck(t,e){Ox(),Rj(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Ck(t,r);return r.type="array",vm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Mi(kz(t,r),r);case"slk":case"sylk":return Mi(MA.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Mi(yk(t.Sheets[t.SheetNames[a]],r),r);case"txt":return VH(Rk(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Mi(pv(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Mi(LA.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return ed(Mg.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Mi(ru.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Mi(HA.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Mi(PA.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Mi(Sk(t,r),r);case"wk1":return ed(El.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return ed(El.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ed(_k(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),PH(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MH(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function BH(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Nk(t,e,r){var n={};return n.type="file",n.file=e,BH(n),Ck(t,n)}function UH(t,e,r,n,a,o,l,u){var h=Vr(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var w=e.s.c;w<=e.e.c;++w){var S=l?t[r][w]:t[n[w]+h];if(S===void 0||S.t===void 0){if(d===void 0)continue;o[w]!=null&&(_[o[w]]=d);continue}var E=S.v;switch(S.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[w]!=null){if(E==null)if(S.t=="e"&&E===null)_[o[w]]=null;else if(d!==void 0)_[o[w]]=d;else if(p&&E===null)_[o[w]]=null;else continue;else _[o[w]]=p&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?E:Ss(S,E,u);E!=null&&(v=!1)}}return{row:_,isempty:v}}function Xd(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":h=Bt(p);break;case"number":h=Bt(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(a=0);var v=Vr(h.s.r),_=[],w=[],S=0,E=0,A=Array.isArray(t),L=h.s.r,U=0,N={};A&&!t[L]&&(t[L]=[]);var Q=d.skipHidden&&t["!cols"]||[],re=d.skipHidden&&t["!rows"]||[];for(U=h.s.c;U<=h.e.c;++U)if(!(Q[U]||{}).hidden)switch(_[U]=Er(U),r=A?t[L][U]:t[_[U]+v],n){case 1:o[U]=U-h.s.c;break;case 2:o[U]=_[U];break;case 3:o[U]=d.header[U-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Ss(r,null,d),E=N[l]||0,!E)N[l]=1;else{do u=l+"_"+E++;while(N[u]);N[l]=E,N[u]=1}o[U]=u}for(L=h.s.r+a;L<=h.e.r;++L)if(!(re[L]||{}).hidden){var ee=UH(t,h,L,_,n,o,A,d);(ee.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(w[S++]=ee.row)}return w.length=S,w}var OE=/"/g;function jH(t,e,r,n,a,o,l,u){for(var h=!0,d=[],p="",v=Vr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var w=u.dense?(t[r]||[])[_]:t[n[_]+v];if(w==null)p="";else if(w.v!=null){h=!1,p=""+(u.rawNumbers&&w.t=="n"?w.v:Ss(w,null,u));for(var S=0,E=0;S!==p.length;++S)if((E=p.charCodeAt(S))===a||E===o||E===34||u.forceQuotes){p='"'+p.replace(OE,'""')+'"';break}p=="ID"&&(p='"ID"')}else w.f!=null&&!w.F?(h=!1,p="="+w.f,p.indexOf(",")>=0&&(p='"'+p.replace(OE,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&h?null:d.join(l)}function pv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Bt(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],w=n.skipHidden&&t["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(v[S]=Er(S));for(var E=0,A=a.s.r;A<=a.e.r;++A)(w[A]||{}).hidden||(p=jH(t,a,A,v,l,h,o,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((E++?u:"")+p)));return delete n.dense,r.join("")}function Rk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=pv(t,e);return r}function zH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Bt(t["!ref"]),o="",l=[],u,h=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=Er(u);for(var p=a.s.r;p<=a.e.r;++p)for(o=Vr(p),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function Ik(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?Sr(n.origin):n.origin;l=h.r,u=h.c}var d,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var v=Bt(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+a)}else l==-1&&(l=0,p.e.r=e.length-1+a);var _=n.header||[],w=0;e.forEach(function(E,A){Rr(E).forEach(function(L){(w=_.indexOf(L))==-1&&(_[w=_.length]=L);var U=E[L],N="z",Q="",re=ot({c:u+w,r:l+A+a});d=e0(o,re),U&&typeof U=="object"&&!(U instanceof Date)?o[re]=U:(typeof U=="number"?N="n":typeof U=="boolean"?N="b":typeof U=="string"?N="s":U instanceof Date?(N="d",n.cellDates||(N="n",U=on(U)),Q=n.dateNF||st[14]):U===null&&n.nullError&&(N="e",U=0),d?(d.t=N,d.v=U,delete d.w,delete d.R,Q&&(d.z=Q)):o[re]=d={t:N,v:U},Q&&(d.z=Q))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var S=Vr(l);if(a)for(w=0;w<_.length;++w)o[Er(w+u)+S]={t:"s",v:_[w]};return o["!ref"]=_t(p),o}function HH(t,e){return Ik(null,t,e)}function e0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?e0(t,ot(e)):e0(t,ot({r:e,c:r||0}))}function GH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gv(){return{SheetNames:[],Sheets:{}}}function xv(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(dk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function qH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=GH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function XH(t,e){return t.z=e,t}function Dk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function WH(t,e,r){return Dk(t,"#"+e,r)}function KH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function $H(t,e,r,n){for(var a=typeof e!="string"?e:Bt(e),o=typeof e=="string"?e:_t(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var h=e0(t,l,u);h.t="n",h.F=o,delete h.v,l==a.s.r&&u==a.s.c&&(h.f=r,n&&(h.D=!0))}return t}var Vi={encode_col:Er,encode_row:Vr,encode_cell:ot,encode_range:_t,decode_col:Xx,decode_row:qx,split_cell:sM,decode_cell:Sr,decode_range:ha,format_cell:Ss,sheet_add_aoa:aA,sheet_add_json:Ik,sheet_add_dom:wk,aoa_to_sheet:mu,json_to_sheet:HH,table_to_sheet:Tk,table_to_book:rH,sheet_to_csv:pv,sheet_to_txt:Rk,sheet_to_json:Xd,sheet_to_html:yk,sheet_to_formulae:zH,sheet_to_row_object_array:Xd,sheet_get_cell:e0,book_new:gv,book_append_sheet:xv,book_set_sheet_visibility:qH,cell_set_number_format:XH,cell_set_hyperlink:Dk,cell_set_internal_link:WH,cell_add_comment:KH,sheet_set_array_formula:$H,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ba="kho-suon-muoi-official-system-v1",Ok=t=>{if(!t)return{text:"Khng xc nh",color:"text-gray-500"};if(t==="Vnh vin")return{text:"Vnh vin",color:"text-blue-400"};const e=new Date,n=new Date(t)-e;if(n<=0)return{text:" ht hn",color:"text-red-500"};const a=Math.floor(n/(1e3*60*60*24)),o=Math.floor(n/(1e3*60*60)%24),l=Math.floor(n/(1e3*60)%24);return a>365?{text:"Vnh vin",color:"text-blue-400"}:a>30?{text:`${a} ngy`,color:"text-green-500"}:a>7?{text:`${a} ngy ${o}h`,color:"text-green-400"}:a>0?{text:`${a} ngy ${o}h`,color:"text-yellow-500"}:{text:`${o} gi ${l}p`,color:"text-red-500 animate-pulse"}},dl={green:{border:"border-green-500/50",text:"text-green-500",bg:"bg-green-500/10",glow:"shadow-[0_0_15px_rgba(34,197,94,0.1)]",solid:"bg-green-500"},blue:{border:"border-blue-500/50",text:"text-blue-500",bg:"bg-blue-500/10",glow:"shadow-[0_0_15px_rgba(59,130,246,0.1)]",solid:"bg-blue-500"},purple:{border:"border-purple-500/50",text:"text-purple-500",bg:"bg-purple-500/10",glow:"shadow-[0_0_15px_rgba(168,85,247,0.1)]",solid:"bg-purple-500"},orange:{border:"border-orange-500/50",text:"text-orange-500",bg:"bg-orange-500/10",glow:"shadow-[0_0_15px_rgba(249,115,22,0.1)]",solid:"bg-orange-500"},red:{border:"border-red-500/50",text:"text-red-500",bg:"bg-red-500/10",glow:"shadow-[0_0_15px_rgba(239,68,68,0.1)]",solid:"bg-red-500"},pink:{border:"border-pink-500/50",text:"text-pink-500",bg:"bg-pink-500/10",glow:"shadow-[0_0_15px_rgba(236,72,153,0.1)]",solid:"bg-pink-500"},yellow:{border:"border-yellow-500/50",text:"text-yellow-500",bg:"bg-yellow-500/10",glow:"shadow-[0_0_15px_rgba(234,179,8,0.1)]",solid:"bg-yellow-500"},cyan:{border:"border-cyan-500/50",text:"text-cyan-500",bg:"bg-cyan-500/10",glow:"shadow-[0_0_15px_rgba(6,182,212,0.1)]",solid:"bg-cyan-500"}},Fk=(t=new Date)=>{const e=t.getTimezoneOffset();return new Date(t.getTime()-e*60*1e3).toISOString().split("T")[0]},YH=({isOpen:t,title:e,message:r,onConfirm:n,onCancel:a})=>t?y.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[" ",y.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:a})," ",y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-sm shadow-2xl animate-modal-pop overflow-hidden",children:[" ",y.jsxs("div",{className:"p-6 flex flex-col items-center text-center",children:[" ",y.jsx("div",{className:"w-12 h-12 rounded-full bg-red-900/20 flex items-center justify-center mb-4",children:y.jsx(y4,{className:"text-red-500 w-6 h-6"})})," ",y.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:e})," ",y.jsx("p",{className:"text-sm text-gray-400 mb-6",children:r})," ",y.jsxs("div",{className:"flex gap-3 w-full",children:[" ",y.jsx("button",{onClick:a,className:"flex-1 bg-[#18181b] hover:bg-[#27272a] text-gray-300 py-2.5 rounded-lg text-sm font-medium transition-colors",children:"Hy"})," ",y.jsx("button",{onClick:n,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2.5 rounded-lg text-sm font-medium shadow-lg shadow-red-900/20 transition-colors",children:"Xa Ngay"})," "]})," "]})," "]})," "]}):null,QH=({onClose:t})=>{const[e,r]=Be.useState(""),[n,a]=Be.useState(""),[o,l]=Be.useState("30"),[u,h]=Be.useState(!1),[d,p]=Be.useState([]),[v,_]=Be.useState(null);Be.useEffect(()=>{const L=_b(Sa,"artifacts",ba,"public","data","license_keys"),U=vl(L,N=>{const Q=[];N.forEach(re=>{re.id!=="license_keys"&&Q.push({id:re.id,...re.data()})}),p(Q)});return()=>U()},[]);const w=async()=>{if(!e||!n)return alert("Thiu thng tin");h(!0);try{const L=new Date;o==="9999"?L.setFullYear(L.getFullYear()+100):L.setDate(L.getDate()+parseInt(o)),await xl(Ln(Sa,"artifacts",ba,"public","data","license_keys",e),{password:n,expiryDate:L.toISOString(),status:"active",createdAt:new Date().toISOString()}),alert(` to Key: ${e}`),r(""),a("")}catch(L){alert("Li: "+L.message)}finally{h(!1)}},S=async L=>{confirm(`Xa ti khon ${L}?`)&&await Nb(Ln(Sa,"artifacts",ba,"public","data","license_keys",L))},E=async(L,U)=>{await vI(Ln(Sa,"artifacts",ba,"public","data","license_keys",L),U),_(null)},A=async(L,U)=>{const N=new Date(L.expiryDate)>new Date?new Date(L.expiryDate):new Date;U===9999?N.setFullYear(N.getFullYear()+100):N.setDate(N.getDate()+U),await E(L.id,{expiryDate:N.toISOString()}),alert(" gia hn!")};return y.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4",children:[" ",y.jsx("div",{className:"absolute inset-0 bg-black/95 backdrop-blur-md",onClick:t})," ",y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-4xl h-[90vh] shadow-2xl animate-modal-pop flex flex-col overflow-hidden",children:[" ",y.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center bg-[#121212]",children:[" ",y.jsxs("h3",{className:"text-green-500 font-bold flex items-center gap-2 text-lg",children:[y.jsx(_4,{size:24})," QUN L LICENSE"]})," ",y.jsx("button",{onClick:t,children:y.jsx(xm,{size:24,className:"text-gray-500 hover:text-white"})})," "]})," ",y.jsxs("div",{className:"flex flex-col md:flex-row h-full overflow-hidden",children:[" ",y.jsxs("div",{className:"w-full md:w-1/3 p-4 border-r border-[#27272a] bg-[#0f0f10] overflow-y-auto",children:[" ",y.jsx("h4",{className:"text-sm font-bold text-white mb-4 uppercase tracking-wider",children:"To ti khon mi"})," ",y.jsxs("div",{className:"space-y-3",children:[" ",y.jsx("input",{type:"text",placeholder:"Tn ng nhp",className:"w-full bg-[#18181b] border border-[#27272a] p-3 rounded text-sm text-white outline-none focus:border-green-500",value:e,onChange:L=>r(L.target.value)})," ",y.jsx("input",{type:"text",placeholder:"Mt khu",className:"w-full bg-[#18181b] border border-[#27272a] p-3 rounded text-sm text-white outline-none focus:border-green-500",value:n,onChange:L=>a(L.target.value)})," ",y.jsxs("div",{className:"space-y-1",children:[" ",y.jsx("label",{className:"text-xs text-gray-500",children:"Thi hn s dng:"})," ",y.jsxs("select",{className:"w-full bg-[#18181b] border border-[#27272a] text-white text-sm p-3 rounded outline-none focus:border-green-500",value:o,onChange:L=>l(L.target.value),children:[" ",y.jsx("option",{value:"1",children:"1 Ngy"})," ",y.jsx("option",{value:"3",children:"3 Ngy"})," ",y.jsx("option",{value:"7",children:"1 Tun"})," ",y.jsx("option",{value:"30",children:"1 Thng"})," ",y.jsx("option",{value:"365",children:"1 Nm"})," ",y.jsx("option",{value:"9999",children:"Vnh vin"})," "]})," "]})," ",y.jsx("button",{onClick:w,disabled:u,className:"w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded mt-2 shadow-lg shadow-green-900/20",children:u?"ang to...":"Cp License"})," "]})," "]})," ",y.jsxs("div",{className:"w-full md:w-2/3 p-0 bg-[#050505] overflow-y-auto",children:[" ",y.jsxs("table",{className:"w-full text-left border-collapse",children:[" ",y.jsx("thead",{className:"bg-[#121212] text-xs uppercase text-gray-500 sticky top-0 z-10",children:y.jsxs("tr",{children:[y.jsx("th",{className:"p-3 border-b border-[#27272a]",children:"User"}),y.jsx("th",{className:"p-3 border-b border-[#27272a]",children:"Mt khu"}),y.jsx("th",{className:"p-3 border-b border-[#27272a]",children:"Cn li"}),y.jsx("th",{className:"p-3 border-b border-[#27272a] text-right",children:"Thao tc"})]})})," ",y.jsxs("tbody",{children:[" ",d.map(L=>{const U=Ok(L.expiryDate);return y.jsxs("tr",{className:"border-b border-[#27272a] hover:bg-[#121212] group",children:[" ",y.jsx("td",{className:"p-3 font-medium text-white",children:L.id})," ",y.jsx("td",{className:"p-3 font-mono text-gray-400",children:v===L.id?y.jsxs("div",{className:"flex gap-1",children:[y.jsx("input",{type:"text",className:"w-20 bg-[#27272a] text-white text-xs p-1 rounded",defaultValue:L.password,id:`pass-${L.id}`}),y.jsx("button",{onClick:()=>E(L.id,{password:document.getElementById(`pass-${L.id}`).value}),className:"text-green-500 bg-green-900/20 px-2 rounded text-xs",children:"OK"})]}):y.jsx("span",{onClick:()=>_(L.id),className:"cursor-pointer hover:text-white",children:L.password})})," ",y.jsx("td",{className:`p-3 text-xs ${U.color} font-bold`,children:U.text})," ",y.jsxs("td",{className:"p-3 text-right",children:[" ",y.jsxs("div",{className:"flex justify-end gap-2",children:[" ",y.jsxs("div",{className:"relative group/extend",children:[y.jsx("button",{className:"p-1.5 bg-[#1f2937] hover:bg-blue-600 text-blue-500 hover:text-white rounded transition-colors",children:y.jsx(Od,{size:14})}),y.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-[#18181b] border border-[#27272a] rounded shadow-xl hidden group-hover/extend:block z-20 min-w-[120px]",children:[y.jsx("button",{onClick:()=>A(L,30),className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-[#27272a] hover:text-white",children:"+ 1 Thng"}),y.jsx("button",{onClick:()=>A(L,365),className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-[#27272a] hover:text-white",children:"+ 1 Nm"})]})]})," ",y.jsx("button",{onClick:()=>S(L.id),className:"p-1.5 bg-[#1f2937] hover:bg-red-600 text-red-500 hover:text-white rounded transition-colors",children:y.jsx(Il,{size:14})})," "]})," "]})," "]},L.id)})," "]})," "]})," "]})," "]})," "]})," "]})},JH=({onClose:t,data:e,globalSettings:r,onUpdateSetting:n,globalItems:a,lastImportTime:o})=>{const[l,u]=Be.useState("negative"),[h,d]=Be.useState(""),[p,v]=Be.useState(!1),_=N=>r[N]||{min:5,ignore:!1},w=Be.useMemo(()=>{const N={};return e.forEach(Q=>N[Q.code]=Q.actual),a.map(Q=>({...Q,actual:N[Q.code]}))},[a,e]),S=w.filter(N=>{const Q=_(N.code),re=parseFloat(N.cukcuk);return!Q.ignore&&!isNaN(re)&&re<0}),E=w.filter(N=>{const Q=_(N.code);if(!(N.actual!==void 0&&N.actual!==null&&String(N.actual).trim()!==""))return!1;const ee=parseFloat(N.actual),k=parseFloat(N.cukcuk)||0,I=ee-k;return!Q.ignore&&I<0}),A=w.filter(N=>{const Q=_(N.code),re=parseFloat(N.cukcuk);return!Q.ignore&&!isNaN(re)&&re>=0&&re<=Q.min}),L=()=>{let N=[],Q="";if(l==="negative"?(N=S,Q="AmHeThong"):l==="negative_actual"?(N=E,Q="AmThucTe"):l==="low"&&(N=A,Q="SapHet"),N.length===0)return alert("Khng c d liu!");const re=Vi.json_to_sheet(N),ee=Vi.book_new();Vi.book_append_sheet(ee,re,"BaoCao"),Nk(ee,`BaoCao_${Q}.xlsx`)},U=(N,Q)=>{const re=_(N.code),ee=parseFloat(N.cukcuk);let k="-",I="text-gray-400";return Q==="negative_actual"?(k=(parseFloat(N.actual||0)-parseFloat(N.cukcuk||0)).toFixed(2),I="text-red-500 font-bold"):isNaN(ee)||(k=Number(ee).toFixed(2).replace(/\.00$/,""),I=ee<0?"text-red-500 font-bold":"text-yellow-500 font-bold"),y.jsxs("tr",{className:"border-b border-[#27272a] hover:bg-[#121212] group",children:[" ",y.jsx("td",{className:"px-3 py-3 font-mono text-xs text-gray-500",children:N.code})," ",y.jsx("td",{className:"px-3 py-3 text-sm text-gray-300 font-medium",children:N.name})," ",y.jsx("td",{className:"px-3 py-3 text-xs text-center text-gray-500",children:N.unit})," ",Q!=="settings"&&y.jsx("td",{className:`px-3 py-3 text-sm text-right ${I}`,children:k})," ",(Q==="low"||Q==="settings")&&y.jsxs("td",{className:"px-3 py-3 text-center",children:[" ",Q==="low"?y.jsx("span",{className:"text-yellow-600 font-mono text-xs font-bold",children:re.min}):y.jsx("input",{type:"number",className:"w-16 bg-[#18181b] border border-[#27272a] text-center text-gray-300 rounded px-1 py-1 text-xs focus:border-yellow-600 outline-none",value:re.min,onChange:R=>n(N.code,{...re,min:parseFloat(R.target.value)||0})})," "]})," ",y.jsxs("td",{className:"px-3 py-3 text-right",children:[" ",y.jsx("button",{onClick:()=>n(N.code,{...re,ignore:!re.ignore}),className:`p-1.5 rounded transition-colors flex items-center justify-center w-8 h-8 ml-auto ${re.ignore?"bg-[#27272a] text-gray-500":"bg-green-900/30 text-green-500"}`,children:re.ignore?y.jsx(Z8,{size:16}):y.jsx(tO,{size:16})})," "]})," "]},N.code)};return y.jsxs("div",{className:"fixed inset-0 z-[85] flex items-center justify-center p-4",children:[" ",y.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t})," ",y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-4xl h-[85vh] shadow-2xl animate-modal-pop flex flex-col",children:[" ",y.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center bg-[#121212]",children:[" ",y.jsxs("h3",{className:"text-lg font-bold text-white flex gap-2 items-center",children:[y.jsx(f4,{className:"text-yellow-500"})," Bo Co Nhanh"]})," ",y.jsxs("div",{className:"flex items-center gap-3",children:[" ",!p&&y.jsxs("button",{onClick:L,className:"bg-green-700 hover:bg-green-600 text-white text-xs px-3 py-1.5 rounded flex items-center gap-1 transition-colors",children:[y.jsx(bg,{size:14})," Xut Excel"]})," ",y.jsx("button",{onClick:()=>v(!p),className:`p-2 rounded-lg transition-colors ${p?"bg-blue-500/20 text-blue-500":"text-gray-400 hover:text-white hover:bg-[#27272a]"}`,title:"Cu hnh",children:y.jsx(Rx,{size:20})})," ",y.jsx("button",{onClick:t,children:y.jsx(xm,{className:"text-gray-500 hover:text-white"})})," "]})," "]})," ",!p&&y.jsxs("div",{className:"flex border-b border-[#27272a] bg-[#0a0a0a] mt-2",children:[" ",y.jsxs("button",{onClick:()=>u("negative"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2 ${l==="negative"?"border-red-500 text-red-500 bg-red-500/5":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[y.jsx(y4,{size:14})," m H Thng ",y.jsx("span",{className:"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full ml-1",children:S.length})]})," ",y.jsxs("button",{onClick:()=>u("negative_actual"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2 ${l==="negative_actual"?"border-orange-500 text-orange-500 bg-orange-500/5":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[y.jsx(LO,{size:14})," m Thc T ",y.jsx("span",{className:"bg-orange-500 text-black text-[10px] px-1.5 py-0.5 rounded-full ml-1",children:E.length})]})," ",y.jsxs("button",{onClick:()=>u("low"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2 ${l==="low"?"border-yellow-500 text-yellow-500 bg-yellow-500/5":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[y.jsx(bg,{size:14,className:"rotate-180"})," Sp Ht ",y.jsx("span",{className:"bg-yellow-500 text-black text-[10px] px-1.5 py-0.5 rounded-full ml-1",children:A.length})]})," "]})," ",p&&y.jsx("div",{className:"p-3 border-b border-[#27272a] bg-[#0f0f10]",children:y.jsx("input",{type:"text",className:"bg-[#18181b] border border-[#27272a] text-gray-200 text-sm rounded-lg w-full pl-4 p-2 outline-none focus:border-blue-500 placeholder-gray-600",placeholder:"Tm kim ci t...",value:h,onChange:N=>d(N.target.value),autoFocus:!0})})," ",y.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-[#050505] p-4",children:[" ",y.jsxs("table",{className:"w-full text-left border-collapse",children:[" ",y.jsxs("thead",{className:"bg-[#121212] text-xs uppercase text-gray-500 sticky top-0 z-10",children:[" ",y.jsxs("tr",{children:[y.jsx("th",{className:"px-3 py-2 border-b border-[#27272a]",children:"M"}),y.jsx("th",{className:"px-3 py-2 border-b border-[#27272a]",children:"Tn Hng"}),y.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-center",children:"VT"}),!p&&y.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-right",children:l==="negative_actual"?"Lch":"Tn CukCuk"}),(l==="low"||p)&&y.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-center text-yellow-600",children:"Min"}),y.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-right",children:"Theo Di"})]})," "]})," ",y.jsxs("tbody",{children:[" ",!p&&l==="negative"&&S.map(N=>U(N,"negative"))," ",!p&&l==="negative_actual"&&E.map(N=>U(N,"negative_actual"))," ",!p&&l==="low"&&A.map(N=>U(N,"low"))," ",p&&w.filter(N=>N.name.toLowerCase().includes(h.toLowerCase())).map(N=>U(N,"settings"))," "]})," "]})," "]})," "]})," "]})},Mk=({onClose:t,onPaste:e,currentData:r,mode:n="number"})=>{const[a,o]=Be.useState(""),[l,u]=Be.useState([]);Be.useEffect(()=>{const d=a.split(/\r?\n/).filter(p=>p.trim()!=="");u(n==="number"?d.map(p=>p.trim()):d.map((p,v)=>{let _=p.trim().split(/[\t]+|\s{2,}/);return{order:v+1,code:_[0]||"",name:_[1]||"Cha c tn",unit:_[2]||"?"}}))},[a,n]);const h=()=>{e(l),t()};return y.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center p-4",children:[" ",y.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t})," ",y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-5xl h-[90vh] shadow-2xl animate-modal-pop flex flex-col",children:[" ",y.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center bg-[#121212]",children:[" ",y.jsx("h3",{className:"text-lg font-bold text-white",children:"Nhp Nhanh"})," ",y.jsx("button",{onClick:t,children:y.jsx(xm,{className:"text-gray-500 hover:text-white"})})," "]})," ",y.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[" ",y.jsx("div",{className:"flex-1 flex flex-col p-4 border-r border-[#27272a]",children:y.jsx("textarea",{className:"flex-1 w-full bg-[#18181b] border border-[#27272a] rounded-lg p-4 outline-none text-xs md:text-sm text-gray-300 font-mono resize-none focus:border-yellow-600 transition-colors whitespace-pre",placeholder:"Dn d liu vo y...",value:a,onChange:d=>o(d.target.value),autoFocus:!0})})," ",y.jsx("div",{className:"flex-1 flex flex-col p-4 bg-[#050505]",children:y.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar border border-[#27272a] rounded-lg bg-[#0a0a0a]",children:y.jsxs("table",{className:"w-full text-xs text-left text-gray-400",children:[y.jsx("thead",{className:"text-[10px] text-gray-500 uppercase bg-[#121212] sticky top-0",children:y.jsx("tr",{children:y.jsx("th",{className:"px-3 py-2",children:"D liu"})})}),y.jsx("tbody",{children:l.map((d,p)=>y.jsx("tr",{className:"border-b border-[#27272a]",children:y.jsx("td",{className:"px-3 py-2",children:n==="item"?d.name:d})},p))})]})})})," "]})," ",y.jsx("div",{className:"p-4 border-t border-[#27272a] flex justify-end gap-3 bg-[#121212]",children:y.jsxs("button",{onClick:h,disabled:l.length===0,className:"bg-yellow-600 hover:bg-yellow-500 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2",children:[y.jsx(V8,{size:16})," p dng"]})})," "]})," "]})},ZH=({selectedDate:t,onChange:e,onClose:r,calendarMap:n})=>{const[a,o]=Be.useState(new Date(t)),l=Be.useMemo(()=>{const u=a.getFullYear(),h=a.getMonth(),d=new Date(u,h,1),p=[],v=d.getDay()===0?6:d.getDay()-1;for(let _=v;_>0;_--)p.push({date:null,inactive:!0});for(;d.getMonth()===h;){const _=Fk(d),w=n[_]||{hasActual:!1,hasCukCuk:!1,isDone:!1};p.push({date:new Date(d),dateStr:_,...w}),d.setDate(d.getDate()+1)}return p},[a,t,n]);return y.jsxs("div",{className:"fixed inset-0 z-[90] flex items-center justify-center p-4",children:[y.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:r}),y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-lg shadow-2xl animate-modal-pop p-6",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[y.jsx(Cx,{className:"text-green-500"})," Lch Kim K"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{onClick:()=>o(new Date(a.getFullYear(),a.getMonth()-1,1)),children:y.jsx(d4,{className:"text-gray-400"})}),y.jsxs("span",{className:"text-sm font-mono",children:[a.getMonth()+1,"/",a.getFullYear()]}),y.jsx("button",{onClick:()=>o(new Date(a.getFullYear(),a.getMonth()+1,1)),children:y.jsx(m4,{className:"text-gray-400"})})]})]}),y.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["T2","T3","T4","T5","T6","T7","CN"].map(u=>y.jsx("div",{className:"text-center text-xs text-gray-500 font-bold mb-2",children:u},u)),l.map((u,h)=>{if(u.inactive)return y.jsx("div",{},h);let d="border-[#27272a] text-gray-500 hover:bg-[#18181b]",p=null;return u.dateStr===t?d="border-white bg-white/10 text-white shadow-lg":u.hasActual?d="border-green-500 bg-green-900/30 text-green-500":u.hasCukCuk&&(d="border-orange-500 bg-orange-900/30 text-orange-500"),u.isDone&&(p=y.jsx("div",{className:"absolute top-1 right-1",children:y.jsx(h4,{size:12,className:"text-white bg-green-500 rounded-full p-[1px]"})})),y.jsxs("button",{onClick:()=>{e(u.dateStr),r()},className:`relative h-14 rounded border flex flex-col items-center justify-center transition-all ${d}`,children:[y.jsx("span",{className:"text-sm font-bold",children:u.date.getDate()}),p,(u.hasActual||u.hasCukCuk)&&y.jsxs("div",{className:"flex gap-1 mt-1",children:[u.hasActual&&y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),u.hasCukCuk&&y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500"})]})]},h)})]})]})]})},eG=({template:t,onClose:e,onSave:r})=>{const[n,a]=Be.useState(t.data||[]),[o,l]=Be.useState(!1),u=()=>{r({...t,data:n}),e()},h=v=>{const _=n.length>0?Math.max(...n.map(w=>w.order)):0;a([...n,...v.map((w,S)=>({...w,order:_+S+1}))])},d=v=>{const _=[...n];_.splice(v,1),a(_)},p=(v,_,w)=>{const S=[...n];S[v][_]=w,a(S)};return y.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4",children:[" ",y.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e})," ",y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-2xl h-[80vh] flex flex-col shadow-2xl animate-modal-pop",children:[" ",y.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center",children:[y.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[y.jsx(Ag,{size:18})," Sa Mu"]}),y.jsx("button",{onClick:e,children:y.jsx(xm,{className:"text-gray-500 hover:text-white"})})]})," ",y.jsxs("div",{className:"p-2 border-b border-[#27272a] bg-[#121212] flex gap-2",children:[y.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-green-900/30 text-green-500 border border-green-900/50 rounded text-xs",children:[y.jsx(zO,{size:14})," Nhp t Excel"]}),y.jsxs("button",{onClick:()=>a([...n,{order:n.length+1,code:"",name:"Mi",unit:"KG"}]),className:"flex items-center gap-2 px-3 py-1.5 bg-[#1f2937] text-gray-300 border border-gray-700 rounded text-xs",children:[y.jsx(Od,{size:14})," Thm dng"]})]})," ",y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[" ",y.jsxs("table",{className:"w-full text-sm text-left text-gray-400",children:[" ",y.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-[#121212] sticky top-0",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-2 py-2",children:"#"}),y.jsx("th",{className:"px-2 py-2",children:"M"}),y.jsx("th",{className:"px-2 py-2",children:"Tn"}),y.jsx("th",{className:"px-2 py-2",children:"VT"}),y.jsx("th",{className:"px-2 py-2 text-right",children:"Xa"})]})})," ",y.jsx("tbody",{children:n.map((v,_)=>y.jsxs("tr",{className:"border-b border-[#27272a] hover:bg-[#121212] group",children:[y.jsx("td",{className:"px-2 py-2 text-gray-600",children:_+1}),y.jsx("td",{className:"px-2 py-2",children:y.jsx("input",{className:"bg-transparent text-green-500 w-full outline-none font-mono",value:v.code,onChange:w=>p(_,"code",w.target.value)})}),y.jsx("td",{className:"px-2 py-2",children:y.jsx("input",{className:"bg-transparent text-white w-full outline-none",value:v.name,onChange:w=>p(_,"name",w.target.value)})}),y.jsx("td",{className:"px-2 py-2",children:y.jsx("input",{className:"bg-transparent text-gray-400 w-full outline-none text-center",value:v.unit,onChange:w=>p(_,"unit",w.target.value)})}),y.jsx("td",{className:"px-2 py-2 text-right",children:y.jsx("button",{onClick:()=>d(_),className:"text-red-500 opacity-50 group-hover:opacity-100",children:y.jsx(Il,{size:14})})})]},_))})," "]})," "]})," ",y.jsx("div",{className:"p-4 border-t border-[#27272a] flex justify-end",children:y.jsx("button",{onClick:u,className:"bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-medium",children:"Lu Thay i"})})," "]})," ",o&&y.jsx(Mk,{mode:"item",onClose:()=>l(!1),onPaste:h,currentData:[]})," "]})},tG=({username:t,onLogout:e,expiryDate:r})=>{const[n,a]=Be.useState({text:"...",color:"text-gray-500"});Be.useEffect(()=>{const De=()=>{const Ke=Ok(r);a(Ke)};De();const Xe=setInterval(De,6e4);return()=>clearInterval(Xe)},[r]);const[o,l]=Be.useState(""),[u,h]=Be.useState([]),[d,p]=Be.useState(Fk()),[v,_]=Be.useState("gray"),[w,S]=Be.useState(""),[E,A]=Be.useState(""),[L,U]=Be.useState(!1),[N,Q]=Be.useState(!1),[re,ee]=Be.useState(null),[k,I]=Be.useState(!1),[R,O]=Be.useState(!1),[F,D]=Be.useState(!1),[V,Te]=Be.useState(!1),[oe,Y]=Be.useState("number"),[ne,ve]=Be.useState([]),[ie,Ce]=Be.useState(""),[K,M]=Be.useState([]),q=Be.useRef(null),[G,J]=Be.useState(""),[le,ye]=Be.useState(""),[be,Ee]=Be.useState("green"),[Ie,nt]=Be.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[te,Ft]=Be.useState({}),[ht,It]=Be.useState({});Be.useEffect(()=>{if(!t)return;const De=Ln(Sa,"artifacts",ba,"public","data","user_templates",t),Xe=vl(De,Ke=>{Ke.exists()?M(Ke.data().list||[]):M([])});return()=>Xe()},[t]),Be.useEffect(()=>{if(!t)return;const De=Ln(Sa,"artifacts",ba,"public","data","daily_inventory",`${t}_${d}`),Xe=vl(De,Ke=>{if(Ke.exists()){const Ze=Ke.data();h(Ze.items||[]),_(Ze.theme||"gray"),S(Ze.templateName||""),A(Ze.templateLabel||"")}else h([]),_("gray"),S(""),A("")});return()=>Xe()},[t,d]),Be.useEffect(()=>{if(!t)return;const De=Ln(Sa,"artifacts",ba,"public","data","user_settings",t),Xe=vl(De,Ke=>{if(Ke.exists()){const Ze=Ke.data();Ft(Ze.settings||{}),ve(Ze.items||[]),Ce(Ze.lastImportTime||"")}});return()=>Xe()},[t]),Be.useEffect(()=>{if(!t)return;const De=_b(Sa,"artifacts",ba,"public","data","daily_inventory"),Xe=vl(De,Ke=>{const Ze={};Ke.forEach(_r=>{if(_r.id.startsWith(`${t}_`)){const en=_r.id.replace(`${t}_`,""),ln=_r.data().items||[],ea=ln.some(Tr=>Tr.actual!==void 0&&Tr.actual!==0&&Tr.actual!=="0"),Gt=ln.some(Tr=>Tr.cukcuk!==void 0&&Tr.cukcuk!==0&&Tr.cukcuk!=="0"),Ir=ea&&Gt;Ze[en]={hasActual:ea,hasCukCuk:Gt,isDone:Ir}}}),It(Ze)});return()=>Xe()},[t]);const at=async(De,Xe,Ke,Ze)=>{if(!t)return;const _r=Ln(Sa,"artifacts",ba,"public","data","daily_inventory",`${t}_${d}`);await xl(_r,{items:De,theme:Xe||v,templateName:Ke||w,templateLabel:Ze||E,updatedAt:new Date().toISOString()})},je=async De=>{if(!t)return;const Xe=Ln(Sa,"artifacts",ba,"public","data","user_templates",t);await xl(Xe,{list:De})},$t=async(De,Xe)=>{const Ke={...te,[De]:Xe},Ze=Ln(Sa,"artifacts",ba,"public","data","user_settings",t);await xl(Ze,{settings:Ke,items:ne,lastImportTime:ie},{merge:!0})},Dt=De=>{const Xe=De.target.files[0];if(!Xe)return;const Ke=new FileReader;Ke.onload=async Ze=>{const _r=Ze.target.result,en=au(_r,{type:"binary"}),jr=en.SheetNames[0],ln=en.Sheets[jr],ea=Vi.sheet_to_json(ln,{header:1}),Gt=[],Ir={};let Tr=0;ea.forEach(qt=>{if(qt.length>=12){const Kn=String(qt[1]).trim(),da=qt[2],ma=qt[4],P=qt[11];if(Kn&&!isNaN(parseFloat(P))){const W=parseFloat(P);Ir[Kn]=W,Gt.push({code:Kn,name:da,unit:ma,cukcuk:W})}}});const tn=[...ne],Ns=new Set(ne.map(qt=>qt.code));Gt.forEach(qt=>{if(!Ns.has(qt.code))tn.push(qt),Ns.add(qt.code);else{const Kn=tn.findIndex(da=>da.code===qt.code);Kn!==-1&&(tn[Kn]={...tn[Kn],cukcuk:qt.cukcuk})}});const wi={...te};Gt.forEach(qt=>{wi[qt.code]||(wi[qt.code]={min:5,ignore:!1})});const cn=new Date,ei=`${cn.getHours()}:${String(cn.getMinutes()).padStart(2,"0")} ${cn.getDate()}/${cn.getMonth()+1}/${cn.getFullYear()}`,jo=Ln(Sa,"artifacts",ba,"public","data","user_settings",t);await xl(jo,{items:tn,settings:wi,lastImportTime:ei});const ti=u.map(qt=>Ir[qt.code]!==void 0?(Tr++,{...qt,cukcuk:Ir[qt.code]}):qt);at(ti),Gt.length>0?alert(` nhp d liu CukCuk thnh cng!
- Tng: ${Gt.length} m
-  khp: ${Tr} m`):alert("Khng tm thy d liu hp l.")},Ke.readAsBinaryString(Xe),De.target.value=""},Ut=De=>{const Xe=De.data.map(Ke=>({...Ke,actual:0,cukcuk:"",note:""}));at(Xe,De.color,De.name,De.label||"KIM K"),U(!1)},Ur=()=>{if(G){const De={id:Date.now(),name:G,label:le||"KIM K KHC",desc:"Mi",color:be,iconColor:dl[be].text,borderColor:dl[be].border,bgColor:dl[be].bg,data:[]};je([...K,De]),J(""),ye("")}},Za=()=>{if(u.length===0)return alert("Cha c d liu!");const De=Vi.json_to_sheet(u.map(Ke=>({STT:Ke.order,M:Ke.code,Tn:Ke.name,VT:Ke.unit,"Thc T":Ke.actual,CukCuk:Ke.cukcuk,Lch:(parseFloat(Ke.actual)||0)-(parseFloat(Ke.cukcuk)||0),"Ghi Ch":Ke.note}))),Xe=Vi.book_new();Vi.book_append_sheet(Xe,De,"KiemKe"),Nk(Xe,`KiemKe_${d}.xlsx`)},Xn=De=>{if(oe==="number"){const Xe=[...u],Ke=u.filter(Ze=>Ze.name.toLowerCase().includes(o.toLowerCase())||Ze.code.toLowerCase().includes(o.toLowerCase()));De.forEach((Ze,_r)=>{if(_r<Ke.length){const en=u.indexOf(Ke[_r]);en!==-1&&(Xe[en].actual=Ze)}}),at(Xe)}else{const Xe=De.map(Ke=>({...Ke,actual:0,cukcuk:"",note:""}));at(Xe)}},Lt=(De,Xe,Ke)=>{const Ze=[...u];Ze[De][Xe]=Ke,h(Ze)},Jr=(De,Xe,Ke)=>{let Ze=Ke;(Ke===""||Ke===null)&&(Ze=0);const _r=[...u];_r[De][Xe]=Ze,at(_r)},gn=(De,Xe,Ke)=>{nt({isOpen:!0,title:De,message:Xe,onConfirm:Ke})},Wn=u.filter(De=>De.name.toLowerCase().includes(o.toLowerCase())||De.code.toLowerCase().includes(o.toLowerCase())),Pt=dl[v]||{border:"border-gray-700",text:"text-gray-400",bg:"bg-gray-800",glow:""},Nn=E||"CHA KHI TO",ut=new Date(d),ar=`${ut.getDate()}/${ut.getMonth()+1}`,Zr=ut.getDay()===0?"CN":`T${ut.getDay()+1}`;return y.jsxs("div",{className:"h-screen w-full bg-[#050505] text-gray-300 font-sans flex flex-col items-center justify-center overflow-hidden relative pt-20",children:[y.jsx("input",{type:"file",ref:q,className:"hidden",accept:".xlsx, .xls, .csv",onChange:Dt}),y.jsxs("div",{className:"w-full max-w-[1800px] h-[95vh] flex flex-col p-4 space-y-4 animate-[fade-in-up_0.5s_ease-out] relative z-10",children:[y.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-[#0a0a0a] border border-[#27272a] p-3 rounded-xl shadow-lg shrink-0 relative",children:[t==="admin"&&y.jsxs("div",{className:"absolute -top-3 -left-3 z-50",children:[" ",y.jsxs("button",{onClick:()=>Te(!0),className:"bg-red-900/50 hover:bg-red-700 text-red-500 hover:text-white p-2 rounded-full border border-red-900 shadow-xl transition-all hover:scale-110",title:"Admin",children:[" ",y.jsx(_4,{size:20})," "]})," "]}),y.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[y.jsxs("div",{className:"relative w-full md:w-96",children:[y.jsx(kg,{className:"absolute left-3 top-2.5 text-gray-500 w-5 h-5"}),y.jsx("input",{type:"text",className:"bg-[#18181b] border border-[#27272a] text-gray-200 text-sm rounded-lg w-full pl-10 p-2.5 outline-none focus:border-green-500",placeholder:"Tm tn hng...",value:o,onChange:De=>l(De.target.value)})]}),r&&y.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[#18181b] border border-[#27272a] rounded-lg text-xs font-medium text-gray-400 hidden md:flex",children:[y.jsx(q8,{size:14,className:n.color}),y.jsxs("span",{children:["Cn li: ",y.jsx("span",{className:"text-white font-mono",children:n.text})]})]})]}),y.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto overflow-x-auto",children:[y.jsxs("button",{onClick:()=>D(!0),className:"bg-[#854d0e] hover:bg-[#a16207] text-yellow-100 border border-yellow-900/50 rounded-lg p-2.5 flex items-center gap-2",title:"Bo co",children:[y.jsx(f4,{className:"w-4 h-4"})," Bo Co"]}),y.jsx("button",{onClick:Za,className:"bg-[#1f2937] hover:bg-[#374151] text-gray-200 border border-gray-700 rounded-lg p-2.5",title:"Xut Excel",children:y.jsx(bg,{className:"w-4 h-4"})}),u.length>0&&y.jsx("button",{onClick:()=>gn("Xa Ht","Xa ht d liu ngy ny?",async()=>{const De=Ln(Sa,"artifacts",ba,"public","data","daily_inventory",`${t}_${d}`);await Nb(De),nt({...Ie,isOpen:!1})}),className:"bg-red-900/20 hover:bg-red-900/40 text-red-500 border border-red-900/50 rounded-lg p-2.5",children:y.jsx(Il,{className:"w-4 h-4"})}),y.jsxs("button",{onClick:()=>{Q(!1),U(!0)},className:"bg-[#f97316] hover:bg-[#ea580c] text-white font-medium rounded-lg text-sm px-5 py-2.5 flex items-center gap-2",children:[y.jsx(SO,{className:"w-4 h-4"})," THM MU"]}),y.jsxs("button",{onClick:()=>q.current.click(),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm px-5 py-2.5 flex items-center gap-2 shadow-lg shadow-blue-900/20",children:[y.jsx(sO,{className:"w-4 h-4"})," Nhp CukCuk"]})]})]}),y.jsxs("div",{className:`bg-[#0a0a0a] border ${Pt.border} rounded-xl shadow-2xl overflow-hidden flex flex-col flex-1 transition-colors duration-500 ${Pt.glow}`,children:[y.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[#27272a] bg-[#0f0f10] shrink-0",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("span",{className:`text-xs font-bold px-3 py-1.5 rounded border tracking-wider uppercase ${Pt.bg} ${Pt.text} ${Pt.border}`,children:Nn}),y.jsxs("button",{onClick:()=>O(!0),className:`flex items-center gap-2 border rounded-lg px-4 py-1.5 transition-all group ${v==="gray"?"border-[#27272a] bg-[#18181b] text-white":`${Pt.border} ${Pt.bg} ${Pt.text}`}`,children:[y.jsx(Cx,{size:16}),y.jsx("span",{className:"text-sm font-bold",children:ar}),y.jsxs("span",{className:"text-xs opacity-80",children:["(",Zr,")"]}),y.jsx(Nx,{size:14})]})]}),u.length>0&&y.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[Wn.length," MT HNG"]})]}),y.jsxs("div",{className:"sticky-header grid grid-cols-[60px_120px_1fr_100px_150px_120px_150px_100px_200px] gap-4 px-8 py-4 bg-[#121214] border-b border-[#27272a] text-[12px] font-bold text-gray-500 uppercase shrink-0 tracking-wide",children:[y.jsx("div",{className:"text-center",children:"#"})," ",y.jsx("div",{className:"text-left pl-2",children:"M Hng"})," ",y.jsx("div",{className:"text-left",children:"Tn Hng Ha"})," ",y.jsx("div",{className:"text-center",children:"VT"})," ",y.jsxs("div",{className:"text-right text-yellow-600/80 flex justify-end gap-2 items-center cursor-pointer hover:text-yellow-500",onClick:()=>{Y("number"),I(!0)},children:["THC T ",y.jsx(Ag,{size:14})]})," ",y.jsx("div",{className:"text-right pr-2",children:"Tng"})," ",y.jsxs("div",{className:"text-right text-blue-500/80 flex justify-end gap-2 items-center cursor-pointer hover:text-blue-400",children:["CUKCUK ",y.jsx(x4,{size:14})]})," ",y.jsx("div",{className:"text-right pr-2",children:"Lch"})," ",y.jsx("div",{className:"pl-2",children:"Ghi Ch"})]}),y.jsx("div",{className:"flex-1 bg-[#050505]/50 relative overflow-y-auto custom-scrollbar",children:u.length===0?y.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-12 text-center text-gray-600",children:[y.jsx(g4,{className:"w-10 h-10 mb-4 opacity-50"}),y.jsx("p",{children:"Cha c d liu. Vui lng chn THM MU."})]}):y.jsx("div",{className:"",children:Wn.map((De,Xe)=>{const Ke=(parseFloat(De.actual)||0)-(parseFloat(De.cukcuk)||0);let Ze="text-gray-600",_r="bg-transparent";Ke>0?(Ze="text-green-500",_r="bg-green-900/20"):Ke<0&&(Ze="text-red-500",_r="bg-red-900/20");const en=Ke!==0?(Ke>0?"+":"")+parseFloat(Ke.toFixed(2)):"-";return y.jsxs("div",{className:"grid grid-cols-[60px_120px_1fr_100px_150px_120px_150px_100px_200px] gap-4 px-8 py-3 border-b border-[#27272a] text-sm items-center hover:bg-[#121214] transition-colors",children:[y.jsx("div",{className:"text-center text-gray-600 font-mono text-xs",children:De.order}),y.jsx("div",{className:"text-left pl-2 text-green-500/80 font-mono text-xs",children:De.code}),y.jsx("div",{className:"text-left text-gray-300 font-medium truncate pr-4",title:De.name,children:De.name}),y.jsx("div",{className:"flex justify-center",children:y.jsx("span",{className:"text-xs text-gray-500 bg-[#18181b] px-2 py-1 rounded border border-[#27272a] min-w-[50px] text-center",children:De.unit})}),y.jsx("div",{className:"text-right",children:y.jsx("input",{type:"number",className:"w-full bg-[#18181b] border border-[#27272a] text-yellow-500 text-right text-sm rounded px-3 py-1.5 outline-none focus:border-yellow-500 transition-colors",value:De.actual,onChange:jr=>Lt(Xe,"actual",jr.target.value),onBlur:jr=>Jr(Xe,"actual",jr.target.value),onFocus:jr=>jr.target.select(),placeholder:"0"})}),y.jsx("div",{className:"text-right pr-2 text-gray-500 font-mono",children:De.actual||"0"}),y.jsx("div",{className:"text-right",children:y.jsx("input",{type:"number",className:"w-full bg-[#18181b] border border-[#27272a] text-blue-400 text-right text-sm rounded px-3 py-1.5 outline-none focus:border-blue-500 transition-colors",value:De.cukcuk,onChange:jr=>Lt(Xe,"cukcuk",jr.target.value)})}),y.jsx("div",{className:`text-right pr-2 font-mono font-bold ${Ze} ${_r} rounded px-2 py-1`,children:en}),y.jsx("div",{className:"pl-2",children:y.jsx("input",{type:"text",className:"w-full bg-transparent border-b border-transparent text-gray-400 text-xs py-1 outline-none focus:border-gray-500 transition-colors placeholder-gray-700",placeholder:"...",value:De.note,onChange:jr=>Lt(Xe,"note",jr.target.value)})})]},Xe)})})})]}),y.jsxs("div",{className:"fixed bottom-6 right-6 flex flex-col gap-3 z-50",children:[y.jsx("a",{href:"https://zalo.me/0342627280",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform",children:y.jsx(vO,{size:20,className:"text-white"})}),y.jsx("a",{href:"https://www.facebook.com/khanhnguyen3102004?locale=vi_VN",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-blue-700 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform",children:y.jsx(nO,{size:20,className:"text-white"})})]})]}),re&&y.jsx(eG,{template:re,onClose:()=>ee(null),onSave:De=>je(K.map(Xe=>Xe.id===De.id?De:Xe))}),k&&y.jsx(Mk,{currentData:Wn,onClose:()=>I(!1),onPaste:Xn,mode:oe}),R&&y.jsx(ZH,{selectedDate:d,onChange:p,onClose:()=>O(!1),calendarMap:ht}),F&&y.jsx(JH,{onClose:()=>D(!1),data:u,globalSettings:te,onUpdateSetting:$t,globalItems:ne,lastImportTime:ie}),V&&y.jsx(QH,{onClose:()=>Te(!1)}),y.jsx(YH,{isOpen:Ie.isOpen,title:Ie.title,message:Ie.message,onConfirm:()=>{Ie.onConfirm(),nt({...Ie,isOpen:!1})},onCancel:()=>nt({...Ie,isOpen:!1})}),L&&y.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[y.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>U(!1)}),y.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-modal-pop flex flex-col",children:[y.jsxs("div",{className:"p-6 pb-2 text-center relative",children:[N&&y.jsx("button",{onClick:()=>Q(!1),className:"absolute top-5 left-5 p-2 rounded-full text-gray-500 hover:text-white",children:y.jsx(d4,{className:"w-5 h-5"})}),y.jsx("button",{onClick:()=>{Q(!0),U(!0)},className:"absolute top-5 right-5 p-2 rounded-full text-gray-500 hover:text-white hover:bg-[#27272a]",title:"Qun l",children:y.jsx(Rx,{className:"w-5 h-5"})}),y.jsx("h2",{className:"text-xl font-bold text-white",children:N?"QUN L MU":"CHN MU TN"})]}),y.jsx("div",{className:"p-6 pt-4 space-y-3",children:N?y.jsxs("div",{className:"space-y-4",children:[K.map(De=>y.jsxs("div",{className:"flex justify-between items-center p-3 bg-[#121212] border border-[#27272a] rounded-lg",children:[y.jsx("span",{className:"text-sm text-gray-300",children:De.name}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>ee(De),className:"text-gray-400 hover:text-white p-1",children:y.jsx(Ag,{size:16})}),y.jsx("button",{onClick:()=>gn("Xa Mu","Xa mu ny?",()=>je(K.filter(Xe=>Xe.id!==De.id))),className:"text-red-500 hover:text-red-400 p-1",children:y.jsx(Il,{size:16})})]})]},De.id)),y.jsxs("div",{className:"pt-2 border-t border-[#27272a]",children:[y.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Chn mu:"}),y.jsx("div",{className:"flex gap-2 mb-4 justify-center",children:Object.keys(dl).map(De=>y.jsx("button",{onClick:()=>Ee(De),className:`w-6 h-6 rounded-full ${dl[De].solid} transition-all ${be===De?"ring-2 ring-white scale-125":"opacity-50 hover:opacity-100"}`},De))}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("input",{type:"text",placeholder:"Tn mu...",className:"w-full bg-[#18181b] border border-[#27272a] text-white text-sm rounded-lg p-2.5 outline-none focus:border-gray-500",value:G,onChange:De=>J(De.target.value)}),y.jsx("input",{type:"text",placeholder:"Tiu ...",className:"w-full bg-[#18181b] border border-[#27272a] text-white text-sm rounded-lg p-2.5 outline-none focus:border-gray-500",value:le,onChange:De=>ye(De.target.value)})]}),y.jsx("button",{onClick:Ur,className:`w-full text-white py-2.5 mt-3 rounded-lg text-sm font-bold shadow-lg transition-all ${dl[be].solid} hover:opacity-90`,children:"Thm"})]})]}):K.length>0?K.map(De=>y.jsxs("button",{className:`w-full flex items-center gap-4 p-4 rounded-xl border border-[#27272a] bg-[#121212] hover:scale-[1.02] text-left ${De.borderColor} ${De.bgColor}`,onClick:()=>Ut(De),children:[y.jsx("div",{className:`p-3 rounded-lg bg-[#18181b] ${De.iconColor}`,children:y.jsx(lO,{className:"w-6 h-6"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-gray-200",children:De.name}),y.jsx("p",{className:"text-xs text-gray-500",children:De.desc})]})]},De.id)):y.jsx("div",{className:"text-center text-gray-500 italic py-4",children:"Cha c mu no."})})]})]})]})},rG={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},nG=n0(rG),FE=cm(nG),ME="kho-suon-muoi-official-system-v1",aG=({username:t})=>{const[e,r]=Be.useState([]),[n,a]=Be.useState(""),[o,l]=Be.useState(""),[u,h]=Be.useState(!1),[d,p]=Be.useState(!1),[v,_]=Be.useState("processing"),w=Be.useRef(e);Be.useEffect(()=>{w.current=e},[e]),Be.useEffect(()=>{if(!t)return;const oe=Ln(FE,"artifacts",ME,"public","data","incoming_goods",`${t}_GLOBAL_LIST`),Y=vl(oe,ne=>{if(ne.exists()){const ve=ne.data().items||[];JSON.stringify(ve)!==JSON.stringify(w.current)&&(w.current=ve,r(ve))}else w.current=[],r([])});return()=>Y()},[t]);const S=async oe=>{w.current=oe;const Y=Ln(FE,"artifacts",ME,"public","data","incoming_goods",`${t}_GLOBAL_LIST`);try{await xl(Y,{items:oe,updatedAt:new Date().toISOString()},{merge:!0}),console.log(" lu thnh cng vo danh sch tng!")}catch(ne){console.error("Li lu:",ne)}},E=()=>{const oe=new Date;return`${oe.getDate()}/${oe.getMonth()+1} ${String(oe.getHours()).padStart(2,"0")}:${String(oe.getMinutes()).padStart(2,"0")}`},A=(oe,Y,ne)=>{const ie=w.current.map(Ce=>Ce.id===oe?{...Ce,[Y]:ne}:Ce);w.current=ie,r(ie)},L=()=>{S(w.current)},U=(oe,Y)=>{const ne=E(),ie=w.current.map(Ce=>{if(Ce.id===oe){const K=!Ce[Y],M=Y.split("_")[1];let q={...Ce,[Y]:K,[`ts_${M}`]:K?ne:"",updatedAt:new Date().toISOString()};return Y==="st_count"&&(K?(Ce.received||(q.received=Ce.ordered),q.st_arrived=!0,q.ts_arrived=Ce.ts_arrived||ne):q.received=""),q}return Ce});r(ie),S(ie)},N=(oe,Y,ne)=>{const ve=E(),ie=w.current,K=ie.filter(G=>G.vendor===oe&&G.orderDate===Y).every(G=>G[ne]),M=ne.split("_")[1],q=ie.map(G=>{if(G.vendor===oe&&G.orderDate===Y){const J=!K;let le={...G,[ne]:J,[`ts_${M}`]:J?ve:"",updatedAt:new Date().toISOString()};return ne==="st_count"&&(J?(le.received=G.ordered,le.st_arrived=!0,le.ts_arrived=G.ts_arrived||ve):le.received=""),le}return G});r(q),S(q)},Q=(oe,Y,ne)=>{if(oe.key==="Enter"){const ve=E(),Ce=w.current.map(M=>M.id===Y&&M.received!==""?{...M,st_arrived:!0,ts_arrived:M.ts_arrived||ve,st_count:!0,ts_count:M.ts_count||ve,updatedAt:new Date().toISOString()}:M);r(Ce),S(Ce);const K=document.querySelectorAll(".received-input");K[ne+1]&&K[ne+1].focus()}},re=oe=>{if(confirm("Xa dng ny?")){const ne=w.current.filter(ve=>ve.id!==oe);r(ne),S(ne)}},ee=oe=>{if(confirm("Xa ton b ha n ny?")){const ne=w.current.filter(ve=>R(ve)!==oe);r(ne),S(ne)}},k=async oe=>{if(!oe||oe.length===0)return;let Y=[];for(let ve of oe){const ie=await ve.arrayBuffer(),Ce=au(ie,{type:"array"});Ce.SheetNames.forEach(K=>{const M=Ce.Sheets[K],q=Vi.sheet_to_json(M,{header:1});let G="Cha r NCC",J="Khng r ngy",le=!1;q.forEach(ye=>{const be=String(ye.join(","));if(be.includes("Tn nh cung cp:")&&(G=be.split("Tn nh cung cp:")[1].split(",")[0].trim()),be.includes("Ngy:")){const Ee=be.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);Ee&&(J=`${Ee[1]}/${Ee[2]}/${Ee[3]}`)}if(be.includes("STT,M NVL,Nguyn vt liu")){le=!0;return}be.includes("Cng tin hng")&&(le=!1),le&&ye[0]&&!isNaN(parseFloat(ye[0]))&&Y.push({id:Math.random().toString(36).substr(2,9),vendor:G,orderDate:J,name:String(ye[2]||"").trim(),unit:String(ye[3]||"").trim(),ordered:parseFloat(ye[4])||0,received:"",st_arrived:!1,ts_arrived:"",st_count:!1,ts_count:"",st_group:!1,ts_group:"",st_cukcuk:!1,ts_cukcuk:"",note:"",updatedAt:new Date().toISOString()})})})}let ne=[];if(w.current.length>0)if(window.confirm(`Thm ${Y.length} dng mi vo danh sch tng?

- OK: GP THM VO
- Cancel: HY B`))ne=[...w.current,...Y];else return;else ne=[...Y];r(ne),S(ne),alert(" thm vo danh sch tng!")},I=async oe=>{const Y=oe.target.files;if(!Y||Y.length===0)return;let ne=[];for(let q of Y){const G=await q.arrayBuffer(),J=au(G,{type:"array"});J.SheetNames.forEach(le=>{const ye=Vi.sheet_to_json(J.Sheets[le],{header:1});let be=!1;ye.forEach(Ee=>{const Ie=String(Ee.join(","));if(Ie.includes("STT,M NVL,Nguyn vt liu")){be=!0;return}Ie.includes("Cng tin hng")&&(be=!1),be&&Ee[0]&&!isNaN(parseFloat(Ee[0]))&&ne.push({name:String(Ee[2]||"").trim().toLowerCase(),qty:parseFloat(Ee[5])||0})})})}const ve=E();let ie=[],Ce=!1;const M=w.current.map(q=>{const G=ne.filter(J=>J.name===q.name.toLowerCase());if(G.length>0){Ce=!0;const J=G.reduce((be,Ee)=>be+Ee.qty,0),le=q.received===""?0:parseFloat(q.received);let ye={...q,st_cukcuk:!0,ts_cukcuk:q.ts_cukcuk||ve,updatedAt:new Date().toISOString()};return le!==J&&(ie.push(`- ${q.name}: Nhp (${le})  File (${J})`),ye.note=`[Lch CukCuk: Nhp ${le} - File ${J}]`),ye}return q});if(ie.length>0){if(!window.confirm(`PHT HIN LCH ${ie.length} MN:
${ie.join(`
`)}

Bn c mun lu thng tin lch vo Ghi ch v TCH CUKCUK khng?`))return}else if(!Ce){alert("Khng tm thy mt hng no khp!");return}r(M),S(M),alert(" i sot xong!"),oe.target.value=null},R=oe=>`${oe.vendor}_${oe.orderDate}`,O=e.reduce((oe,Y)=>{const ne=R(Y);return oe[ne]||(oe[ne]={vendor:Y.vendor,date:Y.orderDate,items:[]}),oe[ne].items.push(Y),oe},{}),F=Object.keys(O).filter(oe=>{const Y=O[oe],ne=Y.items.length>0&&Y.items.every(Ce=>Ce.st_arrived&&Ce.st_cukcuk),ve=v==="completed"?ne:!ne,ie=Y.vendor.toLowerCase().includes(n.toLowerCase())||Y.items.some(Ce=>Ce.name.toLowerCase().includes(n.toLowerCase()));return ve&&ie}).sort((oe,Y)=>{const ne=O[oe].date.split("/").reverse().join("");return O[Y].date.split("/").reverse().join("").localeCompare(ne)}),D=e.filter(oe=>!oe.st_arrived),V=D.filter(oe=>oe.name.toLowerCase().includes(o.toLowerCase())||oe.vendor.toLowerCase().includes(o.toLowerCase())),Te=async()=>{confirm(`CNH BO: Bn c chc chn mun xa SCH ton b d liu trong danh sch tng khng?
Hnh ng ny khng th hon tc!`)&&(r([]),await S([]),alert(" xa sch d liu."))};return y.jsxs("div",{className:"w-full h-full p-6 pt-24 bg-[#050505] text-white flex flex-col items-center",children:[y.jsx("style",{children:"input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.custom-scrollbar::-webkit-scrollbar{width:6px}.custom-scrollbar::-webkit-scrollbar-thumb{background:#333;border-radius:10px}"}),y.jsxs("div",{className:"w-full max-w-[1550px] flex flex-col gap-6 font-sans",children:[y.jsxs("div",{onDragOver:oe=>{oe.preventDefault(),h(!0)},onDragLeave:()=>h(!1),onDrop:oe=>{oe.preventDefault(),h(!1),k(oe.dataTransfer.files)},className:`relative border-2 border-dashed rounded-[32px] p-8 flex justify-between items-center transition-all ${u?"border-orange-500 bg-orange-500/10 scale-[1.01]":"border-[#27272a] bg-[#0a0a0a]"}`,children:[y.jsxs("div",{className:"flex items-center gap-6 pointer-events-none",children:[y.jsx(W8,{size:48,className:"text-orange-600"}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-black uppercase italic tracking-tighter",children:"DANH SCH TNG HP"}),y.jsx("p",{className:"text-gray-500 text-sm",children:"Ko th file vo y  gp thm vo danh sch chung."})]})]}),y.jsxs("div",{className:"flex gap-4 items-center z-10",children:[y.jsxs("label",{className:"bg-[#1a1a1a] text-orange-500 border border-orange-500/30 px-6 py-3 rounded-2xl font-black cursor-pointer hover:bg-orange-500 hover:text-white transition-all uppercase text-xs flex items-center gap-2",children:[y.jsx(v4,{size:16})," Check nhp hng CukCuk",y.jsx("input",{type:"file",multiple:!0,className:"hidden",accept:".xlsx, .xls, .csv",onChange:I})]}),y.jsxs("label",{className:"bg-orange-600 text-white px-8 py-3 rounded-2xl font-black cursor-pointer hover:bg-orange-500 transition-all uppercase text-xs",children:["Nhp ha n t hng",y.jsx("input",{type:"file",multiple:!0,className:"hidden",accept:".xlsx, .xls, .csv",onChange:oe=>k(oe.target.files)})]})]})]}),y.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-[#0a0a0a] border border-[#27272a] p-4 rounded-[28px]",children:[y.jsxs("div",{className:"flex bg-[#111] p-1.5 rounded-2xl border border-white/5",children:[y.jsxs("button",{onClick:()=>_("processing"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase flex items-center gap-2 ${v==="processing"?"bg-orange-600 shadow-lg":"text-gray-500"}`,children:[y.jsx(TT,{size:16})," ang kim"]}),y.jsxs("button",{onClick:()=>_("completed"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase flex items-center gap-2 ${v==="completed"?"bg-green-600 shadow-lg":"text-gray-500"}`,children:[y.jsx(pO,{size:16})," Hon thnh"]})]}),y.jsxs("div",{className:"relative flex-1 w-full",children:[y.jsx(kg,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 w-4 h-4"}),y.jsx("input",{type:"text",placeholder:"Tm NVL hoc NCC (trn ton b danh sch)...",className:"w-full bg-[#050505] border border-white/5 rounded-2xl pl-12 py-3 outline-none text-sm",value:n,onChange:oe=>a(oe.target.value)})]}),y.jsx("button",{onClick:Te,className:"px-4 py-3 rounded-2xl text-xs font-black uppercase flex items-center gap-2 border border-red-900/30 text-red-700 hover:bg-red-900/20 hover:text-red-500",title:"Xa sch d liu",children:y.jsx(b8,{size:16})}),y.jsxs("button",{onClick:()=>p(!d),className:`px-6 py-3 rounded-2xl text-xs font-black uppercase flex items-center gap-2 border ${d?"bg-red-600 border-red-600":"border-[#27272a] text-gray-500"}`,children:[y.jsx(I8,{size:16})," Bo co"]})]}),d&&y.jsxs("div",{className:"bg-[#1a1010] border border-red-900/30 rounded-[32px] p-6 shadow-2xl animate-in slide-in-from-top-4",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsxs("h3",{className:"text-red-500 font-black uppercase flex items-center gap-2",children:[y.jsx(p4,{size:20})," CHA V KHO (",D.length,")"]}),y.jsxs("div",{className:"relative w-64",children:[y.jsx(kg,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-red-900 w-3 h-3"}),y.jsx("input",{type:"text",placeholder:"Lc hng...",className:"w-full bg-black/40 border border-red-900/20 rounded-xl pl-9 py-2 outline-none text-xs",value:o,onChange:oe=>l(oe.target.value)})]})]}),y.jsxs("div",{className:"grid grid-cols-4 bg-black/40 p-3 rounded-t-xl text-[9px] font-bold text-gray-500 uppercase tracking-widest border-b border-red-900/20 text-center",children:[y.jsx("div",{children:"Ngy t"}),y.jsx("div",{children:"Tn Mt Hng"}),y.jsx("div",{children:"S Lng"}),y.jsx("div",{children:"NCC"})]}),y.jsx("div",{className:"max-h-64 overflow-y-auto custom-scrollbar",children:V.map((oe,Y)=>y.jsxs("div",{className:"grid grid-cols-4 p-3 border-b border-red-900/10 text-sm hover:bg-white/5 text-center",children:[y.jsx("div",{className:"text-gray-500 font-mono text-[10px] text-left",children:oe.orderDate}),y.jsx("div",{className:"font-bold text-gray-200 text-left line-clamp-1",children:oe.name}),y.jsxs("div",{className:"text-red-400 font-black",children:[oe.ordered," ",oe.unit]}),y.jsx("div",{className:"text-right text-orange-500/70 text-[10px] font-bold truncate",children:oe.vendor})]},Y))})]}),y.jsx("div",{className:"flex flex-col gap-10 mb-20",children:F.map(oe=>{const Y=O[oe];return y.jsxs("div",{className:`bg-[#0a0a0a] border border-[#27272a] rounded-[32px] overflow-hidden shadow-2xl ${v==="completed"?"opacity-70 border-green-900/30":""}`,children:[y.jsxs("div",{className:"bg-[#121212] px-8 py-5 border-b border-[#27272a] flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsx("div",{className:`w-2 h-10 rounded-full ${v==="completed"?"bg-green-600":"bg-orange-600"}`}),y.jsxs("div",{children:[y.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter leading-none",children:Y.vendor}),y.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase font-mono mt-1 flex items-center gap-1.5",children:[y.jsx(Cx,{size:10,className:"text-orange-600"})," Ngy t: ",Y.date]})]})]}),y.jsx("button",{onClick:()=>ee(oe),className:"text-red-500 text-xs font-bold border border-red-900/20 px-4 py-2 rounded-xl transition-all hover:bg-red-600 hover:text-white",children:"Xa H"})]}),y.jsxs("div",{className:"grid grid-cols-[300px_2.5fr_80px_100px_160px_1.5fr_50px] bg-[#080808] text-[9px] font-black text-gray-600 uppercase py-4 px-8 border-b border-[#27272a] text-center",children:[y.jsxs("div",{className:"flex justify-between px-2 pr-6 border-r border-[#27272a]/50",children:[y.jsx(rd,{label:"V",color:"text-green-500",onClick:()=>N(Y.vendor,Y.date,"st_arrived")}),y.jsx(rd,{label:"SL",color:"text-yellow-500",onClick:()=>N(Y.vendor,Y.date,"st_count")}),y.jsx(rd,{label:"Nhm",color:"text-blue-500",onClick:()=>N(Y.vendor,Y.date,"st_group")}),y.jsx(rd,{label:"CukCuk",color:"text-purple-500",onClick:()=>N(Y.vendor,Y.date,"st_cukcuk")})]}),y.jsx("div",{className:"pl-6 text-left flex items-center",children:"Nguyn Vt Liu"}),y.jsx("div",{children:"VT"}),y.jsx("div",{className:"text-right pr-6",children:"SL t"}),y.jsx("div",{className:"text-orange-500 font-bold",children:"Thc Nhn"}),y.jsx("div",{className:"pl-12 text-left",children:"Ghi Ch"}),y.jsx("div",{children:"Xa"})]}),y.jsx("div",{className:"flex flex-col",children:Y.items.map(ne=>{const ve=(parseFloat(ne.received)||0)-(parseFloat(ne.ordered)||0);return y.jsxs("div",{className:"grid grid-cols-[300px_2.5fr_80px_100px_160px_1.5fr_50px] items-center py-4 px-8 border-b border-[#27272a]/40 hover:bg-white/[0.01]",children:[y.jsxs("div",{className:"flex justify-between px-2 pr-6 border-r border-[#27272a]/50 h-full items-center",children:[y.jsx(td,{checked:ne.st_arrived,time:ne.ts_arrived,color:"bg-green-500",onClick:()=>U(ne.id,"st_arrived"),icon:y.jsx(TT,{size:14})}),y.jsx(td,{checked:ne.st_count,time:ne.ts_count,color:"bg-yellow-500",onClick:()=>U(ne.id,"st_count"),icon:y.jsx(h4,{size:14})}),y.jsx(td,{checked:ne.st_group,time:ne.ts_group,color:"bg-blue-500",onClick:()=>U(ne.id,"st_group"),icon:y.jsx(OO,{size:14})}),y.jsx(td,{checked:ne.st_cukcuk,time:ne.ts_cukcuk,color:"bg-purple-500",onClick:()=>U(ne.id,"st_cukcuk"),icon:y.jsx(dO,{size:14})})]}),y.jsx("div",{className:"pl-6 font-bold text-sm text-gray-100 line-clamp-1 h-full flex items-center",children:ne.name}),y.jsx("div",{className:"text-center text-gray-500 text-[10px] font-bold uppercase flex items-center justify-center h-full",children:ne.unit}),y.jsx("div",{className:"text-right pr-6 text-blue-400 font-mono font-bold text-lg flex items-center justify-end h-full",children:ne.ordered}),y.jsxs("div",{className:"flex items-center justify-end gap-3 px-2 h-full",children:[y.jsx("input",{type:"number",value:ne.received,className:"received-input bg-[#111] border border-white/5 rounded-xl w-20 py-2 text-right text-orange-500 font-mono font-bold text-lg outline-none focus:border-orange-500",onChange:ie=>A(ne.id,"received",ie.target.value),onBlur:L,onKeyDown:ie=>Q(ie,ne.id,e.findIndex(Ce=>Ce.id===ne.id))}),y.jsx("div",{className:`w-14 text-center text-xs font-mono font-black ${ve<0?"text-red-500":ve>0?"text-green-500":"text-gray-800"}`,children:ne.received!==""&&(ve===0?"OK":ve>0?`+${ve}`:ve)})]}),y.jsx("input",{type:"text",value:ne.note||"",onChange:ie=>A(ne.id,"note",ie.target.value),onBlur:L,className:"bg-transparent border-b border-transparent outline-none text-gray-600 text-[10px] ml-12 italic h-full flex items-center",placeholder:"..."}),y.jsx("button",{onClick:()=>re(ne.id),className:"text-gray-800 hover:text-red-500 flex justify-center items-center h-full transition-colors",children:y.jsx(Il,{size:16})})]},ne.id)})})]},oe)})})]})]})},td=({checked:t,time:e,color:r,onClick:n,icon:a})=>y.jsxs("div",{className:"flex flex-col items-center gap-1.5 min-w-[50px] justify-center",children:[y.jsx("button",{onClick:n,className:`w-10 h-10 rounded-2xl border-2 flex items-center justify-center transition-all ${t?`${r} border-transparent text-black shadow-lg scale-105`:"border-[#222] text-gray-700 hover:border-gray-500"}`,children:a}),y.jsx("div",{className:"h-4 flex items-center justify-center text-[7px] font-mono text-gray-500 font-black uppercase",children:t&&e?e:""})]}),rd=({label:t,color:e,onClick:r})=>y.jsxs("div",{className:"flex flex-col items-center gap-1.5 cursor-pointer group min-w-[50px] justify-center",onClick:r,children:[y.jsx("span",{className:`${e} font-black`,children:t}),y.jsx("div",{className:"w-5 h-5 rounded-full border border-gray-700 group-hover:bg-orange-500 transition-all flex items-center justify-center",children:y.jsx(Nx,{size:12,className:"text-white"})})]}),iG={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},sG=n0(iG),LE=cm(sG),PE="kho-suon-muoi-official-system-v1",oG=()=>{const[t,e]=Be.useState("calculate"),[r,n]=Be.useState([]),[a,o]=Be.useState([]),[l,u]=Be.useState(null),[h,d]=Be.useState("loading"),p=Be.useRef(null),v=Be.useRef(!0),_=O=>[...O].sort((F,D)=>F.isPinned&&!D.isPinned?-1:!F.isPinned&&D.isPinned?1:0),w=[{id:1,name:"1. Sn Tng (Tng hp)",forecastRatio:1.1,randomMin:-2,randomMax:2,isPinned:!0,rules:[{id:"r1",codes:"23120301, 23120302, 23120303, 23120305, 23120311, 25032702, 25052702, 25052703",ratio:1,note:"Cc m sn"}]}];Be.useEffect(()=>{const O=Ln(LE,"artifacts",PE,"public","data","material_formulas","official_list"),F=vl(O,D=>{if(D.exists()){const V=D.data().list||[];o(_(V)),d("saved")}else o(w),d("saved");setTimeout(()=>{v.current=!1},1e3)},D=>{console.error(D),d("error")});return()=>F()},[]);const S=O=>{const F=_(O);o(F),!v.current&&(p.current&&clearTimeout(p.current),d("saving"),p.current=setTimeout(async()=>{try{const D=Ln(LE,"artifacts",PE,"public","data","material_formulas","official_list");await xl(D,{list:F,updatedAt:new Date().toISOString()}),d("saved")}catch{d("error")}},1500))},E=O=>{const F=a.map(D=>D.id===O?{...D,isPinned:!D.isPinned}:D);S(F)},A=()=>{S([...a,{id:Date.now(),name:"NVL Mi",forecastRatio:1.1,randomMin:-2,randomMax:2,isPinned:!1,rules:[{id:Date.now()+1,codes:"",ratio:1,note:""}]}])},L=O=>{confirm("Xa mn ny?")&&S(a.filter(F=>F.id!==O))},U=(O,F,D)=>S(a.map(V=>V.id===O?{...V,[F]:D}:V)),N=O=>S(a.map(F=>F.id===O?{...F,rules:[...F.rules,{id:Date.now(),codes:"",ratio:1,note:""}]}:F)),Q=(O,F)=>S(a.map(D=>D.id===O?{...D,rules:D.rules.filter(V=>V.id!==F)}:D)),re=(O,F,D,V)=>S(a.map(Te=>Te.id===O?{...Te,rules:Te.rules.map(oe=>oe.id===F?{...oe,[D]:V}:oe)}:Te)),ee=async O=>{const F=Array.from(O.target.files);if(F.length===0)return;n([]);const D=F.map(V=>new Promise(Te=>{const oe=new FileReader;oe.onload=Y=>{const ne=Y.target.result,ve=au(ne,{type:"binary"}),ie=ve.SheetNames[0],Ce=ve.Sheets[ie],K=Vi.sheet_to_json(Ce,{header:1});Te({fileName:V.name,data:K})},oe.readAsBinaryString(V)}));try{const V=await Promise.all(D);k(V)}catch(V){alert("Li: "+V.message)}},k=O=>{const F={};O.forEach(({fileName:Te,data:oe})=>{let Y="Khng xc nh";for(let ve=0;ve<15;ve++){const ie=oe[ve]?oe[ve][0]:"";if(typeof ie=="string"&&(ie.includes("T ngy")||ie.includes("Ngy"))){const Ce=ie.match(/(\d{1,2}\/\d{1,2}\/\d{4})/);Ce&&(Y=Ce[0]);break}}Y==="Khng xc nh"&&(Y=Te),F[Y]||(F[Y]={salesMap:{},date:Y});const ne=F[Y].salesMap;oe.forEach((ve,ie)=>{if(ie<8)return;const Ce=ve[1],K=ve[4];if(Ce&&(typeof K=="number"||typeof K=="string")){const M=String(Ce).trim();let q=0;if(typeof K=="number")q=K;else if(typeof K=="string"){let G=K.replace(/\s/g,"");G.includes(".")&&G.includes(",")?G=G.replace(/\./g,"").replace(",","."):G.includes(",")&&(G=G.replace(",",".")),q=parseFloat(G)}isNaN(q)||(ne[M]?ne[M]+=q:ne[M]=q)}})});const V=Object.keys(F).sort((Te,oe)=>{const Y=ne=>{const ve=ne.split("/");return ve.length===3?new Date(ve[2],ve[1]-1,ve[0]).getTime():0};return Y(Te)-Y(oe)}).map(Te=>{const{salesMap:oe}=F[Te],Y=a.map(ne=>{let ve=0;ne.rules.forEach(G=>{const J=G.codes.split(/[\n,;]+/).map(ye=>ye.trim()).filter(ye=>ye);let le=0;J.forEach(ye=>{le+=oe[ye]||0}),ve+=le*parseFloat(G.ratio||0)});const ie=parseFloat(ne.forecastRatio||1),Ce=parseInt(ne.randomMin||0),K=parseInt(ne.randomMax||0),M=Math.floor(Math.random()*(K-Ce+1))+Ce;let q=ve*ie+M;return q<0&&(q=0),{name:ne.name,actual:ve,forecast:q}});return{date:Te,items:Y}});n(V),e("calculate")},I=()=>{if(r.length===0)return;let O="";a.forEach((F,D)=>{r.forEach(V=>{const Te=V.items[D],oe=Te.forecast.toLocaleString("vi-VN",{useGrouping:!1,maximumFractionDigits:0}).replace(".",","),Y=Te.actual===0?"0":Te.actual.toLocaleString("vi-VN",{useGrouping:!1,maximumFractionDigits:1}).replace(".",",");O+=`${oe}	${Y}	`}),O+=`
`}),navigator.clipboard.writeText(O),alert(" COPY: [D Bo] [Thc T]...")},R=()=>{if(r.length===0)return;let O="";const F=r.length>1?"		":"	";a.forEach((D,V)=>{const Te=r.map(oe=>{const Y=oe.items[V].actual;return Y===0?"0":Y.toLocaleString("vi-VN",{useGrouping:!1,maximumFractionDigits:1}).replace(".",",")});O+=Te.join(F)+`
`}),navigator.clipboard.writeText(O),alert(" COPY: [Thc T] (Cch ct)")};return y.jsxs("div",{className:"p-6 max-w-[95%] mx-auto text-white animate-[fade-in-up_0.5s_ease-out]",children:[y.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 border-b border-zinc-800 pb-4",children:[y.jsxs("h1",{className:"text-2xl font-bold text-orange-500 flex items-center gap-2",children:[y.jsx($8,{})," TNH NH LNG (AUTO SORT)"]}),y.jsxs("div",{className:"flex items-center gap-4",children:[h==="loading"&&y.jsxs("span",{className:"text-gray-500 text-xs flex items-center gap-1",children:[y.jsx(yT,{className:"w-3 h-3 animate-spin"})," ang ti..."]}),h==="saving"&&y.jsxs("span",{className:"text-yellow-500 text-xs flex items-center gap-1",children:[y.jsx(yT,{className:"w-3 h-3 animate-spin"})," ang lu..."]}),h==="saved"&&y.jsxs("span",{className:"text-green-500 text-xs flex items-center gap-1",children:[y.jsx(U8,{className:"w-3 h-3"}),"  ng b"]}),h==="error"&&y.jsx("span",{className:"text-red-500 text-xs flex items-center gap-1",children:"Li mng!"}),y.jsxs("div",{className:"flex bg-zinc-900 p-1 rounded-lg border border-zinc-700",children:[y.jsx("button",{onClick:()=>e("calculate"),className:`px-4 py-1.5 rounded-md font-bold ${t==="calculate"?"bg-orange-600":"text-zinc-400"}`,children:"TNH TON"}),y.jsxs("button",{onClick:()=>e("settings"),className:`px-4 py-1.5 rounded-md font-bold flex gap-2 ${t==="settings"?"bg-blue-600":"text-zinc-400"}`,children:[y.jsx(Rx,{className:"w-4"})," CI T"]})]})]})]}),t==="calculate"&&y.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[y.jsxs("div",{className:"lg:w-1/4 space-y-4",children:[y.jsxs("div",{className:`bg-zinc-900 border-2 border-dashed ${r.length>0?"border-green-500 bg-green-900/10":"border-zinc-700"} rounded-xl p-6 text-center cursor-pointer relative h-32 flex flex-col items-center justify-center hover:border-orange-500`,children:[y.jsx("input",{type:"file",multiple:!0,accept:".xlsx, .xls, .csv",onChange:ee,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),y.jsx(v4,{className:`w-8 h-8 mb-2 ${r.length>0?"text-green-500":"text-zinc-500"}`}),y.jsx("span",{className:"text-sm font-bold text-zinc-300",children:r.length>0?` c ${r.length} ngy`:"Chn File Excel"})]}),r.length>0&&y.jsxs(y.Fragment,{children:[y.jsxs("button",{onClick:I,className:"w-full bg-blue-700 hover:bg-blue-600 text-white py-3 rounded-lg flex items-center justify-center gap-2 font-bold shadow-lg active:scale-95",children:[y.jsx(H8,{className:"w-4 h-4"})," COPY: D BO + THC T"]}),y.jsxs("button",{onClick:R,className:"w-full bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg flex items-center justify-center gap-2 font-bold shadow-lg active:scale-95 border border-zinc-500",children:[y.jsx(x4,{className:"w-4 h-4"})," COPY: CH THC T"]})]})]}),y.jsx("div",{className:"lg:w-3/4 bg-white text-black p-4 rounded-xl shadow-xl overflow-x-auto",children:r.length>0?y.jsxs("table",{className:"w-full border-collapse",style:{fontFamily:'"Times New Roman", Times, serif',fontSize:"16px"},children:[y.jsxs("thead",{children:[y.jsxs("tr",{className:"bg-gray-100 border-b-2 border-black",children:[y.jsx("th",{className:"p-2 text-left border-r border-gray-300 min-w-[200px] sticky left-0 bg-gray-100 z-10",children:"TN NVL"}),r.map((O,F)=>y.jsx("th",{className:"p-2 text-center border-r border-black min-w-[180px]",colSpan:2,children:y.jsx("div",{className:"text-blue-800 font-bold",children:O.date})},F))]}),y.jsxs("tr",{className:"bg-gray-50 border-b border-gray-300 text-xs uppercase",children:[y.jsx("th",{className:"p-1 border-r border-gray-300 sticky left-0 bg-gray-50"}),r.map((O,F)=>y.jsxs(Jp.Fragment,{children:[y.jsx("th",{className:"p-1 text-right text-blue-700 border-r border-gray-200 w-[90px]",children:"D Bo"}),y.jsx("th",{className:"p-1 text-right text-black border-r border-black w-[90px]",children:"Thc T"})]},F))]})]}),y.jsx("tbody",{children:a.map((O,F)=>y.jsxs("tr",{className:"border-b border-gray-200 hover:bg-yellow-50",children:[y.jsxs("td",{className:"p-2 font-bold border-r border-gray-300 sticky left-0 bg-white hover:bg-yellow-50 relative group",children:[O.isPinned&&y.jsx(wT,{className:"w-3 h-3 text-orange-500 absolute top-1 left-1",fill:"currentColor"}),y.jsx("span",{className:O.isPinned?"pl-2 text-orange-700":"",children:O.name}),y.jsxs("span",{className:"text-[10px] text-gray-400 block font-normal",children:["(Ran: ",O.randomMin," ~ ",O.randomMax,")"]})]}),r.map((D,V)=>{const Te=D.items[F];return y.jsxs(Jp.Fragment,{children:[y.jsx("td",{className:"p-2 text-right font-bold text-blue-700 bg-blue-50/30 border-r border-gray-200",children:Te.forecast.toLocaleString("vi-VN",{maximumFractionDigits:0})}),y.jsx("td",{className:"p-2 text-right font-bold text-black border-r border-black",children:Te.actual===0?"-":Te.actual.toLocaleString("vi-VN",{maximumFractionDigits:1})})]},V)})]},O.id))})]}):y.jsx("div",{className:"h-64 flex flex-col items-center justify-center text-gray-400 italic",children:y.jsx("div",{children:"Cha c d liu"})})})]}),t==="settings"&&y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-zinc-800",children:[y.jsx("h3",{className:"font-bold text-xl",children:"DANH SCH NVL (Cloud Synced)"}),y.jsxs("button",{onClick:A,className:"bg-orange-600 hover:bg-orange-500 px-4 py-2 rounded text-sm font-bold flex gap-2",children:[y.jsx(Od,{className:"w-4"})," Thm NVL"]})]}),y.jsx("div",{className:"space-y-3 pb-20",children:a.map((O,F)=>y.jsxs("div",{className:`bg-zinc-900 border rounded-xl overflow-hidden transition-all ${O.isPinned?"border-orange-500/50 shadow-orange-900/20 shadow-lg":"border-zinc-800"}`,children:[y.jsxs("div",{className:"p-3 flex justify-between items-center cursor-pointer bg-black/40 hover:bg-black/60 transition-colors",onClick:()=>u(l===O.id?null:O.id),children:[y.jsxs("div",{className:"flex gap-3 items-center flex-1",children:[y.jsx("button",{onClick:D=>{D.stopPropagation(),E(O.id)},className:`w-8 h-8 rounded-full flex items-center justify-center transition-all ${O.isPinned?"bg-orange-500 text-white shadow-lg scale-110":"bg-zinc-800 text-zinc-600 hover:text-zinc-300"}`,title:O.isPinned?"B ghim":"Ghim ln u",children:O.isPinned?y.jsx(wT,{className:"w-4 h-4",fill:"currentColor"}):y.jsx(yO,{className:"w-4 h-4"})}),l===O.id?y.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full pr-4",children:[y.jsx("input",{value:O.name,onChange:D=>U(O.id,"name",D.target.value),onClick:D=>D.stopPropagation(),className:"bg-transparent font-bold text-lg flex-1 outline-none border-b border-orange-500 text-orange-100",autoFocus:!0,placeholder:"Tn NVL"}),y.jsxs("div",{className:"flex gap-2",onClick:D=>D.stopPropagation(),children:[y.jsxs("div",{className:"flex items-center gap-1 bg-zinc-800 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[10px] text-zinc-400 uppercase",children:"Nhn:"}),y.jsx("input",{type:"number",step:"0.1",value:O.forecastRatio||1,onChange:D=>U(O.id,"forecastRatio",D.target.value),className:"w-12 bg-black text-white font-bold text-center border border-zinc-600 rounded outline-none text-sm"})]}),y.jsxs("div",{className:"flex items-center gap-1 bg-zinc-800 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[10px] text-zinc-400 uppercase",children:"Ran:"}),y.jsx("input",{type:"number",value:O.randomMin||-2,onChange:D=>U(O.id,"randomMin",D.target.value),className:"w-10 bg-black text-white text-center border border-zinc-600 rounded outline-none text-sm"}),y.jsx("span",{className:"text-zinc-500",children:"~"}),y.jsx("input",{type:"number",value:O.randomMax||2,onChange:D=>U(O.id,"randomMax",D.target.value),className:"w-10 bg-black text-white text-center border border-zinc-600 rounded outline-none text-sm"})]}),y.jsx("button",{onClick:()=>L(O.id),className:"bg-red-900/30 text-red-500 p-2 rounded hover:bg-red-900/50",children:y.jsx(Il,{className:"w-4 h-4"})})]})]}):y.jsxs("div",{className:"flex justify-between w-full pr-4 items-center",children:[y.jsx("div",{className:`font-bold text-base ${O.isPinned?"text-orange-400":"text-white"}`,children:O.name}),y.jsxs("div",{className:"text-xs text-zinc-400 bg-zinc-900 px-2 py-1 rounded flex gap-2",children:[y.jsxs("span",{children:["x",O.forecastRatio||1]}),y.jsxs("span",{className:"text-orange-400",children:["Random: ",O.randomMin||-2," ~ ",O.randomMax||2]})]})]})]}),l===O.id?y.jsx(Nx,{className:"text-orange-500"}):y.jsx(m4,{className:"text-zinc-500"})]}),l===O.id&&y.jsxs("div",{className:"p-3 bg-zinc-900/50 border-t border-zinc-800 space-y-2",children:[O.rules.map(D=>y.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center bg-black p-2 rounded border border-zinc-800",children:[y.jsx("div",{className:"col-span-3",children:y.jsx("input",{value:D.note,onChange:V=>re(O.id,D.id,"note",V.target.value),className:"w-full bg-transparent text-xs text-zinc-400 outline-none",placeholder:"Ghi ch"})}),y.jsx("div",{className:"col-span-5",children:y.jsx("input",{value:D.codes,onChange:V=>re(O.id,D.id,"codes",V.target.value),className:"w-full bg-zinc-900 border border-zinc-700 rounded px-2 py-1 text-xs text-orange-200 font-mono outline-none",placeholder:"M"})}),y.jsx("div",{className:"col-span-3",children:y.jsx("input",{type:"number",value:D.ratio,onChange:V=>re(O.id,D.id,"ratio",V.target.value),className:"w-full bg-zinc-900 border border-zinc-700 rounded px-2 py-1 text-xs text-yellow-400 font-bold text-center outline-none"})}),y.jsx("div",{className:"col-span-1 flex justify-end",children:y.jsx("button",{onClick:()=>Q(O.id,D.id),className:"text-zinc-600 hover:text-red-500",children:y.jsx(Il,{className:"w-4 h-4"})})})]},D.id)),y.jsx("div",{className:"flex justify-between pt-2",children:y.jsxs("button",{onClick:()=>N(O.id),className:"text-blue-400 text-xs flex gap-1",children:[y.jsx(Od,{className:"w-3"})," Thm m"]})})]})]},O.id))})]})]})};function lG(){const[t,e]=Be.useState("login"),[r,n]=Be.useState("inventory"),[a,o]=Be.useState(null),l=()=>{e("dashboard")},u=()=>{e("login"),o(null),n("inventory")};return y.jsxs("div",{className:"relative w-full min-h-screen bg-[#050505] text-white overflow-hidden font-sans",children:[t==="dashboard"&&y.jsxs("div",{className:"animate-[fade-in-up_0.8s_ease-out] w-full h-full",children:[r==="inventory"&&y.jsx(tG,{username:a,onLogout:u}),r==="incoming"&&y.jsx(aG,{username:a}),r==="forecast"&&y.jsx(oG,{})]}),y.jsx(KO,{onComplete:l,onLogout:u,onNavigate:n,currentView:r,isFinished:t==="dashboard",setUsername:o})]})}TC.createRoot(document.getElementById("root")).render(y.jsx(Jp.StrictMode,{children:y.jsx(lG,{})}));
