(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function RE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vp={exports:{}},of={};var Fy;function aC(){if(Fy)return of;Fy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:o}}return of.Fragment=e,of.jsx=r,of.jsxs=r,of}var My;function iC(){return My||(My=1,vp.exports=aC()),vp.exports}var E=iC(),_p={exports:{}},mt={};var Ly;function sC(){if(Ly)return mt;Ly=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function y(Q){return Q===null||typeof Q!="object"?null:(Q=_&&Q[_]||Q["@@iterator"],typeof Q=="function"?Q:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function F(Q,L,W){this.props=Q,this.context=L,this.refs=b,this.updater=W||S}F.prototype.isReactComponent={},F.prototype.setState=function(Q,L){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,L,"setState")},F.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function z(){}z.prototype=F.prototype;function N(Q,L,W){this.props=Q,this.context=L,this.refs=b,this.updater=W||S}var K=N.prototype=new z;K.constructor=N,w(K,F.prototype),K.isPureReactComponent=!0;var te=Array.isArray;function J(){}var k={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function R(Q,L,W){var G=W.ref;return{$$typeof:t,type:Q,key:L,ref:G!==void 0?G:null,props:W}}function M(Q,L){return R(Q.type,L,Q.props)}function O(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function D(Q){var L={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(W){return L[W]})}var V=/\/+/g;function _e(Q,L){return typeof Q=="object"&&Q!==null&&Q.key!=null?D(""+Q.key):L.toString(36)}function Te(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(J,J):(Q.status="pending",Q.then(function(L){Q.status==="pending"&&(Q.status="fulfilled",Q.value=L)},function(L){Q.status==="pending"&&(Q.status="rejected",Q.reason=L)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ne(Q,L,W,G,Z){var le=typeof Q;(le==="undefined"||le==="boolean")&&(Q=null);var Se=!1;if(Q===null)Se=!0;else switch(le){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(Q.$$typeof){case t:case e:Se=!0;break;case p:return Se=Q._init,ne(Se(Q._payload),L,W,G,Z)}}if(Se)return Z=Z(Q),Se=G===""?"."+_e(Q,0):G,te(Z)?(W="",Se!=null&&(W=Se.replace(V,"$&/")+"/"),ne(Z,L,W,"",function(Ie){return Ie})):Z!=null&&(O(Z)&&(Z=M(Z,W+(Z.key==null||Q&&Q.key===Z.key?"":(""+Z.key).replace(V,"$&/")+"/")+Se)),L.push(Z)),1;Se=0;var Ne=G===""?".":G+":";if(te(Q))for(var Ae=0;Ae<Q.length;Ae++)G=Q[Ae],le=Ne+_e(G,Ae),Se+=ne(G,L,W,le,Z);else if(Ae=y(Q),typeof Ae=="function")for(Q=Ae.call(Q),Ae=0;!(G=Q.next()).done;)G=G.value,le=Ne+_e(G,Ae++),Se+=ne(G,L,W,le,Z);else if(le==="object"){if(typeof Q.then=="function")return ne(Te(Q),L,W,G,Z);throw L=String(Q),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return Se}function oe(Q,L,W){if(Q==null)return Q;var G=[],Z=0;return ne(Q,G,"","",function(le){return L.call(W,le,Z++)}),G}function ke(Q){if(Q._status===-1){var L=Q._result;L=L(),L.then(function(W){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=W)},function(W){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=W)}),Q._status===-1&&(Q._status=0,Q._result=L)}if(Q._status===1)return Q._result.default;throw Q._result}var ae=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},Le={map:oe,forEach:function(Q,L,W){oe(Q,function(){L.apply(this,arguments)},W)},count:function(Q){var L=0;return oe(Q,function(){L++}),L},toArray:function(Q){return oe(Q,function(L){return L})||[]},only:function(Q){if(!O(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return mt.Activity=v,mt.Children=Le,mt.Component=F,mt.Fragment=r,mt.Profiler=a,mt.PureComponent=N,mt.StrictMode=n,mt.Suspense=h,mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,mt.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return k.H.useMemoCache(Q)}},mt.cache=function(Q){return function(){return Q.apply(null,arguments)}},mt.cacheSignal=function(){return null},mt.cloneElement=function(Q,L,W){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var G=w({},Q.props),Z=Q.key;if(L!=null)for(le in L.key!==void 0&&(Z=""+L.key),L)!I.call(L,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&L.ref===void 0||(G[le]=L[le]);var le=arguments.length-2;if(le===1)G.children=W;else if(1<le){for(var Se=Array(le),Ne=0;Ne<le;Ne++)Se[Ne]=arguments[Ne+2];G.children=Se}return R(Q.type,Z,G)},mt.createContext=function(Q){return Q={$$typeof:l,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:o,_context:Q},Q},mt.createElement=function(Q,L,W){var G,Z={},le=null;if(L!=null)for(G in L.key!==void 0&&(le=""+L.key),L)I.call(L,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(Z[G]=L[G]);var Se=arguments.length-2;if(Se===1)Z.children=W;else if(1<Se){for(var Ne=Array(Se),Ae=0;Ae<Se;Ae++)Ne[Ae]=arguments[Ae+2];Z.children=Ne}if(Q&&Q.defaultProps)for(G in Se=Q.defaultProps,Se)Z[G]===void 0&&(Z[G]=Se[G]);return R(Q,le,Z)},mt.createRef=function(){return{current:null}},mt.forwardRef=function(Q){return{$$typeof:u,render:Q}},mt.isValidElement=O,mt.lazy=function(Q){return{$$typeof:p,_payload:{_status:-1,_result:Q},_init:ke}},mt.memo=function(Q,L){return{$$typeof:d,type:Q,compare:L===void 0?null:L}},mt.startTransition=function(Q){var L=k.T,W={};k.T=W;try{var G=Q(),Z=k.S;Z!==null&&Z(W,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(J,ae)}catch(le){ae(le)}finally{L!==null&&W.types!==null&&(L.types=W.types),k.T=L}},mt.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},mt.use=function(Q){return k.H.use(Q)},mt.useActionState=function(Q,L,W){return k.H.useActionState(Q,L,W)},mt.useCallback=function(Q,L){return k.H.useCallback(Q,L)},mt.useContext=function(Q){return k.H.useContext(Q)},mt.useDebugValue=function(){},mt.useDeferredValue=function(Q,L){return k.H.useDeferredValue(Q,L)},mt.useEffect=function(Q,L){return k.H.useEffect(Q,L)},mt.useEffectEvent=function(Q){return k.H.useEffectEvent(Q)},mt.useId=function(){return k.H.useId()},mt.useImperativeHandle=function(Q,L,W){return k.H.useImperativeHandle(Q,L,W)},mt.useInsertionEffect=function(Q,L){return k.H.useInsertionEffect(Q,L)},mt.useLayoutEffect=function(Q,L){return k.H.useLayoutEffect(Q,L)},mt.useMemo=function(Q,L){return k.H.useMemo(Q,L)},mt.useOptimistic=function(Q,L){return k.H.useOptimistic(Q,L)},mt.useReducer=function(Q,L,W){return k.H.useReducer(Q,L,W)},mt.useRef=function(Q){return k.H.useRef(Q)},mt.useState=function(Q){return k.H.useState(Q)},mt.useSyncExternalStore=function(Q,L,W){return k.H.useSyncExternalStore(Q,L,W)},mt.useTransition=function(){return k.H.useTransition()},mt.version="19.2.3",mt}var Py;function Lg(){return Py||(Py=1,_p.exports=sC()),_p.exports}var qe=Lg();const oC=RE(qe);var yp={exports:{}},lf={},Tp={exports:{}},wp={};var Vy;function lC(){return Vy||(Vy=1,(function(t){function e(ne,oe){var ke=ne.length;ne.push(oe);e:for(;0<ke;){var ae=ke-1>>>1,Le=ne[ae];if(0<a(Le,oe))ne[ae]=oe,ne[ke]=Le,ke=ae;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var oe=ne[0],ke=ne.pop();if(ke!==oe){ne[0]=ke;e:for(var ae=0,Le=ne.length,Q=Le>>>1;ae<Q;){var L=2*(ae+1)-1,W=ne[L],G=L+1,Z=ne[G];if(0>a(W,ke))G<Le&&0>a(Z,W)?(ne[ae]=Z,ne[G]=ke,ae=G):(ne[ae]=W,ne[L]=ke,ae=L);else if(G<Le&&0>a(Z,ke))ne[ae]=Z,ne[G]=ke,ae=G;else break e}}return oe}function a(ne,oe){var ke=ne.sortIndex-oe.sortIndex;return ke!==0?ke:ne.id-oe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,v=null,_=3,y=!1,S=!1,w=!1,b=!1,F=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function K(ne){for(var oe=r(d);oe!==null;){if(oe.callback===null)n(d);else if(oe.startTime<=ne)n(d),oe.sortIndex=oe.expirationTime,e(h,oe);else break;oe=r(d)}}function te(ne){if(w=!1,K(ne),!S)if(r(h)!==null)S=!0,J||(J=!0,D());else{var oe=r(d);oe!==null&&Te(te,oe.startTime-ne)}}var J=!1,k=-1,I=5,R=-1;function M(){return b?!0:!(t.unstable_now()-R<I)}function O(){if(b=!1,J){var ne=t.unstable_now();R=ne;var oe=!0;try{e:{S=!1,w&&(w=!1,z(k),k=-1),y=!0;var ke=_;try{t:{for(K(ne),v=r(h);v!==null&&!(v.expirationTime>ne&&M());){var ae=v.callback;if(typeof ae=="function"){v.callback=null,_=v.priorityLevel;var Le=ae(v.expirationTime<=ne);if(ne=t.unstable_now(),typeof Le=="function"){v.callback=Le,K(ne),oe=!0;break t}v===r(h)&&n(h),K(ne)}else n(h);v=r(h)}if(v!==null)oe=!0;else{var Q=r(d);Q!==null&&Te(te,Q.startTime-ne),oe=!1}}break e}finally{v=null,_=ke,y=!1}oe=void 0}}finally{oe?D():J=!1}}}var D;if(typeof N=="function")D=function(){N(O)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,_e=V.port2;V.port1.onmessage=O,D=function(){_e.postMessage(null)}}else D=function(){F(O,0)};function Te(ne,oe){k=F(function(){ne(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ne){switch(_){case 1:case 2:case 3:var oe=3;break;default:oe=_}var ke=_;_=oe;try{return ne()}finally{_=ke}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(ne,oe){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var ke=_;_=ne;try{return oe()}finally{_=ke}},t.unstable_scheduleCallback=function(ne,oe,ke){var ae=t.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?ae+ke:ae):ke=ae,ne){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ke+Le,ne={id:p++,callback:oe,priorityLevel:ne,startTime:ke,expirationTime:Le,sortIndex:-1},ke>ae?(ne.sortIndex=ke,e(d,ne),r(h)===null&&ne===r(d)&&(w?(z(k),k=-1):w=!0,Te(te,ke-ae))):(ne.sortIndex=Le,e(h,ne),S||y||(S=!0,J||(J=!0,D()))),ne},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(ne){var oe=_;return function(){var ke=_;_=oe;try{return ne.apply(this,arguments)}finally{_=ke}}}})(wp)),wp}var By;function cC(){return By||(By=1,Tp.exports=lC()),Tp.exports}var Ep={exports:{}},Dn={};var Uy;function uC(){if(Uy)return Dn;Uy=1;var t=Lg();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:h,containerInfo:d,implementation:p}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Dn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,p)},Dn.flushSync=function(h){var d=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=p,n.d.f()}},Dn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Dn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Dn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:y}):p==="script"&&n.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Dn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Dn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Dn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Dn.requestFormReset=function(h){n.d.r(h)},Dn.unstable_batchedUpdates=function(h,d){return h(d)},Dn.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},Dn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Dn.version="19.2.3",Dn}var jy;function fC(){if(jy)return Ep.exports;jy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ep.exports=uC(),Ep.exports}var zy;function hC(){if(zy)return lf;zy=1;var t=cC(),e=Lg(),r=fC();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function l(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function h(i){if(o(i)!==i)throw Error(n(188))}function d(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(n(188));return s!==i?null:i}for(var c=i,f=s;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(f=g.return,f!==null){c=f;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return h(g),i;if(x===f)return h(g),s;x=x.sibling}throw Error(n(188))}if(c.return!==f.return)c=g,f=x;else{for(var A=!1,B=g.child;B;){if(B===c){A=!0,c=g,f=x;break}if(B===f){A=!0,f=g,c=x;break}B=B.sibling}if(!A){for(B=x.child;B;){if(B===c){A=!0,c=x,f=g;break}if(B===f){A=!0,f=x,c=g;break}B=B.sibling}if(!A)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:s}function p(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=p(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),N=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function D(i){return i===null||typeof i!="object"?null:(i=O&&i[O]||i["@@iterator"],typeof i=="function"?i:null)}var V=Symbol.for("react.client.reference");function _e(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===V?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case F:return"Profiler";case b:return"StrictMode";case te:return"Suspense";case J:return"SuspenseList";case R:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case S:return"Portal";case N:return i.displayName||"Context";case z:return(i._context.displayName||"Context")+".Consumer";case K:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case k:return s=i.displayName||null,s!==null?s:_e(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return _e(i(s))}catch{}}return null}var Te=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ke={pending:!1,data:null,method:null,action:null},ae=[],Le=-1;function Q(i){return{current:i}}function L(i){0>Le||(i.current=ae[Le],ae[Le]=null,Le--)}function W(i,s){Le++,ae[Le]=i.current,i.current=s}var G=Q(null),Z=Q(null),le=Q(null),Se=Q(null);function Ne(i,s){switch(W(le,s),W(Z,i),W(G,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?ny(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=ny(s),i=ay(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}L(G),W(G,i)}function Ae(){L(G),L(Z),L(le)}function Ie(i){i.memoizedState!==null&&W(Se,i);var s=G.current,c=ay(s,i.type);s!==c&&(W(Z,i),W(G,c))}function nt(i){Z.current===i&&(L(G),L(Z)),Se.current===i&&(L(Se),rf._currentValue=ke)}var ee,Ft;function ft(i){if(ee===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ee=s&&s[1]||"",Ft=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ee+i+Ft}var It=!1;function at(i,s){if(!i||It)return"";It=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(ve){var ge=ve}Reflect.construct(i,[],Ce)}else{try{Ce.call()}catch(ve){ge=ve}i.call(Ce.prototype)}}else{try{throw Error()}catch(ve){ge=ve}(Ce=i())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(ve){if(ve&&ge&&typeof ve.stack=="string")return[ve.stack,ge.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),A=x[0],B=x[1];if(A&&B){var re=A.split(`
`),de=B.split(`
`);for(g=f=0;f<re.length&&!re[f].includes("DetermineComponentFrameRoot");)f++;for(;g<de.length&&!de[g].includes("DetermineComponentFrameRoot");)g++;if(f===re.length||g===de.length)for(f=re.length-1,g=de.length-1;1<=f&&0<=g&&re[f]!==de[g];)g--;for(;1<=f&&0<=g;f--,g--)if(re[f]!==de[g]){if(f!==1||g!==1)do if(f--,g--,0>g||re[f]!==de[g]){var Ee=`
`+re[f].replace(" at new "," at ");return i.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",i.displayName)),Ee}while(1<=f&&0<=g);break}}}finally{It=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?ft(c):""}function Ue(i,s){switch(i.tag){case 26:case 27:case 5:return ft(i.type);case 16:return ft("Lazy");case 13:return i.child!==s&&s!==null?ft("Suspense Fallback"):ft("Suspense");case 19:return ft("SuspenseList");case 0:case 15:return at(i.type,!1);case 11:return at(i.type.render,!1);case 1:return at(i.type,!0);case 31:return ft("Activity");default:return""}}function $t(i){try{var s="",c=null;do s+=Ue(i,c),c=i,i=i.return;while(i);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Dt=Object.prototype.hasOwnProperty,Ut=t.unstable_scheduleCallback,Ur=t.unstable_cancelCallback,Za=t.unstable_shouldYield,qn=t.unstable_requestPaint,Lt=t.unstable_now,Jr=t.unstable_getCurrentPriorityLevel,gn=t.unstable_ImmediatePriority,Xn=t.unstable_UserBlockingPriority,Pt=t.unstable_NormalPriority,Nn=t.unstable_LowPriority,ct=t.unstable_IdlePriority,ar=t.log,Zr=t.unstable_setDisableYieldValue,Re=null,Xe=null;function Ke(i){if(typeof ar=="function"&&Zr(i),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Re,i)}catch{}}var Ze=Math.clz32?Math.clz32:jr,_r=Math.log,en=Math.LN2;function jr(i){return i>>>=0,i===0?32:31-(_r(i)/en|0)|0}var ln=256,Zn=262144,Gt=4194304;function Ir(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function wr(i,s,c){var f=i.pendingLanes;if(f===0)return 0;var g=0,x=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var B=f&134217727;return B!==0?(f=B&~x,f!==0?g=Ir(f):(A&=B,A!==0?g=Ir(A):c||(c=B&~i,c!==0&&(g=Ir(c))))):(B=f&~x,B!==0?g=Ir(B):A!==0?g=Ir(A):c||(c=f&~i,c!==0&&(g=Ir(c)))),g===0?0:s!==0&&s!==g&&(s&x)===0&&(x=g&-g,c=s&-s,x>=c||x===32&&(c&4194048)!==0)?s:g}function tn(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Ns(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ti(){var i=Gt;return Gt<<=1,(Gt&62914560)===0&&(Gt=4194304),i}function cn(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function ei(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function jo(i,s,c,f,g,x){var A=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var B=i.entanglements,re=i.expirationTimes,de=i.hiddenUpdates;for(c=A&~c;0<c;){var Ee=31-Ze(c),Ce=1<<Ee;B[Ee]=0,re[Ee]=-1;var ge=de[Ee];if(ge!==null)for(de[Ee]=null,Ee=0;Ee<ge.length;Ee++){var ve=ge[Ee];ve!==null&&(ve.lane&=-536870913)}c&=~Ce}f!==0&&ti(i,f,0),x!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=x&~(A&~s))}function ti(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-Ze(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|c&261930}function qt(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var f=31-Ze(c),g=1<<f;g&s|i[f]&s&&(i[f]|=s),c&=~g}}function Wn(i,s){var c=s&-s;return c=(c&42)!==0?1:da(c),(c&(i.suspendedLanes|s))!==0?0:c}function da(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ma(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function P(){var i=oe.p;return i!==0?i:(i=window.event,i===void 0?32:ky(i.type))}function X(i,s){var c=oe.p;try{return oe.p=i,s()}finally{oe.p=c}}var U=Math.random().toString(36).slice(2),H="__reactFiber$"+U,q="__reactProps$"+U,Y="__reactContainer$"+U,fe="__reactEvents$"+U,we="__reactListeners$"+U,he="__reactHandles$"+U,pe="__reactResources$"+U,me="__reactMarker$"+U;function Pe(i){delete i[H],delete i[q],delete i[fe],delete i[we],delete i[he]}function Ve(i){var s=i[H];if(s)return s;for(var c=i.parentNode;c;){if(s=c[Y]||c[H]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=fy(i);i!==null;){if(c=i[H])return c;i=fy(i)}return s}i=c,c=i.parentNode}return null}function Ge(i){if(i=i[H]||i[Y]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Me(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function He(i){var s=i[pe];return s||(s=i[pe]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ye(i){i[me]=!0}var Yt=new Set,Qt={};function ur(i,s){Rn(i,s),Rn(i+"Capture",s)}function Rn(i,s){for(Qt[i]=s,i=0;i<s.length;i++)Yt.add(s[i])}var ri=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ni={},pa={};function Rs(i){return Dt.call(pa,i)?!0:Dt.call(ni,i)?!1:ri.test(i)?pa[i]=!0:(ni[i]=!0,!1)}function In(i,s,c){if(Rs(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function ga(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function zr(i,s,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+f)}}function un(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Is(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function mu(i,s,c){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,x=f.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(A){c=""+A,x.call(this,A)}}),Object.defineProperty(i,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(A){c=""+A},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Jt(i){if(!i._valueTracker){var s=Is(i)?"checked":"value";i._valueTracker=mu(i,s,""+i[s])}}function zo(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return i&&(f=Is(i)?i.checked?"true":"false":i.value),i=f,i!==c?(s.setValue(i),!0):!1}function wi(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Ho=/[\n"\\]/g;function ea(i){return i.replace(Ho,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Hl(i,s,c,f,g,x,A,B){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),s!=null?A==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+un(s)):i.value!==""+un(s)&&(i.value=""+un(s)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),s!=null?pu(i,A,un(s)):c!=null?pu(i,A,un(c)):f!=null&&i.removeAttribute("value"),g==null&&x!=null&&(i.defaultChecked=!!x),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?i.name=""+un(B):i.removeAttribute("name")}function _0(i,s,c,f,g,x,A,B){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),s!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||s!=null)){Jt(i);return}c=c!=null?""+un(c):"",s=s!=null?""+un(s):c,B||s===i.value||(i.value=s),i.defaultValue=s}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=B?i.checked:!!f,i.defaultChecked=!!f,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A),Jt(i)}function pu(i,s,c){s==="number"&&wi(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Ds(i,s,c,f){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&f&&(i[c].defaultSelected=!0)}else{for(c=""+un(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function y0(i,s,c){if(s!=null&&(s=""+un(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+un(c):""}function Os(i,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(Te(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=un(s),i.defaultValue=c,f=i.textContent,f===c&&f!==""&&f!==null&&(i.value=f),Jt(i)}function ta(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var T0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gu(i,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,c):typeof c!="number"||c===0||T0.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function xu(i,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var g in s)f=s[g],s.hasOwnProperty(g)&&c[g]!==f&&gu(i,g,f)}else for(var x in s)s.hasOwnProperty(x)&&gu(i,x,s[x])}function Gl(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var w0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ql(i){return Fs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ai(){}var vu=null;function Da(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ms=null,Ei=null;function Go(i){var s=Ge(i);if(s&&(i=s.stateNode)){var c=i[q]||null;e:switch(i=s.stateNode,s.type){case"input":if(Hl(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ea(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==i&&f.form===i.form){var g=f[q]||null;if(!g)throw Error(n(90));Hl(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===i.form&&zo(f)}break e;case"textarea":y0(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Ds(i,!!c.multiple,s,!1)}}}var Xl=!1;function Ls(i,s,c){if(Xl)return i(s,c);Xl=!0;try{var f=i(s);return f}finally{if(Xl=!1,(Ms!==null||Ei!==null)&&(ph(),Ms&&(s=Ms,i=Ei,Ei=Ms=null,Go(s),i)))for(s=0;s<i.length;s++)Go(i[s])}}function ii(i,s){var c=i.stateNode;if(c===null)return null;var f=c[q]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var Oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qo=!1;if(Oa)try{var ir={};Object.defineProperty(ir,"passive",{get:function(){qo=!0}}),window.addEventListener("test",ir,ir),window.removeEventListener("test",ir,ir)}catch{qo=!1}var Si=null,_u=null,Xo=null;function yu(){if(Xo)return Xo;var i,s=_u,c=s.length,f,g="value"in Si?Si.value:Si.textContent,x=g.length;for(i=0;i<c&&s[i]===g[i];i++);var A=c-i;for(f=1;f<=A&&s[c-f]===g[x-f];f++);return Xo=g.slice(i,1<f?1-f:void 0)}function Wo(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ki(){return!0}function si(){return!1}function xn(i){function s(c,f,g,x,A){this._reactName=c,this._targetInst=g,this.type=f,this.nativeEvent=x,this.target=A,this.currentTarget=null;for(var B in i)i.hasOwnProperty(B)&&(c=i[B],this[B]=c?c(x):x[B]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ki:si,this.isPropagationStopped=si,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ki)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ki)},persist:function(){},isPersistent:Ki}),s}var $i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ai=xn($i),Ps=v({},$i,{view:0,detail:0}),Tu=xn(Ps),Vs,Wl,bi,Kl=v({},Ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==bi&&(bi&&i.type==="mousemove"?(Vs=i.screenX-bi.screenX,Wl=i.screenY-bi.screenY):Wl=Vs=0,bi=i),Vs)},movementY:function(i){return"movementY"in i?i.movementY:Wl}}),wu=xn(Kl),Ko=v({},Kl,{dataTransfer:0}),E0=xn(Ko),S0=v({},Ps,{relatedTarget:0}),$o=xn(S0),Eu=v({},$i,{animationName:0,elapsedTime:0,pseudoElement:0}),A0=xn(Eu),$l=v({},$i,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),b0=xn($l),k0=v({},$i,{data:0}),ki=xn(k0),C0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},R0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I0(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=R0[i])?!!s[i]:!1}function Bs(){return I0}var Kn=v({},Ps,{key:function(i){if(i.key){var s=C0[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Wo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?N0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bs,charCode:function(i){return i.type==="keypress"?Wo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Wo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),D0=xn(Kn),O0=v({},Kl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yi=xn(O0),m=v({},Ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bs}),T=xn(m),C=v({},$i,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=xn(C),ce=v({},Kl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),xe=xn(ce),ze=v({},$i,{newState:0,oldState:0}),gt=xn(ze),Dr=[9,13,27,32],Xt=Oa&&"CompositionEvent"in window,yr=null;Oa&&"documentMode"in document&&(yr=document.documentMode);var Fa=Oa&&"TextEvent"in window&&!yr,Ci=Oa&&(!Xt||yr&&8<yr&&11>=yr),oi=" ",li=!1;function Yo(i,s){switch(i){case"keyup":return Dr.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yl(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ql=!1;function Ck(i,s){switch(i){case"compositionend":return Yl(s);case"keypress":return s.which!==32?null:(li=!0,oi);case"textInput":return i=s.data,i===oi&&li?null:i;default:return null}}function Nk(i,s){if(Ql)return i==="compositionend"||!Xt&&Yo(i,s)?(i=yu(),Xo=_u=Si=null,Ql=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ci&&s.locale!=="ko"?null:s.data;default:return null}}var Rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mv(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Rk[i.type]:s==="textarea"}function pv(i,s,c,f){Ms?Ei?Ei.push(f):Ei=[f]:Ms=f,s=wh(s,"onChange"),0<s.length&&(c=new Ai("onChange","change",null,c,f),i.push({event:c,listeners:s}))}var Su=null,Au=null;function Ik(i){Q2(i,0)}function F0(i){var s=Me(i);if(zo(s))return i}function gv(i,s){if(i==="change")return s}var xv=!1;if(Oa){var Am;if(Oa){var bm="oninput"in document;if(!bm){var vv=document.createElement("div");vv.setAttribute("oninput","return;"),bm=typeof vv.oninput=="function"}Am=bm}else Am=!1;xv=Am&&(!document.documentMode||9<document.documentMode)}function _v(){Su&&(Su.detachEvent("onpropertychange",yv),Au=Su=null)}function yv(i){if(i.propertyName==="value"&&F0(Au)){var s=[];pv(s,Au,i,Da(i)),Ls(Ik,s)}}function Dk(i,s,c){i==="focusin"?(_v(),Su=s,Au=c,Su.attachEvent("onpropertychange",yv)):i==="focusout"&&_v()}function Ok(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return F0(Au)}function Fk(i,s){if(i==="click")return F0(s)}function Mk(i,s){if(i==="input"||i==="change")return F0(s)}function Lk(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var xa=typeof Object.is=="function"?Object.is:Lk;function bu(i,s){if(xa(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var g=c[f];if(!Dt.call(s,g)||!xa(i[g],s[g]))return!1}return!0}function Tv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function wv(i,s){var c=Tv(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=s&&f>=s)return{node:c,offset:s-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Tv(c)}}function Ev(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Ev(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Sv(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=wi(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=wi(i.document)}return s}function km(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var Pk=Oa&&"documentMode"in document&&11>=document.documentMode,Jl=null,Cm=null,ku=null,Nm=!1;function Av(i,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Nm||Jl==null||Jl!==wi(f)||(f=Jl,"selectionStart"in f&&km(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ku&&bu(ku,f)||(ku=f,f=wh(Cm,"onSelect"),0<f.length&&(s=new Ai("onSelect","select",null,s,c),i.push({event:s,listeners:f}),s.target=Jl)))}function Qo(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var Zl={animationend:Qo("Animation","AnimationEnd"),animationiteration:Qo("Animation","AnimationIteration"),animationstart:Qo("Animation","AnimationStart"),transitionrun:Qo("Transition","TransitionRun"),transitionstart:Qo("Transition","TransitionStart"),transitioncancel:Qo("Transition","TransitionCancel"),transitionend:Qo("Transition","TransitionEnd")},Rm={},bv={};Oa&&(bv=document.createElement("div").style,"AnimationEvent"in window||(delete Zl.animationend.animation,delete Zl.animationiteration.animation,delete Zl.animationstart.animation),"TransitionEvent"in window||delete Zl.transitionend.transition);function Jo(i){if(Rm[i])return Rm[i];if(!Zl[i])return i;var s=Zl[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in bv)return Rm[i]=s[c];return i}var kv=Jo("animationend"),Cv=Jo("animationiteration"),Nv=Jo("animationstart"),Vk=Jo("transitionrun"),Bk=Jo("transitionstart"),Uk=Jo("transitioncancel"),Rv=Jo("transitionend"),Iv=new Map,Im="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Im.push("scrollEnd");function ci(i,s){Iv.set(i,s),ur(s,[i])}var M0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ma=[],ec=0,Dm=0;function L0(){for(var i=ec,s=Dm=ec=0;s<i;){var c=Ma[s];Ma[s++]=null;var f=Ma[s];Ma[s++]=null;var g=Ma[s];Ma[s++]=null;var x=Ma[s];if(Ma[s++]=null,f!==null&&g!==null){var A=f.pending;A===null?g.next=g:(g.next=A.next,A.next=g),f.pending=g}x!==0&&Dv(c,g,x)}}function P0(i,s,c,f){Ma[ec++]=i,Ma[ec++]=s,Ma[ec++]=c,Ma[ec++]=f,Dm|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function Om(i,s,c,f){return P0(i,s,c,f),V0(i)}function Zo(i,s){return P0(i,null,null,s),V0(i)}function Dv(i,s,c){i.lanes|=c;var f=i.alternate;f!==null&&(f.lanes|=c);for(var g=!1,x=i.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(g=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,g&&s!==null&&(g=31-Ze(c),i=x.hiddenUpdates,f=i[g],f===null?i[g]=[s]:f.push(s),s.lane=c|536870912),x):null}function V0(i){if(50<$u)throw $u=0,z1=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var tc={};function jk(i,s,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(i,s,c,f){return new jk(i,s,c,f)}function Fm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Qi(i,s){var c=i.alternate;return c===null?(c=va(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Ov(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function B0(i,s,c,f,g,x){var A=0;if(f=i,typeof i=="function")Fm(i)&&(A=1);else if(typeof i=="string")A=X3(i,c,G.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case R:return i=va(31,c,s,g),i.elementType=R,i.lanes=x,i;case w:return el(c.children,g,x,s);case b:A=8,g|=24;break;case F:return i=va(12,c,s,g|2),i.elementType=F,i.lanes=x,i;case te:return i=va(13,c,s,g),i.elementType=te,i.lanes=x,i;case J:return i=va(19,c,s,g),i.elementType=J,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:A=10;break e;case z:A=9;break e;case K:A=11;break e;case k:A=14;break e;case I:A=16,f=null;break e}A=29,c=Error(n(130,i===null?"null":typeof i,"")),f=null}return s=va(A,c,s,g),s.elementType=i,s.type=f,s.lanes=x,s}function el(i,s,c,f){return i=va(7,i,f,s),i.lanes=c,i}function Mm(i,s,c){return i=va(6,i,null,s),i.lanes=c,i}function Fv(i){var s=va(18,null,null,0);return s.stateNode=i,s}function Lm(i,s,c){return s=va(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Mv=new WeakMap;function La(i,s){if(typeof i=="object"&&i!==null){var c=Mv.get(i);return c!==void 0?c:(s={value:i,source:s,stack:$t(s)},Mv.set(i,s),s)}return{value:i,source:s,stack:$t(s)}}var rc=[],nc=0,U0=null,Cu=0,Pa=[],Va=0,Us=null,Ni=1,Ri="";function Ji(i,s){rc[nc++]=Cu,rc[nc++]=U0,U0=i,Cu=s}function Lv(i,s,c){Pa[Va++]=Ni,Pa[Va++]=Ri,Pa[Va++]=Us,Us=i;var f=Ni;i=Ri;var g=32-Ze(f)-1;f&=~(1<<g),c+=1;var x=32-Ze(s)+g;if(30<x){var A=g-g%5;x=(f&(1<<A)-1).toString(32),f>>=A,g-=A,Ni=1<<32-Ze(s)+g|c<<g|f,Ri=x+i}else Ni=1<<x|c<<g|f,Ri=i}function Pm(i){i.return!==null&&(Ji(i,1),Lv(i,1,0))}function Vm(i){for(;i===U0;)U0=rc[--nc],rc[nc]=null,Cu=rc[--nc],rc[nc]=null;for(;i===Us;)Us=Pa[--Va],Pa[Va]=null,Ri=Pa[--Va],Pa[Va]=null,Ni=Pa[--Va],Pa[Va]=null}function Pv(i,s){Pa[Va++]=Ni,Pa[Va++]=Ri,Pa[Va++]=Us,Ni=s.id,Ri=s.overflow,Us=i}var vn=null,hr=null,Ot=!1,js=null,Ba=!1,Bm=Error(n(519));function zs(i){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nu(La(s,i)),Bm}function Vv(i){var s=i.stateNode,c=i.type,f=i.memoizedProps;switch(s[H]=i,s[q]=f,c){case"dialog":At("cancel",s),At("close",s);break;case"iframe":case"object":case"embed":At("load",s);break;case"video":case"audio":for(c=0;c<Qu.length;c++)At(Qu[c],s);break;case"source":At("error",s);break;case"img":case"image":case"link":At("error",s),At("load",s);break;case"details":At("toggle",s);break;case"input":At("invalid",s),_0(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":At("invalid",s);break;case"textarea":At("invalid",s),Os(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||ty(s.textContent,c)?(f.popover!=null&&(At("beforetoggle",s),At("toggle",s)),f.onScroll!=null&&At("scroll",s),f.onScrollEnd!=null&&At("scrollend",s),f.onClick!=null&&(s.onclick=ai),s=!0):s=!1,s||zs(i,!0)}function Bv(i){for(vn=i.return;vn;)switch(vn.tag){case 5:case 31:case 13:Ba=!1;return;case 27:case 3:Ba=!0;return;default:vn=vn.return}}function ac(i){if(i!==vn)return!1;if(!Ot)return Bv(i),Ot=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||np(i.type,i.memoizedProps)),c=!c),c&&hr&&zs(i),Bv(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));hr=uy(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));hr=uy(i)}else s===27?(s=hr,ro(i.type)?(i=lp,lp=null,hr=i):hr=s):hr=vn?ja(i.stateNode.nextSibling):null;return!0}function tl(){hr=vn=null,Ot=!1}function Um(){var i=js;return i!==null&&(ia===null?ia=i:ia.push.apply(ia,i),js=null),i}function Nu(i){js===null?js=[i]:js.push(i)}var jm=Q(null),rl=null,Zi=null;function Hs(i,s,c){W(jm,s._currentValue),s._currentValue=c}function es(i){i._currentValue=jm.current,L(jm)}function zm(i,s,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===c)break;i=i.return}}function Hm(i,s,c,f){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var x=g.dependencies;if(x!==null){var A=g.child;x=x.firstContext;e:for(;x!==null;){var B=x;x=g;for(var re=0;re<s.length;re++)if(B.context===s[re]){x.lanes|=c,B=x.alternate,B!==null&&(B.lanes|=c),zm(x.return,c,i),f||(A=null);break e}x=B.next}}else if(g.tag===18){if(A=g.return,A===null)throw Error(n(341));A.lanes|=c,x=A.alternate,x!==null&&(x.lanes|=c),zm(A,c,i),A=null}else A=g.child;if(A!==null)A.return=g;else for(A=g;A!==null;){if(A===i){A=null;break}if(g=A.sibling,g!==null){g.return=A.return,A=g;break}A=A.return}g=A}}function ic(i,s,c,f){i=null;for(var g=s,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var A=g.alternate;if(A===null)throw Error(n(387));if(A=A.memoizedProps,A!==null){var B=g.type;xa(g.pendingProps.value,A.value)||(i!==null?i.push(B):i=[B])}}else if(g===Se.current){if(A=g.alternate,A===null)throw Error(n(387));A.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(rf):i=[rf])}g=g.return}i!==null&&Hm(s,i,c,f),s.flags|=262144}function j0(i){for(i=i.firstContext;i!==null;){if(!xa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function nl(i){rl=i,Zi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function _n(i){return Uv(rl,i)}function z0(i,s){return rl===null&&nl(i),Uv(i,s)}function Uv(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Zi===null){if(i===null)throw Error(n(308));Zi=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Zi=Zi.next=s;return c}var zk=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},Hk=t.unstable_scheduleCallback,Gk=t.unstable_NormalPriority,Hr={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gm(){return{controller:new zk,data:new Map,refCount:0}}function Ru(i){i.refCount--,i.refCount===0&&Hk(Gk,function(){i.controller.abort()})}var Iu=null,qm=0,sc=0,oc=null;function qk(i,s){if(Iu===null){var c=Iu=[];qm=0,sc=K1(),oc={status:"pending",value:void 0,then:function(f){c.push(f)}}}return qm++,s.then(jv,jv),s}function jv(){if(--qm===0&&Iu!==null){oc!==null&&(oc.status="fulfilled");var i=Iu;Iu=null,sc=0,oc=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function Xk(i,s){var c=[],f={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(f.status="rejected",f.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),f}var zv=ne.S;ne.S=function(i,s){A2=Lt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&qk(i,s),zv!==null&&zv(i,s)};var al=Q(null);function Xm(){var i=al.current;return i!==null?i:fr.pooledCache}function H0(i,s){s===null?W(al,al.current):W(al,s.pool)}function Hv(){var i=Xm();return i===null?null:{parent:Hr._currentValue,pool:i}}var lc=Error(n(460)),Wm=Error(n(474)),G0=Error(n(542)),q0={then:function(){}};function Gv(i){return i=i.status,i==="fulfilled"||i==="rejected"}function qv(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(ai,ai),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Wv(i),i;default:if(typeof s.status=="string")s.then(ai,ai);else{if(i=fr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=f}},function(f){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Wv(i),i}throw sl=s,lc}}function il(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(sl=c,lc):c}}var sl=null;function Xv(){if(sl===null)throw Error(n(459));var i=sl;return sl=null,i}function Wv(i){if(i===lc||i===G0)throw Error(n(483))}var cc=null,Du=0;function X0(i){var s=Du;return Du+=1,cc===null&&(cc=[]),qv(cc,i,s)}function Ou(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function W0(i,s){throw s.$$typeof===_?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Kv(i){function s(se,ie){if(i){var ue=se.deletions;ue===null?(se.deletions=[ie],se.flags|=16):ue.push(ie)}}function c(se,ie){if(!i)return null;for(;ie!==null;)s(se,ie),ie=ie.sibling;return null}function f(se){for(var ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function g(se,ie){return se=Qi(se,ie),se.index=0,se.sibling=null,se}function x(se,ie,ue){return se.index=ue,i?(ue=se.alternate,ue!==null?(ue=ue.index,ue<ie?(se.flags|=67108866,ie):ue):(se.flags|=67108866,ie)):(se.flags|=1048576,ie)}function A(se){return i&&se.alternate===null&&(se.flags|=67108866),se}function B(se,ie,ue,be){return ie===null||ie.tag!==6?(ie=Mm(ue,se.mode,be),ie.return=se,ie):(ie=g(ie,ue),ie.return=se,ie)}function re(se,ie,ue,be){var et=ue.type;return et===w?Ee(se,ie,ue.props.children,be,ue.key):ie!==null&&(ie.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===I&&il(et)===ie.type)?(ie=g(ie,ue.props),Ou(ie,ue),ie.return=se,ie):(ie=B0(ue.type,ue.key,ue.props,null,se.mode,be),Ou(ie,ue),ie.return=se,ie)}function de(se,ie,ue,be){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==ue.containerInfo||ie.stateNode.implementation!==ue.implementation?(ie=Lm(ue,se.mode,be),ie.return=se,ie):(ie=g(ie,ue.children||[]),ie.return=se,ie)}function Ee(se,ie,ue,be,et){return ie===null||ie.tag!==7?(ie=el(ue,se.mode,be,et),ie.return=se,ie):(ie=g(ie,ue),ie.return=se,ie)}function Ce(se,ie,ue){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Mm(""+ie,se.mode,ue),ie.return=se,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case y:return ue=B0(ie.type,ie.key,ie.props,null,se.mode,ue),Ou(ue,ie),ue.return=se,ue;case S:return ie=Lm(ie,se.mode,ue),ie.return=se,ie;case I:return ie=il(ie),Ce(se,ie,ue)}if(Te(ie)||D(ie))return ie=el(ie,se.mode,ue,null),ie.return=se,ie;if(typeof ie.then=="function")return Ce(se,X0(ie),ue);if(ie.$$typeof===N)return Ce(se,z0(se,ie),ue);W0(se,ie)}return null}function ge(se,ie,ue,be){var et=ie!==null?ie.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return et!==null?null:B(se,ie,""+ue,be);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case y:return ue.key===et?re(se,ie,ue,be):null;case S:return ue.key===et?de(se,ie,ue,be):null;case I:return ue=il(ue),ge(se,ie,ue,be)}if(Te(ue)||D(ue))return et!==null?null:Ee(se,ie,ue,be,null);if(typeof ue.then=="function")return ge(se,ie,X0(ue),be);if(ue.$$typeof===N)return ge(se,ie,z0(se,ue),be);W0(se,ue)}return null}function ve(se,ie,ue,be,et){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return se=se.get(ue)||null,B(ie,se,""+be,et);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case y:return se=se.get(be.key===null?ue:be.key)||null,re(ie,se,be,et);case S:return se=se.get(be.key===null?ue:be.key)||null,de(ie,se,be,et);case I:return be=il(be),ve(se,ie,ue,be,et)}if(Te(be)||D(be))return se=se.get(ue)||null,Ee(ie,se,be,et,null);if(typeof be.then=="function")return ve(se,ie,ue,X0(be),et);if(be.$$typeof===N)return ve(se,ie,ue,z0(ie,be),et);W0(ie,be)}return null}function $e(se,ie,ue,be){for(var et=null,jt=null,Qe=ie,yt=ie=0,kt=null;Qe!==null&&yt<ue.length;yt++){Qe.index>yt?(kt=Qe,Qe=null):kt=Qe.sibling;var zt=ge(se,Qe,ue[yt],be);if(zt===null){Qe===null&&(Qe=kt);break}i&&Qe&&zt.alternate===null&&s(se,Qe),ie=x(zt,ie,yt),jt===null?et=zt:jt.sibling=zt,jt=zt,Qe=kt}if(yt===ue.length)return c(se,Qe),Ot&&Ji(se,yt),et;if(Qe===null){for(;yt<ue.length;yt++)Qe=Ce(se,ue[yt],be),Qe!==null&&(ie=x(Qe,ie,yt),jt===null?et=Qe:jt.sibling=Qe,jt=Qe);return Ot&&Ji(se,yt),et}for(Qe=f(Qe);yt<ue.length;yt++)kt=ve(Qe,se,yt,ue[yt],be),kt!==null&&(i&&kt.alternate!==null&&Qe.delete(kt.key===null?yt:kt.key),ie=x(kt,ie,yt),jt===null?et=kt:jt.sibling=kt,jt=kt);return i&&Qe.forEach(function(oo){return s(se,oo)}),Ot&&Ji(se,yt),et}function it(se,ie,ue,be){if(ue==null)throw Error(n(151));for(var et=null,jt=null,Qe=ie,yt=ie=0,kt=null,zt=ue.next();Qe!==null&&!zt.done;yt++,zt=ue.next()){Qe.index>yt?(kt=Qe,Qe=null):kt=Qe.sibling;var oo=ge(se,Qe,zt.value,be);if(oo===null){Qe===null&&(Qe=kt);break}i&&Qe&&oo.alternate===null&&s(se,Qe),ie=x(oo,ie,yt),jt===null?et=oo:jt.sibling=oo,jt=oo,Qe=kt}if(zt.done)return c(se,Qe),Ot&&Ji(se,yt),et;if(Qe===null){for(;!zt.done;yt++,zt=ue.next())zt=Ce(se,zt.value,be),zt!==null&&(ie=x(zt,ie,yt),jt===null?et=zt:jt.sibling=zt,jt=zt);return Ot&&Ji(se,yt),et}for(Qe=f(Qe);!zt.done;yt++,zt=ue.next())zt=ve(Qe,se,yt,zt.value,be),zt!==null&&(i&&zt.alternate!==null&&Qe.delete(zt.key===null?yt:zt.key),ie=x(zt,ie,yt),jt===null?et=zt:jt.sibling=zt,jt=zt);return i&&Qe.forEach(function(nC){return s(se,nC)}),Ot&&Ji(se,yt),et}function lr(se,ie,ue,be){if(typeof ue=="object"&&ue!==null&&ue.type===w&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case y:e:{for(var et=ue.key;ie!==null;){if(ie.key===et){if(et=ue.type,et===w){if(ie.tag===7){c(se,ie.sibling),be=g(ie,ue.props.children),be.return=se,se=be;break e}}else if(ie.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===I&&il(et)===ie.type){c(se,ie.sibling),be=g(ie,ue.props),Ou(be,ue),be.return=se,se=be;break e}c(se,ie);break}else s(se,ie);ie=ie.sibling}ue.type===w?(be=el(ue.props.children,se.mode,be,ue.key),be.return=se,se=be):(be=B0(ue.type,ue.key,ue.props,null,se.mode,be),Ou(be,ue),be.return=se,se=be)}return A(se);case S:e:{for(et=ue.key;ie!==null;){if(ie.key===et)if(ie.tag===4&&ie.stateNode.containerInfo===ue.containerInfo&&ie.stateNode.implementation===ue.implementation){c(se,ie.sibling),be=g(ie,ue.children||[]),be.return=se,se=be;break e}else{c(se,ie);break}else s(se,ie);ie=ie.sibling}be=Lm(ue,se.mode,be),be.return=se,se=be}return A(se);case I:return ue=il(ue),lr(se,ie,ue,be)}if(Te(ue))return $e(se,ie,ue,be);if(D(ue)){if(et=D(ue),typeof et!="function")throw Error(n(150));return ue=et.call(ue),it(se,ie,ue,be)}if(typeof ue.then=="function")return lr(se,ie,X0(ue),be);if(ue.$$typeof===N)return lr(se,ie,z0(se,ue),be);W0(se,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,ie!==null&&ie.tag===6?(c(se,ie.sibling),be=g(ie,ue),be.return=se,se=be):(c(se,ie),be=Mm(ue,se.mode,be),be.return=se,se=be),A(se)):c(se,ie)}return function(se,ie,ue,be){try{Du=0;var et=lr(se,ie,ue,be);return cc=null,et}catch(Qe){if(Qe===lc||Qe===G0)throw Qe;var jt=va(29,Qe,null,se.mode);return jt.lanes=be,jt.return=se,jt}}}var ol=Kv(!0),$v=Kv(!1),Gs=!1;function Km(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $m(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function qs(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Xs(i,s,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(Wt&2)!==0){var g=f.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),f.pending=s,s=V0(i),Dv(i,null,c),s}return P0(i,f,s,c),V0(i)}function Fu(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,qt(i,c)}}function Ym(i,s){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=A:x=x.next=A,c=c.next}while(c!==null);x===null?g=x=s:x=x.next=s}else g=x=s;c={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var Qm=!1;function Mu(){if(Qm){var i=oc;if(i!==null)throw i}}function Lu(i,s,c,f){Qm=!1;var g=i.updateQueue;Gs=!1;var x=g.firstBaseUpdate,A=g.lastBaseUpdate,B=g.shared.pending;if(B!==null){g.shared.pending=null;var re=B,de=re.next;re.next=null,A===null?x=de:A.next=de,A=re;var Ee=i.alternate;Ee!==null&&(Ee=Ee.updateQueue,B=Ee.lastBaseUpdate,B!==A&&(B===null?Ee.firstBaseUpdate=de:B.next=de,Ee.lastBaseUpdate=re))}if(x!==null){var Ce=g.baseState;A=0,Ee=de=re=null,B=x;do{var ge=B.lane&-536870913,ve=ge!==B.lane;if(ve?(bt&ge)===ge:(f&ge)===ge){ge!==0&&ge===sc&&(Qm=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var $e=i,it=B;ge=s;var lr=c;switch(it.tag){case 1:if($e=it.payload,typeof $e=="function"){Ce=$e.call(lr,Ce,ge);break e}Ce=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=it.payload,ge=typeof $e=="function"?$e.call(lr,Ce,ge):$e,ge==null)break e;Ce=v({},Ce,ge);break e;case 2:Gs=!0}}ge=B.callback,ge!==null&&(i.flags|=64,ve&&(i.flags|=8192),ve=g.callbacks,ve===null?g.callbacks=[ge]:ve.push(ge))}else ve={lane:ge,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Ee===null?(de=Ee=ve,re=Ce):Ee=Ee.next=ve,A|=ge;if(B=B.next,B===null){if(B=g.shared.pending,B===null)break;ve=B,B=ve.next,ve.next=null,g.lastBaseUpdate=ve,g.shared.pending=null}}while(!0);Ee===null&&(re=Ce),g.baseState=re,g.firstBaseUpdate=de,g.lastBaseUpdate=Ee,x===null&&(g.shared.lanes=0),Qs|=A,i.lanes=A,i.memoizedState=Ce}}function Yv(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function Qv(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Yv(c[i],s)}var uc=Q(null),K0=Q(0);function Jv(i,s){i=cs,W(K0,i),W(uc,s),cs=i|s.baseLanes}function Jm(){W(K0,cs),W(uc,uc.current)}function Zm(){cs=K0.current,L(uc),L(K0)}var _a=Q(null),Ua=null;function Ws(i){var s=i.alternate;W(Or,Or.current&1),W(_a,i),Ua===null&&(s===null||uc.current!==null||s.memoizedState!==null)&&(Ua=i)}function e1(i){W(Or,Or.current),W(_a,i),Ua===null&&(Ua=i)}function Zv(i){i.tag===22?(W(Or,Or.current),W(_a,i),Ua===null&&(Ua=i)):Ks()}function Ks(){W(Or,Or.current),W(_a,_a.current)}function ya(i){L(_a),Ua===i&&(Ua=null),L(Or)}var Or=Q(0);function $0(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||sp(c)||op(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ts=0,xt=null,sr=null,Gr=null,Y0=!1,fc=!1,ll=!1,Q0=0,Pu=0,hc=null,Wk=0;function br(){throw Error(n(321))}function t1(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!xa(i[c],s[c]))return!1;return!0}function r1(i,s,c,f,g,x){return ts=x,xt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ne.H=i===null||i.memoizedState===null?L_:x1,ll=!1,x=c(f,g),ll=!1,fc&&(x=t_(s,c,f,g)),e_(i),x}function e_(i){ne.H=Uu;var s=sr!==null&&sr.next!==null;if(ts=0,Gr=sr=xt=null,Y0=!1,Pu=0,hc=null,s)throw Error(n(300));i===null||qr||(i=i.dependencies,i!==null&&j0(i)&&(qr=!0))}function t_(i,s,c,f){xt=i;var g=0;do{if(fc&&(hc=null),Pu=0,fc=!1,25<=g)throw Error(n(301));if(g+=1,Gr=sr=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=P_,x=s(c,f)}while(fc);return x}function Kk(){var i=ne.H,s=i.useState()[0];return s=typeof s.then=="function"?Vu(s):s,i=i.useState()[0],(sr!==null?sr.memoizedState:null)!==i&&(xt.flags|=1024),s}function n1(){var i=Q0!==0;return Q0=0,i}function a1(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function i1(i){if(Y0){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Y0=!1}ts=0,Gr=sr=xt=null,fc=!1,Pu=Q0=0,hc=null}function $n(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?xt.memoizedState=Gr=i:Gr=Gr.next=i,Gr}function Fr(){if(sr===null){var i=xt.alternate;i=i!==null?i.memoizedState:null}else i=sr.next;var s=Gr===null?xt.memoizedState:Gr.next;if(s!==null)Gr=s,sr=i;else{if(i===null)throw xt.alternate===null?Error(n(467)):Error(n(310));sr=i,i={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},Gr===null?xt.memoizedState=Gr=i:Gr=Gr.next=i}return Gr}function J0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vu(i){var s=Pu;return Pu+=1,hc===null&&(hc=[]),i=qv(hc,i,s),s=xt,(Gr===null?s.memoizedState:Gr.next)===null&&(s=s.alternate,ne.H=s===null||s.memoizedState===null?L_:x1),i}function Z0(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Vu(i);if(i.$$typeof===N)return _n(i)}throw Error(n(438,String(i)))}function s1(i){var s=null,c=xt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=xt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=J0(),xt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),f=0;f<i;f++)c[f]=M;return s.index++,c}function rs(i,s){return typeof s=="function"?s(i):s}function eh(i){var s=Fr();return o1(s,sr,i)}function o1(i,s,c){var f=i.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var g=i.baseQueue,x=f.pending;if(x!==null){if(g!==null){var A=g.next;g.next=x.next,x.next=A}s.baseQueue=g=x,f.pending=null}if(x=i.baseState,g===null)i.memoizedState=x;else{s=g.next;var B=A=null,re=null,de=s,Ee=!1;do{var Ce=de.lane&-536870913;if(Ce!==de.lane?(bt&Ce)===Ce:(ts&Ce)===Ce){var ge=de.revertLane;if(ge===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ce===sc&&(Ee=!0);else if((ts&ge)===ge){de=de.next,ge===sc&&(Ee=!0);continue}else Ce={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},re===null?(B=re=Ce,A=x):re=re.next=Ce,xt.lanes|=ge,Qs|=ge;Ce=de.action,ll&&c(x,Ce),x=de.hasEagerState?de.eagerState:c(x,Ce)}else ge={lane:Ce,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},re===null?(B=re=ge,A=x):re=re.next=ge,xt.lanes|=Ce,Qs|=Ce;de=de.next}while(de!==null&&de!==s);if(re===null?A=x:re.next=B,!xa(x,i.memoizedState)&&(qr=!0,Ee&&(c=oc,c!==null)))throw c;i.memoizedState=x,i.baseState=A,i.baseQueue=re,f.lastRenderedState=x}return g===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function l1(i){var s=Fr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var f=c.dispatch,g=c.pending,x=s.memoizedState;if(g!==null){c.pending=null;var A=g=g.next;do x=i(x,A.action),A=A.next;while(A!==g);xa(x,s.memoizedState)||(qr=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),c.lastRenderedState=x}return[x,f]}function r_(i,s,c){var f=xt,g=Fr(),x=Ot;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=s();var A=!xa((sr||g).memoizedState,c);if(A&&(g.memoizedState=c,qr=!0),g=g.queue,f1(i_.bind(null,f,g,i),[i]),g.getSnapshot!==s||A||Gr!==null&&Gr.memoizedState.tag&1){if(f.flags|=2048,dc(9,{destroy:void 0},a_.bind(null,f,g,c,s),null),fr===null)throw Error(n(349));x||(ts&127)!==0||n_(f,s,c)}return c}function n_(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=xt.updateQueue,s===null?(s=J0(),xt.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function a_(i,s,c,f){s.value=c,s.getSnapshot=f,s_(s)&&o_(i)}function i_(i,s,c){return c(function(){s_(s)&&o_(i)})}function s_(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!xa(i,c)}catch{return!0}}function o_(i){var s=Zo(i,2);s!==null&&sa(s,i,2)}function c1(i){var s=$n();if(typeof i=="function"){var c=i;if(i=c(),ll){Ke(!0);try{c()}finally{Ke(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:i},s}function l_(i,s,c,f){return i.baseState=c,o1(i,sr,typeof f=="function"?f:rs)}function $k(i,s,c,f,g){if(nh(i))throw Error(n(485));if(i=s.action,i!==null){var x={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){x.listeners.push(A)}};ne.T!==null?c(!0):x.isTransition=!1,f(x),c=s.pending,c===null?(x.next=s.pending=x,c_(s,x)):(x.next=c.next,s.pending=c.next=x)}}function c_(i,s){var c=s.action,f=s.payload,g=i.state;if(s.isTransition){var x=ne.T,A={};ne.T=A;try{var B=c(g,f),re=ne.S;re!==null&&re(A,B),u_(i,s,B)}catch(de){u1(i,s,de)}finally{x!==null&&A.types!==null&&(x.types=A.types),ne.T=x}}else try{x=c(g,f),u_(i,s,x)}catch(de){u1(i,s,de)}}function u_(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){f_(i,s,f)},function(f){return u1(i,s,f)}):f_(i,s,c)}function f_(i,s,c){s.status="fulfilled",s.value=c,h_(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,c_(i,c)))}function u1(i,s,c){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,h_(s),s=s.next;while(s!==f)}i.action=null}function h_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function d_(i,s){return s}function m_(i,s){if(Ot){var c=fr.formState;if(c!==null){e:{var f=xt;if(Ot){if(hr){t:{for(var g=hr,x=Ba;g.nodeType!==8;){if(!x){g=null;break t}if(g=ja(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){hr=ja(g.nextSibling),f=g.data==="F!";break e}}zs(f)}f=!1}f&&(s=c[0])}}return c=$n(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d_,lastRenderedState:s},c.queue=f,c=O_.bind(null,xt,f),f.dispatch=c,f=c1(!1),x=g1.bind(null,xt,!1,f.queue),f=$n(),g={state:s,dispatch:null,action:i,pending:null},f.queue=g,c=$k.bind(null,xt,g,x,c),g.dispatch=c,f.memoizedState=i,[s,c,!1]}function p_(i){var s=Fr();return g_(s,sr,i)}function g_(i,s,c){if(s=o1(i,s,d_)[0],i=eh(rs)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Vu(s)}catch(A){throw A===lc?G0:A}else f=s;s=Fr();var g=s.queue,x=g.dispatch;return c!==s.memoizedState&&(xt.flags|=2048,dc(9,{destroy:void 0},Yk.bind(null,g,c),null)),[f,x,i]}function Yk(i,s){i.action=s}function x_(i){var s=Fr(),c=sr;if(c!==null)return g_(s,c,i);Fr(),s=s.memoizedState,c=Fr();var f=c.queue.dispatch;return c.memoizedState=i,[s,f,!1]}function dc(i,s,c,f){return i={tag:i,create:c,deps:f,inst:s,next:null},s=xt.updateQueue,s===null&&(s=J0(),xt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,s.lastEffect=i),i}function v_(){return Fr().memoizedState}function th(i,s,c,f){var g=$n();xt.flags|=i,g.memoizedState=dc(1|s,{destroy:void 0},c,f===void 0?null:f)}function rh(i,s,c,f){var g=Fr();f=f===void 0?null:f;var x=g.memoizedState.inst;sr!==null&&f!==null&&t1(f,sr.memoizedState.deps)?g.memoizedState=dc(s,x,c,f):(xt.flags|=i,g.memoizedState=dc(1|s,x,c,f))}function __(i,s){th(8390656,8,i,s)}function f1(i,s){rh(2048,8,i,s)}function Qk(i){xt.flags|=4;var s=xt.updateQueue;if(s===null)s=J0(),xt.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function y_(i){var s=Fr().memoizedState;return Qk({ref:s,nextImpl:i}),function(){if((Wt&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function T_(i,s){return rh(4,2,i,s)}function w_(i,s){return rh(4,4,i,s)}function E_(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function S_(i,s,c){c=c!=null?c.concat([i]):null,rh(4,4,E_.bind(null,s,i),c)}function h1(){}function A_(i,s){var c=Fr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&t1(s,f[1])?f[0]:(c.memoizedState=[i,s],i)}function b_(i,s){var c=Fr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&t1(s,f[1]))return f[0];if(f=i(),ll){Ke(!0);try{i()}finally{Ke(!1)}}return c.memoizedState=[f,s],f}function d1(i,s,c){return c===void 0||(ts&1073741824)!==0&&(bt&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=k2(),xt.lanes|=i,Qs|=i,c)}function k_(i,s,c,f){return xa(c,s)?c:uc.current!==null?(i=d1(i,c,f),xa(i,s)||(qr=!0),i):(ts&42)===0||(ts&1073741824)!==0&&(bt&261930)===0?(qr=!0,i.memoizedState=c):(i=k2(),xt.lanes|=i,Qs|=i,s)}function C_(i,s,c,f,g){var x=oe.p;oe.p=x!==0&&8>x?x:8;var A=ne.T,B={};ne.T=B,g1(i,!1,s,c);try{var re=g(),de=ne.S;if(de!==null&&de(B,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ee=Xk(re,f);Bu(i,s,Ee,Ea(i))}else Bu(i,s,f,Ea(i))}catch(Ce){Bu(i,s,{then:function(){},status:"rejected",reason:Ce},Ea())}finally{oe.p=x,A!==null&&B.types!==null&&(A.types=B.types),ne.T=A}}function Jk(){}function m1(i,s,c,f){if(i.tag!==5)throw Error(n(476));var g=N_(i).queue;C_(i,g,s,ke,c===null?Jk:function(){return R_(i),c(f)})}function N_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:ke,baseState:ke,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:ke},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function R_(i){var s=N_(i);s.next===null&&(s=i.alternate.memoizedState),Bu(i,s.next.queue,{},Ea())}function p1(){return _n(rf)}function I_(){return Fr().memoizedState}function D_(){return Fr().memoizedState}function Zk(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=Ea();i=qs(c);var f=Xs(s,i,c);f!==null&&(sa(f,s,c),Fu(f,s,c)),s={cache:Gm()},i.payload=s;return}s=s.return}}function e3(i,s,c){var f=Ea();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},nh(i)?F_(s,c):(c=Om(i,s,c,f),c!==null&&(sa(c,i,f),M_(c,s,f)))}function O_(i,s,c){var f=Ea();Bu(i,s,c,f)}function Bu(i,s,c,f){var g={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(nh(i))F_(s,g);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var A=s.lastRenderedState,B=x(A,c);if(g.hasEagerState=!0,g.eagerState=B,xa(B,A))return P0(i,s,g,0),fr===null&&L0(),!1}catch{}if(c=Om(i,s,g,f),c!==null)return sa(c,i,f),M_(c,s,f),!0}return!1}function g1(i,s,c,f){if(f={lane:2,revertLane:K1(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},nh(i)){if(s)throw Error(n(479))}else s=Om(i,c,f,2),s!==null&&sa(s,i,2)}function nh(i){var s=i.alternate;return i===xt||s!==null&&s===xt}function F_(i,s){fc=Y0=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function M_(i,s,c){if((c&4194048)!==0){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,qt(i,c)}}var Uu={readContext:_n,use:Z0,useCallback:br,useContext:br,useEffect:br,useImperativeHandle:br,useLayoutEffect:br,useInsertionEffect:br,useMemo:br,useReducer:br,useRef:br,useState:br,useDebugValue:br,useDeferredValue:br,useTransition:br,useSyncExternalStore:br,useId:br,useHostTransitionStatus:br,useFormState:br,useActionState:br,useOptimistic:br,useMemoCache:br,useCacheRefresh:br};Uu.useEffectEvent=br;var L_={readContext:_n,use:Z0,useCallback:function(i,s){return $n().memoizedState=[i,s===void 0?null:s],i},useContext:_n,useEffect:__,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,th(4194308,4,E_.bind(null,s,i),c)},useLayoutEffect:function(i,s){return th(4194308,4,i,s)},useInsertionEffect:function(i,s){th(4,2,i,s)},useMemo:function(i,s){var c=$n();s=s===void 0?null:s;var f=i();if(ll){Ke(!0);try{i()}finally{Ke(!1)}}return c.memoizedState=[f,s],f},useReducer:function(i,s,c){var f=$n();if(c!==void 0){var g=c(s);if(ll){Ke(!0);try{c(s)}finally{Ke(!1)}}}else g=s;return f.memoizedState=f.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},f.queue=i,i=i.dispatch=e3.bind(null,xt,i),[f.memoizedState,i]},useRef:function(i){var s=$n();return i={current:i},s.memoizedState=i},useState:function(i){i=c1(i);var s=i.queue,c=O_.bind(null,xt,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:h1,useDeferredValue:function(i,s){var c=$n();return d1(c,i,s)},useTransition:function(){var i=c1(!1);return i=C_.bind(null,xt,i.queue,!0,!1),$n().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var f=xt,g=$n();if(Ot){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),fr===null)throw Error(n(349));(bt&127)!==0||n_(f,s,c)}g.memoizedState=c;var x={value:c,getSnapshot:s};return g.queue=x,__(i_.bind(null,f,x,i),[i]),f.flags|=2048,dc(9,{destroy:void 0},a_.bind(null,f,x,c,s),null),c},useId:function(){var i=$n(),s=fr.identifierPrefix;if(Ot){var c=Ri,f=Ni;c=(f&~(1<<32-Ze(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=Q0++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=Wk++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:p1,useFormState:m_,useActionState:m_,useOptimistic:function(i){var s=$n();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=g1.bind(null,xt,!0,c),c.dispatch=s,[i,s]},useMemoCache:s1,useCacheRefresh:function(){return $n().memoizedState=Zk.bind(null,xt)},useEffectEvent:function(i){var s=$n(),c={impl:i};return s.memoizedState=c,function(){if((Wt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},x1={readContext:_n,use:Z0,useCallback:A_,useContext:_n,useEffect:f1,useImperativeHandle:S_,useInsertionEffect:T_,useLayoutEffect:w_,useMemo:b_,useReducer:eh,useRef:v_,useState:function(){return eh(rs)},useDebugValue:h1,useDeferredValue:function(i,s){var c=Fr();return k_(c,sr.memoizedState,i,s)},useTransition:function(){var i=eh(rs)[0],s=Fr().memoizedState;return[typeof i=="boolean"?i:Vu(i),s]},useSyncExternalStore:r_,useId:I_,useHostTransitionStatus:p1,useFormState:p_,useActionState:p_,useOptimistic:function(i,s){var c=Fr();return l_(c,sr,i,s)},useMemoCache:s1,useCacheRefresh:D_};x1.useEffectEvent=y_;var P_={readContext:_n,use:Z0,useCallback:A_,useContext:_n,useEffect:f1,useImperativeHandle:S_,useInsertionEffect:T_,useLayoutEffect:w_,useMemo:b_,useReducer:l1,useRef:v_,useState:function(){return l1(rs)},useDebugValue:h1,useDeferredValue:function(i,s){var c=Fr();return sr===null?d1(c,i,s):k_(c,sr.memoizedState,i,s)},useTransition:function(){var i=l1(rs)[0],s=Fr().memoizedState;return[typeof i=="boolean"?i:Vu(i),s]},useSyncExternalStore:r_,useId:I_,useHostTransitionStatus:p1,useFormState:x_,useActionState:x_,useOptimistic:function(i,s){var c=Fr();return sr!==null?l_(c,sr,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:s1,useCacheRefresh:D_};P_.useEffectEvent=y_;function v1(i,s,c,f){s=i.memoizedState,c=c(f,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var _1={enqueueSetState:function(i,s,c){i=i._reactInternals;var f=Ea(),g=qs(f);g.payload=s,c!=null&&(g.callback=c),s=Xs(i,g,f),s!==null&&(sa(s,i,f),Fu(s,i,f))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var f=Ea(),g=qs(f);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=Xs(i,g,f),s!==null&&(sa(s,i,f),Fu(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=Ea(),f=qs(c);f.tag=2,s!=null&&(f.callback=s),s=Xs(i,f,c),s!==null&&(sa(s,i,c),Fu(s,i,c))}};function V_(i,s,c,f,g,x,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,A):s.prototype&&s.prototype.isPureReactComponent?!bu(c,f)||!bu(g,x):!0}function B_(i,s,c,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==i&&_1.enqueueReplaceState(s,s.state,null)}function cl(i,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}function U_(i){M0(i)}function j_(i){console.error(i)}function z_(i){M0(i)}function ah(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function H_(i,s,c){try{var f=i.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function y1(i,s,c){return c=qs(c),c.tag=3,c.payload={element:null},c.callback=function(){ah(i,s)},c}function G_(i){return i=qs(i),i.tag=3,i}function q_(i,s,c,f){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=f.value;i.payload=function(){return g(x)},i.callback=function(){H_(s,c,f)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){H_(s,c,f),typeof g!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var B=f.stack;this.componentDidCatch(f.value,{componentStack:B!==null?B:""})})}function t3(i,s,c,f,g){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&ic(s,c,g,!0),c=_a.current,c!==null){switch(c.tag){case 31:case 13:return Ua===null?gh():c.alternate===null&&kr===0&&(kr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,f===q0?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),q1(i,f,g)),!1;case 22:return c.flags|=65536,f===q0?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),q1(i,f,g)),!1}throw Error(n(435,c.tag))}return q1(i,f,g),gh(),!1}if(Ot)return s=_a.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,f!==Bm&&(i=Error(n(422),{cause:f}),Nu(La(i,c)))):(f!==Bm&&(s=Error(n(423),{cause:f}),Nu(La(s,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,f=La(f,c),g=y1(i.stateNode,f,g),Ym(i,g),kr!==4&&(kr=2)),!1;var x=Error(n(520),{cause:f});if(x=La(x,c),Ku===null?Ku=[x]:Ku.push(x),kr!==4&&(kr=2),s===null)return!0;f=La(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=y1(c.stateNode,f,i),Ym(c,i),!1;case 1:if(s=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Js===null||!Js.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=G_(g),q_(g,i,c,f),Ym(c,g),!1}c=c.return}while(c!==null);return!1}var T1=Error(n(461)),qr=!1;function yn(i,s,c,f){s.child=i===null?$v(s,null,c,f):ol(s,i.child,c,f)}function X_(i,s,c,f,g){c=c.render;var x=s.ref;if("ref"in f){var A={};for(var B in f)B!=="ref"&&(A[B]=f[B])}else A=f;return nl(s),f=r1(i,s,c,A,x,g),B=n1(),i!==null&&!qr?(a1(i,s,g),ns(i,s,g)):(Ot&&B&&Pm(s),s.flags|=1,yn(i,s,f,g),s.child)}function W_(i,s,c,f,g){if(i===null){var x=c.type;return typeof x=="function"&&!Fm(x)&&x.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=x,K_(i,s,x,f,g)):(i=B0(c.type,null,f,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(x=i.child,!N1(i,g)){var A=x.memoizedProps;if(c=c.compare,c=c!==null?c:bu,c(A,f)&&i.ref===s.ref)return ns(i,s,g)}return s.flags|=1,i=Qi(x,f),i.ref=s.ref,i.return=s,s.child=i}function K_(i,s,c,f,g){if(i!==null){var x=i.memoizedProps;if(bu(x,f)&&i.ref===s.ref)if(qr=!1,s.pendingProps=f=x,N1(i,g))(i.flags&131072)!==0&&(qr=!0);else return s.lanes=i.lanes,ns(i,s,g)}return w1(i,s,c,f,g)}function $_(i,s,c,f){var g=f.children,x=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,i!==null){for(f=s.child=i.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;f=g&~x}else f=0,s.child=null;return Y_(i,s,x,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&H0(s,x!==null?x.cachePool:null),x!==null?Jv(s,x):Jm(),Zv(s);else return f=s.lanes=536870912,Y_(i,s,x!==null?x.baseLanes|c:c,c,f)}else x!==null?(H0(s,x.cachePool),Jv(s,x),Ks(),s.memoizedState=null):(i!==null&&H0(s,null),Jm(),Ks());return yn(i,s,g,c),s.child}function ju(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Y_(i,s,c,f,g){var x=Xm();return x=x===null?null:{parent:Hr._currentValue,pool:x},s.memoizedState={baseLanes:c,cachePool:x},i!==null&&H0(s,null),Jm(),Zv(s),i!==null&&ic(i,s,f,!0),s.childLanes=g,null}function ih(i,s){return s=oh({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function Q_(i,s,c){return ol(s,i.child,null,c),i=ih(s,s.pendingProps),i.flags|=2,ya(s),s.memoizedState=null,i}function r3(i,s,c){var f=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(Ot){if(f.mode==="hidden")return i=ih(s,f),s.lanes=536870912,ju(null,i);if(e1(s),(i=hr)?(i=cy(i,Ba),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Us!==null?{id:Ni,overflow:Ri}:null,retryLane:536870912,hydrationErrors:null},c=Fv(i),c.return=s,s.child=c,vn=s,hr=null)):i=null,i===null)throw zs(s);return s.lanes=536870912,null}return ih(s,f)}var x=i.memoizedState;if(x!==null){var A=x.dehydrated;if(e1(s),g)if(s.flags&256)s.flags&=-257,s=Q_(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(n(558));else if(qr||ic(i,s,c,!1),g=(c&i.childLanes)!==0,qr||g){if(f=fr,f!==null&&(A=Wn(f,c),A!==0&&A!==x.retryLane))throw x.retryLane=A,Zo(i,A),sa(f,i,A),T1;gh(),s=Q_(i,s,c)}else i=x.treeContext,hr=ja(A.nextSibling),vn=s,Ot=!0,js=null,Ba=!1,i!==null&&Pv(s,i),s=ih(s,f),s.flags|=4096;return s}return i=Qi(i.child,{mode:f.mode,children:f.children}),i.ref=s.ref,s.child=i,i.return=s,i}function sh(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function w1(i,s,c,f,g){return nl(s),c=r1(i,s,c,f,void 0,g),f=n1(),i!==null&&!qr?(a1(i,s,g),ns(i,s,g)):(Ot&&f&&Pm(s),s.flags|=1,yn(i,s,c,g),s.child)}function J_(i,s,c,f,g,x){return nl(s),s.updateQueue=null,c=t_(s,f,c,g),e_(i),f=n1(),i!==null&&!qr?(a1(i,s,x),ns(i,s,x)):(Ot&&f&&Pm(s),s.flags|=1,yn(i,s,c,x),s.child)}function Z_(i,s,c,f,g){if(nl(s),s.stateNode===null){var x=tc,A=c.contextType;typeof A=="object"&&A!==null&&(x=_n(A)),x=new c(f,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=_1,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=f,x.state=s.memoizedState,x.refs={},Km(s),A=c.contextType,x.context=typeof A=="object"&&A!==null?_n(A):tc,x.state=s.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(v1(s,c,A,f),x.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(A=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),A!==x.state&&_1.enqueueReplaceState(x,x.state,null),Lu(s,f,x,g),Mu(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){x=s.stateNode;var B=s.memoizedProps,re=cl(c,B);x.props=re;var de=x.context,Ee=c.contextType;A=tc,typeof Ee=="object"&&Ee!==null&&(A=_n(Ee));var Ce=c.getDerivedStateFromProps;Ee=typeof Ce=="function"||typeof x.getSnapshotBeforeUpdate=="function",B=s.pendingProps!==B,Ee||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(B||de!==A)&&B_(s,x,f,A),Gs=!1;var ge=s.memoizedState;x.state=ge,Lu(s,f,x,g),Mu(),de=s.memoizedState,B||ge!==de||Gs?(typeof Ce=="function"&&(v1(s,c,Ce,f),de=s.memoizedState),(re=Gs||V_(s,c,re,f,ge,de,A))?(Ee||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=de),x.props=f,x.state=de,x.context=A,f=re):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{x=s.stateNode,$m(i,s),A=s.memoizedProps,Ee=cl(c,A),x.props=Ee,Ce=s.pendingProps,ge=x.context,de=c.contextType,re=tc,typeof de=="object"&&de!==null&&(re=_n(de)),B=c.getDerivedStateFromProps,(de=typeof B=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==Ce||ge!==re)&&B_(s,x,f,re),Gs=!1,ge=s.memoizedState,x.state=ge,Lu(s,f,x,g),Mu();var ve=s.memoizedState;A!==Ce||ge!==ve||Gs||i!==null&&i.dependencies!==null&&j0(i.dependencies)?(typeof B=="function"&&(v1(s,c,B,f),ve=s.memoizedState),(Ee=Gs||V_(s,c,Ee,f,ge,ve,re)||i!==null&&i.dependencies!==null&&j0(i.dependencies))?(de||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,ve,re),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,ve,re)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=ve),x.props=f,x.state=ve,x.context=re,f=Ee):(typeof x.componentDidUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=1024),f=!1)}return x=f,sh(i,s),f=(s.flags&128)!==0,x||f?(x=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,i!==null&&f?(s.child=ol(s,i.child,null,g),s.child=ol(s,null,c,g)):yn(i,s,c,g),s.memoizedState=x.state,i=s.child):i=ns(i,s,g),i}function e2(i,s,c,f){return tl(),s.flags|=256,yn(i,s,c,f),s.child}var E1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function S1(i){return{baseLanes:i,cachePool:Hv()}}function A1(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=wa),i}function t2(i,s,c){var f=s.pendingProps,g=!1,x=(s.flags&128)!==0,A;if((A=x)||(A=i!==null&&i.memoizedState===null?!1:(Or.current&2)!==0),A&&(g=!0,s.flags&=-129),A=(s.flags&32)!==0,s.flags&=-33,i===null){if(Ot){if(g?Ws(s):Ks(),(i=hr)?(i=cy(i,Ba),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Us!==null?{id:Ni,overflow:Ri}:null,retryLane:536870912,hydrationErrors:null},c=Fv(i),c.return=s,s.child=c,vn=s,hr=null)):i=null,i===null)throw zs(s);return op(i)?s.lanes=32:s.lanes=536870912,null}var B=f.children;return f=f.fallback,g?(Ks(),g=s.mode,B=oh({mode:"hidden",children:B},g),f=el(f,g,c,null),B.return=s,f.return=s,B.sibling=f,s.child=B,f=s.child,f.memoizedState=S1(c),f.childLanes=A1(i,A,c),s.memoizedState=E1,ju(null,f)):(Ws(s),b1(s,B))}var re=i.memoizedState;if(re!==null&&(B=re.dehydrated,B!==null)){if(x)s.flags&256?(Ws(s),s.flags&=-257,s=k1(i,s,c)):s.memoizedState!==null?(Ks(),s.child=i.child,s.flags|=128,s=null):(Ks(),B=f.fallback,g=s.mode,f=oh({mode:"visible",children:f.children},g),B=el(B,g,c,null),B.flags|=2,f.return=s,B.return=s,f.sibling=B,s.child=f,ol(s,i.child,null,c),f=s.child,f.memoizedState=S1(c),f.childLanes=A1(i,A,c),s.memoizedState=E1,s=ju(null,f));else if(Ws(s),op(B)){if(A=B.nextSibling&&B.nextSibling.dataset,A)var de=A.dgst;A=de,f=Error(n(419)),f.stack="",f.digest=A,Nu({value:f,source:null,stack:null}),s=k1(i,s,c)}else if(qr||ic(i,s,c,!1),A=(c&i.childLanes)!==0,qr||A){if(A=fr,A!==null&&(f=Wn(A,c),f!==0&&f!==re.retryLane))throw re.retryLane=f,Zo(i,f),sa(A,i,f),T1;sp(B)||gh(),s=k1(i,s,c)}else sp(B)?(s.flags|=192,s.child=i.child,s=null):(i=re.treeContext,hr=ja(B.nextSibling),vn=s,Ot=!0,js=null,Ba=!1,i!==null&&Pv(s,i),s=b1(s,f.children),s.flags|=4096);return s}return g?(Ks(),B=f.fallback,g=s.mode,re=i.child,de=re.sibling,f=Qi(re,{mode:"hidden",children:f.children}),f.subtreeFlags=re.subtreeFlags&65011712,de!==null?B=Qi(de,B):(B=el(B,g,c,null),B.flags|=2),B.return=s,f.return=s,f.sibling=B,s.child=f,ju(null,f),f=s.child,B=i.child.memoizedState,B===null?B=S1(c):(g=B.cachePool,g!==null?(re=Hr._currentValue,g=g.parent!==re?{parent:re,pool:re}:g):g=Hv(),B={baseLanes:B.baseLanes|c,cachePool:g}),f.memoizedState=B,f.childLanes=A1(i,A,c),s.memoizedState=E1,ju(i.child,f)):(Ws(s),c=i.child,i=c.sibling,c=Qi(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,i!==null&&(A=s.deletions,A===null?(s.deletions=[i],s.flags|=16):A.push(i)),s.child=c,s.memoizedState=null,c)}function b1(i,s){return s=oh({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function oh(i,s){return i=va(22,i,null,s),i.lanes=0,i}function k1(i,s,c){return ol(s,i.child,null,c),i=b1(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function r2(i,s,c){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),zm(i.return,s,c)}function C1(i,s,c,f,g,x){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:g,treeForkCount:x}:(A.isBackwards=s,A.rendering=null,A.renderingStartTime=0,A.last=f,A.tail=c,A.tailMode=g,A.treeForkCount=x)}function n2(i,s,c){var f=s.pendingProps,g=f.revealOrder,x=f.tail;f=f.children;var A=Or.current,B=(A&2)!==0;if(B?(A=A&1|2,s.flags|=128):A&=1,W(Or,A),yn(i,s,f,c),f=Ot?Cu:0,!B&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&r2(i,c,s);else if(i.tag===19)r2(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&$0(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),C1(s,!1,g,c,x,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&$0(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}C1(s,!0,c,null,x,f);break;case"together":C1(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function ns(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Qs|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(ic(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,c=Qi(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Qi(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function N1(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&j0(i)))}function n3(i,s,c){switch(s.tag){case 3:Ne(s,s.stateNode.containerInfo),Hs(s,Hr,i.memoizedState.cache),tl();break;case 27:case 5:Ie(s);break;case 4:Ne(s,s.stateNode.containerInfo);break;case 10:Hs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,e1(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Ws(s),s.flags|=128,null):(c&s.child.childLanes)!==0?t2(i,s,c):(Ws(s),i=ns(i,s,c),i!==null?i.sibling:null);Ws(s);break;case 19:var g=(i.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(ic(i,s,c,!1),f=(c&s.childLanes)!==0),g){if(f)return n2(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),W(Or,Or.current),f)break;return null;case 22:return s.lanes=0,$_(i,s,c,s.pendingProps);case 24:Hs(s,Hr,i.memoizedState.cache)}return ns(i,s,c)}function a2(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)qr=!0;else{if(!N1(i,c)&&(s.flags&128)===0)return qr=!1,n3(i,s,c);qr=(i.flags&131072)!==0}else qr=!1,Ot&&(s.flags&1048576)!==0&&Lv(s,Cu,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(i=il(s.elementType),s.type=i,typeof i=="function")Fm(i)?(f=cl(i,f),s.tag=1,s=Z_(null,s,i,f,c)):(s.tag=0,s=w1(null,s,i,f,c));else{if(i!=null){var g=i.$$typeof;if(g===K){s.tag=11,s=X_(null,s,i,f,c);break e}else if(g===k){s.tag=14,s=W_(null,s,i,f,c);break e}}throw s=_e(i)||i,Error(n(306,s,""))}}return s;case 0:return w1(i,s,s.type,s.pendingProps,c);case 1:return f=s.type,g=cl(f,s.pendingProps),Z_(i,s,f,g,c);case 3:e:{if(Ne(s,s.stateNode.containerInfo),i===null)throw Error(n(387));f=s.pendingProps;var x=s.memoizedState;g=x.element,$m(i,s),Lu(s,f,null,c);var A=s.memoizedState;if(f=A.cache,Hs(s,Hr,f),f!==x.cache&&Hm(s,[Hr],c,!0),Mu(),f=A.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:A.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=e2(i,s,f,c);break e}else if(f!==g){g=La(Error(n(424)),s),Nu(g),s=e2(i,s,f,c);break e}else for(i=s.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,hr=ja(i.firstChild),vn=s,Ot=!0,js=null,Ba=!0,c=$v(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(tl(),f===g){s=ns(i,s,c);break e}yn(i,s,f,c)}s=s.child}return s;case 26:return sh(i,s),i===null?(c=py(s.type,null,s.pendingProps,null))?s.memoizedState=c:Ot||(c=s.type,i=s.pendingProps,f=Eh(le.current).createElement(c),f[H]=s,f[q]=i,Tn(f,c,i),Ye(f),s.stateNode=f):s.memoizedState=py(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Ie(s),i===null&&Ot&&(f=s.stateNode=hy(s.type,s.pendingProps,le.current),vn=s,Ba=!0,g=hr,ro(s.type)?(lp=g,hr=ja(f.firstChild)):hr=g),yn(i,s,s.pendingProps.children,c),sh(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Ot&&((g=f=hr)&&(f=O3(f,s.type,s.pendingProps,Ba),f!==null?(s.stateNode=f,vn=s,hr=ja(f.firstChild),Ba=!1,g=!0):g=!1),g||zs(s)),Ie(s),g=s.type,x=s.pendingProps,A=i!==null?i.memoizedProps:null,f=x.children,np(g,x)?f=null:A!==null&&np(g,A)&&(s.flags|=32),s.memoizedState!==null&&(g=r1(i,s,Kk,null,null,c),rf._currentValue=g),sh(i,s),yn(i,s,f,c),s.child;case 6:return i===null&&Ot&&((i=c=hr)&&(c=F3(c,s.pendingProps,Ba),c!==null?(s.stateNode=c,vn=s,hr=null,i=!0):i=!1),i||zs(s)),null;case 13:return t2(i,s,c);case 4:return Ne(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=ol(s,null,f,c):yn(i,s,f,c),s.child;case 11:return X_(i,s,s.type,s.pendingProps,c);case 7:return yn(i,s,s.pendingProps,c),s.child;case 8:return yn(i,s,s.pendingProps.children,c),s.child;case 12:return yn(i,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,Hs(s,s.type,f.value),yn(i,s,f.children,c),s.child;case 9:return g=s.type._context,f=s.pendingProps.children,nl(s),g=_n(g),f=f(g),s.flags|=1,yn(i,s,f,c),s.child;case 14:return W_(i,s,s.type,s.pendingProps,c);case 15:return K_(i,s,s.type,s.pendingProps,c);case 19:return n2(i,s,c);case 31:return r3(i,s,c);case 22:return $_(i,s,c,s.pendingProps);case 24:return nl(s),f=_n(Hr),i===null?(g=Xm(),g===null&&(g=fr,x=Gm(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),s.memoizedState={parent:f,cache:g},Km(s),Hs(s,Hr,g)):((i.lanes&c)!==0&&($m(i,s),Lu(s,null,null,c),Mu()),g=i.memoizedState,x=s.memoizedState,g.parent!==f?(g={parent:f,cache:f},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Hs(s,Hr,f)):(f=x.cache,Hs(s,Hr,f),f!==g.cache&&Hm(s,[Hr],c,!0))),yn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function as(i){i.flags|=4}function R1(i,s,c,f,g){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(I2())i.flags|=8192;else throw sl=q0,Wm}else i.flags&=-16777217}function i2(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!yy(s))if(I2())i.flags|=8192;else throw sl=q0,Wm}function lh(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Ti():536870912,i.lanes|=s,xc|=s)}function zu(i,s){if(!Ot)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function dr(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=c,s}function a3(i,s,c){var f=s.pendingProps;switch(Vm(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(s),null;case 1:return dr(s),null;case 3:return c=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),es(Hr),Ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(ac(s)?as(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Um())),dr(s),null;case 26:var g=s.type,x=s.memoizedState;return i===null?(as(s),x!==null?(dr(s),i2(s,x)):(dr(s),R1(s,g,null,f,c))):x?x!==i.memoizedState?(as(s),dr(s),i2(s,x)):(dr(s),s.flags&=-16777217):(i=i.memoizedProps,i!==f&&as(s),dr(s),R1(s,g,i,f,c)),null;case 27:if(nt(s),c=le.current,g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&as(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return dr(s),null}i=G.current,ac(s)?Vv(s):(i=hy(g,f,c),s.stateNode=i,as(s))}return dr(s),null;case 5:if(nt(s),g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&as(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return dr(s),null}if(x=G.current,ac(s))Vv(s);else{var A=Eh(le.current);switch(x){case 1:x=A.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:x=A.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":x=A.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":x=A.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":x=A.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof f.is=="string"?A.createElement("select",{is:f.is}):A.createElement("select"),f.multiple?x.multiple=!0:f.size&&(x.size=f.size);break;default:x=typeof f.is=="string"?A.createElement(g,{is:f.is}):A.createElement(g)}}x[H]=s,x[q]=f;e:for(A=s.child;A!==null;){if(A.tag===5||A.tag===6)x.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===s)break e;for(;A.sibling===null;){if(A.return===null||A.return===s)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}s.stateNode=x;e:switch(Tn(x,g,f),g){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&as(s)}}return dr(s),R1(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&as(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(i=le.current,ac(s)){if(i=s.stateNode,c=s.memoizedProps,f=null,g=vn,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}i[H]=s,i=!!(i.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||ty(i.nodeValue,c)),i||zs(s,!0)}else i=Eh(i).createTextNode(f),i[H]=s,s.stateNode=i}return dr(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(f=ac(s),c!==null){if(i===null){if(!f)throw Error(n(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[H]=s}else tl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;dr(s),i=!1}else c=Um(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(ya(s),s):(ya(s),null);if((s.flags&128)!==0)throw Error(n(558))}return dr(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=ac(s),f!==null&&f.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[H]=s}else tl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;dr(s),g=!1}else g=Um(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(ya(s),s):(ya(s),null)}return ya(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,i=i!==null&&i.memoizedState!==null,c&&(f=s.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==g&&(f.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),lh(s,s.updateQueue),dr(s),null);case 4:return Ae(),i===null&&J1(s.stateNode.containerInfo),dr(s),null;case 10:return es(s.type),dr(s),null;case 19:if(L(Or),f=s.memoizedState,f===null)return dr(s),null;if(g=(s.flags&128)!==0,x=f.rendering,x===null)if(g)zu(f,!1);else{if(kr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(x=$0(i),x!==null){for(s.flags|=128,zu(f,!1),i=x.updateQueue,s.updateQueue=i,lh(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Ov(c,i),c=c.sibling;return W(Or,Or.current&1|2),Ot&&Ji(s,f.treeForkCount),s.child}i=i.sibling}f.tail!==null&&Lt()>dh&&(s.flags|=128,g=!0,zu(f,!1),s.lanes=4194304)}else{if(!g)if(i=$0(x),i!==null){if(s.flags|=128,g=!0,i=i.updateQueue,s.updateQueue=i,lh(s,i),zu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!Ot)return dr(s),null}else 2*Lt()-f.renderingStartTime>dh&&c!==536870912&&(s.flags|=128,g=!0,zu(f,!1),s.lanes=4194304);f.isBackwards?(x.sibling=s.child,s.child=x):(i=f.last,i!==null?i.sibling=x:s.child=x,f.last=x)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Lt(),i.sibling=null,c=Or.current,W(Or,g?c&1|2:c&1),Ot&&Ji(s,f.treeForkCount),i):(dr(s),null);case 22:case 23:return ya(s),Zm(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(dr(s),s.subtreeFlags&6&&(s.flags|=8192)):dr(s),c=s.updateQueue,c!==null&&lh(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),i!==null&&L(al),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),es(Hr),dr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function i3(i,s){switch(Vm(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return es(Hr),Ae(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return nt(s),null;case 31:if(s.memoizedState!==null){if(ya(s),s.alternate===null)throw Error(n(340));tl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(ya(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));tl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return L(Or),null;case 4:return Ae(),null;case 10:return es(s.type),null;case 22:case 23:return ya(s),Zm(),i!==null&&L(al),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return es(Hr),null;case 25:return null;default:return null}}function s2(i,s){switch(Vm(s),s.tag){case 3:es(Hr),Ae();break;case 26:case 27:case 5:nt(s);break;case 4:Ae();break;case 31:s.memoizedState!==null&&ya(s);break;case 13:ya(s);break;case 19:L(Or);break;case 10:es(s.type);break;case 22:case 23:ya(s),Zm(),i!==null&&L(al);break;case 24:es(Hr)}}function Hu(i,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&i)===i){f=void 0;var x=c.create,A=c.inst;f=x(),A.destroy=f}c=c.next}while(c!==g)}}catch(B){er(s,s.return,B)}}function $s(i,s,c){try{var f=s.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&i)===i){var A=f.inst,B=A.destroy;if(B!==void 0){A.destroy=void 0,g=s;var re=c,de=B;try{de()}catch(Ee){er(g,re,Ee)}}}f=f.next}while(f!==x)}}catch(Ee){er(s,s.return,Ee)}}function o2(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{Qv(s,c)}catch(f){er(i,i.return,f)}}}function l2(i,s,c){c.props=cl(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(f){er(i,s,f)}}function Gu(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof c=="function"?i.refCleanup=c(f):c.current=f}}catch(g){er(i,s,g)}}function Ii(i,s){var c=i.ref,f=i.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(g){er(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){er(i,s,g)}else c.current=null}function c2(i){var s=i.type,c=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(g){er(i,i.return,g)}}function I1(i,s,c){try{var f=i.stateNode;k3(f,i.type,c,s),f[q]=s}catch(g){er(i,i.return,g)}}function u2(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ro(i.type)||i.tag===4}function D1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||u2(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ro(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function O1(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=ai));else if(f!==4&&(f===27&&ro(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(O1(i,s,c),i=i.sibling;i!==null;)O1(i,s,c),i=i.sibling}function ch(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(f!==4&&(f===27&&ro(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(ch(i,s,c),i=i.sibling;i!==null;)ch(i,s,c),i=i.sibling}function f2(i){var s=i.stateNode,c=i.memoizedProps;try{for(var f=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Tn(s,f,c),s[H]=i,s[q]=c}catch(x){er(i,i.return,x)}}var is=!1,Xr=!1,F1=!1,h2=typeof WeakSet=="function"?WeakSet:Set,fn=null;function s3(i,s){if(i=i.containerInfo,tp=Rh,i=Sv(i),km(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var g=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var A=0,B=-1,re=-1,de=0,Ee=0,Ce=i,ge=null;t:for(;;){for(var ve;Ce!==c||g!==0&&Ce.nodeType!==3||(B=A+g),Ce!==x||f!==0&&Ce.nodeType!==3||(re=A+f),Ce.nodeType===3&&(A+=Ce.nodeValue.length),(ve=Ce.firstChild)!==null;)ge=Ce,Ce=ve;for(;;){if(Ce===i)break t;if(ge===c&&++de===g&&(B=A),ge===x&&++Ee===f&&(re=A),(ve=Ce.nextSibling)!==null)break;Ce=ge,ge=Ce.parentNode}Ce=ve}c=B===-1||re===-1?null:{start:B,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(rp={focusedElem:i,selectionRange:c},Rh=!1,fn=s;fn!==null;)if(s=fn,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,fn=i;else for(;fn!==null;){switch(s=fn,x=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)g=i[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,c=s,g=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var $e=cl(c.type,g);i=f.getSnapshotBeforeUpdate($e,x),f.__reactInternalSnapshotBeforeUpdate=i}catch(it){er(c,c.return,it)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)ip(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":ip(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,fn=i;break}fn=s.return}}function d2(i,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:os(i,c),f&4&&Hu(5,c);break;case 1:if(os(i,c),f&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(A){er(c,c.return,A)}else{var g=cl(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(A){er(c,c.return,A)}}f&64&&o2(c),f&512&&Gu(c,c.return);break;case 3:if(os(i,c),f&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Qv(i,s)}catch(A){er(c,c.return,A)}}break;case 27:s===null&&f&4&&f2(c);case 26:case 5:os(i,c),s===null&&f&4&&c2(c),f&512&&Gu(c,c.return);break;case 12:os(i,c);break;case 31:os(i,c),f&4&&g2(i,c);break;case 13:os(i,c),f&4&&x2(i,c),f&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=p3.bind(null,c),M3(i,c))));break;case 22:if(f=c.memoizedState!==null||is,!f){s=s!==null&&s.memoizedState!==null||Xr,g=is;var x=Xr;is=f,(Xr=s)&&!x?ls(i,c,(c.subtreeFlags&8772)!==0):os(i,c),is=g,Xr=x}break;case 30:break;default:os(i,c)}}function m2(i){var s=i.alternate;s!==null&&(i.alternate=null,m2(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Pe(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Tr=null,ra=!1;function ss(i,s,c){for(c=c.child;c!==null;)p2(i,s,c),c=c.sibling}function p2(i,s,c){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Re,c)}catch{}switch(c.tag){case 26:Xr||Ii(c,s),ss(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Xr||Ii(c,s);var f=Tr,g=ra;ro(c.type)&&(Tr=c.stateNode,ra=!1),ss(i,s,c),Zu(c.stateNode),Tr=f,ra=g;break;case 5:Xr||Ii(c,s);case 6:if(f=Tr,g=ra,Tr=null,ss(i,s,c),Tr=f,ra=g,Tr!==null)if(ra)try{(Tr.nodeType===9?Tr.body:Tr.nodeName==="HTML"?Tr.ownerDocument.body:Tr).removeChild(c.stateNode)}catch(x){er(c,s,x)}else try{Tr.removeChild(c.stateNode)}catch(x){er(c,s,x)}break;case 18:Tr!==null&&(ra?(i=Tr,oy(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Ac(i)):oy(Tr,c.stateNode));break;case 4:f=Tr,g=ra,Tr=c.stateNode.containerInfo,ra=!0,ss(i,s,c),Tr=f,ra=g;break;case 0:case 11:case 14:case 15:$s(2,c,s),Xr||$s(4,c,s),ss(i,s,c);break;case 1:Xr||(Ii(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&l2(c,s,f)),ss(i,s,c);break;case 21:ss(i,s,c);break;case 22:Xr=(f=Xr)||c.memoizedState!==null,ss(i,s,c),Xr=f;break;default:ss(i,s,c)}}function g2(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Ac(i)}catch(c){er(s,s.return,c)}}}function x2(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Ac(i)}catch(c){er(s,s.return,c)}}function o3(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new h2),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new h2),s;default:throw Error(n(435,i.tag))}}function uh(i,s){var c=o3(i);s.forEach(function(f){if(!c.has(f)){c.add(f);var g=g3.bind(null,i,f);f.then(g,g)}})}function na(i,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var g=c[f],x=i,A=s,B=A;e:for(;B!==null;){switch(B.tag){case 27:if(ro(B.type)){Tr=B.stateNode,ra=!1;break e}break;case 5:Tr=B.stateNode,ra=!1;break e;case 3:case 4:Tr=B.stateNode.containerInfo,ra=!0;break e}B=B.return}if(Tr===null)throw Error(n(160));p2(x,A,g),Tr=null,ra=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)v2(s,i),s=s.sibling}var ui=null;function v2(i,s){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:na(s,i),aa(i),f&4&&($s(3,i,i.return),Hu(3,i),$s(5,i,i.return));break;case 1:na(s,i),aa(i),f&512&&(Xr||c===null||Ii(c,c.return)),f&64&&is&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var g=ui;if(na(s,i),aa(i),f&512&&(Xr||c===null||Ii(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=i.memoizedState,c===null)if(f===null)if(i.stateNode===null){e:{f=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":x=g.getElementsByTagName("title")[0],(!x||x[me]||x[H]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(f),g.head.insertBefore(x,g.querySelector("head > title"))),Tn(x,f,c),x[H]=i,Ye(x),f=x;break e;case"link":var A=vy("link","href",g).get(f+(c.href||""));if(A){for(var B=0;B<A.length;B++)if(x=A[B],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(B,1);break t}}x=g.createElement(f),Tn(x,f,c),g.head.appendChild(x);break;case"meta":if(A=vy("meta","content",g).get(f+(c.content||""))){for(B=0;B<A.length;B++)if(x=A[B],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(B,1);break t}}x=g.createElement(f),Tn(x,f,c),g.head.appendChild(x);break;default:throw Error(n(468,f))}x[H]=i,Ye(x),f=x}i.stateNode=f}else _y(g,i.type,i.stateNode);else i.stateNode=xy(g,f,i.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?_y(g,i.type,i.stateNode):xy(g,f,i.memoizedProps)):f===null&&i.stateNode!==null&&I1(i,i.memoizedProps,c.memoizedProps)}break;case 27:na(s,i),aa(i),f&512&&(Xr||c===null||Ii(c,c.return)),c!==null&&f&4&&I1(i,i.memoizedProps,c.memoizedProps);break;case 5:if(na(s,i),aa(i),f&512&&(Xr||c===null||Ii(c,c.return)),i.flags&32){g=i.stateNode;try{ta(g,"")}catch($e){er(i,i.return,$e)}}f&4&&i.stateNode!=null&&(g=i.memoizedProps,I1(i,g,c!==null?c.memoizedProps:g)),f&1024&&(F1=!0);break;case 6:if(na(s,i),aa(i),f&4){if(i.stateNode===null)throw Error(n(162));f=i.memoizedProps,c=i.stateNode;try{c.nodeValue=f}catch($e){er(i,i.return,$e)}}break;case 3:if(bh=null,g=ui,ui=Sh(s.containerInfo),na(s,i),ui=g,aa(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Ac(s.containerInfo)}catch($e){er(i,i.return,$e)}F1&&(F1=!1,_2(i));break;case 4:f=ui,ui=Sh(i.stateNode.containerInfo),na(s,i),aa(i),ui=f;break;case 12:na(s,i),aa(i);break;case 31:na(s,i),aa(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,uh(i,f)));break;case 13:na(s,i),aa(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(hh=Lt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,uh(i,f)));break;case 22:g=i.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,de=is,Ee=Xr;if(is=de||g,Xr=Ee||re,na(s,i),Xr=Ee,is=de,aa(i),f&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||re||is||Xr||ul(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){re=c=s;try{if(x=re.stateNode,g)A=x.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{B=re.stateNode;var Ce=re.memoizedProps.style,ge=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;B.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch($e){er(re,re.return,$e)}}}else if(s.tag===6){if(c===null){re=s;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch($e){er(re,re.return,$e)}}}else if(s.tag===18){if(c===null){re=s;try{var ve=re.stateNode;g?ly(ve,!0):ly(re.stateNode,!1)}catch($e){er(re,re.return,$e)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,uh(i,c))));break;case 19:na(s,i),aa(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,uh(i,f)));break;case 30:break;case 21:break;default:na(s,i),aa(i)}}function aa(i){var s=i.flags;if(s&2){try{for(var c,f=i.return;f!==null;){if(u2(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,x=D1(i);ch(i,x,g);break;case 5:var A=c.stateNode;c.flags&32&&(ta(A,""),c.flags&=-33);var B=D1(i);ch(i,B,A);break;case 3:case 4:var re=c.stateNode.containerInfo,de=D1(i);O1(i,de,re);break;default:throw Error(n(161))}}catch(Ee){er(i,i.return,Ee)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function _2(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;_2(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function os(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)d2(i,s.alternate,s),s=s.sibling}function ul(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:$s(4,s,s.return),ul(s);break;case 1:Ii(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&l2(s,s.return,c),ul(s);break;case 27:Zu(s.stateNode);case 26:case 5:Ii(s,s.return),ul(s);break;case 22:s.memoizedState===null&&ul(s);break;case 30:ul(s);break;default:ul(s)}i=i.sibling}}function ls(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,g=i,x=s,A=x.flags;switch(x.tag){case 0:case 11:case 15:ls(g,x,c),Hu(4,x);break;case 1:if(ls(g,x,c),f=x,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(de){er(f,f.return,de)}if(f=x,g=f.updateQueue,g!==null){var B=f.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)Yv(re[g],B)}catch(de){er(f,f.return,de)}}c&&A&64&&o2(x),Gu(x,x.return);break;case 27:f2(x);case 26:case 5:ls(g,x,c),c&&f===null&&A&4&&c2(x),Gu(x,x.return);break;case 12:ls(g,x,c);break;case 31:ls(g,x,c),c&&A&4&&g2(g,x);break;case 13:ls(g,x,c),c&&A&4&&x2(g,x);break;case 22:x.memoizedState===null&&ls(g,x,c),Gu(x,x.return);break;case 30:break;default:ls(g,x,c)}s=s.sibling}}function M1(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Ru(c))}function L1(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Ru(i))}function fi(i,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)y2(i,s,c,f),s=s.sibling}function y2(i,s,c,f){var g=s.flags;switch(s.tag){case 0:case 11:case 15:fi(i,s,c,f),g&2048&&Hu(9,s);break;case 1:fi(i,s,c,f);break;case 3:fi(i,s,c,f),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Ru(i)));break;case 12:if(g&2048){fi(i,s,c,f),i=s.stateNode;try{var x=s.memoizedProps,A=x.id,B=x.onPostCommit;typeof B=="function"&&B(A,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(re){er(s,s.return,re)}}else fi(i,s,c,f);break;case 31:fi(i,s,c,f);break;case 13:fi(i,s,c,f);break;case 23:break;case 22:x=s.stateNode,A=s.alternate,s.memoizedState!==null?x._visibility&2?fi(i,s,c,f):qu(i,s):x._visibility&2?fi(i,s,c,f):(x._visibility|=2,mc(i,s,c,f,(s.subtreeFlags&10256)!==0||!1)),g&2048&&M1(A,s);break;case 24:fi(i,s,c,f),g&2048&&L1(s.alternate,s);break;default:fi(i,s,c,f)}}function mc(i,s,c,f,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var x=i,A=s,B=c,re=f,de=A.flags;switch(A.tag){case 0:case 11:case 15:mc(x,A,B,re,g),Hu(8,A);break;case 23:break;case 22:var Ee=A.stateNode;A.memoizedState!==null?Ee._visibility&2?mc(x,A,B,re,g):qu(x,A):(Ee._visibility|=2,mc(x,A,B,re,g)),g&&de&2048&&M1(A.alternate,A);break;case 24:mc(x,A,B,re,g),g&&de&2048&&L1(A.alternate,A);break;default:mc(x,A,B,re,g)}s=s.sibling}}function qu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,f=s,g=f.flags;switch(f.tag){case 22:qu(c,f),g&2048&&M1(f.alternate,f);break;case 24:qu(c,f),g&2048&&L1(f.alternate,f);break;default:qu(c,f)}s=s.sibling}}var Xu=8192;function pc(i,s,c){if(i.subtreeFlags&Xu)for(i=i.child;i!==null;)T2(i,s,c),i=i.sibling}function T2(i,s,c){switch(i.tag){case 26:pc(i,s,c),i.flags&Xu&&i.memoizedState!==null&&W3(c,ui,i.memoizedState,i.memoizedProps);break;case 5:pc(i,s,c);break;case 3:case 4:var f=ui;ui=Sh(i.stateNode.containerInfo),pc(i,s,c),ui=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=Xu,Xu=16777216,pc(i,s,c),Xu=f):pc(i,s,c));break;default:pc(i,s,c)}}function w2(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Wu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];fn=f,S2(f,i)}w2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)E2(i),i=i.sibling}function E2(i){switch(i.tag){case 0:case 11:case 15:Wu(i),i.flags&2048&&$s(9,i,i.return);break;case 3:Wu(i);break;case 12:Wu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,fh(i)):Wu(i);break;default:Wu(i)}}function fh(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];fn=f,S2(f,i)}w2(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:$s(8,s,s.return),fh(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,fh(s));break;default:fh(s)}i=i.sibling}}function S2(i,s){for(;fn!==null;){var c=fn;switch(c.tag){case 0:case 11:case 15:$s(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ru(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,fn=f;else e:for(c=i;fn!==null;){f=fn;var g=f.sibling,x=f.return;if(m2(f),f===c){fn=null;break e}if(g!==null){g.return=x,fn=g;break e}fn=x}}}var l3={getCacheForType:function(i){var s=_n(Hr),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return _n(Hr).controller.signal}},c3=typeof WeakMap=="function"?WeakMap:Map,Wt=0,fr=null,St=null,bt=0,Zt=0,Ta=null,Ys=!1,gc=!1,P1=!1,cs=0,kr=0,Qs=0,fl=0,V1=0,wa=0,xc=0,Ku=null,ia=null,B1=!1,hh=0,A2=0,dh=1/0,mh=null,Js=null,rn=0,Zs=null,vc=null,us=0,U1=0,j1=null,b2=null,$u=0,z1=null;function Ea(){return(Wt&2)!==0&&bt!==0?bt&-bt:ne.T!==null?K1():P()}function k2(){if(wa===0)if((bt&536870912)===0||Ot){var i=Zn;Zn<<=1,(Zn&3932160)===0&&(Zn=262144),wa=i}else wa=536870912;return i=_a.current,i!==null&&(i.flags|=32),wa}function sa(i,s,c){(i===fr&&(Zt===2||Zt===9)||i.cancelPendingCommit!==null)&&(_c(i,0),eo(i,bt,wa,!1)),ei(i,c),((Wt&2)===0||i!==fr)&&(i===fr&&((Wt&2)===0&&(fl|=c),kr===4&&eo(i,bt,wa,!1)),Di(i))}function C2(i,s,c){if((Wt&6)!==0)throw Error(n(327));var f=!c&&(s&127)===0&&(s&i.expiredLanes)===0||tn(i,s),g=f?h3(i,s):G1(i,s,!0),x=f;do{if(g===0){gc&&!f&&eo(i,s,0,!1);break}else{if(c=i.current.alternate,x&&!u3(c)){g=G1(i,s,!1),x=!1;continue}if(g===2){if(x=s,i.errorRecoveryDisabledLanes&x)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){s=A;e:{var B=i;g=Ku;var re=B.current.memoizedState.isDehydrated;if(re&&(_c(B,A).flags|=256),A=G1(B,A,!1),A!==2){if(P1&&!re){B.errorRecoveryDisabledLanes|=x,fl|=x,g=4;break e}x=ia,ia=g,x!==null&&(ia===null?ia=x:ia.push.apply(ia,x))}g=A}if(x=!1,g!==2)continue}}if(g===1){_c(i,0),eo(i,s,0,!0);break}e:{switch(f=i,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:eo(f,s,wa,!Ys);break e;case 2:ia=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(g=hh+300-Lt(),10<g)){if(eo(f,s,wa,!Ys),wr(f,0,!0)!==0)break e;us=s,f.timeoutHandle=iy(N2.bind(null,f,c,ia,mh,B1,s,wa,fl,xc,Ys,x,"Throttled",-0,0),g);break e}N2(f,c,ia,mh,B1,s,wa,fl,xc,Ys,x,null,-0,0)}}break}while(!0);Di(i)}function N2(i,s,c,f,g,x,A,B,re,de,Ee,Ce,ge,ve){if(i.timeoutHandle=-1,Ce=s.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ai},T2(s,x,Ce);var $e=(x&62914560)===x?hh-Lt():(x&4194048)===x?A2-Lt():0;if($e=K3(Ce,$e),$e!==null){us=x,i.cancelPendingCommit=$e(P2.bind(null,i,s,x,c,f,g,A,B,re,Ee,Ce,null,ge,ve)),eo(i,x,A,!de);return}}P2(i,s,x,c,f,g,A,B,re)}function u3(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var g=c[f],x=g.getSnapshot;g=g.value;try{if(!xa(x(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function eo(i,s,c,f){s&=~V1,s&=~fl,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var g=s;0<g;){var x=31-Ze(g),A=1<<x;f[x]=-1,g&=~A}c!==0&&ti(i,c,s)}function ph(){return(Wt&6)===0?(Yu(0),!1):!0}function H1(){if(St!==null){if(Zt===0)var i=St.return;else i=St,Zi=rl=null,i1(i),cc=null,Du=0,i=St;for(;i!==null;)s2(i.alternate,i),i=i.return;St=null}}function _c(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,R3(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),us=0,H1(),fr=i,St=c=Qi(i.current,null),bt=s,Zt=0,Ta=null,Ys=!1,gc=tn(i,s),P1=!1,xc=wa=V1=fl=Qs=kr=0,ia=Ku=null,B1=!1,(s&8)!==0&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var g=31-Ze(f),x=1<<g;s|=i[g],f&=~x}return cs=s,L0(),c}function R2(i,s){xt=null,ne.H=Uu,s===lc||s===G0?(s=Xv(),Zt=3):s===Wm?(s=Xv(),Zt=4):Zt=s===T1?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Ta=s,St===null&&(kr=1,ah(i,La(s,i.current)))}function I2(){var i=_a.current;return i===null?!0:(bt&4194048)===bt?Ua===null:(bt&62914560)===bt||(bt&536870912)!==0?i===Ua:!1}function D2(){var i=ne.H;return ne.H=Uu,i===null?Uu:i}function O2(){var i=ne.A;return ne.A=l3,i}function gh(){kr=4,Ys||(bt&4194048)!==bt&&_a.current!==null||(gc=!0),(Qs&134217727)===0&&(fl&134217727)===0||fr===null||eo(fr,bt,wa,!1)}function G1(i,s,c){var f=Wt;Wt|=2;var g=D2(),x=O2();(fr!==i||bt!==s)&&(mh=null,_c(i,s)),s=!1;var A=kr;e:do try{if(Zt!==0&&St!==null){var B=St,re=Ta;switch(Zt){case 8:H1(),A=6;break e;case 3:case 2:case 9:case 6:_a.current===null&&(s=!0);var de=Zt;if(Zt=0,Ta=null,yc(i,B,re,de),c&&gc){A=0;break e}break;default:de=Zt,Zt=0,Ta=null,yc(i,B,re,de)}}f3(),A=kr;break}catch(Ee){R2(i,Ee)}while(!0);return s&&i.shellSuspendCounter++,Zi=rl=null,Wt=f,ne.H=g,ne.A=x,St===null&&(fr=null,bt=0,L0()),A}function f3(){for(;St!==null;)F2(St)}function h3(i,s){var c=Wt;Wt|=2;var f=D2(),g=O2();fr!==i||bt!==s?(mh=null,dh=Lt()+500,_c(i,s)):gc=tn(i,s);e:do try{if(Zt!==0&&St!==null){s=St;var x=Ta;t:switch(Zt){case 1:Zt=0,Ta=null,yc(i,s,x,1);break;case 2:case 9:if(Gv(x)){Zt=0,Ta=null,M2(s);break}s=function(){Zt!==2&&Zt!==9||fr!==i||(Zt=7),Di(i)},x.then(s,s);break e;case 3:Zt=7;break e;case 4:Zt=5;break e;case 7:Gv(x)?(Zt=0,Ta=null,M2(s)):(Zt=0,Ta=null,yc(i,s,x,7));break;case 5:var A=null;switch(St.tag){case 26:A=St.memoizedState;case 5:case 27:var B=St;if(A?yy(A):B.stateNode.complete){Zt=0,Ta=null;var re=B.sibling;if(re!==null)St=re;else{var de=B.return;de!==null?(St=de,xh(de)):St=null}break t}}Zt=0,Ta=null,yc(i,s,x,5);break;case 6:Zt=0,Ta=null,yc(i,s,x,6);break;case 8:H1(),kr=6;break e;default:throw Error(n(462))}}d3();break}catch(Ee){R2(i,Ee)}while(!0);return Zi=rl=null,ne.H=f,ne.A=g,Wt=c,St!==null?0:(fr=null,bt=0,L0(),kr)}function d3(){for(;St!==null&&!Za();)F2(St)}function F2(i){var s=a2(i.alternate,i,cs);i.memoizedProps=i.pendingProps,s===null?xh(i):St=s}function M2(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=J_(c,s,s.pendingProps,s.type,void 0,bt);break;case 11:s=J_(c,s,s.pendingProps,s.type.render,s.ref,bt);break;case 5:i1(s);default:s2(c,s),s=St=Ov(s,cs),s=a2(c,s,cs)}i.memoizedProps=i.pendingProps,s===null?xh(i):St=s}function yc(i,s,c,f){Zi=rl=null,i1(s),cc=null,Du=0;var g=s.return;try{if(t3(i,g,s,c,bt)){kr=1,ah(i,La(c,i.current)),St=null;return}}catch(x){if(g!==null)throw St=g,x;kr=1,ah(i,La(c,i.current)),St=null;return}s.flags&32768?(Ot||f===1?i=!0:gc||(bt&536870912)!==0?i=!1:(Ys=i=!0,(f===2||f===9||f===3||f===6)&&(f=_a.current,f!==null&&f.tag===13&&(f.flags|=16384))),L2(s,i)):xh(s)}function xh(i){var s=i;do{if((s.flags&32768)!==0){L2(s,Ys);return}i=s.return;var c=a3(s.alternate,s,cs);if(c!==null){St=c;return}if(s=s.sibling,s!==null){St=s;return}St=s=i}while(s!==null);kr===0&&(kr=5)}function L2(i,s){do{var c=i3(i.alternate,i);if(c!==null){c.flags&=32767,St=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){St=i;return}St=i=c}while(i!==null);kr=6,St=null}function P2(i,s,c,f,g,x,A,B,re){i.cancelPendingCommit=null;do vh();while(rn!==0);if((Wt&6)!==0)throw Error(n(327));if(s!==null){if(s===i.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=Dm,jo(i,c,x,A,B,re),i===fr&&(St=fr=null,bt=0),vc=s,Zs=i,us=c,U1=x,j1=g,b2=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,x3(Pt,function(){return z2(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ne.T,ne.T=null,g=oe.p,oe.p=2,A=Wt,Wt|=4;try{s3(i,s,c)}finally{Wt=A,oe.p=g,ne.T=f}}rn=1,V2(),B2(),U2()}}function V2(){if(rn===1){rn=0;var i=Zs,s=vc,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var f=oe.p;oe.p=2;var g=Wt;Wt|=4;try{v2(s,i);var x=rp,A=Sv(i.containerInfo),B=x.focusedElem,re=x.selectionRange;if(A!==B&&B&&B.ownerDocument&&Ev(B.ownerDocument.documentElement,B)){if(re!==null&&km(B)){var de=re.start,Ee=re.end;if(Ee===void 0&&(Ee=de),"selectionStart"in B)B.selectionStart=de,B.selectionEnd=Math.min(Ee,B.value.length);else{var Ce=B.ownerDocument||document,ge=Ce&&Ce.defaultView||window;if(ge.getSelection){var ve=ge.getSelection(),$e=B.textContent.length,it=Math.min(re.start,$e),lr=re.end===void 0?it:Math.min(re.end,$e);!ve.extend&&it>lr&&(A=lr,lr=it,it=A);var se=wv(B,it),ie=wv(B,lr);if(se&&ie&&(ve.rangeCount!==1||ve.anchorNode!==se.node||ve.anchorOffset!==se.offset||ve.focusNode!==ie.node||ve.focusOffset!==ie.offset)){var ue=Ce.createRange();ue.setStart(se.node,se.offset),ve.removeAllRanges(),it>lr?(ve.addRange(ue),ve.extend(ie.node,ie.offset)):(ue.setEnd(ie.node,ie.offset),ve.addRange(ue))}}}}for(Ce=[],ve=B;ve=ve.parentNode;)ve.nodeType===1&&Ce.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Ce.length;B++){var be=Ce[B];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Rh=!!tp,rp=tp=null}finally{Wt=g,oe.p=f,ne.T=c}}i.current=s,rn=2}}function B2(){if(rn===2){rn=0;var i=Zs,s=vc,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var f=oe.p;oe.p=2;var g=Wt;Wt|=4;try{d2(i,s.alternate,s)}finally{Wt=g,oe.p=f,ne.T=c}}rn=3}}function U2(){if(rn===4||rn===3){rn=0,qn();var i=Zs,s=vc,c=us,f=b2;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?rn=5:(rn=0,vc=Zs=null,j2(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(Js=null),ma(c),s=s.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Re,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ne.T,g=oe.p,oe.p=2,ne.T=null;try{for(var x=i.onRecoverableError,A=0;A<f.length;A++){var B=f[A];x(B.value,{componentStack:B.stack})}}finally{ne.T=s,oe.p=g}}(us&3)!==0&&vh(),Di(i),g=i.pendingLanes,(c&261930)!==0&&(g&42)!==0?i===z1?$u++:($u=0,z1=i):$u=0,Yu(0)}}function j2(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Ru(s)))}function vh(){return V2(),B2(),U2(),z2()}function z2(){if(rn!==5)return!1;var i=Zs,s=U1;U1=0;var c=ma(us),f=ne.T,g=oe.p;try{oe.p=32>c?32:c,ne.T=null,c=j1,j1=null;var x=Zs,A=us;if(rn=0,vc=Zs=null,us=0,(Wt&6)!==0)throw Error(n(331));var B=Wt;if(Wt|=4,E2(x.current),y2(x,x.current,A,c),Wt=B,Yu(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Re,x)}catch{}return!0}finally{oe.p=g,ne.T=f,j2(i,s)}}function H2(i,s,c){s=La(c,s),s=y1(i.stateNode,s,2),i=Xs(i,s,2),i!==null&&(ei(i,2),Di(i))}function er(i,s,c){if(i.tag===3)H2(i,i,c);else for(;s!==null;){if(s.tag===3){H2(s,i,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Js===null||!Js.has(f))){i=La(c,i),c=G_(2),f=Xs(s,c,2),f!==null&&(q_(c,f,s,i),ei(f,2),Di(f));break}}s=s.return}}function q1(i,s,c){var f=i.pingCache;if(f===null){f=i.pingCache=new c3;var g=new Set;f.set(s,g)}else g=f.get(s),g===void 0&&(g=new Set,f.set(s,g));g.has(c)||(P1=!0,g.add(c),i=m3.bind(null,i,s,c),s.then(i,i))}function m3(i,s,c){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,fr===i&&(bt&c)===c&&(kr===4||kr===3&&(bt&62914560)===bt&&300>Lt()-hh?(Wt&2)===0&&_c(i,0):V1|=c,xc===bt&&(xc=0)),Di(i)}function G2(i,s){s===0&&(s=Ti()),i=Zo(i,s),i!==null&&(ei(i,s),Di(i))}function p3(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),G2(i,c)}function g3(i,s){var c=0;switch(i.tag){case 31:case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),G2(i,c)}function x3(i,s){return Ut(i,s)}var _h=null,Tc=null,X1=!1,yh=!1,W1=!1,to=0;function Di(i){i!==Tc&&i.next===null&&(Tc===null?_h=Tc=i:Tc=Tc.next=i),yh=!0,X1||(X1=!0,_3())}function Yu(i,s){if(!W1&&yh){W1=!0;do for(var c=!1,f=_h;f!==null;){if(i!==0){var g=f.pendingLanes;if(g===0)var x=0;else{var A=f.suspendedLanes,B=f.pingedLanes;x=(1<<31-Ze(42|i)+1)-1,x&=g&~(A&~B),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,K2(f,x))}else x=bt,x=wr(f,f===fr?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||tn(f,x)||(c=!0,K2(f,x));f=f.next}while(c);W1=!1}}function v3(){q2()}function q2(){yh=X1=!1;var i=0;to!==0&&N3()&&(i=to);for(var s=Lt(),c=null,f=_h;f!==null;){var g=f.next,x=X2(f,s);x===0?(f.next=null,c===null?_h=g:c.next=g,g===null&&(Tc=c)):(c=f,(i!==0||(x&3)!==0)&&(yh=!0)),f=g}rn!==0&&rn!==5||Yu(i),to!==0&&(to=0)}function X2(i,s){for(var c=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var A=31-Ze(x),B=1<<A,re=g[A];re===-1?((B&c)===0||(B&f)!==0)&&(g[A]=Ns(B,s)):re<=s&&(i.expiredLanes|=B),x&=~B}if(s=fr,c=bt,c=wr(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,c===0||i===s&&(Zt===2||Zt===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Ur(f),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||tn(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(f!==null&&Ur(f),ma(c)){case 2:case 8:c=Xn;break;case 32:c=Pt;break;case 268435456:c=ct;break;default:c=Pt}return f=W2.bind(null,i),c=Ut(c,f),i.callbackPriority=s,i.callbackNode=c,s}return f!==null&&f!==null&&Ur(f),i.callbackPriority=2,i.callbackNode=null,2}function W2(i,s){if(rn!==0&&rn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(vh()&&i.callbackNode!==c)return null;var f=bt;return f=wr(i,i===fr?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(C2(i,f,s),X2(i,Lt()),i.callbackNode!=null&&i.callbackNode===c?W2.bind(null,i):null)}function K2(i,s){if(vh())return null;C2(i,s,!0)}function _3(){I3(function(){(Wt&6)!==0?Ut(gn,v3):q2()})}function K1(){if(to===0){var i=sc;i===0&&(i=ln,ln<<=1,(ln&261888)===0&&(ln=256)),to=i}return to}function $2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ql(""+i)}function Y2(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function y3(i,s,c,f,g){if(s==="submit"&&c&&c.stateNode===g){var x=$2((g[q]||null).action),A=f.submitter;A&&(s=(s=A[q]||null)?$2(s.formAction):A.getAttribute("formAction"),s!==null&&(x=s,A=null));var B=new Ai("action","action",null,f,g);i.push({event:B,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(to!==0){var re=A?Y2(g,A):new FormData(g);m1(c,{pending:!0,data:re,method:g.method,action:x},null,re)}}else typeof x=="function"&&(B.preventDefault(),re=A?Y2(g,A):new FormData(g),m1(c,{pending:!0,data:re,method:g.method,action:x},x,re))},currentTarget:g}]})}}for(var $1=0;$1<Im.length;$1++){var Y1=Im[$1],T3=Y1.toLowerCase(),w3=Y1[0].toUpperCase()+Y1.slice(1);ci(T3,"on"+w3)}ci(kv,"onAnimationEnd"),ci(Cv,"onAnimationIteration"),ci(Nv,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(Vk,"onTransitionRun"),ci(Bk,"onTransitionStart"),ci(Uk,"onTransitionCancel"),ci(Rv,"onTransitionEnd"),Rn("onMouseEnter",["mouseout","mouseover"]),Rn("onMouseLeave",["mouseout","mouseover"]),Rn("onPointerEnter",["pointerout","pointerover"]),Rn("onPointerLeave",["pointerout","pointerover"]),ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ur("onBeforeInput",["compositionend","keypress","textInput","paste"]),ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qu));function Q2(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],g=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var A=f.length-1;0<=A;A--){var B=f[A],re=B.instance,de=B.currentTarget;if(B=B.listener,re!==x&&g.isPropagationStopped())break e;x=B,g.currentTarget=de;try{x(g)}catch(Ee){M0(Ee)}g.currentTarget=null,x=re}else for(A=0;A<f.length;A++){if(B=f[A],re=B.instance,de=B.currentTarget,B=B.listener,re!==x&&g.isPropagationStopped())break e;x=B,g.currentTarget=de;try{x(g)}catch(Ee){M0(Ee)}g.currentTarget=null,x=re}}}}function At(i,s){var c=s[fe];c===void 0&&(c=s[fe]=new Set);var f=i+"__bubble";c.has(f)||(J2(s,i,2,!1),c.add(f))}function Q1(i,s,c){var f=0;s&&(f|=4),J2(c,i,f,s)}var Th="_reactListening"+Math.random().toString(36).slice(2);function J1(i){if(!i[Th]){i[Th]=!0,Yt.forEach(function(c){c!=="selectionchange"&&(E3.has(c)||Q1(c,!1,i),Q1(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Th]||(s[Th]=!0,Q1("selectionchange",!1,s))}}function J2(i,s,c,f){switch(ky(s)){case 2:var g=Q3;break;case 8:g=J3;break;default:g=dp}c=g.bind(null,s,c,i),g=void 0,!qo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function Z1(i,s,c,f,g){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var A=f.tag;if(A===3||A===4){var B=f.stateNode.containerInfo;if(B===g)break;if(A===4)for(A=f.return;A!==null;){var re=A.tag;if((re===3||re===4)&&A.stateNode.containerInfo===g)return;A=A.return}for(;B!==null;){if(A=Ve(B),A===null)return;if(re=A.tag,re===5||re===6||re===26||re===27){f=x=A;continue e}B=B.parentNode}}f=f.return}Ls(function(){var de=x,Ee=Da(c),Ce=[];e:{var ge=Iv.get(i);if(ge!==void 0){var ve=Ai,$e=i;switch(i){case"keypress":if(Wo(c)===0)break e;case"keydown":case"keyup":ve=D0;break;case"focusin":$e="focus",ve=$o;break;case"focusout":$e="blur",ve=$o;break;case"beforeblur":case"afterblur":ve=$o;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=wu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=E0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=T;break;case kv:case Cv:case Nv:ve=A0;break;case Rv:ve=j;break;case"scroll":case"scrollend":ve=Tu;break;case"wheel":ve=xe;break;case"copy":case"cut":case"paste":ve=b0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Yi;break;case"toggle":case"beforetoggle":ve=gt}var it=(s&4)!==0,lr=!it&&(i==="scroll"||i==="scrollend"),se=it?ge!==null?ge+"Capture":null:ge;it=[];for(var ie=de,ue;ie!==null;){var be=ie;if(ue=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ue===null||se===null||(be=ii(ie,se),be!=null&&it.push(Ju(ie,be,ue))),lr)break;ie=ie.return}0<it.length&&(ge=new ve(ge,$e,null,c,Ee),Ce.push({event:ge,listeners:it}))}}if((s&7)===0){e:{if(ge=i==="mouseover"||i==="pointerover",ve=i==="mouseout"||i==="pointerout",ge&&c!==vu&&($e=c.relatedTarget||c.fromElement)&&(Ve($e)||$e[Y]))break e;if((ve||ge)&&(ge=Ee.window===Ee?Ee:(ge=Ee.ownerDocument)?ge.defaultView||ge.parentWindow:window,ve?($e=c.relatedTarget||c.toElement,ve=de,$e=$e?Ve($e):null,$e!==null&&(lr=o($e),it=$e.tag,$e!==lr||it!==5&&it!==27&&it!==6)&&($e=null)):(ve=null,$e=de),ve!==$e)){if(it=wu,be="onMouseLeave",se="onMouseEnter",ie="mouse",(i==="pointerout"||i==="pointerover")&&(it=Yi,be="onPointerLeave",se="onPointerEnter",ie="pointer"),lr=ve==null?ge:Me(ve),ue=$e==null?ge:Me($e),ge=new it(be,ie+"leave",ve,c,Ee),ge.target=lr,ge.relatedTarget=ue,be=null,Ve(Ee)===de&&(it=new it(se,ie+"enter",$e,c,Ee),it.target=ue,it.relatedTarget=lr,be=it),lr=be,ve&&$e)t:{for(it=S3,se=ve,ie=$e,ue=0,be=se;be;be=it(be))ue++;be=0;for(var et=ie;et;et=it(et))be++;for(;0<ue-be;)se=it(se),ue--;for(;0<be-ue;)ie=it(ie),be--;for(;ue--;){if(se===ie||ie!==null&&se===ie.alternate){it=se;break t}se=it(se),ie=it(ie)}it=null}else it=null;ve!==null&&Z2(Ce,ge,ve,it,!1),$e!==null&&lr!==null&&Z2(Ce,lr,$e,it,!0)}}e:{if(ge=de?Me(de):window,ve=ge.nodeName&&ge.nodeName.toLowerCase(),ve==="select"||ve==="input"&&ge.type==="file")var jt=gv;else if(mv(ge))if(xv)jt=Mk;else{jt=Ok;var Qe=Dk}else ve=ge.nodeName,!ve||ve.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?de&&Gl(de.elementType)&&(jt=gv):jt=Fk;if(jt&&(jt=jt(i,de))){pv(Ce,jt,c,Ee);break e}Qe&&Qe(i,ge,de),i==="focusout"&&de&&ge.type==="number"&&de.memoizedProps.value!=null&&pu(ge,"number",ge.value)}switch(Qe=de?Me(de):window,i){case"focusin":(mv(Qe)||Qe.contentEditable==="true")&&(Jl=Qe,Cm=de,ku=null);break;case"focusout":ku=Cm=Jl=null;break;case"mousedown":Nm=!0;break;case"contextmenu":case"mouseup":case"dragend":Nm=!1,Av(Ce,c,Ee);break;case"selectionchange":if(Pk)break;case"keydown":case"keyup":Av(Ce,c,Ee)}var yt;if(Xt)e:{switch(i){case"compositionstart":var kt="onCompositionStart";break e;case"compositionend":kt="onCompositionEnd";break e;case"compositionupdate":kt="onCompositionUpdate";break e}kt=void 0}else Ql?Yo(i,c)&&(kt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(kt="onCompositionStart");kt&&(Ci&&c.locale!=="ko"&&(Ql||kt!=="onCompositionStart"?kt==="onCompositionEnd"&&Ql&&(yt=yu()):(Si=Ee,_u="value"in Si?Si.value:Si.textContent,Ql=!0)),Qe=wh(de,kt),0<Qe.length&&(kt=new ki(kt,i,null,c,Ee),Ce.push({event:kt,listeners:Qe}),yt?kt.data=yt:(yt=Yl(c),yt!==null&&(kt.data=yt)))),(yt=Fa?Ck(i,c):Nk(i,c))&&(kt=wh(de,"onBeforeInput"),0<kt.length&&(Qe=new ki("onBeforeInput","beforeinput",null,c,Ee),Ce.push({event:Qe,listeners:kt}),Qe.data=yt)),y3(Ce,i,de,c,Ee)}Q2(Ce,s)})}function Ju(i,s,c){return{instance:i,listener:s,currentTarget:c}}function wh(i,s){for(var c=s+"Capture",f=[];i!==null;){var g=i,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=ii(i,c),g!=null&&f.unshift(Ju(i,g,x)),g=ii(i,s),g!=null&&f.push(Ju(i,g,x))),i.tag===3)return f;i=i.return}return[]}function S3(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Z2(i,s,c,f,g){for(var x=s._reactName,A=[];c!==null&&c!==f;){var B=c,re=B.alternate,de=B.stateNode;if(B=B.tag,re!==null&&re===f)break;B!==5&&B!==26&&B!==27||de===null||(re=de,g?(de=ii(c,x),de!=null&&A.unshift(Ju(c,de,re))):g||(de=ii(c,x),de!=null&&A.push(Ju(c,de,re)))),c=c.return}A.length!==0&&i.push({event:s,listeners:A})}var A3=/\r\n?/g,b3=/\u0000|\uFFFD/g;function ey(i){return(typeof i=="string"?i:""+i).replace(A3,`
`).replace(b3,"")}function ty(i,s){return s=ey(s),ey(i)===s}function or(i,s,c,f,g,x){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||ta(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&ta(i,""+f);break;case"className":ga(i,"class",f);break;case"tabIndex":ga(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":ga(i,c,f);break;case"style":xu(i,f,x);break;case"data":if(s!=="object"){ga(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=ql(""+f),i.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(s!=="input"&&or(i,s,"name",g.name,g,null),or(i,s,"formEncType",g.formEncType,g,null),or(i,s,"formMethod",g.formMethod,g,null),or(i,s,"formTarget",g.formTarget,g,null)):(or(i,s,"encType",g.encType,g,null),or(i,s,"method",g.method,g,null),or(i,s,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=ql(""+f),i.setAttribute(c,f);break;case"onClick":f!=null&&(i.onclick=ai);break;case"onScroll":f!=null&&At("scroll",i);break;case"onScrollEnd":f!=null&&At("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}c=ql(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""+f):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":f===!0?i.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,f):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(c,f):i.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(c):i.setAttribute(c,f);break;case"popover":At("beforetoggle",i),At("toggle",i),In(i,"popover",f);break;case"xlinkActuate":zr(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":zr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":zr(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":zr(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":zr(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":zr(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":zr(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":zr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":zr(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":In(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=w0.get(c)||c,In(i,c,f))}}function ep(i,s,c,f,g,x){switch(c){case"style":xu(i,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof f=="string"?ta(i,f):(typeof f=="number"||typeof f=="bigint")&&ta(i,""+f);break;case"onScroll":f!=null&&At("scroll",i);break;case"onScrollEnd":f!=null&&At("scrollend",i);break;case"onClick":f!=null&&(i.onclick=ai);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),x=i[q]||null,x=x!=null?x[c]:null,typeof x=="function"&&i.removeEventListener(s,x,g),typeof f=="function")){typeof x!="function"&&x!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,f,g);break e}c in i?i[c]=f:f===!0?i.setAttribute(c,""):In(i,c,f)}}}function Tn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":At("error",i),At("load",i);var f=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var A=c[x];if(A!=null)switch(x){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:or(i,s,x,A,c,null)}}g&&or(i,s,"srcSet",c.srcSet,c,null),f&&or(i,s,"src",c.src,c,null);return;case"input":At("invalid",i);var B=x=A=g=null,re=null,de=null;for(f in c)if(c.hasOwnProperty(f)){var Ee=c[f];if(Ee!=null)switch(f){case"name":g=Ee;break;case"type":A=Ee;break;case"checked":re=Ee;break;case"defaultChecked":de=Ee;break;case"value":x=Ee;break;case"defaultValue":B=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,s));break;default:or(i,s,f,Ee,c,null)}}_0(i,x,B,re,de,A,g,!1);return;case"select":At("invalid",i),f=A=x=null;for(g in c)if(c.hasOwnProperty(g)&&(B=c[g],B!=null))switch(g){case"value":x=B;break;case"defaultValue":A=B;break;case"multiple":f=B;default:or(i,s,g,B,c,null)}s=x,c=A,i.multiple=!!f,s!=null?Ds(i,!!f,s,!1):c!=null&&Ds(i,!!f,c,!0);return;case"textarea":At("invalid",i),x=g=f=null;for(A in c)if(c.hasOwnProperty(A)&&(B=c[A],B!=null))switch(A){case"value":f=B;break;case"defaultValue":g=B;break;case"children":x=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:or(i,s,A,B,c,null)}Os(i,f,g,x);return;case"option":for(re in c)c.hasOwnProperty(re)&&(f=c[re],f!=null)&&(re==="selected"?i.selected=f&&typeof f!="function"&&typeof f!="symbol":or(i,s,re,f,c,null));return;case"dialog":At("beforetoggle",i),At("toggle",i),At("cancel",i),At("close",i);break;case"iframe":case"object":At("load",i);break;case"video":case"audio":for(f=0;f<Qu.length;f++)At(Qu[f],i);break;case"image":At("error",i),At("load",i);break;case"details":At("toggle",i);break;case"embed":case"source":case"link":At("error",i),At("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in c)if(c.hasOwnProperty(de)&&(f=c[de],f!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:or(i,s,de,f,c,null)}return;default:if(Gl(s)){for(Ee in c)c.hasOwnProperty(Ee)&&(f=c[Ee],f!==void 0&&ep(i,s,Ee,f,c,void 0));return}}for(B in c)c.hasOwnProperty(B)&&(f=c[B],f!=null&&or(i,s,B,f,c,null))}function k3(i,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,A=null,B=null,re=null,de=null,Ee=null;for(ve in c){var Ce=c[ve];if(c.hasOwnProperty(ve)&&Ce!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":re=Ce;default:f.hasOwnProperty(ve)||or(i,s,ve,null,f,Ce)}}for(var ge in f){var ve=f[ge];if(Ce=c[ge],f.hasOwnProperty(ge)&&(ve!=null||Ce!=null))switch(ge){case"type":x=ve;break;case"name":g=ve;break;case"checked":de=ve;break;case"defaultChecked":Ee=ve;break;case"value":A=ve;break;case"defaultValue":B=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,s));break;default:ve!==Ce&&or(i,s,ge,ve,f,Ce)}}Hl(i,A,B,re,de,Ee,x,g);return;case"select":ve=A=B=ge=null;for(x in c)if(re=c[x],c.hasOwnProperty(x)&&re!=null)switch(x){case"value":break;case"multiple":ve=re;default:f.hasOwnProperty(x)||or(i,s,x,null,f,re)}for(g in f)if(x=f[g],re=c[g],f.hasOwnProperty(g)&&(x!=null||re!=null))switch(g){case"value":ge=x;break;case"defaultValue":B=x;break;case"multiple":A=x;default:x!==re&&or(i,s,g,x,f,re)}s=B,c=A,f=ve,ge!=null?Ds(i,!!c,ge,!1):!!f!=!!c&&(s!=null?Ds(i,!!c,s,!0):Ds(i,!!c,c?[]:"",!1));return;case"textarea":ve=ge=null;for(B in c)if(g=c[B],c.hasOwnProperty(B)&&g!=null&&!f.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:or(i,s,B,null,f,g)}for(A in f)if(g=f[A],x=c[A],f.hasOwnProperty(A)&&(g!=null||x!=null))switch(A){case"value":ge=g;break;case"defaultValue":ve=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&or(i,s,A,g,f,x)}y0(i,ge,ve);return;case"option":for(var $e in c)ge=c[$e],c.hasOwnProperty($e)&&ge!=null&&!f.hasOwnProperty($e)&&($e==="selected"?i.selected=!1:or(i,s,$e,null,f,ge));for(re in f)ge=f[re],ve=c[re],f.hasOwnProperty(re)&&ge!==ve&&(ge!=null||ve!=null)&&(re==="selected"?i.selected=ge&&typeof ge!="function"&&typeof ge!="symbol":or(i,s,re,ge,f,ve));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in c)ge=c[it],c.hasOwnProperty(it)&&ge!=null&&!f.hasOwnProperty(it)&&or(i,s,it,null,f,ge);for(de in f)if(ge=f[de],ve=c[de],f.hasOwnProperty(de)&&ge!==ve&&(ge!=null||ve!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(n(137,s));break;default:or(i,s,de,ge,f,ve)}return;default:if(Gl(s)){for(var lr in c)ge=c[lr],c.hasOwnProperty(lr)&&ge!==void 0&&!f.hasOwnProperty(lr)&&ep(i,s,lr,void 0,f,ge);for(Ee in f)ge=f[Ee],ve=c[Ee],!f.hasOwnProperty(Ee)||ge===ve||ge===void 0&&ve===void 0||ep(i,s,Ee,ge,f,ve);return}}for(var se in c)ge=c[se],c.hasOwnProperty(se)&&ge!=null&&!f.hasOwnProperty(se)&&or(i,s,se,null,f,ge);for(Ce in f)ge=f[Ce],ve=c[Ce],!f.hasOwnProperty(Ce)||ge===ve||ge==null&&ve==null||or(i,s,Ce,ge,f,ve)}function ry(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function C3(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var g=c[f],x=g.transferSize,A=g.initiatorType,B=g.duration;if(x&&B&&ry(A)){for(A=0,B=g.responseEnd,f+=1;f<c.length;f++){var re=c[f],de=re.startTime;if(de>B)break;var Ee=re.transferSize,Ce=re.initiatorType;Ee&&ry(Ce)&&(re=re.responseEnd,A+=Ee*(re<B?1:(B-de)/(re-de)))}if(--f,s+=8*(x+A)/(g.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var tp=null,rp=null;function Eh(i){return i.nodeType===9?i:i.ownerDocument}function ny(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ay(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function np(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ap=null;function N3(){var i=window.event;return i&&i.type==="popstate"?i===ap?!1:(ap=i,!0):(ap=null,!1)}var iy=typeof setTimeout=="function"?setTimeout:void 0,R3=typeof clearTimeout=="function"?clearTimeout:void 0,sy=typeof Promise=="function"?Promise:void 0,I3=typeof queueMicrotask=="function"?queueMicrotask:typeof sy<"u"?function(i){return sy.resolve(null).then(i).catch(D3)}:iy;function D3(i){setTimeout(function(){throw i})}function ro(i){return i==="head"}function oy(i,s){var c=s,f=0;do{var g=c.nextSibling;if(i.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(f===0){i.removeChild(g),Ac(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Zu(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,Zu(c);for(var x=c.firstChild;x;){var A=x.nextSibling,B=x.nodeName;x[me]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=A}}else c==="body"&&Zu(i.ownerDocument.body);c=g}while(c);Ac(s)}function ly(i,s){var c=i;i=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=f}while(c)}function ip(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ip(c),Pe(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function O3(i,s,c,f){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[me])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=ja(i.nextSibling),i===null)break}return null}function F3(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=ja(i.nextSibling),i===null))return null;return i}function cy(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=ja(i.nextSibling),i===null))return null;return i}function sp(i){return i.data==="$?"||i.data==="$~"}function op(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function M3(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function ja(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var lp=null;function uy(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return ja(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function fy(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function hy(i,s,c){switch(s=Eh(c),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Zu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Pe(i)}var za=new Map,dy=new Set;function Sh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var fs=oe.d;oe.d={f:L3,r:P3,D:V3,C:B3,L:U3,m:j3,X:H3,S:z3,M:G3};function L3(){var i=fs.f(),s=ph();return i||s}function P3(i){var s=Ge(i);s!==null&&s.tag===5&&s.type==="form"?R_(s):fs.r(i)}var wc=typeof document>"u"?null:document;function my(i,s,c){var f=wc;if(f&&typeof s=="string"&&s){var g=ea(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),dy.has(g)||(dy.add(g),i={rel:i,crossOrigin:c,href:s},f.querySelector(g)===null&&(s=f.createElement("link"),Tn(s,"link",i),Ye(s),f.head.appendChild(s)))}}function V3(i){fs.D(i),my("dns-prefetch",i,null)}function B3(i,s){fs.C(i,s),my("preconnect",i,s)}function U3(i,s,c){fs.L(i,s,c);var f=wc;if(f&&i&&s){var g='link[rel="preload"][as="'+ea(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+ea(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+ea(c.imageSizes)+'"]')):g+='[href="'+ea(i)+'"]';var x=g;switch(s){case"style":x=Ec(i);break;case"script":x=Sc(i)}za.has(x)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),za.set(x,i),f.querySelector(g)!==null||s==="style"&&f.querySelector(ef(x))||s==="script"&&f.querySelector(tf(x))||(s=f.createElement("link"),Tn(s,"link",i),Ye(s),f.head.appendChild(s)))}}function j3(i,s){fs.m(i,s);var c=wc;if(c&&i){var f=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+ea(f)+'"][href="'+ea(i)+'"]',x=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Sc(i)}if(!za.has(x)&&(i=v({rel:"modulepreload",href:i},s),za.set(x,i),c.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(tf(x)))return}f=c.createElement("link"),Tn(f,"link",i),Ye(f),c.head.appendChild(f)}}}function z3(i,s,c){fs.S(i,s,c);var f=wc;if(f&&i){var g=He(f).hoistableStyles,x=Ec(i);s=s||"default";var A=g.get(x);if(!A){var B={loading:0,preload:null};if(A=f.querySelector(ef(x)))B.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=za.get(x))&&cp(i,c);var re=A=f.createElement("link");Ye(re),Tn(re,"link",i),re._p=new Promise(function(de,Ee){re.onload=de,re.onerror=Ee}),re.addEventListener("load",function(){B.loading|=1}),re.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Ah(A,s,f)}A={type:"stylesheet",instance:A,count:1,state:B},g.set(x,A)}}}function H3(i,s){fs.X(i,s);var c=wc;if(c&&i){var f=He(c).hoistableScripts,g=Sc(i),x=f.get(g);x||(x=c.querySelector(tf(g)),x||(i=v({src:i,async:!0},s),(s=za.get(g))&&up(i,s),x=c.createElement("script"),Ye(x),Tn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function G3(i,s){fs.M(i,s);var c=wc;if(c&&i){var f=He(c).hoistableScripts,g=Sc(i),x=f.get(g);x||(x=c.querySelector(tf(g)),x||(i=v({src:i,async:!0,type:"module"},s),(s=za.get(g))&&up(i,s),x=c.createElement("script"),Ye(x),Tn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function py(i,s,c,f){var g=(g=le.current)?Sh(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ec(c.href),c=He(g).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Ec(c.href);var x=He(g).hoistableStyles,A=x.get(i);if(A||(g=g.ownerDocument||g,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,A),(x=g.querySelector(ef(i)))&&!x._p&&(A.instance=x,A.state.loading=5),za.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},za.set(i,c),x||q3(g,i,c,A.state))),s&&f===null)throw Error(n(528,""));return A}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Sc(c),c=He(g).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Ec(i){return'href="'+ea(i)+'"'}function ef(i){return'link[rel="stylesheet"]['+i+"]"}function gy(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function q3(i,s,c,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Tn(s,"link",c),Ye(s),i.head.appendChild(s))}function Sc(i){return'[src="'+ea(i)+'"]'}function tf(i){return"script[async]"+i}function xy(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+ea(c.href)+'"]');if(f)return s.instance=f,Ye(f),f;var g=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),Ye(f),Tn(f,"style",g),Ah(f,c.precedence,i),s.instance=f;case"stylesheet":g=Ec(c.href);var x=i.querySelector(ef(g));if(x)return s.state.loading|=4,s.instance=x,Ye(x),x;f=gy(c),(g=za.get(g))&&cp(f,g),x=(i.ownerDocument||i).createElement("link"),Ye(x);var A=x;return A._p=new Promise(function(B,re){A.onload=B,A.onerror=re}),Tn(x,"link",f),s.state.loading|=4,Ah(x,c.precedence,i),s.instance=x;case"script":return x=Sc(c.src),(g=i.querySelector(tf(x)))?(s.instance=g,Ye(g),g):(f=c,(g=za.get(x))&&(f=v({},c),up(f,g)),i=i.ownerDocument||i,g=i.createElement("script"),Ye(g),Tn(g,"link",f),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,Ah(f,c.precedence,i));return s.instance}function Ah(i,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,x=g,A=0;A<f.length;A++){var B=f[A];if(B.dataset.precedence===s)x=B;else if(x!==g)break}x?x.parentNode.insertBefore(i,x.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function cp(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function up(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var bh=null;function vy(i,s,c){if(bh===null){var f=new Map,g=bh=new Map;g.set(c,f)}else g=bh,f=g.get(c),f||(f=new Map,g.set(c,f));if(f.has(i))return f;for(f.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var x=c[g];if(!(x[me]||x[H]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var A=x.getAttribute(s)||"";A=i+A;var B=f.get(A);B?B.push(x):f.set(A,[x])}}return f}function _y(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function X3(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(i=s.disabled,typeof s.precedence=="string"&&i==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function yy(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function W3(i,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=Ec(f.href),x=s.querySelector(ef(g));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=kh.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=x,Ye(x);return}x=s.ownerDocument||s,f=gy(f),(g=za.get(g))&&cp(f,g),x=x.createElement("link"),Ye(x);var A=x;A._p=new Promise(function(B,re){A.onload=B,A.onerror=re}),Tn(x,"link",f),c.instance=x}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=kh.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var fp=0;function K3(i,s){return i.stylesheets&&i.count===0&&Nh(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var f=setTimeout(function(){if(i.stylesheets&&Nh(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4+s);0<i.imgBytes&&fp===0&&(fp=62500*C3());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Nh(i,i.stylesheets),i.unsuspend)){var x=i.unsuspend;i.unsuspend=null,x()}},(i.imgBytes>fp?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(g)}}:null}function kh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Nh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Ch=null;function Nh(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Ch=new Map,s.forEach($3,i),Ch=null,kh.call(i))}function $3(i,s){if(!(s.state.loading&4)){var c=Ch.get(i);if(c)var f=c.get(null);else{c=new Map,Ch.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var A=g[x];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),f=A)}f&&c.set(null,f)}g=s.instance,A=g.getAttribute("data-precedence"),x=c.get(A)||f,x===f&&c.set(null,g),c.set(A,g),this.count++,f=kh.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),x?x.parentNode.insertBefore(g,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var rf={$$typeof:N,Provider:null,Consumer:null,_currentValue:ke,_currentValue2:ke,_threadCount:0};function Y3(i,s,c,f,g,x,A,B,re){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.hiddenUpdates=cn(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function Ty(i,s,c,f,g,x,A,B,re,de,Ee,Ce){return i=new Y3(i,s,c,A,re,de,Ee,Ce,B),s=1,x===!0&&(s|=24),x=va(3,null,null,s),i.current=x,x.stateNode=i,s=Gm(),s.refCount++,i.pooledCache=s,s.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:s},Km(x),i}function wy(i){return i?(i=tc,i):tc}function Ey(i,s,c,f,g,x){g=wy(g),f.context===null?f.context=g:f.pendingContext=g,f=qs(s),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=Xs(i,f,s),c!==null&&(sa(c,i,s),Fu(c,i,s))}function Sy(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function hp(i,s){Sy(i,s),(i=i.alternate)&&Sy(i,s)}function Ay(i){if(i.tag===13||i.tag===31){var s=Zo(i,67108864);s!==null&&sa(s,i,67108864),hp(i,67108864)}}function by(i){if(i.tag===13||i.tag===31){var s=Ea();s=da(s);var c=Zo(i,s);c!==null&&sa(c,i,s),hp(i,s)}}var Rh=!0;function Q3(i,s,c,f){var g=ne.T;ne.T=null;var x=oe.p;try{oe.p=2,dp(i,s,c,f)}finally{oe.p=x,ne.T=g}}function J3(i,s,c,f){var g=ne.T;ne.T=null;var x=oe.p;try{oe.p=8,dp(i,s,c,f)}finally{oe.p=x,ne.T=g}}function dp(i,s,c,f){if(Rh){var g=mp(f);if(g===null)Z1(i,s,f,Ih,c),Cy(i,f);else if(eC(g,i,s,c,f))f.stopPropagation();else if(Cy(i,f),s&4&&-1<Z3.indexOf(i)){for(;g!==null;){var x=Ge(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var A=Ir(x.pendingLanes);if(A!==0){var B=x;for(B.pendingLanes|=2,B.entangledLanes|=2;A;){var re=1<<31-Ze(A);B.entanglements[1]|=re,A&=~re}Di(x),(Wt&6)===0&&(dh=Lt()+500,Yu(0))}}break;case 31:case 13:B=Zo(x,2),B!==null&&sa(B,x,2),ph(),hp(x,2)}if(x=mp(f),x===null&&Z1(i,s,f,Ih,c),x===g)break;g=x}g!==null&&f.stopPropagation()}else Z1(i,s,f,null,c)}}function mp(i){return i=Da(i),pp(i)}var Ih=null;function pp(i){if(Ih=null,i=Ve(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=l(s),i!==null)return i;i=null}else if(c===31){if(i=u(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Ih=i,null}function ky(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jr()){case gn:return 2;case Xn:return 8;case Pt:case Nn:return 32;case ct:return 268435456;default:return 32}default:return 32}}var gp=!1,no=null,ao=null,io=null,nf=new Map,af=new Map,so=[],Z3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cy(i,s){switch(i){case"focusin":case"focusout":no=null;break;case"dragenter":case"dragleave":ao=null;break;case"mouseover":case"mouseout":io=null;break;case"pointerover":case"pointerout":nf.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":af.delete(s.pointerId)}}function sf(i,s,c,f,g,x){return i===null||i.nativeEvent!==x?(i={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[g]},s!==null&&(s=Ge(s),s!==null&&Ay(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function eC(i,s,c,f,g){switch(s){case"focusin":return no=sf(no,i,s,c,f,g),!0;case"dragenter":return ao=sf(ao,i,s,c,f,g),!0;case"mouseover":return io=sf(io,i,s,c,f,g),!0;case"pointerover":var x=g.pointerId;return nf.set(x,sf(nf.get(x)||null,i,s,c,f,g)),!0;case"gotpointercapture":return x=g.pointerId,af.set(x,sf(af.get(x)||null,i,s,c,f,g)),!0}return!1}function Ny(i){var s=Ve(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){i.blockedOn=s,X(i.priority,function(){by(c)});return}}else if(s===31){if(s=u(c),s!==null){i.blockedOn=s,X(i.priority,function(){by(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Dh(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=mp(i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);vu=f,c.target.dispatchEvent(f),vu=null}else return s=Ge(c),s!==null&&Ay(s),i.blockedOn=c,!1;s.shift()}return!0}function Ry(i,s,c){Dh(i)&&c.delete(s)}function tC(){gp=!1,no!==null&&Dh(no)&&(no=null),ao!==null&&Dh(ao)&&(ao=null),io!==null&&Dh(io)&&(io=null),nf.forEach(Ry),af.forEach(Ry)}function Oh(i,s){i.blockedOn===s&&(i.blockedOn=null,gp||(gp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,tC)))}var Fh=null;function Iy(i){Fh!==i&&(Fh=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Fh===i&&(Fh=null);for(var s=0;s<i.length;s+=3){var c=i[s],f=i[s+1],g=i[s+2];if(typeof f!="function"){if(pp(f||c)===null)continue;break}var x=Ge(c);x!==null&&(i.splice(s,3),s-=3,m1(x,{pending:!0,data:g,method:c.method,action:f},f,g))}}))}function Ac(i){function s(re){return Oh(re,i)}no!==null&&Oh(no,i),ao!==null&&Oh(ao,i),io!==null&&Oh(io,i),nf.forEach(s),af.forEach(s);for(var c=0;c<so.length;c++){var f=so[c];f.blockedOn===i&&(f.blockedOn=null)}for(;0<so.length&&(c=so[0],c.blockedOn===null);)Ny(c),c.blockedOn===null&&so.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var g=c[f],x=c[f+1],A=g[q]||null;if(typeof x=="function")A||Iy(c);else if(A){var B=null;if(x&&x.hasAttribute("formAction")){if(g=x,A=x[q]||null)B=A.formAction;else if(pp(g)!==null)continue}else B=A.action;typeof B=="function"?c[f+1]=B:(c.splice(f,3),f-=3),Iy(c)}}}function Dy(){function i(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(A){return g=A})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function xp(i){this._internalRoot=i}Mh.prototype.render=xp.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=Ea();Ey(c,f,i,s,null,null)},Mh.prototype.unmount=xp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Ey(i.current,2,null,i,null,null),ph(),s[Y]=null}};function Mh(i){this._internalRoot=i}Mh.prototype.unstable_scheduleHydration=function(i){if(i){var s=P();i={blockedOn:null,target:i,priority:s};for(var c=0;c<so.length&&s!==0&&s<so[c].priority;c++);so.splice(c,0,i),c===0&&Ny(i)}};var Oy=e.version;if(Oy!=="19.2.3")throw Error(n(527,Oy,"19.2.3"));oe.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(s),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var rC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lh.isDisabled&&Lh.supportsFiber)try{Re=Lh.inject(rC),Xe=Lh}catch{}}return lf.createRoot=function(i,s){if(!a(i))throw Error(n(299));var c=!1,f="",g=U_,x=j_,A=z_;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError)),s=Ty(i,1,!1,null,null,c,f,null,g,x,A,Dy),i[Y]=s.current,J1(i),new xp(s)},lf.hydrateRoot=function(i,s,c){if(!a(i))throw Error(n(299));var f=!1,g="",x=U_,A=j_,B=z_,re=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.formState!==void 0&&(re=c.formState)),s=Ty(i,1,!0,s,c??null,f,g,re,x,A,B,Dy),s.context=wy(null),c=s.current,f=Ea(),f=da(f),g=qs(f),g.callback=null,Xs(c,g,f),c=f,s.current.lanes=c,ei(s,c),Di(s),i[Y]=s.current,J1(i),new Mh(s)},lf.version="19.2.3",lf}var Hy;function dC(){if(Hy)return yp.exports;Hy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),yp.exports=hC(),yp.exports}var mC=dC();const pC=RE(mC),gC=()=>{};var Gy={};const IE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},xC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],l=t[r++],u=t[r++],h=((a&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|l&63)}}return e.join("")},DE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],l=a+1<t.length,u=l?t[a+1]:0,h=a+2<t.length,d=h?t[a+2]:0,p=o>>2,v=(o&3)<<4|u>>4;let _=(u&15)<<2|d>>6,y=d&63;h||(y=64,l||(_=64)),n.push(r[p],r[v],r[_],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(IE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):xC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const v=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||d==null||v==null)throw new vC;const _=o<<2|u>>4;if(n.push(_),d!==64){const y=u<<4&240|d>>2;if(n.push(y),v!==64){const S=d<<6&192|v;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class vC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _C=function(t){const e=IE(t);return DE.encodeByteArray(e,!0)},hd=function(t){return _C(t).replace(/\./g,"")},OE=function(t){try{return DE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function yC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const TC=()=>yC().__FIREBASE_DEFAULTS__,wC=()=>{if(typeof process>"u"||typeof Gy>"u")return;const t=Gy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},EC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&OE(t[1]);return e&&JSON.parse(e)},qd=()=>{try{return gC()||TC()||wC()||EC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},FE=t=>qd()?.emulatorHosts?.[t],SC=t=>{const e=FE(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},ME=()=>qd()?.config,LE=t=>qd()?.[`_${t}`];class AC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function nu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function PE(t){return(await fetch(t,{credentials:"include"})).ok}function bC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[hd(JSON.stringify(r)),hd(JSON.stringify(l)),""].join(".")}const xf={};function kC(){const t={prod:[],emulator:[]};for(const e of Object.keys(xf))xf[e]?t.emulator.push(e):t.prod.push(e);return t}function CC(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let qy=!1;function VE(t,e){if(typeof window>"u"||typeof document>"u"||!nu(window.location.host)||xf[t]===e||xf[t]||qy)return;xf[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=kC().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function h(_,y){_.setAttribute("width","24"),_.setAttribute("id",y),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{qy=!0,l()},_}function p(_,y){_.setAttribute("id",y),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=CC(n),y=r("text"),S=document.getElementById(y)||document.createElement("span"),w=r("learnmore"),b=document.getElementById(w)||document.createElement("a"),F=r("preprendIcon"),z=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const N=_.element;u(N),p(b,w);const K=d();h(z,F),N.append(z,S,b,K),document.body.appendChild(N)}o?(S.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function RC(){const t=qd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function IC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function OC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FC(){const t=zn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function MC(){return!RC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function LC(){try{return typeof indexedDB=="object"}catch{return!1}}function PC(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}const VC="FirebaseError";class As extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=VC,Object.setPrototypeOf(this,As.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t0.prototype.create)}}class t0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],l=o?BC(o,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new As(a,u,n)}}function BC(t,e){return t.replace(UC,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const UC=/\{\$([^}]+)}/g;function jC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function El(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],l=e[a];if(Xy(o)&&Xy(l)){if(!El(o,l))return!1}else if(o!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Xy(t){return t!==null&&typeof t=="object"}function r0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function zC(t,e){const r=new HC(t,e);return r.subscribe.bind(r)}class HC{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");GC(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=Sp),a.error===void 0&&(a.error=Sp),a.complete===void 0&&(a.complete=Sp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Sp(){}function kn(t){return t&&t._delegate?t._delegate:t}class Sl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ml="[DEFAULT]";class qC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new AC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(WC(e))try{this.getOrInitializeService({instanceIdentifier:ml})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=ml){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ml){return this.instances.has(e)}getOptions(e=ml){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const o=this.instances.get(n);return o&&e(o,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:XC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ml){return this.component?this.component.multipleInstances?e:ml:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XC(t){return t===ml?void 0:t}function WC(t){return t.instantiationMode==="EAGER"}class KC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new qC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ct||(Ct={}));const $C={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},YC=Ct.INFO,QC={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},JC=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=QC[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pg{constructor(e){this.name=e,this._logLevel=YC,this._logHandler=JC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$C[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const ZC=(t,e)=>e.some(r=>t instanceof r);let Wy,Ky;function e5(){return Wy||(Wy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function t5(){return Ky||(Ky=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const BE=new WeakMap,Yp=new WeakMap,UE=new WeakMap,Ap=new WeakMap,Vg=new WeakMap;function r5(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{r(vo(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&BE.set(r,t)}).catch(()=>{}),Vg.set(e,t),e}function n5(t){if(Yp.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});Yp.set(t,e)}let Qp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Yp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||UE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return vo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function a5(t){Qp=t(Qp)}function i5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(bp(this),e,...r);return UE.set(n,e.sort?e.sort():[e]),vo(n)}:t5().includes(t)?function(...e){return t.apply(bp(this),e),vo(BE.get(this))}:function(...e){return vo(t.apply(bp(this),e))}}function s5(t){return typeof t=="function"?i5(t):(t instanceof IDBTransaction&&n5(t),ZC(t,e5())?new Proxy(t,Qp):t)}function vo(t){if(t instanceof IDBRequest)return r5(t);if(Ap.has(t))return Ap.get(t);const e=s5(t);return e!==t&&(Ap.set(t,e),Vg.set(e,t)),e}const bp=t=>Vg.get(t);function o5(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const l=indexedDB.open(t,e),u=vo(l);return n&&l.addEventListener("upgradeneeded",h=>{n(vo(l.result),h.oldVersion,h.newVersion,vo(l.transaction),h)}),r&&l.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const l5=["get","getKey","getAll","getAllKeys","count"],c5=["put","add","delete","clear"],kp=new Map;function $y(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(kp.get(e))return kp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=c5.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||l5.includes(r)))return;const o=async function(l,...u){const h=this.transaction(l,a?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&h.done]))[0]};return kp.set(e,o),o}a5(t=>({...t,get:(e,r,n)=>$y(e,r)||t.get(e,r,n),has:(e,r)=>!!$y(e,r)||t.has(e,r)}));class u5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(f5(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function f5(t){return t.getComponent()?.type==="VERSION"}const Jp="@firebase/app",Yy="0.14.6";const _s=new Pg("@firebase/app"),h5="@firebase/app-compat",d5="@firebase/analytics-compat",m5="@firebase/analytics",p5="@firebase/app-check-compat",g5="@firebase/app-check",x5="@firebase/auth",v5="@firebase/auth-compat",_5="@firebase/database",y5="@firebase/data-connect",T5="@firebase/database-compat",w5="@firebase/functions",E5="@firebase/functions-compat",S5="@firebase/installations",A5="@firebase/installations-compat",b5="@firebase/messaging",k5="@firebase/messaging-compat",C5="@firebase/performance",N5="@firebase/performance-compat",R5="@firebase/remote-config",I5="@firebase/remote-config-compat",D5="@firebase/storage",O5="@firebase/storage-compat",F5="@firebase/firestore",M5="@firebase/ai",L5="@firebase/firestore-compat",P5="firebase",V5="12.6.0";const Zp="[DEFAULT]",B5={[Jp]:"fire-core",[h5]:"fire-core-compat",[m5]:"fire-analytics",[d5]:"fire-analytics-compat",[g5]:"fire-app-check",[p5]:"fire-app-check-compat",[x5]:"fire-auth",[v5]:"fire-auth-compat",[_5]:"fire-rtdb",[y5]:"fire-data-connect",[T5]:"fire-rtdb-compat",[w5]:"fire-fn",[E5]:"fire-fn-compat",[S5]:"fire-iid",[A5]:"fire-iid-compat",[b5]:"fire-fcm",[k5]:"fire-fcm-compat",[C5]:"fire-perf",[N5]:"fire-perf-compat",[R5]:"fire-rc",[I5]:"fire-rc-compat",[D5]:"fire-gcs",[O5]:"fire-gcs-compat",[F5]:"fire-fst",[L5]:"fire-fst-compat",[M5]:"fire-vertex","fire-js":"fire-js",[P5]:"fire-js-all"};const dd=new Map,U5=new Map,eg=new Map;function Qy(t,e){try{t.container.addComponent(e)}catch(r){_s.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Wc(t){const e=t.name;if(eg.has(e))return _s.debug(`There were multiple attempts to register component ${e}.`),!1;eg.set(e,t);for(const r of dd.values())Qy(r,t);for(const r of U5.values())Qy(r,t);return!0}function Bg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function di(t){return t==null?!1:t.settings!==void 0}const j5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_o=new t0("app","Firebase",j5);class z5{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Sl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _o.create("app-deleted",{appName:this._name})}}const au=V5;function Xd(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Zp,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw _o.create("bad-app-name",{appName:String(a)});if(r||(r=ME()),!r)throw _o.create("no-options");const o=dd.get(a);if(o){if(El(r,o.options)&&El(n,o.config))return o;throw _o.create("duplicate-app",{appName:a})}const l=new KC(a);for(const h of eg.values())l.addComponent(h);const u=new z5(r,n,l);return dd.set(a,u),u}function jE(t=Zp){const e=dd.get(t);if(!e&&t===Zp&&ME())return Xd();if(!e)throw _o.create("no-app",{appName:t});return e}function yo(t,e,r){let n=B5[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${n}" with version "${e}":`];a&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_s.warn(l.join(" "));return}Wc(new Sl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const H5="firebase-heartbeat-database",G5=1,If="firebase-heartbeat-store";let Cp=null;function zE(){return Cp||(Cp=o5(H5,G5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(If)}catch(r){console.warn(r)}}}}).catch(t=>{throw _o.create("idb-open",{originalErrorMessage:t.message})})),Cp}async function q5(t){try{const r=(await zE()).transaction(If),n=await r.objectStore(If).get(HE(t));return await r.done,n}catch(e){if(e instanceof As)_s.warn(e.message);else{const r=_o.create("idb-get",{originalErrorMessage:e?.message});_s.warn(r.message)}}}async function Jy(t,e){try{const n=(await zE()).transaction(If,"readwrite");await n.objectStore(If).put(e,HE(t)),await n.done}catch(r){if(r instanceof As)_s.warn(r.message);else{const n=_o.create("idb-set",{originalErrorMessage:r?.message});_s.warn(n.message)}}}function HE(t){return`${t.name}!${t.options.appId}`}const X5=1024,W5=30;class K5{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Y5(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Zy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>W5){const a=Q5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_s.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Zy(),{heartbeatsToSend:r,unsentEntries:n}=$5(this._heartbeatsCache.heartbeats),a=hd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return _s.warn(e),""}}}function Zy(){return new Date().toISOString().substring(0,10)}function $5(t,e=X5){const r=[];let n=t.slice();for(const a of t){const o=r.find(l=>l.agent===a.agent);if(o){if(o.dates.push(a.date),eT(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),eT(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Y5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return LC()?PC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await q5(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Jy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Jy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function eT(t){return hd(JSON.stringify({version:2,heartbeats:t})).length}function Q5(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function J5(t){Wc(new Sl("platform-logger",e=>new u5(e),"PRIVATE")),Wc(new Sl("heartbeat",e=>new K5(e),"PRIVATE")),yo(Jp,Yy,t),yo(Jp,Yy,"esm2020"),yo("fire-js","")}J5("");var Z5="firebase",e6="12.7.0";yo(Z5,e6,"app");var tT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var To,GE;(function(){var t;function e(k,I){function R(){}R.prototype=I.prototype,k.F=I.prototype,k.prototype=new R,k.prototype.constructor=k,k.D=function(M,O,D){for(var V=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)V[_e-2]=arguments[_e];return I.prototype[O].apply(M,V)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,I,R){R||(R=0);const M=Array(16);if(typeof I=="string")for(var O=0;O<16;++O)M[O]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(O=0;O<16;++O)M[O]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=k.g[0],R=k.g[1],O=k.g[2];let D=k.g[3],V;V=I+(D^R&(O^D))+M[0]+3614090360&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(O^I&(R^O))+M[1]+3905402710&4294967295,D=I+(V<<12&4294967295|V>>>20),V=O+(R^D&(I^R))+M[2]+606105819&4294967295,O=D+(V<<17&4294967295|V>>>15),V=R+(I^O&(D^I))+M[3]+3250441966&4294967295,R=O+(V<<22&4294967295|V>>>10),V=I+(D^R&(O^D))+M[4]+4118548399&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(O^I&(R^O))+M[5]+1200080426&4294967295,D=I+(V<<12&4294967295|V>>>20),V=O+(R^D&(I^R))+M[6]+2821735955&4294967295,O=D+(V<<17&4294967295|V>>>15),V=R+(I^O&(D^I))+M[7]+4249261313&4294967295,R=O+(V<<22&4294967295|V>>>10),V=I+(D^R&(O^D))+M[8]+1770035416&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(O^I&(R^O))+M[9]+2336552879&4294967295,D=I+(V<<12&4294967295|V>>>20),V=O+(R^D&(I^R))+M[10]+4294925233&4294967295,O=D+(V<<17&4294967295|V>>>15),V=R+(I^O&(D^I))+M[11]+2304563134&4294967295,R=O+(V<<22&4294967295|V>>>10),V=I+(D^R&(O^D))+M[12]+1804603682&4294967295,I=R+(V<<7&4294967295|V>>>25),V=D+(O^I&(R^O))+M[13]+4254626195&4294967295,D=I+(V<<12&4294967295|V>>>20),V=O+(R^D&(I^R))+M[14]+2792965006&4294967295,O=D+(V<<17&4294967295|V>>>15),V=R+(I^O&(D^I))+M[15]+1236535329&4294967295,R=O+(V<<22&4294967295|V>>>10),V=I+(O^D&(R^O))+M[1]+4129170786&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^O&(I^R))+M[6]+3225465664&4294967295,D=I+(V<<9&4294967295|V>>>23),V=O+(I^R&(D^I))+M[11]+643717713&4294967295,O=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(O^D))+M[0]+3921069994&4294967295,R=O+(V<<20&4294967295|V>>>12),V=I+(O^D&(R^O))+M[5]+3593408605&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^O&(I^R))+M[10]+38016083&4294967295,D=I+(V<<9&4294967295|V>>>23),V=O+(I^R&(D^I))+M[15]+3634488961&4294967295,O=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(O^D))+M[4]+3889429448&4294967295,R=O+(V<<20&4294967295|V>>>12),V=I+(O^D&(R^O))+M[9]+568446438&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^O&(I^R))+M[14]+3275163606&4294967295,D=I+(V<<9&4294967295|V>>>23),V=O+(I^R&(D^I))+M[3]+4107603335&4294967295,O=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(O^D))+M[8]+1163531501&4294967295,R=O+(V<<20&4294967295|V>>>12),V=I+(O^D&(R^O))+M[13]+2850285829&4294967295,I=R+(V<<5&4294967295|V>>>27),V=D+(R^O&(I^R))+M[2]+4243563512&4294967295,D=I+(V<<9&4294967295|V>>>23),V=O+(I^R&(D^I))+M[7]+1735328473&4294967295,O=D+(V<<14&4294967295|V>>>18),V=R+(D^I&(O^D))+M[12]+2368359562&4294967295,R=O+(V<<20&4294967295|V>>>12),V=I+(R^O^D)+M[5]+4294588738&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^O)+M[8]+2272392833&4294967295,D=I+(V<<11&4294967295|V>>>21),V=O+(D^I^R)+M[11]+1839030562&4294967295,O=D+(V<<16&4294967295|V>>>16),V=R+(O^D^I)+M[14]+4259657740&4294967295,R=O+(V<<23&4294967295|V>>>9),V=I+(R^O^D)+M[1]+2763975236&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^O)+M[4]+1272893353&4294967295,D=I+(V<<11&4294967295|V>>>21),V=O+(D^I^R)+M[7]+4139469664&4294967295,O=D+(V<<16&4294967295|V>>>16),V=R+(O^D^I)+M[10]+3200236656&4294967295,R=O+(V<<23&4294967295|V>>>9),V=I+(R^O^D)+M[13]+681279174&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^O)+M[0]+3936430074&4294967295,D=I+(V<<11&4294967295|V>>>21),V=O+(D^I^R)+M[3]+3572445317&4294967295,O=D+(V<<16&4294967295|V>>>16),V=R+(O^D^I)+M[6]+76029189&4294967295,R=O+(V<<23&4294967295|V>>>9),V=I+(R^O^D)+M[9]+3654602809&4294967295,I=R+(V<<4&4294967295|V>>>28),V=D+(I^R^O)+M[12]+3873151461&4294967295,D=I+(V<<11&4294967295|V>>>21),V=O+(D^I^R)+M[15]+530742520&4294967295,O=D+(V<<16&4294967295|V>>>16),V=R+(O^D^I)+M[2]+3299628645&4294967295,R=O+(V<<23&4294967295|V>>>9),V=I+(O^(R|~D))+M[0]+4096336452&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~O))+M[7]+1126891415&4294967295,D=I+(V<<10&4294967295|V>>>22),V=O+(I^(D|~R))+M[14]+2878612391&4294967295,O=D+(V<<15&4294967295|V>>>17),V=R+(D^(O|~I))+M[5]+4237533241&4294967295,R=O+(V<<21&4294967295|V>>>11),V=I+(O^(R|~D))+M[12]+1700485571&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~O))+M[3]+2399980690&4294967295,D=I+(V<<10&4294967295|V>>>22),V=O+(I^(D|~R))+M[10]+4293915773&4294967295,O=D+(V<<15&4294967295|V>>>17),V=R+(D^(O|~I))+M[1]+2240044497&4294967295,R=O+(V<<21&4294967295|V>>>11),V=I+(O^(R|~D))+M[8]+1873313359&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~O))+M[15]+4264355552&4294967295,D=I+(V<<10&4294967295|V>>>22),V=O+(I^(D|~R))+M[6]+2734768916&4294967295,O=D+(V<<15&4294967295|V>>>17),V=R+(D^(O|~I))+M[13]+1309151649&4294967295,R=O+(V<<21&4294967295|V>>>11),V=I+(O^(R|~D))+M[4]+4149444226&4294967295,I=R+(V<<6&4294967295|V>>>26),V=D+(R^(I|~O))+M[11]+3174756917&4294967295,D=I+(V<<10&4294967295|V>>>22),V=O+(I^(D|~R))+M[2]+718787259&4294967295,O=D+(V<<15&4294967295|V>>>17),V=R+(D^(O|~I))+M[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(O+(V<<21&4294967295|V>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+D&4294967295}n.prototype.v=function(k,I){I===void 0&&(I=k.length);const R=I-this.blockSize,M=this.C;let O=this.h,D=0;for(;D<I;){if(O==0)for(;D<=R;)a(this,k,D),D+=this.blockSize;if(typeof k=="string"){for(;D<I;)if(M[O++]=k.charCodeAt(D++),O==this.blockSize){a(this,M),O=0;break}}else for(;D<I;)if(M[O++]=k[D++],O==this.blockSize){a(this,M),O=0;break}}this.h=O,this.o+=I},n.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var R=k.length-8;R<k.length;++R)k[R]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,R=0;R<4;++R)for(let M=0;M<32;M+=8)k[I++]=this.g[R]>>>M&255;return k};function o(k,I){var R=u;return Object.prototype.hasOwnProperty.call(R,k)?R[k]:R[k]=I(k)}function l(k,I){this.h=I;const R=[];let M=!0;for(let O=k.length-1;O>=0;O--){const D=k[O]|0;M&&D==I||(R[O]=D,M=!1)}this.g=R}var u={};function h(k){return-128<=k&&k<128?o(k,function(I){return new l([I|0],I<0?-1:0)}):new l([k|0],k<0?-1:0)}function d(k){if(isNaN(k)||!isFinite(k))return v;if(k<0)return b(d(-k));const I=[];let R=1;for(let M=0;k>=R;M++)I[M]=k/R|0,R*=4294967296;return new l(I,0)}function p(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return b(p(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=d(Math.pow(I,8));let M=v;for(let D=0;D<k.length;D+=8){var O=Math.min(8,k.length-D);const V=parseInt(k.substring(D,D+O),I);O<8?(O=d(Math.pow(I,O)),M=M.j(O).add(d(V))):(M=M.j(R),M=M.add(d(V)))}return M}var v=h(0),_=h(1),y=h(16777216);t=l.prototype,t.m=function(){if(w(this))return-b(this).m();let k=0,I=1;for(let R=0;R<this.g.length;R++){const M=this.i(R);k+=(M>=0?M:4294967296+M)*I,I*=4294967296}return k},t.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(S(this))return"0";if(w(this))return"-"+b(this).toString(k);const I=d(Math.pow(k,6));var R=this;let M="";for(;;){const O=K(R,I).g;R=F(R,O.j(I));let D=((R.g.length>0?R.g[0]:R.h)>>>0).toString(k);if(R=O,S(R))return D+M;for(;D.length<6;)D="0"+D;M=D+M}},t.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function S(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function w(k){return k.h==-1}t.l=function(k){return k=F(this,k),w(k)?-1:S(k)?0:1};function b(k){const I=k.g.length,R=[];for(let M=0;M<I;M++)R[M]=~k.g[M];return new l(R,~k.h).add(_)}t.abs=function(){return w(this)?b(this):this},t.add=function(k){const I=Math.max(this.g.length,k.g.length),R=[];let M=0;for(let O=0;O<=I;O++){let D=M+(this.i(O)&65535)+(k.i(O)&65535),V=(D>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);M=V>>>16,D&=65535,V&=65535,R[O]=V<<16|D}return new l(R,R[R.length-1]&-2147483648?-1:0)};function F(k,I){return k.add(b(I))}t.j=function(k){if(S(this)||S(k))return v;if(w(this))return w(k)?b(this).j(b(k)):b(b(this).j(k));if(w(k))return b(this.j(b(k)));if(this.l(y)<0&&k.l(y)<0)return d(this.m()*k.m());const I=this.g.length+k.g.length,R=[];for(var M=0;M<2*I;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(let O=0;O<k.g.length;O++){const D=this.i(M)>>>16,V=this.i(M)&65535,_e=k.i(O)>>>16,Te=k.i(O)&65535;R[2*M+2*O]+=V*Te,z(R,2*M+2*O),R[2*M+2*O+1]+=D*Te,z(R,2*M+2*O+1),R[2*M+2*O+1]+=V*_e,z(R,2*M+2*O+1),R[2*M+2*O+2]+=D*_e,z(R,2*M+2*O+2)}for(k=0;k<I;k++)R[k]=R[2*k+1]<<16|R[2*k];for(k=I;k<2*I;k++)R[k]=0;return new l(R,0)};function z(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function N(k,I){this.g=k,this.h=I}function K(k,I){if(S(I))throw Error("division by zero");if(S(k))return new N(v,v);if(w(k))return I=K(b(k),I),new N(b(I.g),b(I.h));if(w(I))return I=K(k,b(I)),new N(b(I.g),I.h);if(k.g.length>30){if(w(k)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var R=_,M=I;M.l(k)<=0;)R=te(R),M=te(M);var O=J(R,1),D=J(M,1);for(M=J(M,2),R=J(R,2);!S(M);){var V=D.add(M);V.l(k)<=0&&(O=O.add(R),D=V),M=J(M,1),R=J(R,1)}return I=F(k,O.j(I)),new N(O,I)}for(O=v;k.l(I)>=0;){for(R=Math.max(1,Math.floor(k.m()/I.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),D=d(R),V=D.j(I);w(V)||V.l(k)>0;)R-=M,D=d(R),V=D.j(I);S(D)&&(D=_),O=O.add(D),k=F(k,V)}return new N(O,k)}t.B=function(k){return K(this,k).h},t.and=function(k){const I=Math.max(this.g.length,k.g.length),R=[];for(let M=0;M<I;M++)R[M]=this.i(M)&k.i(M);return new l(R,this.h&k.h)},t.or=function(k){const I=Math.max(this.g.length,k.g.length),R=[];for(let M=0;M<I;M++)R[M]=this.i(M)|k.i(M);return new l(R,this.h|k.h)},t.xor=function(k){const I=Math.max(this.g.length,k.g.length),R=[];for(let M=0;M<I;M++)R[M]=this.i(M)^k.i(M);return new l(R,this.h^k.h)};function te(k){const I=k.g.length+1,R=[];for(let M=0;M<I;M++)R[M]=k.i(M)<<1|k.i(M-1)>>>31;return new l(R,k.h)}function J(k,I){const R=I>>5;I%=32;const M=k.g.length-R,O=[];for(let D=0;D<M;D++)O[D]=I>0?k.i(D+R)>>>I|k.i(D+R+1)<<32-I:k.i(D+R);return new l(O,k.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,GE=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,To=l}).apply(typeof tT<"u"?tT:typeof self<"u"?self:typeof window<"u"?window:{});var Ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qE,uf,XE,rd,tg,WE,KE,$E;(function(){var t,e=Object.defineProperty;function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ph=="object"&&Ph];for(var T=0;T<m.length;++T){var C=m[T];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function a(m,T){if(T)e:{var C=n;m=m.split(".");for(var j=0;j<m.length-1;j++){var ce=m[j];if(!(ce in C))break e;C=C[ce]}m=m[m.length-1],j=C[m],T=T(j),T!=j&&T!=null&&e(C,m,{configurable:!0,writable:!0,value:T})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(T){var C=[],j;for(j in T)Object.prototype.hasOwnProperty.call(T,j)&&C.push([j,T[j]]);return C}});var o=o||{},l=this||self;function u(m){var T=typeof m;return T=="object"&&m!=null||T=="function"}function h(m,T,C){return m.call.apply(m.bind,arguments)}function d(m,T,C){return d=h,d.apply(null,arguments)}function p(m,T){var C=Array.prototype.slice.call(arguments,1);return function(){var j=C.slice();return j.push.apply(j,arguments),m.apply(this,j)}}function v(m,T){function C(){}C.prototype=T.prototype,m.Z=T.prototype,m.prototype=new C,m.prototype.constructor=m,m.Ob=function(j,ce,xe){for(var ze=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)ze[gt-2]=arguments[gt];return T.prototype[ce].apply(j,ze)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function y(m){const T=m.length;if(T>0){const C=Array(T);for(let j=0;j<T;j++)C[j]=m[j];return C}return[]}function S(m,T){for(let j=1;j<arguments.length;j++){const ce=arguments[j];var C=typeof ce;if(C=C!="object"?C:ce?Array.isArray(ce)?"array":C:"null",C=="array"||C=="object"&&typeof ce.length=="number"){C=m.length||0;const xe=ce.length||0;m.length=C+xe;for(let ze=0;ze<xe;ze++)m[C+ze]=ce[ze]}else m.push(ce)}}class w{constructor(T,C){this.i=T,this.j=C,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function b(m){l.setTimeout(()=>{throw m},0)}function F(){var m=k;let T=null;return m.g&&(T=m.g,m.g=m.g.next,m.g||(m.h=null),T.next=null),T}class z{constructor(){this.h=this.g=null}add(T,C){const j=N.get();j.set(T,C),this.h?this.h.next=j:this.g=j,this.h=j}}var N=new w(()=>new K,m=>m.reset());class K{constructor(){this.next=this.g=this.h=null}set(T,C){this.h=T,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let te,J=!1,k=new z,I=()=>{const m=Promise.resolve(void 0);te=()=>{m.then(R)}};function R(){for(var m;m=F();){try{m.h.call(m.g)}catch(C){b(C)}var T=N;T.j(m),T.h<100&&(T.h++,m.next=T.g,T.g=m)}J=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(m,T){this.type=m,this.g=this.target=T,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,T=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const C=()=>{};l.addEventListener("test",C,T),l.removeEventListener("test",C,T)}catch{}return m})();function V(m){return/^[\s\xa0]*$/.test(m)}function _e(m,T){O.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,T)}v(_e,O),_e.prototype.init=function(m,T){const C=this.type=m.type,j=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=T,T=m.relatedTarget,T||(C=="mouseover"?T=m.fromElement:C=="mouseout"&&(T=m.toElement)),this.relatedTarget=T,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Te="closure_listenable_"+(Math.random()*1e6|0),ne=0;function oe(m,T,C,j,ce){this.listener=m,this.proxy=null,this.src=T,this.type=C,this.capture=!!j,this.ha=ce,this.key=++ne,this.da=this.fa=!1}function ke(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ae(m,T,C){for(const j in m)T.call(C,m[j],j,m)}function Le(m,T){for(const C in m)T.call(void 0,m[C],C,m)}function Q(m){const T={};for(const C in m)T[C]=m[C];return T}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(m,T){let C,j;for(let ce=1;ce<arguments.length;ce++){j=arguments[ce];for(C in j)m[C]=j[C];for(let xe=0;xe<L.length;xe++)C=L[xe],Object.prototype.hasOwnProperty.call(j,C)&&(m[C]=j[C])}}function G(m){this.src=m,this.g={},this.h=0}G.prototype.add=function(m,T,C,j,ce){const xe=m.toString();m=this.g[xe],m||(m=this.g[xe]=[],this.h++);const ze=le(m,T,j,ce);return ze>-1?(T=m[ze],C||(T.fa=!1)):(T=new oe(T,this.src,xe,!!j,ce),T.fa=C,m.push(T)),T};function Z(m,T){const C=T.type;if(C in m.g){var j=m.g[C],ce=Array.prototype.indexOf.call(j,T,void 0),xe;(xe=ce>=0)&&Array.prototype.splice.call(j,ce,1),xe&&(ke(T),m.g[C].length==0&&(delete m.g[C],m.h--))}}function le(m,T,C,j){for(let ce=0;ce<m.length;++ce){const xe=m[ce];if(!xe.da&&xe.listener==T&&xe.capture==!!C&&xe.ha==j)return ce}return-1}var Se="closure_lm_"+(Math.random()*1e6|0),Ne={};function Ae(m,T,C,j,ce){if(Array.isArray(T)){for(let xe=0;xe<T.length;xe++)Ae(m,T[xe],C,j,ce);return null}return C=$t(C),m&&m[Te]?m.J(T,C,u(j)?!!j.capture:!1,ce):Ie(m,T,C,!1,j,ce)}function Ie(m,T,C,j,ce,xe){if(!T)throw Error("Invalid event type");const ze=u(ce)?!!ce.capture:!!ce;let gt=at(m);if(gt||(m[Se]=gt=new G(m)),C=gt.add(T,C,j,ze,xe),C.proxy)return C;if(j=nt(),C.proxy=j,j.src=m,j.listener=C,m.addEventListener)D||(ce=ze),ce===void 0&&(ce=!1),m.addEventListener(T.toString(),j,ce);else if(m.attachEvent)m.attachEvent(ft(T.toString()),j);else if(m.addListener&&m.removeListener)m.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return C}function nt(){function m(C){return T.call(m.src,m.listener,C)}const T=It;return m}function ee(m,T,C,j,ce){if(Array.isArray(T))for(var xe=0;xe<T.length;xe++)ee(m,T[xe],C,j,ce);else j=u(j)?!!j.capture:!!j,C=$t(C),m&&m[Te]?(m=m.i,xe=String(T).toString(),xe in m.g&&(T=m.g[xe],C=le(T,C,j,ce),C>-1&&(ke(T[C]),Array.prototype.splice.call(T,C,1),T.length==0&&(delete m.g[xe],m.h--)))):m&&(m=at(m))&&(T=m.g[T.toString()],m=-1,T&&(m=le(T,C,j,ce)),(C=m>-1?T[m]:null)&&Ft(C))}function Ft(m){if(typeof m!="number"&&m&&!m.da){var T=m.src;if(T&&T[Te])Z(T.i,m);else{var C=m.type,j=m.proxy;T.removeEventListener?T.removeEventListener(C,j,m.capture):T.detachEvent?T.detachEvent(ft(C),j):T.addListener&&T.removeListener&&T.removeListener(j),(C=at(T))?(Z(C,m),C.h==0&&(C.src=null,T[Se]=null)):ke(m)}}}function ft(m){return m in Ne?Ne[m]:Ne[m]="on"+m}function It(m,T){if(m.da)m=!0;else{T=new _e(T,this);const C=m.listener,j=m.ha||m.src;m.fa&&Ft(m),m=C.call(j,T)}return m}function at(m){return m=m[Se],m instanceof G?m:null}var Ue="__closure_events_fn_"+(Math.random()*1e9>>>0);function $t(m){return typeof m=="function"?m:(m[Ue]||(m[Ue]=function(T){return m.handleEvent(T)}),m[Ue])}function Dt(){M.call(this),this.i=new G(this),this.M=this,this.G=null}v(Dt,M),Dt.prototype[Te]=!0,Dt.prototype.removeEventListener=function(m,T,C,j){ee(this,m,T,C,j)};function Ut(m,T){var C,j=m.G;if(j)for(C=[];j;j=j.G)C.push(j);if(m=m.M,j=T.type||T,typeof T=="string")T=new O(T,m);else if(T instanceof O)T.target=T.target||m;else{var ce=T;T=new O(j,m),W(T,ce)}ce=!0;let xe,ze;if(C)for(ze=C.length-1;ze>=0;ze--)xe=T.g=C[ze],ce=Ur(xe,j,!0,T)&&ce;if(xe=T.g=m,ce=Ur(xe,j,!0,T)&&ce,ce=Ur(xe,j,!1,T)&&ce,C)for(ze=0;ze<C.length;ze++)xe=T.g=C[ze],ce=Ur(xe,j,!1,T)&&ce}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var m=this.i;for(const T in m.g){const C=m.g[T];for(let j=0;j<C.length;j++)ke(C[j]);delete m.g[T],m.h--}}this.G=null},Dt.prototype.J=function(m,T,C,j){return this.i.add(String(m),T,!1,C,j)},Dt.prototype.K=function(m,T,C,j){return this.i.add(String(m),T,!0,C,j)};function Ur(m,T,C,j){if(T=m.i.g[String(T)],!T)return!0;T=T.concat();let ce=!0;for(let xe=0;xe<T.length;++xe){const ze=T[xe];if(ze&&!ze.da&&ze.capture==C){const gt=ze.listener,Dr=ze.ha||ze.src;ze.fa&&Z(m.i,ze),ce=gt.call(Dr,j)!==!1&&ce}}return ce&&!j.defaultPrevented}function Za(m,T){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=d(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:l.setTimeout(m,T||0)}function qn(m){m.g=Za(()=>{m.g=null,m.i&&(m.i=!1,qn(m))},m.l);const T=m.h;m.h=null,m.m.apply(null,T)}class Lt extends M{constructor(T,C){super(),this.m=T,this.l=C,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:qn(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jr(m){M.call(this),this.h=m,this.g={}}v(Jr,M);var gn=[];function Xn(m){ae(m.g,function(T,C){this.g.hasOwnProperty(C)&&Ft(T)},m),m.g={}}Jr.prototype.N=function(){Jr.Z.N.call(this),Xn(this)},Jr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pt=l.JSON.stringify,Nn=l.JSON.parse,ct=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function ar(){}function Zr(){}var Re={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xe(){O.call(this,"d")}v(Xe,O);function Ke(){O.call(this,"c")}v(Ke,O);var Ze={},_r=null;function en(){return _r=_r||new Dt}Ze.Ia="serverreachability";function jr(m){O.call(this,Ze.Ia,m)}v(jr,O);function ln(m){const T=en();Ut(T,new jr(T))}Ze.STAT_EVENT="statevent";function Zn(m,T){O.call(this,Ze.STAT_EVENT,m),this.stat=T}v(Zn,O);function Gt(m){const T=en();Ut(T,new Zn(T,m))}Ze.Ja="timingevent";function Ir(m,T){O.call(this,Ze.Ja,m),this.size=T}v(Ir,O);function wr(m,T){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},T)}function tn(){this.g=!0}tn.prototype.ua=function(){this.g=!1};function Ns(m,T,C,j,ce,xe){m.info(function(){if(m.g)if(xe){var ze="",gt=xe.split("&");for(let Xt=0;Xt<gt.length;Xt++){var Dr=gt[Xt].split("=");if(Dr.length>1){const yr=Dr[0];Dr=Dr[1];const Fa=yr.split("_");ze=Fa.length>=2&&Fa[1]=="type"?ze+(yr+"="+Dr+"&"):ze+(yr+"=redacted&")}}}else ze=null;else ze=xe;return"XMLHTTP REQ ("+j+") [attempt "+ce+"]: "+T+`
`+C+`
`+ze})}function Ti(m,T,C,j,ce,xe,ze){m.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ce+"]: "+T+`
`+C+`
`+xe+" "+ze})}function cn(m,T,C,j){m.info(function(){return"XMLHTTP TEXT ("+T+"): "+jo(m,C)+(j?" "+j:"")})}function ei(m,T){m.info(function(){return"TIMEOUT: "+T})}tn.prototype.info=function(){};function jo(m,T){if(!m.g)return T;if(!T)return null;try{const xe=JSON.parse(T);if(xe){for(m=0;m<xe.length;m++)if(Array.isArray(xe[m])){var C=xe[m];if(!(C.length<2)){var j=C[1];if(Array.isArray(j)&&!(j.length<1)){var ce=j[0];if(ce!="noop"&&ce!="stop"&&ce!="close")for(let ze=1;ze<j.length;ze++)j[ze]=""}}}}return Pt(xe)}catch{return T}}var ti={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},qt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Wn;function da(){}v(da,ar),da.prototype.g=function(){return new XMLHttpRequest},Wn=new da;function ma(m){return encodeURIComponent(String(m))}function P(m){var T=1;m=m.split(":");const C=[];for(;T>0&&m.length;)C.push(m.shift()),T--;return m.length&&C.push(m.join(":")),C}function X(m,T,C,j){this.j=m,this.i=T,this.l=C,this.S=j||1,this.V=new Jr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new U}function U(){this.i=null,this.g="",this.h=!1}var H={},q={};function Y(m,T,C){m.M=1,m.A=zo(zr(T)),m.u=C,m.R=!0,fe(m,null)}function fe(m,T){m.F=Date.now(),me(m),m.B=zr(m.A);var C=m.B,j=m.S;Array.isArray(j)||(j=[String(j)]),Gl(C.i,"t",j),m.C=0,C=m.j.L,m.h=new U,m.g=R0(m.j,C?T:null,!m.u),m.P>0&&(m.O=new Lt(d(m.Y,m,m.g),m.P)),T=m.V,C=m.g,j=m.ba;var ce="readystatechange";Array.isArray(ce)||(ce&&(gn[0]=ce.toString()),ce=gn);for(let xe=0;xe<ce.length;xe++){const ze=Ae(C,ce[xe],j||T.handleEvent,!1,T.h||T);if(!ze)break;T.g[ze.key]=ze}T=m.J?Q(m.J):{},m.u?(m.v||(m.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,T)):(m.v="GET",m.g.ea(m.B,m.v,null,T)),ln(),Ns(m.i,m.v,m.B,m.l,m.S,m.u)}X.prototype.ba=function(m){m=m.target;const T=this.O;T&&si(m)==3?T.j():this.Y(m)},X.prototype.Y=function(m){try{if(m==this.g)e:{const gt=si(this.g),Dr=this.g.ya(),Xt=this.g.ca();if(!(gt<3)&&(gt!=3||this.g&&(this.h.h||this.g.la()||xn(this.g)))){this.K||gt!=4||Dr==7||(Dr==8||Xt<=0?ln(3):ln(2)),Ve(this);var T=this.g.ca();this.X=T;var C=we(this);if(this.o=T==200,Ti(this.i,this.v,this.B,this.l,this.S,gt,T),this.o){if(this.U&&!this.L){t:{if(this.g){var j,ce=this.g;if((j=ce.g?ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(j)){var xe=j;break t}}xe=null}if(m=xe)cn(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,He(this,m);else{this.o=!1,this.m=3,Gt(12),Me(this),Ge(this);break e}}if(this.R){m=!0;let yr;for(;!this.K&&this.C<C.length;)if(yr=pe(this,C),yr==q){gt==4&&(this.m=4,Gt(14),m=!1),cn(this.i,this.l,null,"[Incomplete Response]");break}else if(yr==H){this.m=4,Gt(15),cn(this.i,this.l,C,"[Invalid Chunk]"),m=!1;break}else cn(this.i,this.l,yr,null),He(this,yr);if(he(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||C.length!=0||this.h.h||(this.m=1,Gt(16),m=!1),this.o=this.o&&m,!m)cn(this.i,this.l,C,"[Invalid Chunked Response]"),Me(this),Ge(this);else if(C.length>0&&!this.W){this.W=!0;var ze=this.j;ze.g==this&&ze.aa&&!ze.P&&(ze.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Eu(ze),ze.P=!0,Gt(11))}}else cn(this.i,this.l,C,null),He(this,C);gt==4&&Me(this),this.o&&!this.K&&(gt==4?b0(this.j,this):(this.o=!1,me(this)))}else $i(this.g),T==400&&C.indexOf("Unknown SID")>0?(this.m=3,Gt(12)):(this.m=0,Gt(13)),Me(this),Ge(this)}}}catch{}};function we(m){if(!he(m))return m.g.la();const T=xn(m.g);if(T==="")return"";let C="";const j=T.length,ce=si(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Me(m),Ge(m),"";m.h.i=new l.TextDecoder}for(let xe=0;xe<j;xe++)m.h.h=!0,C+=m.h.i.decode(T[xe],{stream:!(ce&&xe==j-1)});return T.length=0,m.h.g+=C,m.C=0,m.h.g}function he(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function pe(m,T){var C=m.C,j=T.indexOf(`
`,C);return j==-1?q:(C=Number(T.substring(C,j)),isNaN(C)?H:(j+=1,j+C>T.length?q:(T=T.slice(j,j+C),m.C=j+C,T)))}X.prototype.cancel=function(){this.K=!0,Me(this)};function me(m){m.T=Date.now()+m.H,Pe(m,m.H)}function Pe(m,T){if(m.D!=null)throw Error("WatchDog timer not null");m.D=wr(d(m.aa,m),T)}function Ve(m){m.D&&(l.clearTimeout(m.D),m.D=null)}X.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(ei(this.i,this.B),this.M!=2&&(ln(),Gt(17)),Me(this),this.m=2,Ge(this)):Pe(this,this.T-m)};function Ge(m){m.j.I==0||m.K||b0(m.j,m)}function Me(m){Ve(m);var T=m.O;T&&typeof T.dispose=="function"&&T.dispose(),m.O=null,Xn(m.V),m.g&&(T=m.g,m.g=null,T.abort(),T.dispose())}function He(m,T){try{var C=m.j;if(C.I!=0&&(C.g==m||Rn(C.h,m))){if(!m.L&&Rn(C.h,m)&&C.I==3){try{var j=C.Ba.g.parse(T)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ce=j;if(ce[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<m.F)$l(C),Vs(C);else break e;$o(C),Gt(18)}}else C.xa=ce[1],0<C.xa-C.K&&ce[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=wr(d(C.Va,C),6e3));ur(C.h)<=1&&C.ta&&(C.ta=void 0)}else ki(C,11)}else if((m.L||C.g==m)&&$l(C),!V(T))for(ce=C.Ba.g.parse(T),T=0;T<ce.length;T++){let Xt=ce[T];const yr=Xt[0];if(!(yr<=C.K))if(C.K=yr,Xt=Xt[1],C.I==2)if(Xt[0]=="c"){C.M=Xt[1],C.ba=Xt[2];const Fa=Xt[3];Fa!=null&&(C.ka=Fa,C.j.info("VER="+C.ka));const Ci=Xt[4];Ci!=null&&(C.za=Ci,C.j.info("SVER="+C.za));const oi=Xt[5];oi!=null&&typeof oi=="number"&&oi>0&&(j=1.5*oi,C.O=j,C.j.info("backChannelRequestTimeoutMs_="+j)),j=C;const li=m.g;if(li){const Yo=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yo){var xe=j.h;xe.g||Yo.indexOf("spdy")==-1&&Yo.indexOf("quic")==-1&&Yo.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(ri(xe,xe.h),xe.h=null))}if(j.G){const Yl=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;Yl&&(j.wa=Yl,Jt(j.J,j.G,Yl))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-m.F,C.j.info("Handshake RTT: "+C.T+"ms")),j=C;var ze=m;if(j.na=N0(j,j.L?j.ba:null,j.W),ze.L){ni(j.h,ze);var gt=ze,Dr=j.O;Dr&&(gt.H=Dr),gt.D&&(Ve(gt),me(gt)),j.g=ze}else S0(j);C.i.length>0&&bi(C)}else Xt[0]!="stop"&&Xt[0]!="close"||ki(C,7);else C.I==3&&(Xt[0]=="stop"||Xt[0]=="close"?Xt[0]=="stop"?ki(C,7):Tu(C):Xt[0]!="noop"&&C.l&&C.l.qa(Xt),C.A=0)}}ln(4)}catch{}}var Ye=class{constructor(m,T){this.g=m,this.map=T}};function Yt(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qt(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function ur(m){return m.h?1:m.g?m.g.size:0}function Rn(m,T){return m.h?m.h==T:m.g?m.g.has(T):!1}function ri(m,T){m.g?m.g.add(T):m.h=T}function ni(m,T){m.h&&m.h==T?m.h=null:m.g&&m.g.has(T)&&m.g.delete(T)}Yt.prototype.cancel=function(){if(this.i=pa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function pa(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let T=m.i;for(const C of m.g.values())T=T.concat(C.G);return T}return y(m.i)}var Rs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function In(m,T){if(m){m=m.split("&");for(let C=0;C<m.length;C++){const j=m[C].indexOf("=");let ce,xe=null;j>=0?(ce=m[C].substring(0,j),xe=m[C].substring(j+1)):ce=m[C],T(ce,xe?decodeURIComponent(xe.replace(/\+/g," ")):"")}}}function ga(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;m instanceof ga?(this.l=m.l,un(this,m.j),this.o=m.o,this.g=m.g,Is(this,m.u),this.h=m.h,mu(this,w0(m.i)),this.m=m.m):m&&(T=String(m).match(Rs))?(this.l=!1,un(this,T[1]||"",!0),this.o=wi(T[2]||""),this.g=wi(T[3]||"",!0),Is(this,T[4]),this.h=wi(T[5]||"",!0),mu(this,T[6]||"",!0),this.m=wi(T[7]||"")):(this.l=!1,this.i=new Os(null,this.l))}ga.prototype.toString=function(){const m=[];var T=this.j;T&&m.push(Ho(T,Hl,!0),":");var C=this.g;return(C||T=="file")&&(m.push("//"),(T=this.o)&&m.push(Ho(T,Hl,!0),"@"),m.push(ma(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&m.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&m.push("/"),m.push(Ho(C,C.charAt(0)=="/"?pu:_0,!0))),(C=this.i.toString())&&m.push("?",C),(C=this.m)&&m.push("#",Ho(C,y0)),m.join("")},ga.prototype.resolve=function(m){const T=zr(this);let C=!!m.j;C?un(T,m.j):C=!!m.o,C?T.o=m.o:C=!!m.g,C?T.g=m.g:C=m.u!=null;var j=m.h;if(C)Is(T,m.u);else if(C=!!m.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var ce=T.h.lastIndexOf("/");ce!=-1&&(j=T.h.slice(0,ce+1)+j)}if(ce=j,ce==".."||ce==".")j="";else if(ce.indexOf("./")!=-1||ce.indexOf("/.")!=-1){j=ce.lastIndexOf("/",0)==0,ce=ce.split("/");const xe=[];for(let ze=0;ze<ce.length;){const gt=ce[ze++];gt=="."?j&&ze==ce.length&&xe.push(""):gt==".."?((xe.length>1||xe.length==1&&xe[0]!="")&&xe.pop(),j&&ze==ce.length&&xe.push("")):(xe.push(gt),j=!0)}j=xe.join("/")}else j=ce}return C?T.h=j:C=m.i.toString()!=="",C?mu(T,w0(m.i)):C=!!m.m,C&&(T.m=m.m),T};function zr(m){return new ga(m)}function un(m,T,C){m.j=C?wi(T,!0):T,m.j&&(m.j=m.j.replace(/:$/,""))}function Is(m,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);m.u=T}else m.u=null}function mu(m,T,C){T instanceof Os?(m.i=T,ql(m.i,m.l)):(C||(T=Ho(T,Ds)),m.i=new Os(T,m.l))}function Jt(m,T,C){m.i.set(T,C)}function zo(m){return Jt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function wi(m,T){return m?T?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Ho(m,T,C){return typeof m=="string"?(m=encodeURI(m).replace(T,ea),C&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function ea(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Hl=/[#\/\?@]/g,_0=/[#\?:]/g,pu=/[#\?]/g,Ds=/[#\?@]/g,y0=/#/g;function Os(m,T){this.h=this.g=null,this.i=m||null,this.j=!!T}function ta(m){m.g||(m.g=new Map,m.h=0,m.i&&In(m.i,function(T,C){m.add(decodeURIComponent(T.replace(/\+/g," ")),C)}))}t=Os.prototype,t.add=function(m,T){ta(this),this.i=null,m=Fs(this,m);let C=this.g.get(m);return C||this.g.set(m,C=[]),C.push(T),this.h+=1,this};function T0(m,T){ta(m),T=Fs(m,T),m.g.has(T)&&(m.i=null,m.h-=m.g.get(T).length,m.g.delete(T))}function gu(m,T){return ta(m),T=Fs(m,T),m.g.has(T)}t.forEach=function(m,T){ta(this),this.g.forEach(function(C,j){C.forEach(function(ce){m.call(T,ce,j,this)},this)},this)};function xu(m,T){ta(m);let C=[];if(typeof T=="string")gu(m,T)&&(C=C.concat(m.g.get(Fs(m,T))));else for(m=Array.from(m.g.values()),T=0;T<m.length;T++)C=C.concat(m[T]);return C}t.set=function(m,T){return ta(this),this.i=null,m=Fs(this,m),gu(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[T]),this.h+=1,this},t.get=function(m,T){return m?(m=xu(this,m),m.length>0?String(m[0]):T):T};function Gl(m,T,C){T0(m,T),C.length>0&&(m.i=null,m.g.set(Fs(m,T),y(C)),m.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],T=Array.from(this.g.keys());for(let j=0;j<T.length;j++){var C=T[j];const ce=ma(C);C=xu(this,C);for(let xe=0;xe<C.length;xe++){let ze=ce;C[xe]!==""&&(ze+="="+ma(C[xe])),m.push(ze)}}return this.i=m.join("&")};function w0(m){const T=new Os;return T.i=m.i,m.g&&(T.g=new Map(m.g),T.h=m.h),T}function Fs(m,T){return T=String(T),m.j&&(T=T.toLowerCase()),T}function ql(m,T){T&&!m.j&&(ta(m),m.i=null,m.g.forEach(function(C,j){const ce=j.toLowerCase();j!=ce&&(T0(this,j),Gl(this,ce,C))},m)),m.j=T}function ai(m,T){const C=new tn;if(l.Image){const j=new Image;j.onload=p(Da,C,"TestLoadImage: loaded",!0,T,j),j.onerror=p(Da,C,"TestLoadImage: error",!1,T,j),j.onabort=p(Da,C,"TestLoadImage: abort",!1,T,j),j.ontimeout=p(Da,C,"TestLoadImage: timeout",!1,T,j),l.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=m}else T(!1)}function vu(m,T){const C=new tn,j=new AbortController,ce=setTimeout(()=>{j.abort(),Da(C,"TestPingServer: timeout",!1,T)},1e4);fetch(m,{signal:j.signal}).then(xe=>{clearTimeout(ce),xe.ok?Da(C,"TestPingServer: ok",!0,T):Da(C,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(ce),Da(C,"TestPingServer: error",!1,T)})}function Da(m,T,C,j,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),j(C)}catch{}}function Ms(){this.g=new ct}function Ei(m){this.i=m.Sb||null,this.h=m.ab||!1}v(Ei,ar),Ei.prototype.g=function(){return new Go(this.i,this.h)};function Go(m,T){Dt.call(this),this.H=m,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Go,Dt),t=Go.prototype,t.open=function(m,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=T,this.readyState=1,ii(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(T.body=m),(this.H||l).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ls(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,ii(this)),this.g&&(this.readyState=3,ii(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xl(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xl(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var T=m.value?m.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!m.done}))&&(this.response=this.responseText+=T)}m.done?Ls(this):ii(this),this.readyState==3&&Xl(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,Ls(this))},t.Na=function(m){this.g&&(this.response=m,Ls(this))},t.ga=function(){this.g&&Ls(this)};function Ls(m){m.readyState=4,m.l=null,m.j=null,m.B=null,ii(m)}t.setRequestHeader=function(m,T){this.A.append(m,T)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],T=this.h.entries();for(var C=T.next();!C.done;)C=C.value,m.push(C[0]+": "+C[1]),C=T.next();return m.join(`\r
`)};function ii(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Go.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Oa(m){let T="";return ae(m,function(C,j){T+=j,T+=":",T+=C,T+=`\r
`}),T}function qo(m,T,C){e:{for(j in C){var j=!1;break e}j=!0}j||(C=Oa(C),typeof m=="string"?C!=null&&ma(C):Jt(m,T,C))}function ir(m){Dt.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ir,Dt);var Si=/^https?$/i,_u=["POST","PUT"];t=ir.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,T,C,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);T=T?T.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Wn.g(),this.g.onreadystatechange=_(d(this.Ca,this));try{this.B=!0,this.g.open(T,String(m),!0),this.B=!1}catch(xe){Xo(this,xe);return}if(m=C||"",C=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ce in j)C.set(ce,j[ce]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const xe of j.keys())C.set(xe,j.get(xe));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(C.keys()).find(xe=>xe.toLowerCase()=="content-type"),ce=l.FormData&&m instanceof l.FormData,!(Array.prototype.indexOf.call(_u,T,void 0)>=0)||j||ce||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,ze]of C)this.g.setRequestHeader(xe,ze);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(xe){Xo(this,xe)}};function Xo(m,T){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=T,m.o=5,yu(m),Ki(m)}function yu(m){m.A||(m.A=!0,Ut(m,"complete"),Ut(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,Ut(this,"complete"),Ut(this,"abort"),Ki(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ki(this,!0)),ir.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Wo(this):this.Xa())},t.Xa=function(){Wo(this)};function Wo(m){if(m.h&&typeof o<"u"){if(m.v&&si(m)==4)setTimeout(m.Ca.bind(m),0);else if(Ut(m,"readystatechange"),si(m)==4){m.h=!1;try{const xe=m.ca();e:switch(xe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var C;if(!(C=T)){var j;if(j=xe===0){let ze=String(m.D).match(Rs)[1]||null;!ze&&l.self&&l.self.location&&(ze=l.self.location.protocol.slice(0,-1)),j=!Si.test(ze?ze.toLowerCase():"")}C=j}if(C)Ut(m,"complete"),Ut(m,"success");else{m.o=6;try{var ce=si(m)>2?m.g.statusText:""}catch{ce=""}m.l=ce+" ["+m.ca()+"]",yu(m)}}finally{Ki(m)}}}}function Ki(m,T){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const C=m.g;m.g=null,T||Ut(m,"ready");try{C.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function si(m){return m.g?m.g.readyState:0}t.ca=function(){try{return si(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var T=this.g.responseText;return m&&T.indexOf(m)==0&&(T=T.substring(m.length)),Nn(T)}};function xn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function $i(m){const T={};m=(m.g&&si(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<m.length;j++){if(V(m[j]))continue;var C=P(m[j]);const ce=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const xe=T[ce]||[];T[ce]=xe,xe.push(C)}Le(T,function(j){return j.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(m,T,C){return C&&C.internalChannelParams&&C.internalChannelParams[m]||T}function Ps(m){this.za=0,this.i=[],this.j=new tn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ai("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ai("baseRetryDelayMs",5e3,m),this.Za=Ai("retryDelaySeedMs",1e4,m),this.Ta=Ai("forwardChannelMaxRetries",2,m),this.va=Ai("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Yt(m&&m.concurrentRequestLimit),this.Ba=new Ms,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ps.prototype,t.ka=8,t.I=1,t.connect=function(m,T,C,j){Gt(0),this.W=m,this.H=T||{},C&&j!==void 0&&(this.H.OSID=C,this.H.OAID=j),this.F=this.X,this.J=N0(this,null,this.W),bi(this)};function Tu(m){if(Wl(m),m.I==3){var T=m.V++,C=zr(m.J);if(Jt(C,"SID",m.M),Jt(C,"RID",T),Jt(C,"TYPE","terminate"),Ko(m,C),T=new X(m,m.j,T),T.M=2,T.A=zo(zr(C)),C=!1,l.navigator&&l.navigator.sendBeacon)try{C=l.navigator.sendBeacon(T.A.toString(),"")}catch{}!C&&l.Image&&(new Image().src=T.A,C=!0),C||(T.g=R0(T.j,null),T.g.ea(T.A)),T.F=Date.now(),me(T)}C0(m)}function Vs(m){m.g&&(Eu(m),m.g.cancel(),m.g=null)}function Wl(m){Vs(m),m.v&&(l.clearTimeout(m.v),m.v=null),$l(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&l.clearTimeout(m.m),m.m=null)}function bi(m){if(!Qt(m.h)&&!m.m){m.m=!0;var T=m.Ea;te||I(),J||(te(),J=!0),k.add(T,m),m.D=0}}function Kl(m,T){return ur(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=T.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=wr(d(m.Ea,m,T),k0(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const ce=new X(this,this.j,m);let xe=this.o;if(this.U&&(xe?(xe=Q(xe),W(xe,this.U)):xe=this.U),this.u!==null||this.R||(ce.J=xe,xe=null),this.S)e:{for(var T=0,C=0;C<this.i.length;C++){t:{var j=this.i[C];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(T+=j,T>4096){T=C;break e}if(T===4096||C===this.i.length-1){T=C+1;break e}}T=1e3}else T=1e3;T=E0(this,ce,T),C=zr(this.J),Jt(C,"RID",m),Jt(C,"CVER",22),this.G&&Jt(C,"X-HTTP-Session-Id",this.G),Ko(this,C),xe&&(this.R?T="headers="+ma(Oa(xe))+"&"+T:this.u&&qo(C,this.u,xe)),ri(this.h,ce),this.Ra&&Jt(C,"TYPE","init"),this.S?(Jt(C,"$req",T),Jt(C,"SID","null"),ce.U=!0,Y(ce,C,null)):Y(ce,C,T),this.I=2}}else this.I==3&&(m?wu(this,m):this.i.length==0||Qt(this.h)||wu(this))};function wu(m,T){var C;T?C=T.l:C=m.V++;const j=zr(m.J);Jt(j,"SID",m.M),Jt(j,"RID",C),Jt(j,"AID",m.K),Ko(m,j),m.u&&m.o&&qo(j,m.u,m.o),C=new X(m,m.j,C,m.D+1),m.u===null&&(C.J=m.o),T&&(m.i=T.G.concat(m.i)),T=E0(m,C,1e3),C.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),ri(m.h,C),Y(C,j,T)}function Ko(m,T){m.H&&ae(m.H,function(C,j){Jt(T,j,C)}),m.l&&ae({},function(C,j){Jt(T,j,C)})}function E0(m,T,C){C=Math.min(m.i.length,C);const j=m.l?d(m.l.Ka,m.l,m):null;e:{var ce=m.i;let gt=-1;for(;;){const Dr=["count="+C];gt==-1?C>0?(gt=ce[0].g,Dr.push("ofs="+gt)):gt=0:Dr.push("ofs="+gt);let Xt=!0;for(let yr=0;yr<C;yr++){var xe=ce[yr].g;const Fa=ce[yr].map;if(xe-=gt,xe<0)gt=Math.max(0,ce[yr].g-100),Xt=!1;else try{xe="req"+xe+"_"||"";try{var ze=Fa instanceof Map?Fa:Object.entries(Fa);for(const[Ci,oi]of ze){let li=oi;u(oi)&&(li=Pt(oi)),Dr.push(xe+Ci+"="+encodeURIComponent(li))}}catch(Ci){throw Dr.push(xe+"type="+encodeURIComponent("_badmap")),Ci}}catch{j&&j(Fa)}}if(Xt){ze=Dr.join("&");break e}}ze=void 0}return m=m.i.splice(0,C),T.G=m,ze}function S0(m){if(!m.g&&!m.v){m.Y=1;var T=m.Da;te||I(),J||(te(),J=!0),k.add(T,m),m.A=0}}function $o(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=wr(d(m.Da,m),k0(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,A0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=wr(d(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Gt(10),Vs(this),A0(this))};function Eu(m){m.B!=null&&(l.clearTimeout(m.B),m.B=null)}function A0(m){m.g=new X(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var T=zr(m.na);Jt(T,"RID","rpc"),Jt(T,"SID",m.M),Jt(T,"AID",m.K),Jt(T,"CI",m.F?"0":"1"),!m.F&&m.ia&&Jt(T,"TO",m.ia),Jt(T,"TYPE","xmlhttp"),Ko(m,T),m.u&&m.o&&qo(T,m.u,m.o),m.O&&(m.g.H=m.O);var C=m.g;m=m.ba,C.M=1,C.A=zo(zr(T)),C.u=null,C.R=!0,fe(C,m)}t.Va=function(){this.C!=null&&(this.C=null,Vs(this),$o(this),Gt(19))};function $l(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function b0(m,T){var C=null;if(m.g==T){$l(m),Eu(m),m.g=null;var j=2}else if(Rn(m.h,T))C=T.G,ni(m.h,T),j=1;else return;if(m.I!=0){if(T.o)if(j==1){C=T.u?T.u.length:0,T=Date.now()-T.F;var ce=m.D;j=en(),Ut(j,new Ir(j,C)),bi(m)}else S0(m);else if(ce=T.m,ce==3||ce==0&&T.X>0||!(j==1&&Kl(m,T)||j==2&&$o(m)))switch(C&&C.length>0&&(T=m.h,T.i=T.i.concat(C)),ce){case 1:ki(m,5);break;case 4:ki(m,10);break;case 3:ki(m,6);break;default:ki(m,2)}}}function k0(m,T){let C=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(C*=2),C*T}function ki(m,T){if(m.j.info("Error code "+T),T==2){var C=d(m.bb,m),j=m.Ua;const ce=!j;j=new ga(j||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||un(j,"https"),zo(j),ce?ai(j.toString(),C):vu(j.toString(),C)}else Gt(2);m.I=0,m.l&&m.l.pa(T),C0(m),Wl(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function C0(m){if(m.I=0,m.ja=[],m.l){const T=pa(m.h);(T.length!=0||m.i.length!=0)&&(S(m.ja,T),S(m.ja,m.i),m.h.i.length=0,y(m.i),m.i.length=0),m.l.oa()}}function N0(m,T,C){var j=C instanceof ga?zr(C):new ga(C);if(j.g!="")T&&(j.g=T+"."+j.g),Is(j,j.u);else{var ce=l.location;j=ce.protocol,T=T?T+"."+ce.hostname:ce.hostname,ce=+ce.port;const xe=new ga(null);j&&un(xe,j),T&&(xe.g=T),ce&&Is(xe,ce),C&&(xe.h=C),j=xe}return C=m.G,T=m.wa,C&&T&&Jt(j,C,T),Jt(j,"VER",m.ka),Ko(m,j),j}function R0(m,T,C){if(T&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=m.Aa&&!m.ma?new ir(new Ei({ab:C})):new ir(m.ma),T.Fa(m.L),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function I0(){}t=I0.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Bs(){}Bs.prototype.g=function(m,T){return new Kn(m,T)};function Kn(m,T){Dt.call(this),this.g=new Ps(T),this.l=m,this.h=T&&T.messageUrlParams||null,m=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(m?m["X-WebChannel-Content-Type"]=T.messageContentType:m={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(m?m["X-WebChannel-Client-Profile"]=T.sa:m={"X-WebChannel-Client-Profile":T.sa}),this.g.U=m,(m=T&&T.Qb)&&!V(m)&&(this.g.u=m),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!V(T)&&(this.g.G=T,m=this.h,m!==null&&T in m&&(m=this.h,T in m&&delete m[T])),this.j=new Yi(this)}v(Kn,Dt),Kn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Kn.prototype.close=function(){Tu(this.g)},Kn.prototype.o=function(m){var T=this.g;if(typeof m=="string"){var C={};C.__data__=m,m=C}else this.v&&(C={},C.__data__=Pt(m),m=C);T.i.push(new Ye(T.Ya++,m)),T.I==3&&bi(T)},Kn.prototype.N=function(){this.g.l=null,delete this.j,Tu(this.g),delete this.g,Kn.Z.N.call(this)};function D0(m){Xe.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var T=m.__sm__;if(T){e:{for(const C in T){m=C;break e}m=void 0}(this.i=m)&&(m=this.i,T=T!==null&&m in T?T[m]:void 0),this.data=T}else this.data=m}v(D0,Xe);function O0(){Ke.call(this),this.status=1}v(O0,Ke);function Yi(m){this.g=m}v(Yi,I0),Yi.prototype.ra=function(){Ut(this.g,"a")},Yi.prototype.qa=function(m){Ut(this.g,new D0(m))},Yi.prototype.pa=function(m){Ut(this.g,new O0)},Yi.prototype.oa=function(){Ut(this.g,"b")},Bs.prototype.createWebChannel=Bs.prototype.g,Kn.prototype.send=Kn.prototype.o,Kn.prototype.open=Kn.prototype.m,Kn.prototype.close=Kn.prototype.close,$E=function(){return new Bs},KE=function(){return en()},WE=Ze,tg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ti.NO_ERROR=0,ti.TIMEOUT=8,ti.HTTP_ERROR=6,rd=ti,qt.COMPLETE="complete",XE=qt,Zr.EventType=Re,Re.OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,uf=Zr,ir.prototype.listenOnce=ir.prototype.K,ir.prototype.getLastError=ir.prototype.Ha,ir.prototype.getLastErrorCode=ir.prototype.ya,ir.prototype.getStatus=ir.prototype.ca,ir.prototype.getResponseJson=ir.prototype.La,ir.prototype.getResponseText=ir.prototype.la,ir.prototype.send=ir.prototype.ea,ir.prototype.setWithCredentials=ir.prototype.Fa,qE=ir}).apply(typeof Ph<"u"?Ph:typeof self<"u"?self:typeof window<"u"?window:{});const rT="@firebase/firestore",nT="4.9.3";let Mn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");let iu="12.7.0";const Al=new Pg("@firebase/firestore");function Nc(){return Al.logLevel}function We(t,...e){if(Al.logLevel<=Ct.DEBUG){const r=e.map(Ug);Al.debug(`Firestore (${iu}): ${t}`,...r)}}function ys(t,...e){if(Al.logLevel<=Ct.ERROR){const r=e.map(Ug);Al.error(`Firestore (${iu}): ${t}`,...r)}}function Kc(t,...e){if(Al.logLevel<=Ct.WARN){const r=e.map(Ug);Al.warn(`Firestore (${iu}): ${t}`,...r)}}function Ug(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function lt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,YE(t,n,r)}function YE(t,e,r){let n=`FIRESTORE (${iu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ys(n),new Error(n)}function Kt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||YE(e,a,n)}function pt(t,e){return t}const Fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Je extends As{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class wo{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class QE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class t6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Mn.UNAUTHENTICATED)))}shutdown(){}}class r6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class n6{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Kt(this.o===void 0,42304);let n=this.i;const a=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new wo;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new wo,e.enqueueRetryable((()=>a(this.currentUser)))};const l=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await a(this.currentUser)}))},u=h=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new wo)}}),0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Kt(typeof n.accessToken=="string",31837,{l:n}),new QE(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kt(e===null||typeof e=="string",2055,{h:e}),new Mn(e)}}class a6{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class i6{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new a6(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Mn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class aT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class s6{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,di(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Kt(this.o===void 0,3512);const n=o=>{o.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,We("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const a=o=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>a(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new aT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Kt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new aT(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function o6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class jg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=o6(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function Nt(t,e){return t<e?-1:t>e?1:0}function rg(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),o=e.charAt(n);if(a!==o)return Np(a)===Np(o)?Nt(a,o):Np(a)?1:-1}return Nt(t.length,e.length)}const l6=55296,c6=57343;function Np(t){const e=t.charCodeAt(0);return e>=l6&&e<=c6}function $c(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}const iT="__name__";class Li{constructor(e,r,n){r===void 0?r=0:r>e.length&&lt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&lt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Li.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Li?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=Li.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return Nt(e.length,r.length)}static compareSegments(e,r){const n=Li.isNumericId(e),a=Li.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Li.extractNumericId(e).compare(Li.extractNumericId(r)):rg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return To.fromString(e.substring(4,e.length-2))}}class pr extends Li{construct(e,r,n){return new pr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Je(Fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new pr(r)}static emptyPath(){return new pr([])}}const u6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class An extends Li{construct(e,r,n){return new An(e,r,n)}static isValidIdentifier(e){return u6.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),An.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===iT}static keyField(){return new An([iT])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new Je(Fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new Je(Fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Je(Fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(o(),a++)}if(o(),l)throw new Je(Fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new An(r)}static emptyPath(){return new An([])}}class rt{constructor(e){this.path=e}static fromPath(e){return new rt(pr.fromString(e))}static fromName(e){return new rt(pr.fromString(e).popFirst(5))}static empty(){return new rt(pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rt(new pr(e.slice()))}}function JE(t,e,r){if(!r)throw new Je(Fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function f6(t,e,r,n){if(e===!0&&n===!0)throw new Je(Fe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function sT(t){if(!rt.isDocumentKey(t))throw new Je(Fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function oT(t){if(rt.isDocumentKey(t))throw new Je(Fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ZE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function zg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":lt(12329,{type:typeof t})}function xi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Je(Fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=zg(t);throw new Je(Fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function Qr(t,e){const r={typeString:t};return e&&(r.value=e),r}function n0(t,e){if(!ZE(t))throw new Je(Fe.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(o!==void 0&&l!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Je(Fe.INVALID_ARGUMENT,r);return!0}const lT=-62135596800,cT=1e6;class gr{static now(){return gr.fromMillis(Date.now())}static fromDate(e){return gr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*cT);return new gr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Je(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Je(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<lT)throw new Je(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Je(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cT}_compareTo(e){return this.seconds===e.seconds?Nt(this.nanoseconds,e.nanoseconds):Nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(n0(e,gr._jsonSchema))return new gr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gr._jsonSchemaVersion="firestore/timestamp/1.0",gr._jsonSchema={type:Qr("string",gr._jsonSchemaVersion),seconds:Qr("number"),nanoseconds:Qr("number")};class dt{static fromTimestamp(e){return new dt(e)}static min(){return new dt(new gr(0,0))}static max(){return new dt(new gr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Df=-1;function h6(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=dt.fromTimestamp(n===1e9?new gr(r+1,0):new gr(r,n));return new Ao(a,rt.empty(),e)}function d6(t){return new Ao(t.readTime,t.key,Df)}class Ao{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ao(dt.min(),rt.empty(),Df)}static max(){return new Ao(dt.max(),rt.empty(),Df)}}function m6(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=rt.comparator(t.documentKey,e.documentKey),r!==0?r:Nt(t.largestBatchId,e.largestBatchId))}const p6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class g6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function su(t){if(t.code!==Fe.FAILED_PRECONDITION||t.message!==p6)throw t;We("LocalStore","Unexpectedly lost primary lease")}class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&lt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new De(((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof De?r:De.resolve(r)}catch(r){return De.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):De.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):De.reject(r)}static resolve(e){return new De(((r,n)=>{r(e)}))}static reject(e){return new De(((r,n)=>{n(e)}))}static waitFor(e){return new De(((r,n)=>{let a=0,o=0,l=!1;e.forEach((u=>{++a,u.next((()=>{++o,l&&o===a&&r()}),(h=>n(h)))})),l=!0,o===a&&r()}))}static or(e){let r=De.resolve(!1);for(const n of e)r=r.next((a=>a?De.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,o)=>{n.push(r.call(this,a,o))})),this.waitFor(n)}static mapArray(e,r){return new De(((n,a)=>{const o=e.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next((p=>{l[d]=p,++u,u===o&&n(l)}),(p=>a(p)))}}))}static doWhile(e,r){return new De(((n,a)=>{const o=()=>{e()===!0?r().next((()=>{o()}),a):n()};o()}))}}function x6(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function ou(t){return t.name==="IndexedDbTransactionError"}class Wd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Wd.ce=-1;const Hg=-1;function Kd(t){return t==null}function md(t){return t===0&&1/t==-1/0}function v6(t){return typeof t=="number"&&Number.isInteger(t)&&!md(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const eS="";function _6(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=uT(e)),e=y6(t.get(r),e);return uT(e)}function y6(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case eS:r+="";break;default:r+=o}}return r}function uT(t){return t+eS+""}function fT(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Lo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function tS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ar{constructor(e,r){this.comparator=e,this.root=r||En.EMPTY}insert(e,r){return new Ar(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new Ar(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vh(this.root,e,this.comparator,!0)}}class Vh{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??En.RED,this.left=a??En.EMPTY,this.right=o??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new En(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return En.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw lt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw lt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw lt(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw lt(57766)}get value(){throw lt(16141)}get color(){throw lt(16727)}get left(){throw lt(29726)}get right(){throw lt(36894)}copy(e,r,n,a,o){return this}insert(e,r,n){return new En(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sn{constructor(e){this.comparator=e,this.data=new Ar(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new hT(this.data.getIterator())}getIteratorFrom(e){return new hT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new sn(this.comparator);return r.data=e,r}}class hT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ra{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new Ra([])}unionWith(e){let r=new sn(An.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ra(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return $c(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class rS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new rS("Invalid base64 string: "+o):o}})(e);return new Cn(r)}static fromUint8Array(e){const r=(function(a){let o="";for(let l=0;l<a.length;++l)o+=String.fromCharCode(a[l]);return o})(e);return new Cn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const T6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bo(t){if(Kt(!!t,39018),typeof t=="string"){let e=0;const r=T6.exec(t);if(Kt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Lr(t.seconds),nanos:Lr(t.nanos)}}function Lr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ko(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}const nS="server_timestamp",aS="__type__",iS="__previous_value__",sS="__local_write_time__";function Gg(t){return(t?.mapValue?.fields||{})[aS]?.stringValue===nS}function $d(t){const e=t.mapValue.fields[iS];return Gg(e)?$d(e):e}function Of(t){const e=bo(t.mapValue.fields[sS].timestampValue);return new gr(e.seconds,e.nanos)}class w6{constructor(e,r,n,a,o,l,u,h,d,p){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const pd="(default)";class Ff{constructor(e,r){this.projectId=e,this.database=r||pd}static empty(){return new Ff("","")}get isDefaultDatabase(){return this.database===pd}isEqual(e){return e instanceof Ff&&e.projectId===this.projectId&&e.database===this.database}}const oS="__type__",E6="__max__",Bh={mapValue:{}},lS="__vector__",gd="value";function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gg(t)?4:A6(t)?9007199254740991:S6(t)?10:11:lt(28295,{value:t})}function Gi(t,e){if(t===e)return!0;const r=Co(t);if(r!==Co(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Of(t).isEqual(Of(e));case 3:return(function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const l=bo(a.timestampValue),u=bo(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,o){return ko(a.bytesValue).isEqual(ko(o.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,o){return Lr(a.geoPointValue.latitude)===Lr(o.geoPointValue.latitude)&&Lr(a.geoPointValue.longitude)===Lr(o.geoPointValue.longitude)})(t,e);case 2:return(function(a,o){if("integerValue"in a&&"integerValue"in o)return Lr(a.integerValue)===Lr(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const l=Lr(a.doubleValue),u=Lr(o.doubleValue);return l===u?md(l)===md(u):isNaN(l)&&isNaN(u)}return!1})(t,e);case 9:return $c(t.arrayValue.values||[],e.arrayValue.values||[],Gi);case 10:case 11:return(function(a,o){const l=a.mapValue.fields||{},u=o.mapValue.fields||{};if(fT(l)!==fT(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!Gi(l[h],u[h])))return!1;return!0})(t,e);default:return lt(52216,{left:t})}}function Mf(t,e){return(t.values||[]).find((r=>Gi(r,e)))!==void 0}function Yc(t,e){if(t===e)return 0;const r=Co(t),n=Co(e);if(r!==n)return Nt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Nt(t.booleanValue,e.booleanValue);case 2:return(function(o,l){const u=Lr(o.integerValue||o.doubleValue),h=Lr(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(t,e);case 3:return dT(t.timestampValue,e.timestampValue);case 4:return dT(Of(t),Of(e));case 5:return rg(t.stringValue,e.stringValue);case 6:return(function(o,l){const u=ko(o),h=ko(l);return u.compareTo(h)})(t.bytesValue,e.bytesValue);case 7:return(function(o,l){const u=o.split("/"),h=l.split("/");for(let d=0;d<u.length&&d<h.length;d++){const p=Nt(u[d],h[d]);if(p!==0)return p}return Nt(u.length,h.length)})(t.referenceValue,e.referenceValue);case 8:return(function(o,l){const u=Nt(Lr(o.latitude),Lr(l.latitude));return u!==0?u:Nt(Lr(o.longitude),Lr(l.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return mT(t.arrayValue,e.arrayValue);case 10:return(function(o,l){const u=o.fields||{},h=l.fields||{},d=u[gd]?.arrayValue,p=h[gd]?.arrayValue,v=Nt(d?.values?.length||0,p?.values?.length||0);return v!==0?v:mT(d,p)})(t.mapValue,e.mapValue);case 11:return(function(o,l){if(o===Bh.mapValue&&l===Bh.mapValue)return 0;if(o===Bh.mapValue)return 1;if(l===Bh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){const _=rg(h[v],p[v]);if(_!==0)return _;const y=Yc(u[h[v]],d[p[v]]);if(y!==0)return y}return Nt(h.length,p.length)})(t.mapValue,e.mapValue);default:throw lt(23264,{he:r})}}function dT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Nt(t,e);const r=bo(t),n=bo(e),a=Nt(r.seconds,n.seconds);return a!==0?a:Nt(r.nanos,n.nanos)}function mT(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=Yc(r[a],n[a]);if(o)return o}return Nt(r.length,n.length)}function Qc(t){return ng(t)}function ng(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=bo(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return ko(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return rt.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=ng(o);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const l of n)o?o=!1:a+=",",a+=`${l}:${ng(r.fields[l])}`;return a+"}"})(t.mapValue):lt(61005,{value:t})}function nd(t){switch(Co(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$d(t);return e?16+nd(e):16;case 5:return 2*t.stringValue.length;case 6:return ko(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,o)=>a+nd(o)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return Lo(n.fields,((o,l)=>{a+=o.length+nd(l)})),a})(t.mapValue);default:throw lt(13486,{value:t})}}function ag(t){return!!t&&"integerValue"in t}function qg(t){return!!t&&"arrayValue"in t}function pT(t){return!!t&&"nullValue"in t}function gT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ad(t){return!!t&&"mapValue"in t}function S6(t){return(t?.mapValue?.fields||{})[oS]?.stringValue===lS}function vf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Lo(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=vf(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=vf(t.arrayValue.values[r]);return e}return{...t}}function A6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===E6}class ua{constructor(e){this.value=e}static empty(){return new ua({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ad(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=vf(r)}setAll(e){let r=An.emptyPath(),n={},a=[];e.forEach(((l,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=vf(l):a.push(u.lastSegment())}));const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());ad(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Gi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];ad(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Lo(r,((a,o)=>e[a]=o));for(const a of n)delete e[a]}clone(){return new ua(vf(this.value))}}function cS(t){const e=[];return Lo(t.fields,((r,n)=>{const a=new An([r]);if(ad(n)){const o=cS(n.mapValue).fields;if(o.length===0)e.push(a);else for(const l of o)e.push(a.child(l))}else e.push(a)})),new Ra(e)}class Vn{constructor(e,r,n,a,o,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Vn(e,0,dt.min(),dt.min(),dt.min(),ua.empty(),0)}static newFoundDocument(e,r,n,a){return new Vn(e,1,r,dt.min(),n,a,0)}static newNoDocument(e,r){return new Vn(e,2,r,dt.min(),dt.min(),ua.empty(),0)}static newUnknownDocument(e,r){return new Vn(e,3,r,dt.min(),dt.min(),ua.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ua.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ua.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xd{constructor(e,r){this.position=e,this.inclusive=r}}function xT(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],l=t.position[a];if(o.field.isKeyField()?n=rt.comparator(rt.fromName(l.referenceValue),r.key):n=Yc(l,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function vT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Gi(t.position[r],e.position[r]))return!1;return!0}class vd{constructor(e,r="asc"){this.field=e,this.dir=r}}function b6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class uS{}class nn extends uS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new C6(e,r,n):r==="array-contains"?new I6(e,n):r==="in"?new D6(e,n):r==="not-in"?new O6(e,n):r==="array-contains-any"?new F6(e,n):new nn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new N6(e,n):new R6(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Yc(r,this.value)):r!==null&&Co(this.value)===Co(r)&&this.matchesComparison(Yc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return lt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qi extends uS{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new qi(e,r)}matches(e){return fS(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fS(t){return t.op==="and"}function hS(t){return k6(t)&&fS(t)}function k6(t){for(const e of t.filters)if(e instanceof qi)return!1;return!0}function ig(t){if(t instanceof nn)return t.field.canonicalString()+t.op.toString()+Qc(t.value);if(hS(t))return t.filters.map((e=>ig(e))).join(",");{const e=t.filters.map((r=>ig(r))).join(",");return`${t.op}(${e})`}}function dS(t,e){return t instanceof nn?(function(n,a){return a instanceof nn&&n.op===a.op&&n.field.isEqual(a.field)&&Gi(n.value,a.value)})(t,e):t instanceof qi?(function(n,a){return a instanceof qi&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((o,l,u)=>o&&dS(l,a.filters[u])),!0):!1})(t,e):void lt(19439)}function mS(t){return t instanceof nn?(function(r){return`${r.field.canonicalString()} ${r.op} ${Qc(r.value)}`})(t):t instanceof qi?(function(r){return r.op.toString()+" {"+r.getFilters().map(mS).join(" ,")+"}"})(t):"Filter"}class C6 extends nn{constructor(e,r,n){super(e,r,n),this.key=rt.fromName(n.referenceValue)}matches(e){const r=rt.comparator(e.key,this.key);return this.matchesComparison(r)}}class N6 extends nn{constructor(e,r){super(e,"in",r),this.keys=pS("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class R6 extends nn{constructor(e,r){super(e,"not-in",r),this.keys=pS("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function pS(t,e){return(e.arrayValue?.values||[]).map((r=>rt.fromName(r.referenceValue)))}class I6 extends nn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return qg(r)&&Mf(r.arrayValue,this.value)}}class D6 extends nn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Mf(this.value.arrayValue,r)}}class O6 extends nn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Mf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Mf(this.value.arrayValue,r)}}class F6 extends nn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!qg(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>Mf(this.value.arrayValue,n)))}}class M6{constructor(e,r=null,n=[],a=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function _T(t,e=null,r=[],n=[],a=null,o=null,l=null){return new M6(t,e,r,n,a,o,l)}function Xg(t){const e=pt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>ig(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),Kd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Qc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Qc(n))).join(",")),e.Te=r}return e.Te}function Wg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!b6(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!dS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vT(t.startAt,e.startAt)&&vT(t.endAt,e.endAt)}function sg(t){return rt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Yd{constructor(e,r=null,n=[],a=[],o=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function L6(t,e,r,n,a,o,l,u){return new Yd(t,e,r,n,a,o,l,u)}function Qd(t){return new Yd(t)}function yT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function P6(t){return t.collectionGroup!==null}function _f(t){const e=pt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new sn(An.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new vd(o,n))})),r.has(An.keyField().canonicalString())||e.Ie.push(new vd(An.keyField(),n))}return e.Ie}function Vi(t){const e=pt(t);return e.Ee||(e.Ee=V6(e,_f(t))),e.Ee}function V6(t,e){if(t.limitType==="F")return _T(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const o=a.dir==="desc"?"asc":"desc";return new vd(a.field,o)}));const r=t.endAt?new xd(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new xd(t.startAt.position,t.startAt.inclusive):null;return _T(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function og(t,e,r){return new Yd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Jd(t,e){return Wg(Vi(t),Vi(e))&&t.limitType===e.limitType}function gS(t){return`${Xg(Vi(t))}|lt:${t.limitType}`}function Rc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>mS(a))).join(", ")}]`),Kd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>Qc(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>Qc(a))).join(",")),`Target(${n})`})(Vi(t))}; limitType=${t.limitType})`}function Zd(t,e){return e.isFoundDocument()&&(function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):rt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(t,e)&&(function(n,a){for(const o of _f(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(l,u,h){const d=xT(l,u,h);return l.inclusive?d<=0:d<0})(n.startAt,_f(n),a)||n.endAt&&!(function(l,u,h){const d=xT(l,u,h);return l.inclusive?d>=0:d>0})(n.endAt,_f(n),a))})(t,e)}function B6(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xS(t){return(e,r)=>{let n=!1;for(const a of _f(t)){const o=U6(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function U6(t,e,r){const n=t.field.isKeyField()?rt.comparator(e.key,r.key):(function(o,l,u){const h=l.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Yc(h,d):lt(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return lt(19790,{direction:t.dir})}}class Ml{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Lo(this.inner,((r,n)=>{for(const[a,o]of n)e(a,o)}))}isEmpty(){return tS(this.inner)}size(){return this.innerSize}}const j6=new Ar(rt.comparator);function Ts(){return j6}const vS=new Ar(rt.comparator);function ff(...t){let e=vS;for(const r of t)e=e.insert(r.key,r);return e}function _S(t){let e=vS;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function gl(){return yf()}function yS(){return yf()}function yf(){return new Ml((t=>t.toString()),((t,e)=>t.isEqual(e)))}const z6=new Ar(rt.comparator),H6=new sn(rt.comparator);function Rt(...t){let e=H6;for(const r of t)e=e.add(r);return e}const G6=new sn(Nt);function q6(){return G6}function Kg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:md(e)?"-0":e}}function TS(t){return{integerValue:""+t}}function X6(t,e){return v6(e)?TS(e):Kg(t,e)}class em{constructor(){this._=void 0}}function W6(t,e,r){return t instanceof _d?(function(a,o){const l={fields:{[aS]:{stringValue:nS},[sS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&Gg(o)&&(o=$d(o)),o&&(l.fields[iS]=o),{mapValue:l}})(r,e):t instanceof Lf?ES(t,e):t instanceof Pf?SS(t,e):(function(a,o){const l=wS(a,o),u=TT(l)+TT(a.Ae);return ag(l)&&ag(a.Ae)?TS(u):Kg(a.serializer,u)})(t,e)}function K6(t,e,r){return t instanceof Lf?ES(t,e):t instanceof Pf?SS(t,e):r}function wS(t,e){return t instanceof yd?(function(n){return ag(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class _d extends em{}class Lf extends em{constructor(e){super(),this.elements=e}}function ES(t,e){const r=AS(e);for(const n of t.elements)r.some((a=>Gi(a,n)))||r.push(n);return{arrayValue:{values:r}}}class Pf extends em{constructor(e){super(),this.elements=e}}function SS(t,e){let r=AS(e);for(const n of t.elements)r=r.filter((a=>!Gi(a,n)));return{arrayValue:{values:r}}}class yd extends em{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function TT(t){return Lr(t.integerValue||t.doubleValue)}function AS(t){return qg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $6(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof Lf&&a instanceof Lf||n instanceof Pf&&a instanceof Pf?$c(n.elements,a.elements,Gi):n instanceof yd&&a instanceof yd?Gi(n.Ae,a.Ae):n instanceof _d&&a instanceof _d})(t.transform,e.transform)}class Y6{constructor(e,r){this.version=e,this.transformResults=r}}class vi{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new vi}static exists(e){return new vi(void 0,e)}static updateTime(e){return new vi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function id(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tm{}function bS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new $g(t.key,vi.none()):new a0(t.key,t.data,vi.none());{const r=t.data,n=ua.empty();let a=new sn(An.comparator);for(let o of e.fields)if(!a.has(o)){let l=r.field(o);l===null&&o.length>1&&(o=o.popLast(),l=r.field(o)),l===null?n.delete(o):n.set(o,l),a=a.add(o)}return new Po(t.key,n,new Ra(a.toArray()),vi.none())}}function Q6(t,e,r){t instanceof a0?(function(a,o,l){const u=a.value.clone(),h=ET(a.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(t,e,r):t instanceof Po?(function(a,o,l){if(!id(a.precondition,o))return void o.convertToUnknownDocument(l.version);const u=ET(a.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(kS(a)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(t,e,r):(function(a,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,r)}function Tf(t,e,r,n){return t instanceof a0?(function(o,l,u,h){if(!id(o.precondition,l))return u;const d=o.value.clone(),p=ST(o.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof Po?(function(o,l,u,h){if(!id(o.precondition,l))return u;const d=ST(o.fieldTransforms,h,l),p=l.data;return p.setAll(kS(o)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(t,e,r,n):(function(o,l,u){return id(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(t,e,r)}function J6(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=wS(n.transform,a||null);o!=null&&(r===null&&(r=ua.empty()),r.set(n.field,o))}return r||null}function wT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&$c(n,a,((o,l)=>$6(o,l)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class a0 extends tm{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Po extends tm{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function kS(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function ET(t,e,r){const n=new Map;Kt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const o=t[a],l=o.transform,u=e.data.field(o.field);n.set(o.field,K6(l,u,r[a]))}return n}function ST(t,e,r){const n=new Map;for(const a of t){const o=a.transform,l=r.data.field(a.field);n.set(a.field,W6(o,l,e))}return n}class $g extends tm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Z6 extends tm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eN{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&Q6(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Tf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Tf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=yS();return this.mutations.forEach((a=>{const o=e.get(a.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=r.has(a.key)?null:u;const h=bS(l,u);h!==null&&n.set(a.key,h),l.isValidDocument()||l.convertToNoDocument(dt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Rt())}isEqual(e){return this.batchId===e.batchId&&$c(this.mutations,e.mutations,((r,n)=>wT(r,n)))&&$c(this.baseMutations,e.baseMutations,((r,n)=>wT(r,n)))}}class Yg{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Kt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return z6})();const o=e.mutations;for(let l=0;l<o.length;l++)a=a.insert(o[l].key,n[l].version);return new Yg(e,r,n,a)}}class tN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class rN{constructor(e,r){this.count=e,this.unchangedNames=r}}var Kr,Mt;function nN(t){switch(t){case Fe.OK:return lt(64938);case Fe.CANCELLED:case Fe.UNKNOWN:case Fe.DEADLINE_EXCEEDED:case Fe.RESOURCE_EXHAUSTED:case Fe.INTERNAL:case Fe.UNAVAILABLE:case Fe.UNAUTHENTICATED:return!1;case Fe.INVALID_ARGUMENT:case Fe.NOT_FOUND:case Fe.ALREADY_EXISTS:case Fe.PERMISSION_DENIED:case Fe.FAILED_PRECONDITION:case Fe.ABORTED:case Fe.OUT_OF_RANGE:case Fe.UNIMPLEMENTED:case Fe.DATA_LOSS:return!0;default:return lt(15467,{code:t})}}function CS(t){if(t===void 0)return ys("GRPC error has no .code"),Fe.UNKNOWN;switch(t){case Kr.OK:return Fe.OK;case Kr.CANCELLED:return Fe.CANCELLED;case Kr.UNKNOWN:return Fe.UNKNOWN;case Kr.DEADLINE_EXCEEDED:return Fe.DEADLINE_EXCEEDED;case Kr.RESOURCE_EXHAUSTED:return Fe.RESOURCE_EXHAUSTED;case Kr.INTERNAL:return Fe.INTERNAL;case Kr.UNAVAILABLE:return Fe.UNAVAILABLE;case Kr.UNAUTHENTICATED:return Fe.UNAUTHENTICATED;case Kr.INVALID_ARGUMENT:return Fe.INVALID_ARGUMENT;case Kr.NOT_FOUND:return Fe.NOT_FOUND;case Kr.ALREADY_EXISTS:return Fe.ALREADY_EXISTS;case Kr.PERMISSION_DENIED:return Fe.PERMISSION_DENIED;case Kr.FAILED_PRECONDITION:return Fe.FAILED_PRECONDITION;case Kr.ABORTED:return Fe.ABORTED;case Kr.OUT_OF_RANGE:return Fe.OUT_OF_RANGE;case Kr.UNIMPLEMENTED:return Fe.UNIMPLEMENTED;case Kr.DATA_LOSS:return Fe.DATA_LOSS;default:return lt(39323,{code:t})}}(Mt=Kr||(Kr={}))[Mt.OK=0]="OK",Mt[Mt.CANCELLED=1]="CANCELLED",Mt[Mt.UNKNOWN=2]="UNKNOWN",Mt[Mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mt[Mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mt[Mt.NOT_FOUND=5]="NOT_FOUND",Mt[Mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mt[Mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mt[Mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mt[Mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mt[Mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mt[Mt.ABORTED=10]="ABORTED",Mt[Mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mt[Mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mt[Mt.INTERNAL=13]="INTERNAL",Mt[Mt.UNAVAILABLE=14]="UNAVAILABLE",Mt[Mt.DATA_LOSS=15]="DATA_LOSS";function aN(){return new TextEncoder}const iN=new To([4294967295,4294967295],0);function AT(t){const e=aN().encode(t),r=new GE;return r.update(e),new Uint8Array(r.digest())}function bT(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new To([r,n],0),new To([a,o],0)]}class Qg{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new hf(`Invalid padding: ${r}`);if(n<0)throw new hf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new hf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new hf(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=To.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(To.fromNumber(n)));return a.compare(iN)===1&&(a=new To([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=AT(e),[n,a]=bT(r);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,a,o);if(!this.we(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new Qg(o,a,r);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const r=AT(e),[n,a]=bT(r);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,a,o);this.Se(l)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class hf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rm{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,i0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new rm(dt.min(),a,new Ar(Nt),Ts(),Rt())}}class i0{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new i0(n,r,Rt(),Rt(),Rt())}}class sd{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class NS{constructor(e,r){this.targetId=e,this.Ce=r}}class RS{constructor(e,r,n=Cn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class kT{constructor(){this.ve=0,this.Fe=CT(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Rt(),r=Rt(),n=Rt();return this.Fe.forEach(((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:lt(38017,{changeType:o})}})),new i0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=CT()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Kt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class sN{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ts(),this.Je=Uh(),this.He=Uh(),this.Ye=new Ar(Nt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:lt(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const o=a.target;if(sg(o))if(n===0){const l=new rt(o.path);this.et(r,l,Vn.newNoDocument(l,dt.min()))}else Kt(n===1,20013,{expectedCount:n});else{const l=this._t(r);if(l!==n){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let l,u;try{l=ko(n).toUint8Array()}catch(h){if(h instanceof rS)return Kc("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Qg(l,a,o)}catch(h){return Kc(h instanceof hf?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(r,o,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&sg(u.target)){const h=new rt(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Vn.newNoDocument(h,e))}o.Be&&(r.set(l,o.ke()),o.qe())}}));let n=Rt();this.He.forEach(((o,l)=>{let u=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const a=new rm(e,r,this.Ye,this.je,n);return this.je=Ts(),this.Je=Uh(),this.He=Uh(),this.Ye=new Ar(Nt),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new kT,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new sn(Nt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new sn(Nt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||We("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kT),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Uh(){return new Ar(rt.comparator)}function CT(){return new Ar(rt.comparator)}const oN={asc:"ASCENDING",desc:"DESCENDING"},lN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cN={and:"AND",or:"OR"};class uN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function lg(t,e){return t.useProto3Json||Kd(e)?e:{value:e}}function Td(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function IS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fN(t,e){return Td(t,e.toTimestamp())}function Bi(t){return Kt(!!t,49232),dt.fromTimestamp((function(r){const n=bo(r);return new gr(n.seconds,n.nanos)})(t))}function Jg(t,e){return cg(t,e).canonicalString()}function cg(t,e){const r=(function(a){return new pr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function DS(t){const e=pr.fromString(t);return Kt(PS(e),10190,{key:e.toString()}),e}function ug(t,e){return Jg(t.databaseId,e.path)}function Rp(t,e){const r=DS(e);if(r.get(1)!==t.databaseId.projectId)throw new Je(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Je(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new rt(FS(r))}function OS(t,e){return Jg(t.databaseId,e)}function hN(t){const e=DS(t);return e.length===4?pr.emptyPath():FS(e)}function fg(t){return new pr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function FS(t){return Kt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function NT(t,e,r){return{name:ug(t,e),fields:r.value.mapValue.fields}}function dN(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:lt(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(Kt(p===void 0||typeof p=="string",58123),Cn.fromBase64String(p||"")):(Kt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Cn.fromUint8Array(p||new Uint8Array))})(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(d){const p=d.code===void 0?Fe.UNKNOWN:CS(d.code);return new Je(p,d.message||"")})(l);r=new RS(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Rp(t,n.document.name),o=Bi(n.document.updateTime),l=n.document.createTime?Bi(n.document.createTime):dt.min(),u=new ua({mapValue:{fields:n.document.fields}}),h=Vn.newFoundDocument(a,o,l,u),d=n.targetIds||[],p=n.removedTargetIds||[];r=new sd(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Rp(t,n.document),o=n.readTime?Bi(n.readTime):dt.min(),l=Vn.newNoDocument(a,o),u=n.removedTargetIds||[];r=new sd([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Rp(t,n.document),o=n.removedTargetIds||[];r=new sd([],o,a,null)}else{if(!("filter"in e))return lt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,l=new rN(a,o),u=n.targetId;r=new NS(u,l)}}return r}function mN(t,e){let r;if(e instanceof a0)r={update:NT(t,e.key,e.value)};else if(e instanceof $g)r={delete:ug(t,e.key)};else if(e instanceof Po)r={update:NT(t,e.key,e.data),updateMask:EN(e.fieldMask)};else{if(!(e instanceof Z6))return lt(16599,{Vt:e.type});r={verify:ug(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(o,l){const u=l.transform;if(u instanceof _d)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Lf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Pf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof yd)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw lt(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,o){return o.updateTime!==void 0?{updateTime:fN(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:lt(27497)})(t,e.precondition)),r}function pN(t,e){return t&&t.length>0?(Kt(e!==void 0,14353),t.map((r=>(function(a,o){let l=a.updateTime?Bi(a.updateTime):Bi(o);return l.isEqual(dt.min())&&(l=Bi(o)),new Y6(l,a.transformResults||[])})(r,e)))):[]}function gN(t,e){return{documents:[OS(t,e.path)]}}function xN(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=OS(t,a);const o=(function(d){if(d.length!==0)return LS(qi.create(d,"and"))})(e.filters);o&&(r.structuredQuery.where=o);const l=(function(d){if(d.length!==0)return d.map((p=>(function(_){return{field:Ic(_.field),direction:yN(_.dir)}})(p)))})(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=lg(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:a}}function vN(t){let e=hN(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Kt(n===1,65062);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let o=[];r.where&&(o=(function(v){const _=MS(v);return _ instanceof qi&&hS(_)?_.getFilters():[_]})(r.where));let l=[];r.orderBy&&(l=(function(v){return v.map((_=>(function(S){return new vd(Dc(S.field),(function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(r.orderBy));let u=null;r.limit&&(u=(function(v){let _;return _=typeof v=="object"?v.value:v,Kd(_)?null:_})(r.limit));let h=null;r.startAt&&(h=(function(v){const _=!!v.before,y=v.values||[];return new xd(y,_)})(r.startAt));let d=null;return r.endAt&&(d=(function(v){const _=!v.before,y=v.values||[];return new xd(y,_)})(r.endAt)),L6(e,a,l,o,u,"F",h,d)}function _N(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return lt(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function MS(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Dc(r.unaryFilter.field);return nn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Dc(r.unaryFilter.field);return nn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Dc(r.unaryFilter.field);return nn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Dc(r.unaryFilter.field);return nn.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return lt(61313);default:return lt(60726)}})(t):t.fieldFilter!==void 0?(function(r){return nn.create(Dc(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return lt(58110);default:return lt(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return qi.create(r.compositeFilter.filters.map((n=>MS(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return lt(1026)}})(r.compositeFilter.op))})(t):lt(30097,{filter:t})}function yN(t){return oN[t]}function TN(t){return lN[t]}function wN(t){return cN[t]}function Ic(t){return{fieldPath:t.canonicalString()}}function Dc(t){return An.fromServerFormat(t.fieldPath)}function LS(t){return t instanceof nn?(function(r){if(r.op==="=="){if(gT(r.value))return{unaryFilter:{field:Ic(r.field),op:"IS_NAN"}};if(pT(r.value))return{unaryFilter:{field:Ic(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(gT(r.value))return{unaryFilter:{field:Ic(r.field),op:"IS_NOT_NAN"}};if(pT(r.value))return{unaryFilter:{field:Ic(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ic(r.field),op:TN(r.op),value:r.value}}})(t):t instanceof qi?(function(r){const n=r.getFilters().map((a=>LS(a)));return n.length===1?n[0]:{compositeFilter:{op:wN(r.op),filters:n}}})(t):lt(54877,{filter:t})}function EN(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function PS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class po{constructor(e,r,n,a,o=dt.min(),l=dt.min(),u=Cn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new po(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class SN{constructor(e){this.yt=e}}function AN(t){const e=vN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?og(e,e.limit,"L"):e}class bN{constructor(){this.Cn=new kN}addToCollectionParentIndex(e,r){return this.Cn.add(r),De.resolve()}getCollectionParents(e,r){return De.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return De.resolve()}deleteFieldIndex(e,r){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,r){return De.resolve()}getDocumentsMatchingTarget(e,r){return De.resolve(null)}getIndexType(e,r){return De.resolve(0)}getFieldIndexes(e,r){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,r){return De.resolve(Ao.min())}getMinOffsetFromCollectionGroup(e,r){return De.resolve(Ao.min())}updateCollectionGroup(e,r,n){return De.resolve()}updateIndexEntries(e,r){return De.resolve()}}class kN{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new sn(pr.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new sn(pr.comparator)).toArray()}}const RT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},VS=41943040;class la{static withCacheSize(e){return new la(e,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}la.DEFAULT_COLLECTION_PERCENTILE=10,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,la.DEFAULT=new la(VS,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),la.DISABLED=new la(-1,0,0);class Jc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Jc(0)}static cr(){return new Jc(-1)}}const IT="LruGarbageCollector",CN=1048576;function DT([t,e],[r,n]){const a=Nt(t,r);return a===0?Nt(e,n):a}class NN{constructor(e){this.Ir=e,this.buffer=new sn(DT),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();DT(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class RN{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){We(IT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){ou(r)?We(IT,"Ignoring IndexedDB error during garbage collection: ",r):await su(r)}await this.Vr(3e5)}))}}class IN{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return De.resolve(Wd.ce);const n=new NN(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(We("LruGarbageCollector","Garbage collection skipped; disabled"),De.resolve(RT)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(We("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),RT):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,o,l,u,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(We("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,l=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(n=v,u=Date.now(),this.removeTargets(e,n,r)))).next((v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,n)))).next((v=>(d=Date.now(),Nc()<=Ct.DEBUG&&We("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),De.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:v}))))}}function DN(t,e){return new IN(t,e)}class ON{constructor(){this.changes=new Ml((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Vn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?De.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class FN{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class MN{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Tf(n.mutation,a,Ra.empty(),gr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Rt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Rt()){const a=gl();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((o=>{let l=ff();return o.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,r){const n=gl();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Rt())))}populateOverlays(e,r,n){const a=[];return n.forEach((o=>{r.has(o)||a.push(o)})),this.documentOverlayCache.getOverlays(e,a).next((o=>{o.forEach(((l,u)=>{r.set(l,u)}))}))}computeViews(e,r,n,a){let o=Ts();const l=yf(),u=(function(){return yf()})();return r.forEach(((h,d)=>{const p=n.get(d.key);a.has(d.key)&&(p===void 0||p.mutation instanceof Po)?o=o.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),Tf(p.mutation,d,p.mutation.getFieldMask(),gr.now())):l.set(d.key,Ra.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((d,p)=>l.set(d,p))),r.forEach(((d,p)=>u.set(d,new FN(p,l.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=yf();let a=new Ar(((l,u)=>l-u)),o=Rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((l=>{for(const u of l)u.keys().forEach((h=>{const d=r.get(h);if(d===null)return;let p=n.get(h)||Ra.empty();p=u.applyToLocalView(d,p),n.set(h,p);const v=(a.get(u.batchId)||Rt()).add(h);a=a.insert(u.batchId,v)}))})).next((()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,p=h.value,v=yS();p.forEach((_=>{if(!o.has(_)){const y=bS(r.get(_),n.get(_));y!==null&&v.set(_,y),o=o.add(_)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,v))}return De.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(l){return rt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):P6(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((o=>{const l=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):De.resolve(gl());let u=Df,h=o;return l.next((d=>De.forEach(d,((p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(p)?De.resolve():this.remoteDocumentCache.getEntry(e,p).next((_=>{h=h.insert(p,_)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,h,d,Rt()))).next((p=>({batchId:u,changes:_S(p)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new rt(r)).next((n=>{let a=ff();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let l=ff();return this.indexManager.getCollectionParents(e,o).next((u=>De.forEach(u,(h=>{const d=(function(v,_){return new Yd(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((p=>{p.forEach(((v,_)=>{l=l.insert(v,_)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a)))).next((l=>{o.forEach(((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,Vn.newInvalidDocument(p)))}));let u=ff();return l.forEach(((h,d)=>{const p=o.get(h);p!==void 0&&Tf(p.mutation,d,Ra.empty(),gr.now()),Zd(r,d)&&(u=u.insert(h,d))})),u}))}}class LN{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return De.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:Bi(a.createTime)}})(r)),De.resolve()}getNamedQuery(e,r){return De.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:AN(a.bundledQuery),readTime:Bi(a.readTime)}})(r)),De.resolve()}}class PN{constructor(){this.overlays=new Ar(rt.comparator),this.qr=new Map}getOverlay(e,r){return De.resolve(this.overlays.get(r))}getOverlays(e,r){const n=gl();return De.forEach(r,(a=>this.getOverlay(e,a).next((o=>{o!==null&&n.set(a,o)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,o)=>{this.St(e,r,o)})),De.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),De.resolve()}getOverlaysForCollection(e,r,n){const a=gl(),o=r.length+1,l=new rt(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&a.set(h.getKey(),h)}return De.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new Ar(((d,p)=>d-p));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let p=o.get(d.largestBatchId);p===null&&(p=gl(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=gl(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>u.set(d,p))),!(u.size()>=a)););return De.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new tN(r,n));let o=this.qr.get(r);o===void 0&&(o=Rt(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}class VN{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,De.resolve()}}class Zg{constructor(){this.Qr=new sn(hn.$r),this.Ur=new sn(hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new hn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new hn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new rt(new pr([])),n=new hn(r,e),a=new hn(r,e+1),o=[];return this.Ur.forEachInRange([n,a],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new rt(new pr([])),n=new hn(r,e),a=new hn(r,e+1);let o=Rt();return this.Ur.forEachInRange([n,a],(l=>{o=o.add(l.key)})),o}containsKey(e){const r=new hn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class hn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return rt.comparator(e.key,r.key)||Nt(e.Yr,r.Yr)}static Kr(e,r){return Nt(e.Yr,r.Yr)||rt.comparator(e.key,r.key)}}class BN{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new sn(hn.$r)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new eN(o,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Zr=this.Zr.add(new hn(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return De.resolve(l)}lookupMutationBatch(e,r){return De.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),o=a<0?0:a;return De.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?Hg:this.tr-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new hn(r,0),a=new hn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,a],(l=>{const u=this.Xr(l.Yr);o.push(u)})),De.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new sn(Nt);return r.forEach((a=>{const o=new hn(a,0),l=new hn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(u=>{n=n.add(u.Yr)}))})),De.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;rt.isDocumentKey(o)||(o=o.child(""));const l=new hn(new rt(o),0);let u=new sn(Nt);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(h.Yr)),!0)}),l),De.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Kt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return De.forEach(r.mutations,(a=>{const o=new hn(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new hn(r,0),a=this.Zr.firstAfterOrEqual(n);return De.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class UN{constructor(e){this.ri=e,this.docs=(function(){return new Ar(rt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,l=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return De.resolve(n?n.document.mutableCopy():Vn.newInvalidDocument(r))}getEntries(e,r){let n=Ts();return r.forEach((a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():Vn.newInvalidDocument(a))})),De.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=Ts();const l=r.path,u=new rt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||m6(d6(p),n)<=0||(a.has(p.key)||Zd(r,p))&&(o=o.insert(p.key,p.mutableCopy()))}return De.resolve(o)}getAllFromCollectionGroup(e,r,n,a){lt(9500)}ii(e,r){return De.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new jN(this)}getSize(e){return De.resolve(this.size)}}class jN extends ON{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),De.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class zN{constructor(e){this.persistence=e,this.si=new Ml((r=>Xg(r)),Wg),this.lastRemoteSnapshotVersion=dt.min(),this.highestTargetId=0,this.oi=0,this._i=new Zg,this.targetCount=0,this.ai=Jc.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),De.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Jc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,De.resolve()}updateTargetData(e,r){return this.Pr(r),De.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),De.waitFor(o).next((()=>a))}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return De.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),De.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach((l=>{o.push(a.markPotentiallyOrphaned(e,l))})),De.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),De.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return De.resolve(n)}containsKey(e,r){return De.resolve(this._i.containsKey(r))}}class BS{constructor(e,r){this.ui={},this.overlays={},this.ci=new Wd(0),this.li=!1,this.li=!0,this.hi=new VN,this.referenceDelegate=e(this),this.Pi=new zN(this),this.indexManager=new bN,this.remoteDocumentCache=(function(a){return new UN(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new SN(r),this.Ii=new LN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new PN,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new BN(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){We("MemoryPersistence","Starting transaction:",e);const a=new HN(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((o=>this.referenceDelegate.di(a).next((()=>o)))).toPromise().then((o=>(a.raiseOnCommittedEvent(),o)))}Ai(e,r){return De.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class HN extends g6{constructor(e){super(),this.currentSequenceNumber=e}}class ex{constructor(e){this.persistence=e,this.Ri=new Zg,this.Vi=null}static mi(e){return new ex(e)}get fi(){if(this.Vi)return this.Vi;throw lt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),De.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),De.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),De.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.fi,(n=>{const a=rt.fromPath(n);return this.gi(e,a).next((o=>{o||r.removeEntry(a,dt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return De.or([()=>De.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class wd{constructor(e,r){this.persistence=e,this.pi=new Ml((n=>_6(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=DN(this,r)}static mi(e,r){return new wd(e,r)}Ei(){}di(e){return De.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return De.forEach(this.pi,((n,a)=>this.br(e,n,a).next((o=>o?De.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ii(e,(l=>this.br(e,l,r).next((u=>{u||(n++,o.removeEntry(l,dt.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),De.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),De.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),De.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),De.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=nd(e.data.value)),r}br(e,r,n){return De.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return De.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class tx{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Rt(),a=Rt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new tx(e,r.fromCache,n,a)}}class GN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class qN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return MC()?8:x6(zn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.ys(e,r).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(e,r,a,n).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new GN;return this.Ss(e,r,l).next((u=>{if(o.result=u,this.Vs)return this.bs(e,r,l,u.size)}))})).next((()=>o.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(Nc()<=Ct.DEBUG&&We("QueryEngine","SDK will not create cache indexes for query:",Rc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),De.resolve()):(Nc()<=Ct.DEBUG&&We("QueryEngine","Query:",Rc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(Nc()<=Ct.DEBUG&&We("QueryEngine","The SDK decides to create cache indexes for query:",Rc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vi(r))):De.resolve())}ys(e,r){if(yT(r))return De.resolve(null);let n=Vi(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=og(r,null,"F"),n=Vi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const l=Rt(...o);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((h=>{const d=this.Ds(r,u);return this.Cs(r,d,l,h.readTime)?this.ys(e,og(r,null,"F")):this.vs(e,d,r,h)}))))})))))}ws(e,r,n,a){return yT(r)||a.isEqual(dt.min())?De.resolve(null):this.ps.getDocuments(e,n).next((o=>{const l=this.Ds(r,o);return this.Cs(r,l,n,a)?De.resolve(null):(Nc()<=Ct.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Rc(r)),this.vs(e,l,r,h6(a,Df)).next((u=>u)))}))}Ds(e,r){let n=new sn(xS(e));return r.forEach(((a,o)=>{Zd(e,o)&&(n=n.add(o))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}Ss(e,r,n){return Nc()<=Ct.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",Rc(r)),this.ps.getDocumentsMatchingQuery(e,r,Ao.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((o=>(r.forEach((l=>{o=o.insert(l.key,l)})),o)))}}const rx="LocalStore",XN=3e8;class WN{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new Ar(Nt),this.xs=new Ml((o=>Xg(o)),Wg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function KN(t,e,r,n){return new WN(t,e,r,n)}async function US(t,e){const r=pt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((o=>(a=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((o=>{const l=[],u=[];let h=Rt();for(const d of a){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of o){u.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return r.localDocuments.getDocuments(n,h).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:u})))}))}))}function $N(t,e){const r=pt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,p){const v=d.batch,_=v.keys();let y=De.resolve();return _.forEach((S=>{y=y.next((()=>p.getEntry(h,S))).next((w=>{const b=d.docVersions.get(S);Kt(b!==null,48541),w.version.compareTo(b)<0&&(v.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),p.addEntry(w)))}))})),y.next((()=>u.mutationQueue.removeMutationBatch(h,v)))})(r,n,e,o).next((()=>o.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=Rt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function jS(t){const e=pt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function YN(t,e){const r=pt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((p,v)=>{const _=a.get(v);if(!_)return;u.push(r.Pi.removeMatchingKeys(o,p.removedDocuments,v).next((()=>r.Pi.addMatchingKeys(o,p.addedDocuments,v))));let y=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?y=y.withResumeToken(Cn.EMPTY_BYTE_STRING,dt.min()).withLastLimboFreeSnapshotVersion(dt.min()):p.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(p.resumeToken,n)),a=a.insert(v,y),(function(w,b,F){return w.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=XN?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(_,y,p)&&u.push(r.Pi.updateTargetData(o,y))}));let h=Ts(),d=Rt();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,p))})),u.push(QN(o,l,e.documentUpdates).next((p=>{h=p.ks,d=p.qs}))),!n.isEqual(dt.min())){const p=r.Pi.getLastRemoteSnapshotVersion(o).next((v=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(p)}return De.waitFor(u).next((()=>l.apply(o))).next((()=>r.localDocuments.getLocalViewOfDocuments(o,h,d))).next((()=>h))})).then((o=>(r.Ms=a,o)))}function QN(t,e,r){let n=Rt(),a=Rt();return r.forEach((o=>n=n.add(o))),e.getEntries(t,n).next((o=>{let l=Ts();return r.forEach(((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),h.isNoDocument()&&h.version.isEqual(dt.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):We(rx,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)})),{ks:l,qs:a}}))}function JN(t,e){const r=pt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Hg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function ZN(t,e){const r=pt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((o=>o?(a=o,De.resolve(a)):r.Pi.allocateTargetId(n).next((l=>(a=new po(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function hg(t,e,r){const n=pt(t),a=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,(l=>n.persistence.referenceDelegate.removeTarget(l,a)))}catch(l){if(!ou(l))throw l;We(rx,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function OT(t,e,r){const n=pt(t);let a=dt.min(),o=Rt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,p){const v=pt(h),_=v.xs.get(p);return _!==void 0?De.resolve(v.Ms.get(_)):v.Pi.getTargetData(d,p)})(n,l,Vi(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{o=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,r?a:dt.min(),r?o:Rt()))).next((u=>(eR(n,B6(e),u),{documents:u,Qs:o})))))}function eR(t,e,r){let n=t.Os.get(e)||dt.min();r.forEach(((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),t.Os.set(e,n)}class FT{constructor(){this.activeTargetIds=q6()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tR{constructor(){this.Mo=new FT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new FT,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class rR{Oo(e){}shutdown(){}}const MT="ConnectivityMonitor";class LT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){We(MT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){We(MT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let jh=null;function dg(){return jh===null?jh=(function(){return 268435456+Math.round(2147483648*Math.random())})():jh++,"0x"+jh.toString(16)}const Ip="RestConnection",nR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aR{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===pd?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,o){const l=dg(),u=this.zo(e,r.toUriEncodedString());We(Ip,`Sending RPC '${e}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,a,o);const{host:d}=new URL(u),p=nu(d);return this.Jo(e,u,h,n,p).then((v=>(We(Ip,`Received RPC '${e}' ${l}: `,v),v)),(v=>{throw Kc(Ip,`RPC '${e}' ${l} failed with error: `,v,"url: ",u,"request:",n),v}))}Ho(e,r,n,a,o,l){return this.Go(e,r,n,a,o)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+iu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,o)=>e[o]=a)),n&&n.headers.forEach(((a,o)=>e[o]=a))}zo(e,r){const n=nR[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class iR{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const On="WebChannelConnection";class sR extends aR{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,o){const l=dg();return new Promise(((u,h)=>{const d=new qE;d.setWithCredentials(!0),d.listenOnce(XE.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case rd.NO_ERROR:const v=d.getResponseJson();We(On,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),u(v);break;case rd.TIMEOUT:We(On,`RPC '${e}' ${l} timed out`),h(new Je(Fe.DEADLINE_EXCEEDED,"Request time out"));break;case rd.HTTP_ERROR:const _=d.getStatus();if(We(On,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const S=y?.error;if(S&&S.status&&S.message){const w=(function(F){const z=F.toLowerCase().replace(/_/g,"-");return Object.values(Fe).indexOf(z)>=0?z:Fe.UNKNOWN})(S.status);h(new Je(w,S.message))}else h(new Je(Fe.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new Je(Fe.UNAVAILABLE,"Connection failed."));break;default:lt(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{We(On,`RPC '${e}' ${l} completed.`)}}));const p=JSON.stringify(a);We(On,`RPC '${e}' ${l} sending request:`,a),d.send(r,"POST",p,n,15)}))}T_(e,r,n){const a=dg(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=$E(),u=KE(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const p=o.join("");We(On,`Creating RPC '${e}' stream ${a}: ${p}`,h);const v=l.createWebChannel(p,h);this.I_(v);let _=!1,y=!1;const S=new iR({Yo:b=>{y?We(On,`Not sending because RPC '${e}' stream ${a} is closed:`,b):(_||(We(On,`Opening RPC '${e}' stream ${a} transport.`),v.open(),_=!0),We(On,`RPC '${e}' stream ${a} sending:`,b),v.send(b))},Zo:()=>v.close()}),w=(b,F,z)=>{b.listen(F,(N=>{try{z(N)}catch(K){setTimeout((()=>{throw K}),0)}}))};return w(v,uf.EventType.OPEN,(()=>{y||(We(On,`RPC '${e}' stream ${a} transport opened.`),S.o_())})),w(v,uf.EventType.CLOSE,(()=>{y||(y=!0,We(On,`RPC '${e}' stream ${a} transport closed`),S.a_(),this.E_(v))})),w(v,uf.EventType.ERROR,(b=>{y||(y=!0,Kc(On,`RPC '${e}' stream ${a} transport errored. Name:`,b.name,"Message:",b.message),S.a_(new Je(Fe.UNAVAILABLE,"The operation could not be completed")))})),w(v,uf.EventType.MESSAGE,(b=>{if(!y){const F=b.data[0];Kt(!!F,16349);const z=F,N=z?.error||z[0]?.error;if(N){We(On,`RPC '${e}' stream ${a} received error:`,N);const K=N.status;let te=(function(I){const R=Kr[I];if(R!==void 0)return CS(R)})(K),J=N.message;te===void 0&&(te=Fe.INTERNAL,J="Unknown error status: "+K+" with message "+N.message),y=!0,S.a_(new Je(te,J)),v.close()}else We(On,`RPC '${e}' stream ${a} received:`,F),S.u_(F)}})),w(u,WE.STAT_EVENT,(b=>{b.stat===tg.PROXY?We(On,`RPC '${e}' stream ${a} detected buffering proxy`):b.stat===tg.NOPROXY&&We(On,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function Dp(){return typeof document<"u"?document:null}function nm(t){return new uN(t,!0)}class zS{constructor(e,r,n=1e3,a=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&We("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const PT="PersistentStream";class HS{constructor(e,r,n,a,o,l,u,h){this.Mi=e,this.S_=n,this.b_=a,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new zS(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Fe.RESOURCE_EXHAUSTED?(ys(r.toString()),ys("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new Je(Fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return We(PT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(We(PT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class oR extends HS{constructor(e,r,n,a,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=dN(this.serializer,e),n=(function(o){if(!("targetChange"in o))return dt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?dt.min():l.readTime?Bi(l.readTime):dt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=fg(this.serializer),r.addTarget=(function(o,l){let u;const h=l.target;if(u=sg(h)?{documents:gN(o,h)}:{query:xN(o,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=IS(o,l.resumeToken);const d=lg(o,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(dt.min())>0){u.readTime=Td(o,l.snapshotVersion.toTimestamp());const d=lg(o,l.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=_N(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=fg(this.serializer),r.removeTarget=e,this.q_(r)}}class lR extends HS{constructor(e,r,n,a,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Kt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Kt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=pN(e.writeResults,e.commitTime),n=Bi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=fg(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>mN(this.serializer,n)))};this.q_(r)}}class cR{}class uR extends cR{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Je(Fe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(e,cg(r,n),a,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Je(Fe.UNKNOWN,o.toString())}))}Ho(e,r,n,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,cg(r,n),a,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Je(Fe.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class fR{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ys(r),this.aa=!1):We("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const bl="RemoteStore";class hR{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{Ll(this)&&(We(bl,"Restarting streams for network reachability change."),await(async function(h){const d=pt(h);d.Ea.add(4),await s0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await am(d)})(this))}))})),this.Ra=new fR(n,a)}}async function am(t){if(Ll(t))for(const e of t.da)await e(!0)}async function s0(t){for(const e of t.da)await e(!1)}function GS(t,e){const r=pt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),sx(r)?ix(r):lu(r).O_()&&ax(r,e))}function nx(t,e){const r=pt(t),n=lu(r);r.Ia.delete(e),n.O_()&&qS(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ll(r)&&r.Ra.set("Unknown"))}function ax(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(dt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}lu(t).Y_(e)}function qS(t,e){t.Va.Ue(e),lu(t).Z_(e)}function ix(t){t.Va=new sN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),lu(t).start(),t.Ra.ua()}function sx(t){return Ll(t)&&!lu(t).x_()&&t.Ia.size>0}function Ll(t){return pt(t).Ea.size===0}function XS(t){t.Va=void 0}async function dR(t){t.Ra.set("Online")}async function mR(t){t.Ia.forEach(((e,r)=>{ax(t,e)}))}async function pR(t,e){XS(t),sx(t)?(t.Ra.ha(e),ix(t)):t.Ra.set("Unknown")}async function gR(t,e,r){if(t.Ra.set("Online"),e instanceof RS&&e.state===2&&e.cause)try{await(async function(a,o){const l=o.cause;for(const u of o.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){We(bl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ed(t,n)}else if(e instanceof sd?t.Va.Ze(e):e instanceof NS?t.Va.st(e):t.Va.tt(e),!r.isEqual(dt.min()))try{const n=await jS(t.localStore);r.compareTo(n)>=0&&await(function(o,l){const u=o.Va.Tt(l);return u.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(d);p&&o.Ia.set(d,p.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,d)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(Cn.EMPTY_BYTE_STRING,p.snapshotVersion)),qS(o,h);const v=new po(p.target,h,d,p.sequenceNumber);ax(o,v)})),o.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){We(bl,"Failed to raise snapshot:",n),await Ed(t,n)}}async function Ed(t,e,r){if(!ou(e))throw e;t.Ea.add(1),await s0(t),t.Ra.set("Offline"),r||(r=()=>jS(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{We(bl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await am(t)}))}function WS(t,e){return e().catch((r=>Ed(t,r,e)))}async function im(t){const e=pt(t),r=No(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hg;for(;xR(e);)try{const a=await JN(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,vR(e,a)}catch(a){await Ed(e,a)}KS(e)&&$S(e)}function xR(t){return Ll(t)&&t.Ta.length<10}function vR(t,e){t.Ta.push(e);const r=No(t);r.O_()&&r.X_&&r.ea(e.mutations)}function KS(t){return Ll(t)&&!No(t).x_()&&t.Ta.length>0}function $S(t){No(t).start()}async function _R(t){No(t).ra()}async function yR(t){const e=No(t);for(const r of t.Ta)e.ea(r.mutations)}async function TR(t,e,r){const n=t.Ta.shift(),a=Yg.from(n,e,r);await WS(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await im(t)}async function wR(t,e){e&&No(t).X_&&await(async function(n,a){if((function(l){return nN(l)&&l!==Fe.ABORTED})(a.code)){const o=n.Ta.shift();No(n).B_(),await WS(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a))),await im(n)}})(t,e),KS(t)&&$S(t)}async function VT(t,e){const r=pt(t);r.asyncQueue.verifyOperationInProgress(),We(bl,"RemoteStore received new credentials");const n=Ll(r);r.Ea.add(3),await s0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await am(r)}async function ER(t,e){const r=pt(t);e?(r.Ea.delete(2),await am(r)):e||(r.Ea.add(2),await s0(r),r.Ra.set("Unknown"))}function lu(t){return t.ma||(t.ma=(function(r,n,a){const o=pt(r);return o.sa(),new oR(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:dR.bind(null,t),t_:mR.bind(null,t),r_:pR.bind(null,t),H_:gR.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),sx(t)?ix(t):t.Ra.set("Unknown")):(await t.ma.stop(),XS(t))}))),t.ma}function No(t){return t.fa||(t.fa=(function(r,n,a){const o=pt(r);return o.sa(),new lR(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:_R.bind(null,t),r_:wR.bind(null,t),ta:yR.bind(null,t),na:TR.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await im(t)):(await t.fa.stop(),t.Ta.length>0&&(We(bl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class ox{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new wo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const l=Date.now()+n,u=new ox(e,r,l,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Je(Fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lx(t,e){if(ys("AsyncQueue",`${e}: ${t}`),ou(t))return new Je(Fe.UNAVAILABLE,`${e}: ${t}`);throw t}class Vc{static emptySet(e){return new Vc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||rt.comparator(r.key,n.key):(r,n)=>rt.comparator(r.key,n.key),this.keyedMap=ff(),this.sortedSet=new Ar(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Vc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Vc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class BT{constructor(){this.ga=new Ar(rt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):lt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class Zc{constructor(e,r,n,a,o,l,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,o){const l=[];return r.forEach((u=>{l.push({type:0,doc:u})})),new Zc(e,r,Vc.emptySet(r),l,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class SR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class AR{constructor(){this.queries=UT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=pt(r),o=a.queries;a.queries=UT(),o.forEach(((l,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new Je(Fe.ABORTED,"Firestore shutting down"))}}function UT(){return new Ml((t=>gS(t)),Jd)}async function YS(t,e){const r=pt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.ba()&&e.Da()&&(n=2):(o=new SR,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(a,!0);break;case 1:o.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=lx(l,`Initialization of query '${Rc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&cx(r)}async function QS(t,e){const r=pt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?a=e.Da()?0:1:!o.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function bR(t,e){const r=pt(t);let n=!1;for(const a of e){const o=a.query,l=r.queries.get(o);if(l){for(const u of l.Sa)u.Fa(a)&&(n=!0);l.wa=a}}n&&cx(r)}function kR(t,e,r){const n=pt(t),a=n.queries.get(e);if(a)for(const o of a.Sa)o.onError(r);n.queries.delete(e)}function cx(t){t.Ca.forEach((e=>{e.next()}))}var mg,jT;(jT=mg||(mg={})).Ma="default",jT.Cache="cache";class JS{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Zc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Zc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mg.Cache}}class ZS{constructor(e){this.key=e}}class e4{constructor(e){this.key=e}}class CR{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Rt(),this.mutatedKeys=Rt(),this.eu=xS(e),this.tu=new Vc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new BT,a=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((p,v)=>{const _=a.get(p),y=Zd(this.query,v)?v:null,S=!!_&&this.mutatedKeys.has(_.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let b=!1;_&&y?_.data.isEqual(y.data)?S!==w&&(n.track({type:3,doc:y}),b=!0):this.su(_,y)||(n.track({type:2,doc:y}),b=!0,(h&&this.eu(y,h)>0||d&&this.eu(y,d)<0)&&(u=!0)):!_&&y?(n.track({type:0,doc:y}),b=!0):_&&!y&&(n.track({type:1,doc:_}),b=!0,(h||d)&&(u=!0)),b&&(y?(l=l.add(y),o=w?o.add(p):o.delete(p)):(l=l.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),o=o.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Cs:u,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((p,v)=>(function(y,S){const w=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return lt(20277,{Rt:b})}};return w(y)-w(S)})(p.type,v.type)||this.eu(p.doc,v.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],h=this.Xa.size===0&&this.current&&!a?1:0,d=h!==this.Za;return this.Za=h,l.length!==0||d?{snapshot:new Zc(this.query,e.tu,o,l,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new BT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Rt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new e4(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new ZS(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Rt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Zc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ux="SyncEngine";class NR{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class RR{constructor(e){this.key=e,this.hu=!1}}class IR{constructor(e,r,n,a,o,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Ml((u=>gS(u)),Jd),this.Iu=new Map,this.Eu=new Set,this.du=new Ar(rt.comparator),this.Au=new Map,this.Ru=new Zg,this.Vu={},this.mu=new Map,this.fu=Jc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function DR(t,e,r=!0){const n=s4(t);let a;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.lu()):a=await t4(n,e,r,!0),a}async function OR(t,e){const r=s4(t);await t4(r,e,!0,!1)}async function t4(t,e,r,n){const a=await ZN(t.localStore,Vi(e)),o=a.targetId,l=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await FR(t,e,o,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&GS(t.remoteStore,a),u}async function FR(t,e,r,n,a){t.pu=(v,_,y)=>(async function(w,b,F,z){let N=b.view.ru(F);N.Cs&&(N=await OT(w.localStore,b.query,!1).then((({documents:k})=>b.view.ru(k,N))));const K=z&&z.targetChanges.get(b.targetId),te=z&&z.targetMismatches.get(b.targetId)!=null,J=b.view.applyChanges(N,w.isPrimaryClient,K,te);return HT(w,b.targetId,J.au),J.snapshot})(t,v,_,y);const o=await OT(t.localStore,e,!0),l=new CR(e,o.Qs),u=l.ru(o.documents),h=i0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=l.applyChanges(u,t.isPrimaryClient,h);HT(t,r,d.au);const p=new NR(e,r,l);return t.Tu.set(e,p),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function MR(t,e,r){const n=pt(t),a=n.Tu.get(e),o=n.Iu.get(a.targetId);if(o.length>1)return n.Iu.set(a.targetId,o.filter((l=>!Jd(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await hg(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&nx(n.remoteStore,a.targetId),pg(n,a.targetId)})).catch(su)):(pg(n,a.targetId),await hg(n.localStore,a.targetId,!0))}async function LR(t,e){const r=pt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),nx(r.remoteStore,n.targetId))}async function PR(t,e,r){const n=GR(t);try{const a=await(function(l,u){const h=pt(l),d=gr.now(),p=u.reduce(((y,S)=>y.add(S.key)),Rt());let v,_;return h.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let S=Ts(),w=Rt();return h.Ns.getEntries(y,p).next((b=>{S=b,S.forEach(((F,z)=>{z.isValidDocument()||(w=w.add(F))}))})).next((()=>h.localDocuments.getOverlayedDocuments(y,S))).next((b=>{v=b;const F=[];for(const z of u){const N=J6(z,v.get(z.key).overlayedDocument);N!=null&&F.push(new Po(z.key,N,cS(N.value.mapValue),vi.exists(!0)))}return h.mutationQueue.addMutationBatch(y,d,F,u)})).next((b=>{_=b;const F=b.applyToLocalDocumentSet(v,w);return h.documentOverlayCache.saveOverlays(y,b.batchId,F)}))})).then((()=>({batchId:_.batchId,changes:_S(v)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(l,u,h){let d=l.Vu[l.currentUser.toKey()];d||(d=new Ar(Nt)),d=d.insert(u,h),l.Vu[l.currentUser.toKey()]=d})(n,a.batchId,r),await o0(n,a.changes),await im(n.remoteStore)}catch(a){const o=lx(a,"Failed to persist write");r.reject(o)}}async function r4(t,e){const r=pt(t);try{const n=await YN(r.localStore,e);e.targetChanges.forEach(((a,o)=>{const l=r.Au.get(o);l&&(Kt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.hu=!0:a.modifiedDocuments.size>0?Kt(l.hu,14607):a.removedDocuments.size>0&&(Kt(l.hu,42227),l.hu=!1))})),await o0(r,n,e)}catch(n){await su(n)}}function zT(t,e,r){const n=pt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((o,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(l,u){const h=pt(l);h.onlineState=u;let d=!1;h.queries.forEach(((p,v)=>{for(const _ of v.Sa)_.va(u)&&(d=!0)})),d&&cx(h)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function VR(t,e,r){const n=pt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),o=a&&a.key;if(o){let l=new Ar(rt.comparator);l=l.insert(o,Vn.newNoDocument(o,dt.min()));const u=Rt().add(o),h=new rm(dt.min(),new Map,new Ar(Nt),l,u);await r4(n,h),n.du=n.du.remove(o),n.Au.delete(e),fx(n)}else await hg(n.localStore,e,!1).then((()=>pg(n,e,r))).catch(su)}async function BR(t,e){const r=pt(t),n=e.batch.batchId;try{const a=await $N(r.localStore,e);a4(r,n,null),n4(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await o0(r,a)}catch(a){await su(a)}}async function UR(t,e,r){const n=pt(t);try{const a=await(function(l,u){const h=pt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next((v=>(Kt(v!==null,37113),p=v.keys(),h.mutationQueue.removeMutationBatch(d,v)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(n.localStore,e);a4(n,e,r),n4(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await o0(n,a)}catch(a){await su(a)}}function n4(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function a4(t,e,r){const n=pt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function pg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||i4(t,n)}))}function i4(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(nx(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),fx(t))}function HT(t,e,r){for(const n of r)n instanceof ZS?(t.Ru.addReference(n.key,e),jR(t,n)):n instanceof e4?(We(ux,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||i4(t,n.key)):lt(19791,{wu:n})}function jR(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(We(ux,"New document in limbo: "+r),t.Eu.add(n),fx(t))}function fx(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new rt(pr.fromString(e)),n=t.fu.next();t.Au.set(n,new RR(r)),t.du=t.du.insert(r,n),GS(t.remoteStore,new po(Vi(Qd(r.path)),n,"TargetPurposeLimboResolution",Wd.ce))}}async function o0(t,e,r){const n=pt(t),a=[],o=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{l.push(n.pu(h,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const p=d?!d.fromCache:r?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){a.push(d);const p=tx.As(h.targetId,d);o.push(p)}})))})),await Promise.all(l),n.Pu.H_(a),await(async function(h,d){const p=pt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>De.forEach(d,(_=>De.forEach(_.Es,(y=>p.persistence.referenceDelegate.addReference(v,_.targetId,y))).next((()=>De.forEach(_.ds,(y=>p.persistence.referenceDelegate.removeReference(v,_.targetId,y)))))))))}catch(v){if(!ou(v))throw v;We(rx,"Failed to update sequence numbers: "+v)}for(const v of d){const _=v.targetId;if(!v.fromCache){const y=p.Ms.get(_),S=y.snapshotVersion,w=y.withLastLimboFreeSnapshotVersion(S);p.Ms=p.Ms.insert(_,w)}}})(n.localStore,o))}async function zR(t,e){const r=pt(t);if(!r.currentUser.isEqual(e)){We(ux,"User change. New user:",e.toKey());const n=await US(r.localStore,e);r.currentUser=e,(function(o,l){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new Je(Fe.CANCELLED,l))}))})),o.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await o0(r,n.Ls)}}function HR(t,e){const r=pt(t),n=r.Au.get(e);if(n&&n.hu)return Rt().add(n.key);{let a=Rt();const o=r.Iu.get(e);if(!o)return a;for(const l of o){const u=r.Tu.get(l);a=a.unionWith(u.view.nu)}return a}}function s4(t){const e=pt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=r4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=HR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=VR.bind(null,e),e.Pu.H_=bR.bind(null,e.eventManager),e.Pu.yu=kR.bind(null,e.eventManager),e}function GR(t){const e=pt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=UR.bind(null,e),e}class Sd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return KN(this.persistence,new qN,e.initialUser,this.serializer)}Cu(e){return new BS(ex.mi,this.serializer)}Du(e){return new tR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sd.provider={build:()=>new Sd};class qR extends Sd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Kt(this.persistence.referenceDelegate instanceof wd,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new RN(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?la.withCacheSize(this.cacheSizeBytes):la.DEFAULT;return new BS((n=>wd.mi(n,r)),this.serializer)}}class gg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>zT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=zR.bind(null,this.syncEngine),await ER(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new AR})()}createDatastore(e){const r=nm(e.databaseInfo.databaseId),n=(function(o){return new sR(o)})(e.databaseInfo);return(function(o,l,u,h){return new uR(o,l,u,h)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,o,l,u){return new hR(n,a,o,l,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>zT(this.syncEngine,r,0)),(function(){return LT.v()?new LT:new rR})())}createSyncEngine(e,r){return(function(a,o,l,u,h,d,p){const v=new IR(a,o,l,u,h,d);return p&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=pt(r);We(bl,"RemoteStore shutting down."),n.Ea.add(5),await s0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}gg.provider={build:()=>new gg};class o4{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ys("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const Ro="FirestoreClient";class XR{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Mn.UNAUTHENTICATED,this.clientId=jg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async l=>{We(Ro,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(We(Ro,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=lx(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Op(t,e){t.asyncQueue.verifyOperationInProgress(),We(Ro,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await US(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function GT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await WR(t);We(Ro,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>VT(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>VT(e.remoteStore,a))),t._onlineComponents=e}async function WR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){We(Ro,"Using user provided OfflineComponentProvider");try{await Op(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Fe.FAILED_PRECONDITION||a.code===Fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;Kc("Error using user provided cache. Falling back to memory cache: "+r),await Op(t,new Sd)}}else We(Ro,"Using default OfflineComponentProvider"),await Op(t,new qR(void 0));return t._offlineComponents}async function l4(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(We(Ro,"Using user provided OnlineComponentProvider"),await GT(t,t._uninitializedComponentsProvider._online)):(We(Ro,"Using default OnlineComponentProvider"),await GT(t,new gg))),t._onlineComponents}function KR(t){return l4(t).then((e=>e.syncEngine))}async function xg(t){const e=await l4(t),r=e.eventManager;return r.onListen=DR.bind(null,e.syncEngine),r.onUnlisten=MR.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=OR.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=LR.bind(null,e.syncEngine),r}function $R(t,e,r={}){const n=new wo;return t.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,d){const p=new o4({next:_=>{p.Nu(),l.enqueueAndForget((()=>QS(o,v)));const y=_.docs.has(u);!y&&_.fromCache?d.reject(new Je(Fe.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&_.fromCache&&h&&h.source==="server"?d.reject(new Je(Fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),v=new JS(Qd(u.path),p,{includeMetadataChanges:!0,qa:!0});return YS(o,v)})(await xg(t),t.asyncQueue,e,r,n))),n.promise}function c4(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const qT=new Map;const u4="firestore.googleapis.com",XT=!0;class WT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Je(Fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=u4,this.ssl=XT}else this.host=e.host,this.ssl=e.ssl??XT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CN)throw new Je(Fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}f6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=c4(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Je(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Je(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Je(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sm{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Je(Fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Je(Fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new t6;switch(n.type){case"firstParty":return new i6(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Je(Fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=qT.get(r);n&&(We("ComponentProvider","Removing Datastore"),qT.delete(r),n.terminate())})(this),Promise.resolve()}}function YR(t,e,r,n={}){t=xi(t,sm);const a=nu(e),o=t._getSettings(),l={...o,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(PE(`https://${u}`),VE("Firestore",!0)),o.host!==u4&&o.host!==u&&Kc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:a,emulatorOptions:n};if(!El(h,l)&&(t._setSettings(h),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=Mn.MOCK_USER;else{d=bC(n.mockUserToken,t._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new Je(Fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Mn(v)}t._authCredentials=new r6(new QE(d,p))}}class om{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new om(this.firestore,e,this._query)}}class Pr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Eo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pr(this.firestore,e,this._key)}toJSON(){return{type:Pr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(n0(r,Pr._jsonSchema))return new Pr(e,n||null,new rt(pr.fromString(r.referencePath)))}}Pr._jsonSchemaVersion="firestore/documentReference/1.0",Pr._jsonSchema={type:Qr("string",Pr._jsonSchemaVersion),referencePath:Qr("string")};class Eo extends om{constructor(e,r,n){super(e,r,Qd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pr(this.firestore,null,new rt(e))}withConverter(e){return new Eo(this.firestore,e,this._path)}}function f4(t,e,...r){if(t=kn(t),JE("collection","path",e),t instanceof sm){const n=pr.fromString(e,...r);return oT(n),new Eo(t,null,n)}{if(!(t instanceof Pr||t instanceof Eo))throw new Je(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pr.fromString(e,...r));return oT(n),new Eo(t.firestore,null,n)}}function ca(t,e,...r){if(t=kn(t),arguments.length===1&&(e=jg.newId()),JE("doc","path",e),t instanceof sm){const n=pr.fromString(e,...r);return sT(n),new Pr(t,null,new rt(n))}{if(!(t instanceof Pr||t instanceof Eo))throw new Je(Fe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pr.fromString(e,...r));return sT(n),new Pr(t.firestore,t instanceof Eo?t.converter:null,new rt(n))}}const KT="AsyncQueue";class $T{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new zS(this,"async_queue_retry"),this._c=()=>{const n=Dp();n&&We(KT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Dp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Dp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new wo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ou(e))throw e;We(KT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ys("INTERNAL UNHANDLED ERROR: ",YT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=ox.createAndSchedule(this,e,r,n,(o=>this.hc(o)));return this.tc.push(a),a}uc(){this.nc&&lt(47125,{Pc:YT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function YT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function QT(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const o of n)if(o in a&&typeof a[o]=="function")return!0;return!1})(t,["next","error","complete"])}class kl extends sm{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new $T,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $T(e),this._firestoreClient=void 0,await e}}}function hx(t,e){const r=typeof t=="object"?t:jE(),n=typeof t=="string"?t:pd,a=Bg(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=SC("firestore");o&&YR(a,...o)}return a}function dx(t){if(t._terminated)throw new Je(Fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||QR(t),t._firestoreClient}function QR(t){const e=t._freezeSettings(),r=(function(a,o,l,u){return new w6(a,o,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,c4(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new XR(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const o=a?._online.build();return{_offline:a?._offline.build(o),_online:o}})(t._componentsProvider))}class $a{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $a(Cn.fromBase64String(e))}catch(r){throw new Je(Fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new $a(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$a._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(n0(e,$a._jsonSchema))return $a.fromBase64String(e.bytes)}}$a._jsonSchemaVersion="firestore/bytes/1.0",$a._jsonSchema={type:Qr("string",$a._jsonSchemaVersion),bytes:Qr("string")};class lm{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Je(Fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class mx{constructor(e){this._methodName=e}}class Ui{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Je(Fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Je(Fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Nt(this._lat,e._lat)||Nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ui._jsonSchemaVersion}}static fromJSON(e){if(n0(e,Ui._jsonSchema))return new Ui(e.latitude,e.longitude)}}Ui._jsonSchemaVersion="firestore/geoPoint/1.0",Ui._jsonSchema={type:Qr("string",Ui._jsonSchemaVersion),latitude:Qr("number"),longitude:Qr("number")};class ji{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ji._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(n0(e,ji._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new ji(e.vectorValues);throw new Je(Fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ji._jsonSchemaVersion="firestore/vectorValue/1.0",ji._jsonSchema={type:Qr("string",ji._jsonSchemaVersion),vectorValues:Qr("object")};const JR=/^__.*__$/;class ZR{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Po(e,this.data,this.fieldMask,r,this.fieldTransforms):new a0(e,this.data,r,this.fieldTransforms)}}class h4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Po(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function d4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw lt(40011,{Ac:t})}}class px{constructor(e,r,n,a,o,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new px({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ad(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(d4(this.Ac)&&JR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class eI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||nm(e)}Cc(e,r,n,a=!1){return new px({Ac:e,methodName:r,Dc:n,path:An.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function m4(t){const e=t._freezeSettings(),r=nm(t._databaseId);return new eI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function tI(t,e,r,n,a,o={}){const l=t.Cc(o.merge||o.mergeFields?2:0,e,r,a);gx("Data must be an object, but it was:",l,n);const u=p4(n,l);let h,d;if(o.merge)h=new Ra(l.fieldMask),d=l.fieldTransforms;else if(o.mergeFields){const p=[];for(const v of o.mergeFields){const _=vg(e,v,r);if(!l.contains(_))throw new Je(Fe.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);x4(p,_)||p.push(_)}h=new Ra(p),d=l.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,d=l.fieldTransforms;return new ZR(new ua(u),h,d)}class cm extends mx{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cm}}function rI(t,e,r,n){const a=t.Cc(1,e,r);gx("Data must be an object, but it was:",a,n);const o=[],l=ua.empty();Lo(n,((h,d)=>{const p=xx(e,h,r);d=kn(d);const v=a.yc(p);if(d instanceof cm)o.push(p);else{const _=um(d,v);_!=null&&(o.push(p),l.set(p,_))}}));const u=new Ra(o);return new h4(l,u,a.fieldTransforms)}function nI(t,e,r,n,a,o){const l=t.Cc(1,e,r),u=[vg(e,n,r)],h=[a];if(o.length%2!=0)throw new Je(Fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)u.push(vg(e,o[_])),h.push(o[_+1]);const d=[],p=ua.empty();for(let _=u.length-1;_>=0;--_)if(!x4(d,u[_])){const y=u[_];let S=h[_];S=kn(S);const w=l.yc(y);if(S instanceof cm)d.push(y);else{const b=um(S,w);b!=null&&(d.push(y),p.set(y,b))}}const v=new Ra(d);return new h4(p,v,l.fieldTransforms)}function um(t,e){if(g4(t=kn(t)))return gx("Unsupported field value:",e,t),p4(t,e);if(t instanceof mx)return(function(n,a){if(!d4(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const o=[];let l=0;for(const u of n){let h=um(u,a.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(t,e)}return(function(n,a){if((n=kn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return X6(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=gr.fromDate(n);return{timestampValue:Td(a.serializer,o)}}if(n instanceof gr){const o=new gr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Td(a.serializer,o)}}if(n instanceof Ui)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof $a)return{bytesValue:IS(a.serializer,n._byteString)};if(n instanceof Pr){const o=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw a.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Jg(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof ji)return(function(l,u){return{mapValue:{fields:{[oS]:{stringValue:lS},[gd]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Kg(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${zg(n)}`)})(t,e)}function p4(t,e){const r={};return tS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Lo(t,((n,a)=>{const o=um(a,e.mc(n));o!=null&&(r[n]=o)})),{mapValue:{fields:r}}}function g4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gr||t instanceof Ui||t instanceof $a||t instanceof Pr||t instanceof mx||t instanceof ji)}function gx(t,e,r){if(!g4(r)||!ZE(r)){const n=zg(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function vg(t,e,r){if((e=kn(e))instanceof lm)return e._internalPath;if(typeof e=="string")return xx(t,e);throw Ad("Field path arguments must be of type string or ",t,!1,void 0,r)}const aI=new RegExp("[~\\*/\\[\\]]");function xx(t,e,r){if(e.search(aI)>=0)throw Ad(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new lm(...e.split("."))._internalPath}catch{throw Ad(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ad(t,e,r,n,a){const o=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${n}`),l&&(h+=` in document ${a}`),h+=")"),new Je(Fe.INVALID_ARGUMENT,u+t+h)}function x4(t,e){return t.some((r=>r.isEqual(e)))}class v4{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Pr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(_4("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class iI extends v4{data(){return super.data()}}function _4(t,e){return typeof e=="string"?xx(t,e):e instanceof lm?e._internalPath:e._delegate._internalPath}function sI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Je(Fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oI{convertValue(e,r="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw lt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Lo(e,((a,o)=>{n[a]=this.convertValue(o,r)})),n}convertVectorValue(e){const r=e.fields?.[gd].arrayValue?.values?.map((n=>Lr(n.doubleValue)));return new ji(r)}convertGeoPoint(e){return new Ui(Lr(e.latitude),Lr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=$d(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Of(e));default:return null}}convertTimestamp(e){const r=bo(e);return new gr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pr.fromString(e);Kt(PS(n),9688,{name:e});const a=new Ff(n.get(1),n.get(3)),o=new rt(n.popFirst(5));return a.isEqual(r)||ys(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}function lI(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class df{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vl extends v4{constructor(e,r,n,a,o,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new od(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(_4("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Je(Fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=vl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}vl._jsonSchemaVersion="firestore/documentSnapshot/1.0",vl._jsonSchema={type:Qr("string",vl._jsonSchemaVersion),bundleSource:Qr("string","DocumentSnapshot"),bundleName:Qr("string"),bundle:Qr("string")};class od extends vl{data(e={}){return super.data(e)}}class Bc{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new df(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new od(this._firestore,this._userDataWriter,n.key,n,new df(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Je(Fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,o){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map((u=>{const h=new od(a._firestore,a._userDataWriter,u.doc.key,u.doc,new df(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new od(a._firestore,a._userDataWriter,u.doc.key,u.doc,new df(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,p=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),p=l.indexOf(u.doc.key)),{type:cI(u.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Je(Fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function cI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return lt(61501,{type:t})}}function uI(t){t=xi(t,Pr);const e=xi(t.firestore,kl);return $R(dx(e),t._key).then((r=>w4(e,t,r)))}Bc._jsonSchemaVersion="firestore/querySnapshot/1.0",Bc._jsonSchema={type:Qr("string",Bc._jsonSchemaVersion),bundleSource:Qr("string","QuerySnapshot"),bundleName:Qr("string"),bundle:Qr("string")};class y4 extends oI{constructor(e){super(),this.firestore=e}convertBytes(e){return new $a(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Pr(this.firestore,null,r)}}function Fc(t,e,r){t=xi(t,Pr);const n=xi(t.firestore,kl),a=lI(t.converter,e,r);return vx(n,[tI(m4(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,vi.none())])}function fI(t,e,r,...n){t=xi(t,Pr);const a=xi(t.firestore,kl),o=m4(a);let l;return l=typeof(e=kn(e))=="string"||e instanceof lm?nI(o,"updateDoc",t._key,e,r,n):rI(o,"updateDoc",t._key,e),vx(a,[l.toMutation(t._key,vi.exists(!0))])}function T4(t){return vx(xi(t.firestore,kl),[new $g(t._key,vi.none())])}function Mc(t,...e){t=kn(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||QT(e[n])||(r=e[n++]);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(QT(e[n])){const h=e[n];e[n]=h.next?.bind(h),e[n+1]=h.error?.bind(h),e[n+2]=h.complete?.bind(h)}let o,l,u;if(t instanceof Pr)l=xi(t.firestore,kl),u=Qd(t._key.path),o={next:h=>{e[n]&&e[n](w4(l,t,h))},error:e[n+1],complete:e[n+2]};else{const h=xi(t,om);l=xi(h.firestore,kl),u=h._query;const d=new y4(l);o={next:p=>{e[n]&&e[n](new Bc(l,d,h,p))},error:e[n+1],complete:e[n+2]},sI(t._query)}return(function(d,p,v,_){const y=new o4(_),S=new JS(p,y,v);return d.asyncQueue.enqueueAndForget((async()=>YS(await xg(d),S))),()=>{y.Nu(),d.asyncQueue.enqueueAndForget((async()=>QS(await xg(d),S)))}})(dx(l),u,a,o)}function vx(t,e){return(function(n,a){const o=new wo;return n.asyncQueue.enqueueAndForget((async()=>PR(await KR(n),a,o))),o.promise})(dx(t),e)}function w4(t,e,r){const n=r.docs.get(e._key),a=new y4(t);return new vl(t,a,e._key,n,new df(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(a){iu=a})(au),Wc(new Sl("firestore",((n,{instanceIdentifier:a,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new kl(new n6(n.getProvider("auth-internal")),new s6(l,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Je(Fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ff(d.options.projectId,p)})(l,a),l);return o={useFetchStreams:r,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),yo(rT,nT,e),yo(rT,nT,"esm2020")})();function E4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hI=E4,S4=new t0("auth","Firebase",E4());const bd=new Pg("@firebase/auth");function dI(t,...e){bd.logLevel<=Ct.WARN&&bd.warn(`Auth (${au}): ${t}`,...e)}function ld(t,...e){bd.logLevel<=Ct.ERROR&&bd.error(`Auth (${au}): ${t}`,...e)}function ws(t,...e){throw _x(t,...e)}function zi(t,...e){return _x(t,...e)}function A4(t,e,r){const n={...hI(),[e]:r};return new t0("auth","Firebase",n).create(e,{appName:t.name})}function So(t){return A4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _x(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return S4.create(t,...e)}function ht(t,e,...r){if(!t)throw _x(e,...r)}function hs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ld(e),new Error(e)}function Es(t,e){t||hs(e)}function _g(){return typeof self<"u"&&self.location?.href||""}function mI(){return JT()==="http:"||JT()==="https:"}function JT(){return typeof self<"u"&&self.location?.protocol||null}function pI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mI()||DC()||"connection"in navigator)?navigator.onLine:!0}function gI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class l0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Es(r>e,"Short delay should be less than long delay!"),this.isMobile=NC()||OC()}get(){return pI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yx(t,e){Es(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class b4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const xI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const vI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_I=new l0(3e4,6e4);function fm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function cu(t,e,r,n,a={}){return k4(t,a,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const u=r0({key:t.config.apiKey,...l}).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:h,...o};return IC()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&nu(t.emulatorConfig.host)&&(d.credentials="include"),b4.fetch()(await N4(t,t.config.apiHost,r,u),d)})}async function k4(t,e,r){t._canInitEmulator=!1;const n={...xI,...e};try{const a=new yI(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw zh(t,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw zh(t,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw zh(t,"email-already-in-use",l);if(h==="USER_DISABLED")throw zh(t,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw A4(t,p,d);ws(t,p)}}catch(a){if(a instanceof As)throw a;ws(t,"network-request-failed",{message:String(a)})}}async function C4(t,e,r,n,a={}){const o=await cu(t,e,r,n,a);return"mfaPendingCredential"in o&&ws(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function N4(t,e,r,n){const a=`${e}${r}?${n}`,o=t,l=o.config.emulator?yx(t.config,a):`${t.config.apiScheme}://${a}`;return vI.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}class yI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(zi(this.auth,"network-request-failed")),_I.get())})}}function zh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=zi(t,e,n);return a.customData._tokenResponse=r,a}async function TI(t,e){return cu(t,"POST","/v1/accounts:delete",e)}async function kd(t,e){return cu(t,"POST","/v1/accounts:lookup",e)}function wf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wI(t,e=!1){const r=kn(t),n=await r.getIdToken(e),a=Tx(n);ht(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,l=o?.sign_in_provider;return{claims:a,token:n,authTime:wf(Fp(a.auth_time)),issuedAtTime:wf(Fp(a.iat)),expirationTime:wf(Fp(a.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Fp(t){return Number(t)*1e3}function Tx(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ld("JWT malformed, contained fewer than 3 sections"),null;try{const a=OE(r);return a?JSON.parse(a):(ld("Failed to decode base64 JWT payload"),null)}catch(a){return ld("Caught error parsing JWT payload as JSON",a?.toString()),null}}function ZT(t){const e=Tx(t);return ht(e,"internal-error"),ht(typeof e.exp<"u","internal-error"),ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof As&&EI(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function EI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class SI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class yg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=wf(this.lastLoginAt),this.creationTime=wf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Cd(t){const e=t.auth,r=await t.getIdToken(),n=await Vf(t,kd(e,{idToken:r}));ht(n?.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const o=a.providerUserInfo?.length?R4(a.providerUserInfo):[],l=bI(t.providerData,o),u=t.isAnonymous,h=!(t.email&&a.passwordHash)&&!l?.length,d=u?h:!1,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new yg(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function AI(t){const e=kn(t);await Cd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function bI(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function R4(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function kI(t,e){const r=await k4(t,{},async()=>{const n=r0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,l=await N4(t,a,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&nu(t.emulatorConfig.host)&&(h.credentials="include"),b4.fetch()(l,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function CI(t,e){return cu(t,"POST","/v2/accounts:revokeToken",fm(t,e))}class Uc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken<"u","internal-error"),ht(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ZT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ht(e.length!==0,"internal-error");const r=ZT(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await kI(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,l=new Uc;return n&&(ht(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(ht(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),o&&(ht(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uc,this.toJSON())}_performRefresh(){return hs("not implemented")}}function lo(t,e){ht(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class mi{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new SI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new yg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Vf(this,this.stsTokenManager.getToken(this.auth,e));return ht(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return wI(this,e)}reload(){return AI(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new mi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Cd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(di(this.auth.app))return Promise.reject(So(this.auth));const e=await this.getIdToken();return await Vf(this,TI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,o=r.phoneNumber??void 0,l=r.photoURL??void 0,u=r.tenantId??void 0,h=r._redirectEventId??void 0,d=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:y,providerData:S,stsTokenManager:w}=r;ht(v&&w,e,"internal-error");const b=Uc.fromJSON(this.name,w);ht(typeof v=="string",e,"internal-error"),lo(n,e.name),lo(a,e.name),ht(typeof _=="boolean",e,"internal-error"),ht(typeof y=="boolean",e,"internal-error"),lo(o,e.name),lo(l,e.name),lo(u,e.name),lo(h,e.name),lo(d,e.name),lo(p,e.name);const F=new mi({uid:v,auth:e,email:a,emailVerified:_,displayName:n,isAnonymous:y,photoURL:l,phoneNumber:o,tenantId:u,stsTokenManager:b,createdAt:d,lastLoginAt:p});return S&&Array.isArray(S)&&(F.providerData=S.map(z=>({...z}))),h&&(F._redirectEventId=h),F}static async _fromIdTokenResponse(e,r,n=!1){const a=new Uc;a.updateFromServerResponse(r);const o=new mi({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Cd(o),o}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];ht(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?R4(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!o?.length,u=new Uc;u.updateFromIdToken(n);const h=new mi({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new yg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!o?.length};return Object.assign(h,d),h}}const ew=new Map;function ds(t){Es(t instanceof Function,"Expected a class definition");let e=ew.get(t);return e?(Es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ew.set(t,e),e)}class I4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}I4.type="NONE";const tw=I4;function cd(t,e,r){return`firebase:${t}:${e}:${r}`}class jc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=cd(this.userKey,a.apiKey,o),this.fullPersistenceKey=cd("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await kd(this.auth,{idToken:e}).catch(()=>{});return r?mi._fromGetAccountInfoResponse(this.auth,r,e):null}return mi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new jc(ds(tw),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=a[0]||ds(tw);const l=cd(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const p=await d._get(l);if(p){let v;if(typeof p=="string"){const _=await kd(e,{idToken:p}).catch(()=>{});if(!_)break;v=await mi._fromGetAccountInfoResponse(e,_,p)}else v=mi._fromJSON(e,p);d!==o&&(u=v),o=d;break}}catch{}const h=a.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new jc(o,e,n):(o=h[0],u&&await o._set(l,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(l)}catch{}})),new jc(o,e,n))}}function rw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(M4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(D4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(P4(e))return"Blackberry";if(V4(e))return"Webos";if(O4(e))return"Safari";if((e.includes("chrome/")||F4(e))&&!e.includes("edge/"))return"Chrome";if(L4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function D4(t=zn()){return/firefox\//i.test(t)}function O4(t=zn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function F4(t=zn()){return/crios\//i.test(t)}function M4(t=zn()){return/iemobile/i.test(t)}function L4(t=zn()){return/android/i.test(t)}function P4(t=zn()){return/blackberry/i.test(t)}function V4(t=zn()){return/webos/i.test(t)}function wx(t=zn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function NI(t=zn()){return wx(t)&&!!window.navigator?.standalone}function RI(){return FC()&&document.documentMode===10}function B4(t=zn()){return wx(t)||L4(t)||V4(t)||P4(t)||/windows phone/i.test(t)||M4(t)}function U4(t,e=[]){let r;switch(t){case"Browser":r=rw(zn());break;case"Worker":r=`${rw(zn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${au}/${n}`}class II{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((l,u)=>{try{const h=e(o);l(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function DI(t,e={}){return cu(t,"GET","/v2/passwordPolicy",fm(t,e))}const OI=6;class FI{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??OI,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class MI{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nw(this),this.idTokenSubscription=new nw(this),this.beforeStateQueue=new II(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=S4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ds(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await jc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await kd(this,{idToken:e}),n=await mi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(di(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&u?.user&&(n=u.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Cd(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(di(this.app))return Promise.reject(So(this));const r=e?kn(e):null;return r&&ht(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return di(this.app)?Promise.reject(So(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return di(this.app)?Promise.reject(So(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ds(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DI(this),r=new FI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new t0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await CI(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ds(e)||this._popupRedirectResolver;ht(r,this,"argument-error"),this.redirectPersistenceManager=await jc.create(this,[ds(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ht(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,a);return()=>{l=!0,h()}}else{const h=e.addObserver(r);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=U4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(di(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&dI(`Error while retrieving App Check token: ${e.error}`),e?.token}}function hm(t){return kn(t)}class nw{constructor(e){this.auth=e,this.observer=null,this.addObserver=zC(r=>this.observer=r)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ex={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function LI(t){Ex=t}function PI(t){return Ex.loadJS(t)}function VI(){return Ex.gapiScript}function BI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function UI(t,e){const r=Bg(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(El(o,e??{}))return a;ws(a,"already-initialized")}return r.initialize({options:e})}function jI(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(ds);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function zI(t,e,r){const n=hm(t);ht(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,o=j4(e),{host:l,port:u}=HI(e),h=u===null?"":`:${u}`,d={url:`${o}//${l}${h}/`},p=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){ht(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ht(El(d,n.config.emulator)&&El(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,nu(l)?(PE(`${o}//${l}${h}`),VE("Auth",!0)):GI()}function j4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function HI(t){const e=j4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const o=a[1];return{host:o,port:aw(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:aw(l)}}}function aw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class z4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return hs("not implemented")}_getIdTokenResponse(e){return hs("not implemented")}_linkToIdToken(e,r){return hs("not implemented")}_getReauthenticationResolver(e){return hs("not implemented")}}async function zc(t,e){return C4(t,"POST","/v1/accounts:signInWithIdp",fm(t,e))}const qI="http://localhost";class Cl extends z4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Cl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ws("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...o}=r;if(!n||!a)return null;const l=new Cl(n,a);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return zc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,zc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,zc(e,r)}buildRequest(){const e={requestUri:qI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=r0(r)}return e}}class H4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class c0 extends H4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class uo extends c0{constructor(){super("facebook.com")}static credential(e){return Cl._fromParams({providerId:uo.PROVIDER_ID,signInMethod:uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uo.credentialFromTaggedObject(e)}static credentialFromError(e){return uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return uo.credential(e.oauthAccessToken)}catch{return null}}}uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";uo.PROVIDER_ID="facebook.com";class fo extends c0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Cl._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return fo.credential(r,n)}catch{return null}}}fo.GOOGLE_SIGN_IN_METHOD="google.com";fo.PROVIDER_ID="google.com";class ho extends c0{constructor(){super("github.com")}static credential(e){return Cl._fromParams({providerId:ho.PROVIDER_ID,signInMethod:ho.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ho.credentialFromTaggedObject(e)}static credentialFromError(e){return ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ho.credential(e.oauthAccessToken)}catch{return null}}}ho.GITHUB_SIGN_IN_METHOD="github.com";ho.PROVIDER_ID="github.com";class mo extends c0{constructor(){super("twitter.com")}static credential(e,r){return Cl._fromParams({providerId:mo.PROVIDER_ID,signInMethod:mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return mo.credentialFromTaggedObject(e)}static credentialFromError(e){return mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return mo.credential(r,n)}catch{return null}}}mo.TWITTER_SIGN_IN_METHOD="twitter.com";mo.PROVIDER_ID="twitter.com";async function XI(t,e){return C4(t,"POST","/v1/accounts:signUp",fm(t,e))}class Io{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await mi._fromIdTokenResponse(e,n,a),l=iw(n);return new Io({user:o,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=iw(n);return new Io({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function iw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function WI(t){if(di(t.app))return Promise.reject(So(t));const e=hm(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Io({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await XI(e,{returnSecureToken:!0}),n=await Io._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}class Nd extends As{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Nd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Nd(e,r,n,a)}}function G4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Nd._fromErrorAndOperation(t,o,e,n):o})}async function KI(t,e,r=!1){const n=await Vf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Io._forOperation(t,"link",n)}async function $I(t,e,r=!1){const{auth:n}=t;if(di(n.app))return Promise.reject(So(n));const a="reauthenticate";try{const o=await Vf(t,G4(n,a,e,t),r);ht(o.idToken,n,"internal-error");const l=Tx(o.idToken);ht(l,n,"internal-error");const{sub:u}=l;return ht(t.uid===u,n,"user-mismatch"),Io._forOperation(t,a,o)}catch(o){throw o?.code==="auth/user-not-found"&&ws(n,"user-mismatch"),o}}async function YI(t,e,r=!1){if(di(t.app))return Promise.reject(So(t));const n="signIn",a=await G4(t,n,e),o=await Io._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}function QI(t,e,r,n){return kn(t).onIdTokenChanged(e,r,n)}function JI(t,e,r){return kn(t).beforeAuthStateChanged(e,r)}function ZI(t,e,r,n){return kn(t).onAuthStateChanged(e,r,n)}function eD(t){return kn(t).signOut()}const Rd="__sak";class q4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Rd,"1"),this.storage.removeItem(Rd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const tD=1e3,rD=10;class X4 extends q4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=B4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);RI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,rD):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},tD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}X4.type="LOCAL";const nD=X4;class W4 extends q4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}W4.type="SESSION";const K4=W4;function aD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class dm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new dm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,l=this.handlersMap[a];if(!l?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async d=>d(r.origin,o)),h=await aD(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dm.receivers=[];function Sx(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class iD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,l;return new Promise((u,h)=>{const d=Sx("",20);a.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(v){const _=v;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(_.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function Hi(){return window}function sD(t){Hi().location.href=t}function $4(){return typeof Hi().WorkerGlobalScope<"u"&&typeof Hi().importScripts=="function"}async function oD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function lD(){return navigator?.serviceWorker?.controller||null}function cD(){return $4()?self:null}const Y4="firebaseLocalStorageDb",uD=1,Id="firebaseLocalStorage",Q4="fbase_key";class u0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function mm(t,e){return t.transaction([Id],e?"readwrite":"readonly").objectStore(Id)}function fD(){const t=indexedDB.deleteDatabase(Y4);return new u0(t).toPromise()}function Tg(){const t=indexedDB.open(Y4,uD);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Id,{keyPath:Q4})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Id)?e(n):(n.close(),await fD(),e(await Tg()))})})}async function sw(t,e,r){const n=mm(t,!0).put({[Q4]:e,value:r});return new u0(n).toPromise()}async function hD(t,e){const r=mm(t,!1).get(e),n=await new u0(r).toPromise();return n===void 0?null:n.value}function ow(t,e){const r=mm(t,!0).delete(e);return new u0(r).toPromise()}const dD=800,mD=3;class J4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Tg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>mD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dm._getInstance(cD()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await oD(),!this.activeServiceWorker)return;this.sender=new iD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||lD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Tg();return await sw(e,Rd,"1"),await ow(e,Rd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>sw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>hD(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>ow(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=mm(a,!1).getAll();return new u0(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}J4.type="LOCAL";const pD=J4;new l0(3e4,6e4);function gD(t,e){return e?ds(e):(ht(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Ax extends z4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return zc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return zc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function xD(t){return YI(t.auth,new Ax(t),t.bypassAuthState)}function vD(t){const{auth:e,user:r}=t;return ht(r,e,"internal-error"),$I(r,new Ax(t),t.bypassAuthState)}async function _D(t){const{auth:e,user:r}=t;return ht(r,e,"internal-error"),KI(r,new Ax(t),t.bypassAuthState)}class Z4{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xD;case"linkViaPopup":case"linkViaRedirect":return _D;case"reauthViaPopup":case"reauthViaRedirect":return vD;default:ws(this.auth,"internal-error")}}resolve(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yD=new l0(2e3,1e4);class Lc extends Z4{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,Lc.currentPopupAction&&Lc.currentPopupAction.cancel(),Lc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ht(e,this.auth,"internal-error"),e}async onExecution(){Es(this.filter.length===1,"Popup operations only handle one event");const e=Sx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(zi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(zi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,yD.get())};e()}}Lc.currentPopupAction=null;const TD="pendingRedirect",ud=new Map;class wD extends Z4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const n=await ED(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ED(t,e){const r=bD(e),n=AD(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function SD(t,e){ud.set(t._key(),e)}function AD(t){return ds(t._redirectPersistence)}function bD(t){return cd(TD,t.config.apiKey,t.name)}async function kD(t,e,r=!1){if(di(t.app))return Promise.reject(So(t));const n=hm(t),a=gD(n,e),l=await new wD(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const CD=600*1e3;class ND{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!RD(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!eA(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(zi(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=CD&&this.cachedEventUids.clear(),this.cachedEventUids.has(lw(e))}saveEventToCache(e){this.cachedEventUids.add(lw(e)),this.lastProcessedEventTime=Date.now()}}function lw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eA({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function RD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eA(t);default:return!1}}async function ID(t,e={}){return cu(t,"GET","/v1/projects",e)}const DD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,OD=/^https?/;async function FD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ID(t);for(const r of e)try{if(MD(r))return}catch{}ws(t,"unauthorized-domain")}function MD(t){const e=_g(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!OD.test(r))return!1;if(DD.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const LD=new l0(3e4,6e4);function cw(){const t=Hi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function PD(t){return new Promise((e,r)=>{function n(){cw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cw(),r(zi(t,"network-request-failed"))},timeout:LD.get()})}if(Hi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Hi().gapi?.load)n();else{const a=BI("iframefcb");return Hi()[a]=()=>{gapi.load?n():r(zi(t,"network-request-failed"))},PI(`${VI()}?onload=${a}`).catch(o=>r(o))}}).catch(e=>{throw fd=null,e})}let fd=null;function VD(t){return fd=fd||PD(t),fd}const BD=new l0(5e3,15e3),UD="__/auth/iframe",jD="emulator/auth/iframe",zD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GD(t){const e=t.config;ht(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?yx(e,jD):`https://${t.config.authDomain}/${UD}`,n={apiKey:e.apiKey,appName:t.name,v:au},a=HD.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${r0(n).slice(1)}`}async function qD(t){const e=await VD(t),r=Hi().gapi;return ht(r,t,"internal-error"),e.open({where:document.body,url:GD(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zD,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const l=zi(t,"network-request-failed"),u=Hi().setTimeout(()=>{o(l)},BD.get());function h(){Hi().clearTimeout(u),a(n)}n.ping(h).then(h,()=>{o(l)})}))}const XD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WD=500,KD=600,$D="_blank",YD="http://localhost";class uw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function QD(t,e,r,n=WD,a=KD){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...XD,width:n.toString(),height:a.toString(),top:o,left:l},d=zn().toLowerCase();r&&(u=F4(d)?$D:r),D4(d)&&(e=e||YD,h.scrollbars="yes");const p=Object.entries(h).reduce((_,[y,S])=>`${_}${y}=${S},`,"");if(NI(d)&&u!=="_self")return JD(e||"",u),new uw(null);const v=window.open(e||"",u,p);ht(v,t,"popup-blocked");try{v.focus()}catch{}return new uw(v)}function JD(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const ZD="__/auth/handler",e8="emulator/auth/handler",t8=encodeURIComponent("fac");async function fw(t,e,r,n,a,o){ht(t.config.authDomain,t,"auth-domain-config-required"),ht(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:au,eventId:a};if(e instanceof H4){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",jC(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries({}))l[p]=v}if(e instanceof c0){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(l.scopes=p.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await t._getAppCheckToken(),d=h?`#${t8}=${encodeURIComponent(h)}`:"";return`${r8(t)}?${r0(u).slice(1)}${d}`}function r8({config:t}){return t.emulator?yx(t,e8):`https://${t.authDomain}/${ZD}`}const Mp="webStorageSupport";class n8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=K4,this._completeRedirectFn=kD,this._overrideRedirectResult=SD}async _openPopup(e,r,n,a){Es(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await fw(e,r,n,_g(),a);return QD(e,o,Sx())}async _openRedirect(e,r,n,a){await this._originValidation(e);const o=await fw(e,r,n,_g(),a);return sD(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(Es(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await qD(e),n=new ND(e);return r.register("authEvent",a=>(ht(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Mp,{type:Mp},a=>{const o=a?.[0]?.[Mp];o!==void 0&&r(!!o),ws(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=FD(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return B4()||O4()||wx()}}const a8=n8;var hw="@firebase/auth",dw="1.12.0";class i8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function s8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function o8(t){Wc(new Sl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;ht(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:U4(t)},d=new MI(n,a,o,h);return jI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Wc(new Sl("auth-internal",e=>{const r=hm(e.getProvider("auth").getImmediate());return(n=>new i8(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),yo(hw,dw,s8(t)),yo(hw,dw,"esm2020")}const l8=300,c8=LE("authIdTokenMaxAge")||l8;let mw=null;const u8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>c8)return;const a=r?.token;mw!==a&&(mw=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function tA(t=jE()){const e=Bg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=UI(t,{popupRedirectResolver:a8,persistence:[pD,nD,K4]}),n=LE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=u8(o.toString());JI(r,l,()=>l(r.currentUser)),QI(r,u=>l(u))}}const a=FE("auth");return a&&zI(r,`http://${a}`),r}function f8(){return document.getElementsByTagName("head")?.[0]??document}LI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=zi("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",f8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});o8("Browser");const h8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),d8=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),pw=t=>{const e=d8(t);return e.charAt(0).toUpperCase()+e.slice(1)},rA=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),m8=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var p8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const g8=qe.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:l,...u},h)=>qe.createElement("svg",{ref:h,...p8,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:rA("lucide",a),...!o&&!m8(u)&&{"aria-hidden":"true"},...u},[...l.map(([d,p])=>qe.createElement(d,p)),...Array.isArray(o)?o:[o]]));const _t=(t,e)=>{const r=qe.forwardRef(({className:n,...a},o)=>qe.createElement(g8,{ref:o,iconNode:e,className:rA(`lucide-${h8(pw(t))}`,`lucide-${t}`,n),...a}));return r.displayName=pw(t),r};const x8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],v8=_t("arrow-right",x8);const _8=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],bx=_t("calendar",_8);const y8=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],nA=_t("chart-column",y8);const T8=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],w8=_t("chart-pie",T8);const E8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],aA=_t("check",E8);const S8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],iA=_t("chevron-down",S8);const A8=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],sA=_t("chevron-left",A8);const b8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],k8=_t("chevron-right",b8);const C8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],oA=_t("circle-alert",C8);const N8=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],R8=_t("circle-check-big",N8);const I8=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],lA=_t("clipboard-list",I8);const D8=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],O8=_t("clock",D8);const F8=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],M8=_t("cloud-upload",F8);const L8=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],P8=_t("copy",L8);const V8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],wg=_t("download",V8);const B8=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],U8=_t("eye-off",B8);const j8=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],z8=_t("eye",j8);const H8=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],G8=_t("facebook",H8);const q8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],X8=_t("file-spreadsheet",q8);const W8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],K8=_t("file-up",W8);const $8=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Y8=_t("list",$8);const Q8=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],J8=_t("log-out",Q8);const Z8=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],eO=_t("monitor",Z8);const tO=[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],rO=_t("package-check",tO);const nO=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Eg=_t("pen-line",nO);const aO=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],iO=_t("phone",aO);const sO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],cA=_t("plus",sO);const oO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],lO=_t("refresh-cw",oO);const cO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Sg=_t("search",cO);const uO=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uA=_t("settings",uO);const fO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],fA=_t("shield-check",fO);const hO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],dO=_t("shield",hO);const mO=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],pO=_t("shopping-cart",mO);const gO=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],xO=_t("smartphone",gO);const vO=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Bf=_t("trash-2",vO);const _O=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],yO=_t("trending-down",_O);const TO=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],wO=_t("trending-up",TO);const EO=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],hA=_t("triangle-alert",EO);const SO=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],gw=_t("truck",SO);const AO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],bO=_t("upload",AO);const kO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],CO=_t("user",kO);const NO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pm=_t("x",NO),RO={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},dA=Xd(RO),hl=tA(dA),xw=hx(dA),IO=typeof __app_id<"u"?__app_id:"kho-suon-muoi-official-system-v1",vw=({isLeft:t})=>E.jsxs("svg",{className:`absolute inset-0 w-full h-full pointer-events-none z-10 ${t?"":"scale-x-[-1]"}`,viewBox:"0 0 400 600",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",style:{opacity:1},children:[E.jsxs("defs",{children:[E.jsxs("linearGradient",{id:"flow-grad-orange",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[E.jsx("stop",{offset:"0%",stopColor:"#ff5e00",stopOpacity:"0"}),E.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"1"}),E.jsx("stop",{offset:"100%",stopColor:"#ff5e00",stopOpacity:"0"})]}),E.jsxs("linearGradient",{id:"flow-grad-cyan",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[E.jsx("stop",{offset:"0%",stopColor:"#00f2ff",stopOpacity:"0"}),E.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"1"}),E.jsx("stop",{offset:"100%",stopColor:"#00f2ff",stopOpacity:"0"})]}),E.jsxs("linearGradient",{id:"flow-grad-purple",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[E.jsx("stop",{offset:"0%",stopColor:"#d400ff",stopOpacity:"0"}),E.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"1"}),E.jsx("stop",{offset:"100%",stopColor:"#d400ff",stopOpacity:"0"})]}),E.jsxs("filter",{id:"glow-circuit",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[E.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),E.jsxs("feMerge",{children:[E.jsx("feMergeNode",{in:"coloredBlur"}),E.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),E.jsxs("filter",{id:"static-glow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[E.jsx("feGaussianBlur",{stdDeviation:"0.5",result:"blur"}),E.jsx("feFlood",{floodColor:"#555",result:"color"}),E.jsx("feComposite",{in:"color",in2:"blur",operator:"in",result:"coloredBlur"}),E.jsxs("feMerge",{children:[E.jsx("feMergeNode",{in:"coloredBlur"}),E.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),E.jsx("pattern",{id:"grid-dots",x:"0",y:"0",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:E.jsx("rect",{x:"0",y:"0",width:"1.5",height:"1.5",fill:"#333",opacity:"0.8"})})]}),E.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid-dots)"}),E.jsxs("g",{stroke:"#444",strokeWidth:"2",fill:"none",opacity:"0.7",filter:"url(#static-glow)",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M20 0 V 40 L 40 60 H 60 L 70 50 L 80 60 L 90 50 L 100 60 L 110 50 L 120 60 H 150 L 200 110 V 200 L 250 250 H 400"}),E.jsx("path",{d:"M0 150 H 30 L 80 200 H 120 L 150 230 H 400"}),E.jsx("path",{d:"M0 160 H 25 L 75 210 H 115 L 145 240 H 400"}),E.jsx("path",{d:"M0 300 H 50 L 80 270 H 120 L 150 300 H 200 L 230 330 H 280 L 310 300 H 400",strokeWidth:"3"}),E.jsx("path",{d:"M50 600 V 550 L 100 500 H 150 L 200 450 V 400 L 250 350 H 400"}),E.jsx("path",{d:"M180 0 V 50 L 150 80 H 100"}),E.jsx("path",{d:"M350 0 V 100 L 300 150 H 250"}),E.jsx("path",{d:"M0 450 H 40 L 80 490 V 550"}),E.jsx("path",{d:"M350 600 V 500 L 320 470 H 280"}),E.jsx("path",{d:"M200 500 H 220 L 225 495 L 230 505 L 235 495 L 240 505 L 245 500 H 280 L 320 460"})]}),E.jsxs("g",{filter:"url(#glow-circuit)",children:[E.jsxs("g",{fill:"#ff5e00",children:[E.jsx("circle",{cx:"200",cy:"110",r:"4"}),E.jsx("rect",{x:"76",y:"266",width:"8",height:"8",transform:"rotate(45 80 270)"}),E.jsx("circle",{cx:"200",cy:"450",r:"4"}),E.jsx("circle",{cx:"10",cy:"290",r:"2.5"})," ",E.jsx("circle",{cx:"10",cy:"300",r:"2.5"})," ",E.jsx("circle",{cx:"10",cy:"310",r:"2.5"})]}),E.jsxs("g",{fill:"#00f2ff",children:[E.jsx("circle",{cx:"150",cy:"230",r:"3"}),E.jsx("circle",{cx:"100",cy:"500",r:"4"}),E.jsx("circle",{cx:"390",cy:"290",r:"2.5"})," ",E.jsx("circle",{cx:"390",cy:"300",r:"2.5"})," ",E.jsx("circle",{cx:"390",cy:"310",r:"2.5"}),E.jsx("circle",{cx:"250",cy:"250",r:"3"})]}),E.jsxs("g",{fill:"#d400ff",children:[E.jsx("circle",{cx:"145",cy:"240",r:"3"}),E.jsx("rect",{x:"226",y:"326",width:"8",height:"8",transform:"rotate(45 230 330)"})]})]}),E.jsxs("g",{strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow-circuit)",children:[E.jsx("path",{d:"M20 0 V 40 L 40 60 H 60 L 70 50 L 80 60 L 90 50 L 100 60 L 110 50 L 120 60 H 150 L 200 110 V 200 L 250 250 H 400",stroke:"url(#flow-grad-orange)",className:"circuit-flow-complex-slow"}),E.jsx("path",{d:"M0 150 H 30 L 80 200 H 120 L 150 230 H 400",stroke:"url(#flow-grad-cyan)",className:"circuit-flow-complex-medium delay-1"}),E.jsx("path",{d:"M0 160 H 25 L 75 210 H 115 L 145 240 H 400",stroke:"url(#flow-grad-purple)",className:"circuit-flow-complex-medium delay-2"}),E.jsx("path",{d:"M0 300 H 50 L 80 270 H 120 L 150 300 H 200 L 230 330 H 280 L 310 300 H 400",stroke:"url(#flow-grad-orange)",className:"circuit-flow-complex-fast"}),E.jsx("path",{d:"M50 600 V 550 L 100 500 H 150 L 200 450 V 400 L 250 350 H 400",stroke:"url(#flow-grad-cyan)",className:"circuit-flow-complex-slow delay-1"}),E.jsx("path",{d:"M180 0 V 50 L 150 80 H 100",stroke:"url(#flow-grad-purple)",className:"circuit-flow-fast"}),E.jsx("path",{d:"M350 0 V 100 L 300 150 H 250",stroke:"url(#flow-grad-cyan)",className:"circuit-flow-medium delay-2"}),E.jsx("path",{d:"M200 500 H 220 L 225 495 L 230 505 L 235 495 L 240 505 L 245 500 H 280 L 320 460",stroke:"url(#flow-grad-orange)",className:"circuit-flow-medium"})]})]}),DO=({onComplete:t=()=>console.log("Login Success"),onLogoClick:e=()=>console.log("Logo Clicked"),onLogout:r=()=>console.log("Logged out"),onNavigate:n,currentView:a,isFinished:o=!1,setUsername:l=h=>console.log("Username:",h),setExpiryDate:u=h=>console.log("Expiry:",h)})=>{const[h,d]=qe.useState(""),[p,v]=qe.useState(""),[_,y]=qe.useState(!1),[S,w]=qe.useState(""),[b,F]=qe.useState(!1),[z,N]=qe.useState(null),[K,te]=qe.useState(!1),[J,k]=qe.useState(0),I=qe.useRef(null);qe.useEffect(()=>{if((async()=>{if(hl)try{await WI(hl)}catch(ae){console.error("Auth failed:",ae),y(!0),w("Li kt ni h thng")}})(),hl){const ae=ZI(hl,N);return()=>ae()}},[]),qe.useEffect(()=>{!o&&I.current&&I.current.focus()},[o]);const R=()=>{o&&(te(!K),e())},M=async()=>{try{hl&&await eD(hl),r&&r(),te(!1),window.location.reload()}catch(ke){console.error("Li ng xut:",ke),window.location.reload()}},O=(ke,ae)=>{k(1),setTimeout(()=>k(2),500),setTimeout(()=>k(3),1e3),setTimeout(()=>k(4),1100),setTimeout(()=>{k(5),l(ke),u(ae),t()},2e3)},D=async ke=>{ke.preventDefault();const ae=h.trim(),Le=p.trim();if(ae==="1"&&Le==="1"){F(!0),y(!1),w(""),O("TEST_ADMIN",new Date(2099,11,31).toISOString());return}if(!z&&hl){y(!0),w("ang kt ni...");return}if(!ae||!Le){y(!0),w("Vui lng nhp thng tin."),setTimeout(()=>y(!1),2e3);return}F(!0),y(!1),w("");try{if(!xw)throw new Error("Database Offline");const Q=ca(xw,"artifacts",IO,"public","data","license_keys",ae),L=await uI(Q);if(L.exists()){const W=L.data();if(String(W.password||"").trim()!==Le)throw new Error("MT KHU KHNG NG");const Z=new Date;if(W.expiryDate){const le=new Date(W.expiryDate);if(Z>le)throw new Error("TI KHON HT HN")}if(W.status&&W.status!=="active")throw new Error("TI KHON B KHA");O(ae,W.expiryDate)}else throw new Error("TI KHON KHNG TN TI")}catch(Q){F(!1),y(!0),w(Q.message||"LI KT NI"),setTimeout(()=>y(!1),2e3)}},V=o?"50px":"220px",_e=_?"#ff0033":J>0?"#ff5e00":"#f59e0b",Te=J>=3?"open":"",ne=J>=4?"open":"",oe=J>=1&&J<3?"energized":"";return E.jsxs("div",{className:`fixed inset-0 z-50 overflow-hidden ${o?"pointer-events-none":"pointer-events-auto"} ${_?"animate-shake-glitch":""}`,children:[E.jsx("style",{children:`
                .metal-bg { background-color: #050505; background-image: linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111), linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111), radial-gradient(circle at 50% 50%, #1a1a1a, #000); background-position: 0 0, 10px 10px, 0 0; background-size: 20px 20px, 20px 20px, 100% 100%; box-shadow: inset 0 0 100px #000; }
                .inner-metal-bg { background: repeating-linear-gradient(-45deg, #151515, #151515 10px, #111 10px, #111 20px); box-shadow: inset 0 0 50px #000; }
                @keyframes circuit-loop { from { stroke-dashoffset: 1200; } to { stroke-dashoffset: 0; } }
                .circuit-flow-complex-fast { stroke-dasharray: 150 1050; animation: circuit-loop 5s linear infinite; }
                .circuit-flow-complex-medium { stroke-dasharray: 200 1000; animation: circuit-loop 7s linear infinite; }
                .circuit-flow-complex-slow { stroke-dasharray: 250 950; animation: circuit-loop 10s linear infinite; }
                .circuit-flow-fast { stroke-dasharray: 100 500; animation: circuit-loop 6s linear infinite; }
                .circuit-flow-medium { stroke-dasharray: 120 480; animation: circuit-loop 8s linear infinite; }
                .delay-1 { animation-delay: 2s; } .delay-2 { animation-delay: 4s; }
                @keyframes spin-rev { from { transform: rotate(360deg); } to { transform: rotate(0deg); } }
                @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
                .animate-spin-slow { animation: spin-slow 8s linear infinite; }
                .animate-spin-slow-reverse { animation: spin-rev 12s linear infinite; }
                .door-panel { position: absolute; top: 0; bottom: 0; width: 50%; transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); z-index: 40; display: flex; align-items: center; justify-content: center; border-top: 5px solid #222; border-bottom: 5px solid #222; overflow: hidden; }
                .door-left { left: 0; border-right: 4px solid #333; -webkit-mask-image: radial-gradient(circle at 100% 50%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 100% 50%, transparent 115px, black 116px); }
                .door-left.energized::after { content: ''; position: absolute; top: 0; bottom: 0; right: 0; width: 4px; background: linear-gradient(to bottom, transparent 20%, #00f2ff 50%, transparent 80%); box-shadow: 0 0 15px #00f2ff; z-index: 60; opacity: 1; transition: all 0.5s ease; }
                .door-left::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 100% 50%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .door-right { right: 0; border-left: 4px solid #333; -webkit-mask-image: radial-gradient(circle at 0% 50%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 0% 50%, transparent 115px, black 116px); }
                .door-right.energized::after { content: ''; position: absolute; top: 0; bottom: 0; left: 0; width: 4px; background: linear-gradient(to bottom, transparent 20%, #00f2ff 50%, transparent 80%); box-shadow: 0 0 15px #00f2ff; z-index: 60; opacity: 1; transition: all 0.5s ease; }
                .door-right::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 0% 50%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .door-left.open { transform: translateX(-100%); } .door-right.open { transform: translateX(100%); }
                .inner-door { position: absolute; left: 0; right: 0; height: 50%; z-index: 39; transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); display: flex; justify-content: center; align-items: flex-end; border-left: 5px solid #222; border-right: 5px solid #222; }
                .inner-door-top { top: 0; border-bottom: 2px solid #ff7b00; align-items: flex-end; -webkit-mask-image: radial-gradient(circle at 50% 100%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 50% 100%, transparent 115px, black 116px); }
                .inner-door-top::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 50% 100%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .inner-door-bottom { bottom: 0; border-top: 2px solid #ff7b00; align-items: flex-start; -webkit-mask-image: radial-gradient(circle at 50% 0%, transparent 115px, black 116px); mask-image: radial-gradient(circle at 50% 0%, transparent 115px, black 116px); }
                .inner-door-bottom::before { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 50; background: radial-gradient(circle at 50% 0%, transparent 115px, #888 116px, #111 120px, #ff5e00 123px, transparent 125px); }
                .inner-door-top.open { transform: translateY(-100%); } .inner-door-bottom.open { transform: translateY(100%); }
                .clamp { position: absolute; width: 80px; height: 140px; background: #1a1a1a; border: 1px solid #444; z-index: 45; transition: all 0.6s cubic-bezier(0.68, -0.6, 0.32, 1.6); display: flex; flex-direction: column; align-items: center; justify-content: space-evenly; }
                .clamp-left { left: 50%; top: 50%; transform: translate(-100%, -50%); border-radius: 12px 0 0 12px; border-right: 4px solid #000; }
                .clamp-right { left: 50%; top: 50%; transform: translate(0, -50%); border-radius: 0 12px 12px 0; border-left: 4px solid #000; }
                .unlocked .clamp-left { transform: translate(-350px, -50%) scale(0.9); opacity: 0; }
                .unlocked .clamp-right { transform: translate(350px, -50%) scale(0.9); opacity: 0; }
                .data-overlay { background: linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px); background-size: 100% 3px; animation: data-scroll 5s linear infinite; pointer-events: none; }
                @keyframes data-scroll { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } }
                @keyframes shake-glitch { 0%, 100% { transform: translate(0); } 20% { transform: translate(-5px, 5px); } 80% { transform: translate(5px, 5px); } }
                .animate-shake-glitch { animation: shake-glitch 0.3s cubic-bezier(.36,.07,.19,.97) both; }
                @keyframes heat-pulse { 0%, 100% { box-shadow: 0 0 20px ${_e}40, inset 0 0 10px ${_e}20; border-color: ${_e}80; } 50% { box-shadow: 0 0 50px ${_e}, inset 0 0 30px ${_e}60; border-color: #ffaa00; } }
                .animate-heat-glow { animation: heat-pulse 2s infinite; }
                @keyframes spin-turbo { 0% { transform: rotate(0deg); } 100% { transform: rotate(720deg); } }
                .animate-spin-turbo { animation: spin-turbo 1s cubic-bezier(0.5, 0, 1, 1) forwards; transform-origin: 100px 100px; }
                .logo-container { transition: all 1.2s cubic-bezier(0.77, 0, 0.175, 1); }
                .logo-container.minimized { top: 15px; left: 20px; transform: translate(0, 0) scale(1) !important; }
            `}),E.jsxs("div",{className:`door-panel door-left metal-bg ${Te} ${oe}`,children:[E.jsx(vw,{isLeft:!0}),E.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-gradient-to-l from-orange-500/20 to-transparent z-20"}),E.jsxs("div",{className:"flex flex-col gap-6 opacity-30 w-full pl-20 z-20",children:[E.jsx("div",{className:"text-white/20 text-6xl font-black rotate-90 origin-left whitespace-nowrap",children:"SECTOR 09"}),E.jsx("div",{className:"w-full h-1 bg-white/10"})]})]}),E.jsxs("div",{className:`door-panel door-right metal-bg ${Te} ${oe}`,children:[E.jsx(vw,{isLeft:!1}),E.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-gradient-to-r from-orange-500/20 to-transparent z-20"}),E.jsxs("div",{className:"flex flex-col gap-6 opacity-30 w-full pr-20 items-end z-20",children:[E.jsx("div",{className:"text-white/20 text-6xl font-black -rotate-90 origin-right whitespace-nowrap",children:"ARMORY"}),E.jsx("div",{className:"w-full h-1 bg-white/10"})]})]}),E.jsxs("div",{className:`inner-door inner-door-top inner-metal-bg ${ne}`,children:[E.jsx("div",{className:"w-full h-4 bg-orange-500/50 blur-sm mb-2"}),E.jsx("div",{className:"absolute bottom-4 text-orange-500/50 font-mono tracking-[1em] text-xs",children:"SYSTEM INITIALIZING"})]}),E.jsxs("div",{className:`inner-door inner-door-bottom inner-metal-bg ${ne}`,children:[E.jsx("div",{className:"w-full h-4 bg-orange-500/50 blur-sm mt-2"}),E.jsx("div",{className:"absolute top-4 text-orange-500/50 font-mono tracking-[1em] text-xs",children:"DATA DECRYPTED"})]}),J>=3&&!o&&E.jsx("div",{className:"absolute inset-0 z-30 data-overlay opacity-50"}),E.jsxs("div",{className:`absolute top-1/2 left-1/2 w-0 h-0 z-[45] flex items-center justify-center transition-opacity duration-300 ${J>=3?"opacity-0":"opacity-100"}`,children:[E.jsx("div",{className:`clamp clamp-left ${J>=2?"unlocked":""}`,children:E.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[E.jsx("div",{className:`w-2 h-2 rounded-full ${J>=1?"bg-orange-500 animate-ping":"bg-red-900"}`}),E.jsx("div",{className:"w-1 h-8 bg-black/50"})]})}),E.jsx("div",{className:`clamp clamp-right ${J>=2?"unlocked":""}`,children:E.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[E.jsx("div",{className:`w-2 h-2 rounded-full ${J>=1?"bg-orange-500 animate-ping":"bg-red-900"}`}),E.jsx("div",{className:"w-1 h-8 bg-black/50"})]})})]}),E.jsx("div",{className:`absolute bottom-[15%] left-1/2 -translate-x-1/2 w-full flex justify-center flex-col items-center z-[50] transition-all duration-500 ${J>0?"opacity-0 translate-y-10 pointer-events-none":"opacity-100"}`,children:E.jsxs("form",{onSubmit:D,className:"flex flex-col items-center gap-4",children:[E.jsx("div",{className:"relative group w-80",children:E.jsxs("div",{className:"relative flex items-center bg-black rounded border border-neutral-700 focus-within:border-orange-500 transition-colors shadow-2xl",children:[E.jsx(CO,{className:"w-5 h-5 text-neutral-500 ml-4"}),E.jsx("input",{ref:I,type:"text",value:h,onChange:ke=>d(ke.target.value),placeholder:"M TRUY CP",className:"bg-transparent border-none outline-none text-white placeholder-neutral-600 px-4 py-3.5 w-full font-mono tracking-[0.2em] text-center uppercase font-bold",autoComplete:"off"})]})}),E.jsx("div",{className:"relative group w-80",children:E.jsxs("div",{className:`relative flex items-center bg-black rounded border transition-colors shadow-2xl ${_?"border-red-600":"border-neutral-700 focus-within:border-orange-500"}`,children:[E.jsx(dO,{className:`w-5 h-5 ml-4 ${_?"text-red-500":"text-neutral-500"}`}),E.jsx("input",{type:"password",value:p,onChange:ke=>v(ke.target.value),placeholder:"MT KHU",className:`bg-transparent border-none outline-none px-4 py-3.5 w-full font-mono tracking-[0.2em] text-center uppercase font-bold ${_?"text-red-500 placeholder-red-800":"text-white placeholder-neutral-600"}`,autoComplete:"off"}),E.jsx("button",{type:"submit",disabled:b,className:"absolute right-1 p-2 transition-colors disabled:opacity-50 text-neutral-500 hover:text-white",children:E.jsx(v8,{className:"w-5 h-5"})})]})}),E.jsxs("div",{className:"h-6 mt-1",children:[b&&E.jsx("div",{className:"text-orange-500 text-xs font-mono animate-pulse tracking-[0.2em] bg-black/50 px-2 py-1 rounded",children:"ANG XC THC..."}),_&&E.jsxs("div",{className:"text-[#ff0033] text-xs font-bold font-mono flex items-center gap-2 animate-bounce tracking-widest uppercase bg-black/50 px-2 py-1 rounded",children:[E.jsx(oA,{className:"w-3 h-3"})," ",S]})]})]})}),E.jsx("div",{onClick:R,className:`logo-container fixed z-[60] flex items-center justify-center bg-[#0a0a0a] rounded-full 
                ${o?"minimized cursor-pointer hover:scale-110 border-2 pointer-events-auto":"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none border-4"}
                ${_?"animate-shake-glitch":""}
                animate-heat-glow
                `,style:{width:V,height:V,borderColor:_e},children:E.jsx("div",{className:"relative w-full h-full p-2 flex items-center justify-center overflow-hidden rounded-full",children:E.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full overflow-visible z-10",fill:"none",stroke:_e,strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"100",cy:"100",r:"95",stroke:"#333",strokeWidth:"4"}),E.jsx("path",{d:"M100 5 L100 15 M100 185 L100 195 M5 100 L15 100 M185 100 L195 100",stroke:"#444",strokeWidth:"3"}),E.jsxs("g",{className:J>=1?"animate-spin-turbo":"",style:{transformOrigin:"100px 100px"},children:[E.jsx("circle",{cx:"100",cy:"100",r:"85",stroke:"#444",strokeWidth:"2",strokeDasharray:"20 10"}),E.jsx("path",{d:"M100 20 L100 30 M170 100 L180 100 M100 170 L100 180 M20 100 L30 100",stroke:"#555",strokeWidth:"4"})]}),E.jsxs("g",{style:{transformOrigin:"100px 100px",animation:"spin-rev 12s linear infinite"},children:[E.jsx("circle",{cx:"100",cy:"100",r:"70",stroke:"#333",strokeWidth:"1",strokeDasharray:"5 5"}),E.jsx("path",{d:"M100 30 L110 40 L90 40 Z",fill:"#222",stroke:"none"}),E.jsx("path",{d:"M100 30 L110 40 L90 40 Z",fill:"#222",stroke:"none",transform:"rotate(120, 100, 100)"}),E.jsx("path",{d:"M100 30 L110 40 L90 40 Z",fill:"#222",stroke:"none",transform:"rotate(240, 100, 100)"})]}),E.jsxs("g",{style:{transformOrigin:"100px 100px",animation:"spin-slow 8s linear infinite"},children:[E.jsx("circle",{cx:"100",cy:"100",r:"50",stroke:_e,strokeWidth:"1",strokeDasharray:"2 4"}),[0,60,120,180,240,300].map(ke=>E.jsx("path",{d:"M100 55 L105 65 H95 Z",fill:_e,transform:`rotate(${ke}, 100, 100)`},ke))]}),E.jsxs("g",{style:{transformOrigin:"100px 100px",animation:"spin-rev 4s linear infinite"},children:[E.jsx("path",{d:"M100 65 L115 85 L85 85 Z",stroke:_e,strokeWidth:"2",fill:"none"}),E.jsx("path",{d:"M100 65 L115 85 L85 85 Z",stroke:_e,strokeWidth:"2",fill:"none",transform:"rotate(120, 100, 100)"}),E.jsx("path",{d:"M100 65 L115 85 L85 85 Z",stroke:_e,strokeWidth:"2",fill:"none",transform:"rotate(240, 100, 100)"})]}),E.jsx("circle",{cx:"100",cy:"100",r:"25",fill:_e,fillOpacity:"0.2"}),E.jsx("circle",{cx:"100",cy:"100",r:"15",fill:_e,className:"animate-pulse"})]})})}),o&&K&&E.jsx("div",{className:"fixed top-[70px] left-[20px] z-[70] w-64 animate-in fade-in slide-in-from-top-5 duration-300 pointer-events-auto",children:E.jsxs("div",{className:"bg-black/95 border border-orange-500/50 rounded-lg p-2 shadow-[0_0_20px_rgba(255,94,0,0.3)] backdrop-blur-md",children:[E.jsxs("div",{className:"px-4 py-2 border-b border-white/10 mb-2 flex justify-between items-center",children:[E.jsx("span",{className:"text-[10px] text-orange-500 font-mono tracking-widest uppercase",children:"H THNG"}),E.jsx("button",{onClick:()=>te(!1),className:"text-gray-500 hover:text-white transition-colors font-mono text-xs",children:"[NG]"})]}),E.jsxs("div",{className:"flex flex-col gap-1",children:[E.jsxs("button",{onClick:()=>{n&&n("inventory"),te(!1)},className:`group flex items-center gap-3 w-full px-4 py-3 text-left hover:bg-orange-500/10 rounded transition-colors ${a==="inventory"?"text-white bg-orange-500/20":"text-gray-300"}`,children:[E.jsx(lA,{className:"w-4 h-4 text-orange-500 group-hover:scale-110 transition-transform"}),E.jsx("span",{className:"font-mono text-sm tracking-wider",children:"KIM K KHO"})]}),E.jsxs("button",{onClick:()=>{n&&n("incoming"),te(!1)},className:`group flex items-center gap-3 w-full px-4 py-3 text-left hover:bg-orange-500/10 rounded transition-colors ${a==="incoming"?"text-white bg-orange-500/20":"text-gray-300"}`,children:[E.jsx(pO,{className:"w-4 h-4 text-orange-500 group-hover:scale-110 transition-transform"}),E.jsx("span",{className:"font-mono text-sm tracking-wider",children:"KIM T HNG"})]}),E.jsxs("button",{onClick:()=>{n&&n("forecast"),te(!1)},className:`group flex items-center gap-3 w-full px-4 py-3 text-left hover:bg-orange-500/10 rounded transition-colors ${a==="forecast"?"text-white bg-orange-500/20":"text-gray-300"}`,children:[E.jsx(wO,{className:"w-4 h-4 text-orange-500 group-hover:scale-110 transition-transform"}),E.jsx("span",{className:"font-mono text-sm tracking-wider",children:"D BO DOANH S"})]}),E.jsx("div",{className:"h-px bg-white/10 my-1"}),E.jsxs("button",{onClick:M,className:"group flex items-center gap-3 w-full px-4 py-3 text-left bg-red-900/20 hover:bg-red-600 rounded transition-all duration-300 text-red-400 hover:text-white border border-transparent hover:border-red-500",children:[E.jsx(J8,{className:"w-4 h-4 group-hover:rotate-180 transition-transform duration-500"}),E.jsx("span",{className:"font-mono text-sm tracking-wider font-bold",children:"NG XUT"})]})]})]})}),o&&E.jsx("div",{className:"absolute transition-all duration-1000 ease-in-out whitespace-nowrap z-[60] left-20 top-6 ml-4 opacity-100",children:E.jsxs("div",{className:"flex flex-col",children:[E.jsx("span",{className:"font-bold text-white font-mono tracking-widest text-lg drop-shadow-[0_0_5px_rgba(255,165,0,0.5)]",children:"KHO SN MI"}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),E.jsx("span",{className:"text-[10px] text-orange-500 font-mono tracking-widest uppercase",children:a==="inventory"?"Inventory Online":a==="incoming"?"Orders Online":"Forecast Online"})]})]})})]})},OO={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},mA=Xd(OO);tA(mA);const Sa=hx(mA);var Dd={};Dd.version="0.18.5";var pA=1252,FO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Cx=function(t){FO.indexOf(t)!=-1&&(pA=kx[0]=t)};function MO(){Cx(1252)}var pi=function(t){Cx(t)};function Nx(){pi(1200),MO()}function _w(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function LO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function gA(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var mf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?LO(t.slice(2)):e==254&&r==255?gA(t.slice(2)):e==65279?t.slice(1):t},Hh=function(e){return String.fromCharCode(e)},yw=function(e){return String.fromCharCode(e)},Uf,go="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jf(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),l=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),e+=go.charAt(o)+go.charAt(l)+go.charAt(u)+go.charAt(h);return e}function Ia(t){var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=go.indexOf(t.charAt(d++)),l=go.indexOf(t.charAt(d++)),r=o<<2|l>>4,e+=String.fromCharCode(r),u=go.indexOf(t.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=go.indexOf(t.charAt(d++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var wt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),bs=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Do(t){return wt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Tw(t){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ca=function(e){return wt?bs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function gm(t){if(typeof ArrayBuffer>"u")return Ca(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Vo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function PO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Rx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Rx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var mn=wt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:bs(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function VO(t){for(var e=[],r=0,n=t.length+250,a=Do(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Do(65535),n=65530)}return e.push(a.slice(0,r)),mn(e)}var Jn=/\u0000/g,pf=/[\u0001-\u0006]/g;function Hc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function gi(t,e){var r=""+t;return r.length>=e?r:Cr("0",e-r.length)+r}function Ix(t,e){var r=""+t;return r.length>=e?r:Cr(" ",e-r.length)+r}function Od(t,e){var r=""+t;return r.length>=e?r:r+Cr(" ",e-r.length)}function BO(t,e){var r=""+Math.round(t);return r.length>=e?r:Cr("0",e-r.length)+r}function UO(t,e){var r=""+t;return r.length>=e?r:Cr("0",e-r.length)+r}var ww=Math.pow(2,32);function bc(t,e){if(t>ww||t<-ww)return BO(t,e);var r=Math.round(t);return UO(r,e)}function Fd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Ew=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},zO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Md(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,l=1,u=0,h=1,d=0,p=0,v=Math.floor(a);d<e&&(v=Math.floor(a),u=v*l+o,p=v*d+h,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=o):(p=d,u=l)),!r)return[0,n*u,p];var _=Math.floor(n*u/p);return[_,n*u-_*p,p]}function xl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=KO(h,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var xA=new Date(1899,11,31,0,0,0),HO=xA.getTime(),GO=new Date(1900,2,1,0,0,0);function vA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=GO&&(r+=1440*60*1e3),(r-(HO+(t.getTimezoneOffset()-xA.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Dx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function XO(t){var e=t<0?12:11,r=Dx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function WO(t){var e=Dx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function zf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=XO(t):e===10?r=t.toFixed(10).substr(0,12):r=WO(t),Dx(qO(r.toUpperCase()))}function Nl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):zf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Qa(14,vA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function KO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function $O(t,e,r,n){var a="",o=0,l=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return Lp[r.m-1][1];case 5:return Lp[r.m-1][0];default:return Lp[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return Ew[r.q][0];default:return Ew[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?gi(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=gi(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?gi(h,d):"";return p}function xo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var _A=/%/g;function YO(t,e,r){var n=e.replace(_A,""),a=e.length-n.length;return gs(t,n,r*Math.pow(10,2*a))+Cr("%",a)}function QO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return gs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function yA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+yA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var TA=/# (\?+)( ?)\/( ?)(\d+)/;function JO(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),l=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(l===0?Cr(" ",t[1].length+1+t[4].length):Ix(l,t[1].length)+t[2]+"/"+t[3]+gi(u,t[4].length))}function ZO(t,e,r){return r+(e===0?"":""+e)+Cr(" ",t[1].length+2+t[4].length)}var wA=/^#*0*\.([0#]+)/,EA=/\).*[0#]/,SA=/\(###\) ###\\?-####/;function Yn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Aw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function bw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function eF(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function tF(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ga(t,e,r){if(t.charCodeAt(0)===40&&!e.match(EA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ga("n",n,r):"("+Ga("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return QO(t,e,r);if(e.indexOf("%")!==-1)return YO(t,e,r);if(e.indexOf("E")!==-1)return yA(e,r);if(e.charCodeAt(0)===36)return"$"+Ga(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+bc(h,e.length);if(e.match(/^[#?]+$/))return a=bc(r,0),a==="0"&&(a=""),a.length>e.length?a:Yn(e.substr(0,e.length-a.length))+a;if(o=e.match(TA))return JO(o,h,d);if(e.match(/^#+0+$/))return d+bc(h,e.length-e.indexOf("0"));if(o=e.match(wA))return a=Aw(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Yn(o[1])).replace(/\.$/,"."+Yn(o[1])).replace(/\.(\d*)$/,function(S,w){return"."+w+Cr("0",Yn(o[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+Aw(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+xo(bc(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ga(t,e,-r):xo(""+(Math.floor(r)+eF(r,o[1].length)))+"."+gi(bw(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Ga(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Hc(Ga(t,e.replace(/[\\-]/g,""),r)),l=0,Hc(Hc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(SA))return a=Ga(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Md(h,Math.pow(10,l)-1,!1),a=""+d,p=gs("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Od(u[2],l),p.length<o[4].length&&(p=Yn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Md(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Ix(u[1],l)+o[2]+"/"+o[3]+Od(u[2],l):Cr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=bc(r,0),e.length<=a.length?a:Yn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Yn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=bw(r,o[1].length),r<0?"-"+Ga(t,e,-r):xo(tF(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?gi(0,3-S.length):"")+S})+"."+gi(l,o[1].length);switch(e){case"###,##0.00":return Ga(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=xo(bc(h,0));return y!=="0"?d+y:"";case"###,###.00":return Ga(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ga(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function rF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return gs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function nF(t,e,r){var n=e.replace(_A,""),a=e.length-n.length;return gs(t,n,r*Math.pow(10,2*a))+Cr("%",a)}function AA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+AA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(EA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fi("n",n,r):"("+Fi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return rF(t,e,r);if(e.indexOf("%")!==-1)return nF(t,e,r);if(e.indexOf("E")!==-1)return AA(e,r);if(e.charCodeAt(0)===36)return"$"+Fi(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+gi(h,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Yn(e.substr(0,e.length-a.length))+a;if(o=e.match(TA))return ZO(o,h,d);if(e.match(/^#+0+$/))return d+gi(h,e.length-e.indexOf("0"));if(o=e.match(wA))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Yn(o[1])).replace(/\.$/,"."+Yn(o[1])),a=a.replace(/\.(\d*)$/,function(S,w){return"."+w+Cr("0",Yn(o[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+xo(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fi(t,e,-r):xo(""+r)+"."+Cr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Fi(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Hc(Fi(t,e.replace(/[\\-]/g,""),r)),l=0,Hc(Hc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(SA))return a=Fi(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Md(h,Math.pow(10,l)-1,!1),a=""+d,p=gs("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Od(u[2],l),p.length<o[4].length&&(p=Yn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Md(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Ix(u[1],l)+o[2]+"/"+o[3]+Od(u[2],l):Cr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Yn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Yn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fi(t,e,-r):xo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?gi(0,3-S.length):"")+S})+"."+gi(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=xo(""+h);return y!=="0"?d+y:"";default:if(e.match(/\.[0#?]*$/))return Fi(t,e.slice(0,e.lastIndexOf(".")),r)+Yn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function gs(t,e,r){return(r|0)===r?Fi(t,e,r):Ga(t,e,r)}function aF(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var bA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function uu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Fd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(bA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function iF(t,e,r,n){for(var a=[],o="",l=0,u="",h="t",d,p,v,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!Fd(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var y=t.charAt(++l),S=y==="("||y===")"?y:"t";a[a.length]={t:S,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=xl(e,r,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=xl(e,r),d==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=xl(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",l+=5,_="h"):(w.t="t",++l),d==null&&w.t==="T")return"";a[a.length]=w,h=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(bA)){if(d==null&&(d=xl(e,r),d==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",uu(t)||(a[a.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},h=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var b=0,F=0,z;for(l=a.length-1,h="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,h="h",b<1&&(b=1);break;case"s":(z=a[l].v.match(/\.0+$/))&&(F=Math.max(F,z[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=a[l].t;break;case"m":h==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var N="",K;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=$O(a[l].t.charCodeAt(0),a[l].v,d,F),a[l].t="t";break;case"n":case"?":for(K=l+1;a[K]!=null&&((u=a[K].t)==="?"||u==="D"||(u===" "||u==="t")&&a[K+1]!=null&&(a[K+1].t==="?"||a[K+1].t==="t"&&a[K+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[K].v==="/"||a[K].v===" "&&a[K+1]!=null&&a[K+1].t=="?"));)a[l].v+=a[K].v,a[K]={v:"",t:";"},++K;N+=a[l].v,l=K-1;break;case"G":a[l].t="t",a[l].v=Nl(e,r);break}var te="",J,k;if(N.length>0){N.charCodeAt(0)==40?(J=e<0&&N.charCodeAt(0)===45?-e:e,k=gs("n",N,J)):(J=e<0&&n>1?-e:e,k=gs("n",N,J),J<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),K=k.length-1;var I=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){I=l;break}var R=a.length;if(I===a.length&&k.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(K>=a[l].v.length-1?(K-=a[l].v.length,a[l].v=k.substr(K+1,a[l].v.length)):K<0?a[l].v="":(a[l].v=k.substr(0,K+1),K=-1),a[l].t="t",R=l);K>=0&&R<a.length&&(a[R].v=k.substr(0,K+1)+a[R].v)}else if(I!==a.length&&k.indexOf("E")===-1){for(K=k.indexOf(".")-1,l=I;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")-1:a[l].v.length-1,te=a[l].v.substr(p+1);p>=0;--p)K>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(te=k.charAt(K--)+te);a[l].v=te,a[l].t="t",R=l}for(K>=0&&R<a.length&&(a[R].v=k.substr(0,K+1)+a[R].v),K=k.indexOf(".")+1,l=I;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==I)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")+1:0,te=a[l].v.substr(0,p);p<a[l].v.length;++p)K<k.length&&(te+=k.charAt(K++));a[l].v=te,a[l].t="t",R=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(J=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=gs(a[l].t,a[l].v,J),a[l].t="t");var M="";for(l=0;l!==a.length;++l)a[l]!=null&&(M+=a[l].v);return M}var kw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Cw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function sF(t,e){var r=aF(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(kw),u=r[1].match(kw);return Cw(e,l)?[n,r[0]]:Cw(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,o]}function Qa(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:st)[t],n==null&&(n=r.table&&r.table[Sw[t]]||st[Sw[t]]),n==null&&(n=zO[t]||"General");break}if(Fd(n,0))return Nl(e,r);e instanceof Date&&(e=vA(e,r.date1904));var a=sF(n,e);if(Fd(a[1]))return Nl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return iF(a[1],e,r,a[0])}function xs(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(st[r]==null){e<0&&(e=r);continue}if(st[r]==t){e=r;break}}e<0&&(e=391)}return st[e]=t,e}function xm(t){for(var e=0;e!=392;++e)t[e]!==void 0&&xs(t[e],e)}function fu(){st=jO()}var oF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},kA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function lF(t){var e=typeof t=="number"?st[t]:t;return e=e.replace(kA,"(\\d+)"),new RegExp("^"+e+"$")}function cF(t,e,r){var n=-1,a=-1,o=-1,l=-1,u=-1,h=-1;(e.match(kA)||[]).forEach(function(v,_){var y=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=y;break;case"d":o=y;break;case"h":l=y;break;case"s":h=y;break;case"m":l>=0?u=y:a=y;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&u==-1&&h==-1?d:n==-1&&a==-1&&o==-1?p:d+"T"+p}var uF=(function(){var t={};t.version="1.2.0";function e(){for(var k=0,I=new Array(256),R=0;R!=256;++R)k=R,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,I[R]=k;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(k){var I=0,R=0,M=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)O[M]=k[M];for(M=0;M!=256;++M)for(R=k[M],I=256+M;I<4096;I+=256)R=O[I]=R>>>8^k[R&255];var D=[];for(M=1;M!=16;++M)D[M-1]=typeof Int32Array<"u"?O.subarray(M*256,M*256+256):O.slice(M*256,M*256+256);return D}var a=n(r),o=a[0],l=a[1],u=a[2],h=a[3],d=a[4],p=a[5],v=a[6],_=a[7],y=a[8],S=a[9],w=a[10],b=a[11],F=a[12],z=a[13],N=a[14];function K(k,I){for(var R=I^-1,M=0,O=k.length;M<O;)R=R>>>8^r[(R^k.charCodeAt(M++))&255];return~R}function te(k,I){for(var R=I^-1,M=k.length-15,O=0;O<M;)R=N[k[O++]^R&255]^z[k[O++]^R>>8&255]^F[k[O++]^R>>16&255]^b[k[O++]^R>>>24]^w[k[O++]]^S[k[O++]]^y[k[O++]]^_[k[O++]]^v[k[O++]]^p[k[O++]]^d[k[O++]]^h[k[O++]]^u[k[O++]]^l[k[O++]]^o[k[O++]]^r[k[O++]];for(M+=15;O<M;)R=R>>>8^r[(R^k[O++])&255];return~R}function J(k,I){for(var R=I^-1,M=0,O=k.length,D=0,V=0;M<O;)D=k.charCodeAt(M++),D<128?R=R>>>8^r[(R^D)&255]:D<2048?(R=R>>>8^r[(R^(192|D>>6&31))&255],R=R>>>8^r[(R^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,V=k.charCodeAt(M++)&1023,R=R>>>8^r[(R^(240|D>>8&7))&255],R=R>>>8^r[(R^(128|D>>2&63))&255],R=R>>>8^r[(R^(128|V>>6&15|(D&3)<<4))&255],R=R>>>8^r[(R^(128|V&63))&255]):(R=R>>>8^r[(R^(224|D>>12&15))&255],R=R>>>8^r[(R^(128|D>>6&63))&255],R=R>>>8^r[(R^(128|D&63))&255]);return~R}return t.table=r,t.bstr=K,t.buf=te,t.str=J,t})(),tt=(function(){var e={};e.version="1.2.1";function r(P,X){for(var U=P.split("/"),H=X.split("/"),q=0,Y=0,fe=Math.min(U.length,H.length);q<fe;++q){if(Y=U[q].length-H[q].length)return Y;if(U[q]!=H[q])return U[q]<H[q]?-1:1}return U.length-H.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var X=P.lastIndexOf("/");return X===-1?P:P.slice(0,X+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var X=P.lastIndexOf("/");return X===-1?P:P.slice(X+1)}function o(P,X){typeof X=="string"&&(X=new Date(X));var U=X.getHours();U=U<<6|X.getMinutes(),U=U<<5|X.getSeconds()>>>1,P.write_shift(2,U);var H=X.getFullYear()-1980;H=H<<4|X.getMonth()+1,H=H<<5|X.getDate(),P.write_shift(2,H)}function l(P){var X=P.read_shift(2)&65535,U=P.read_shift(2)&65535,H=new Date,q=U&31;U>>>=5;var Y=U&15;U>>>=4,H.setMilliseconds(0),H.setFullYear(U+1980),H.setMonth(Y-1),H.setDate(q);var fe=X&31;X>>>=5;var we=X&63;return X>>>=6,H.setHours(X),H.setMinutes(we),H.setSeconds(fe<<1),H}function u(P){Sn(P,0);for(var X={},U=0;P.l<=P.length-4;){var H=P.read_shift(2),q=P.read_shift(2),Y=P.l+q,fe={};H===21589&&(U=P.read_shift(1),U&1&&(fe.mtime=P.read_shift(4)),q>5&&(U&2&&(fe.atime=P.read_shift(4)),U&4&&(fe.ctime=P.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3))),P.l=Y,X[H]=fe}return X}var h;function d(){return h||(h={})}function p(P,X){if(P[0]==80&&P[1]==75)return ln(P,X);if((P[0]|32)==109&&(P[1]|32)==105)return ei(P,X);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var U=3,H=512,q=0,Y=0,fe=0,we=0,he=0,pe=[],me=P.slice(0,512);Sn(me,0);var Pe=v(me);switch(U=Pe[0],U){case 3:H=512;break;case 4:H=4096;break;case 0:if(Pe[1]==0)return ln(P,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}H!==512&&(me=P.slice(0,H),Sn(me,28));var Ve=P.slice(0,H);_(me,U);var Ge=me.read_shift(4,"i");if(U===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);me.l+=4,fe=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),we=me.read_shift(4,"i"),q=me.read_shift(4,"i"),he=me.read_shift(4,"i"),Y=me.read_shift(4,"i");for(var Me=-1,He=0;He<109&&(Me=me.read_shift(4,"i"),!(Me<0));++He)pe[He]=Me;var Ye=y(P,H);b(he,Y,Ye,H,pe);var Yt=z(Ye,fe,pe,H);Yt[fe].name="!Directory",q>0&&we!==V&&(Yt[we].name="!MiniFAT"),Yt[pe[0]].name="!FAT",Yt.fat_addrs=pe,Yt.ssz=H;var Qt={},ur=[],Rn=[],ri=[];N(fe,Yt,Ye,ur,q,Qt,Rn,we),S(Rn,ri,ur),ur.shift();var ni={FileIndex:Rn,FullPaths:ri};return X&&X.raw&&(ni.raw={header:Ve,sectors:Ye}),ni}function v(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(_e,"Header Signature: "),P.l+=16;var X=P.read_shift(2,"u");return[P.read_shift(2,"u"),X]}function _(P,X){var U=9;switch(P.l+=2,U=P.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function y(P,X){for(var U=Math.ceil(P.length/X)-1,H=[],q=1;q<U;++q)H[q-1]=P.slice(q*X,(q+1)*X);return H[U-1]=P.slice(U*X),H}function S(P,X,U){for(var H=0,q=0,Y=0,fe=0,we=0,he=U.length,pe=[],me=[];H<he;++H)pe[H]=me[H]=H,X[H]=U[H];for(;we<me.length;++we)H=me[we],q=P[H].L,Y=P[H].R,fe=P[H].C,pe[H]===H&&(q!==-1&&pe[q]!==q&&(pe[H]=pe[q]),Y!==-1&&pe[Y]!==Y&&(pe[H]=pe[Y])),fe!==-1&&(pe[fe]=H),q!==-1&&H!=pe[H]&&(pe[q]=pe[H],me.lastIndexOf(q)<we&&me.push(q)),Y!==-1&&H!=pe[H]&&(pe[Y]=pe[H],me.lastIndexOf(Y)<we&&me.push(Y));for(H=1;H<he;++H)pe[H]===H&&(Y!==-1&&pe[Y]!==Y?pe[H]=pe[Y]:q!==-1&&pe[q]!==q&&(pe[H]=pe[q]));for(H=1;H<he;++H)if(P[H].type!==0){if(we=H,we!=pe[we])do we=pe[we],X[H]=X[we]+"/"+X[H];while(we!==0&&pe[we]!==-1&&we!=pe[we]);pe[H]=-1}for(X[0]+="/",H=1;H<he;++H)P[H].type!==2&&(X[H]+="/")}function w(P,X,U){for(var H=P.start,q=P.size,Y=[],fe=H;U&&q>0&&fe>=0;)Y.push(X.slice(fe*D,fe*D+D)),q-=D,fe=pl(U,fe*4);return Y.length===0?ye(0):mn(Y).slice(0,P.size)}function b(P,X,U,H,q){var Y=V;if(P===V){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var fe=U[P],we=(H>>>2)-1;if(!fe)return;for(var he=0;he<we&&(Y=pl(fe,he*4))!==V;++he)q.push(Y);b(pl(fe,H-4),X-1,U,H,q)}}function F(P,X,U,H,q){var Y=[],fe=[];q||(q=[]);var we=H-1,he=0,pe=0;for(he=X;he>=0;){q[he]=!0,Y[Y.length]=he,fe.push(P[he]);var me=U[Math.floor(he*4/H)];if(pe=he*4&we,H<4+pe)throw new Error("FAT boundary crossed: "+he+" 4 "+H);if(!P[me])break;he=pl(P[me],pe)}return{nodes:Y,data:Uw([fe])}}function z(P,X,U,H){var q=P.length,Y=[],fe=[],we=[],he=[],pe=H-1,me=0,Pe=0,Ve=0,Ge=0;for(me=0;me<q;++me)if(we=[],Ve=me+X,Ve>=q&&(Ve-=q),!fe[Ve]){he=[];var Me=[];for(Pe=Ve;Pe>=0;){Me[Pe]=!0,fe[Pe]=!0,we[we.length]=Pe,he.push(P[Pe]);var He=U[Math.floor(Pe*4/H)];if(Ge=Pe*4&pe,H<4+Ge)throw new Error("FAT boundary crossed: "+Pe+" 4 "+H);if(!P[He]||(Pe=pl(P[He],Ge),Me[Pe]))break}Y[Ve]={nodes:we,data:Uw([he])}}return Y}function N(P,X,U,H,q,Y,fe,we){for(var he=0,pe=H.length?2:0,me=X[P].data,Pe=0,Ve=0,Ge;Pe<me.length;Pe+=128){var Me=me.slice(Pe,Pe+128);Sn(Me,64),Ve=Me.read_shift(2),Ge=Bx(Me,0,Ve-pe),H.push(Ge);var He={name:Ge,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},Ye=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Ye!==0&&(He.ct=K(Me,Me.l-8));var Yt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Yt!==0&&(He.mt=K(Me,Me.l-8)),He.start=Me.read_shift(4,"i"),He.size=Me.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=V,He.name=""),He.type===5?(he=He.start,q>0&&he!==V&&(X[he].name="!StreamData")):He.size>=4096?(He.storage="fat",X[He.start]===void 0&&(X[He.start]=F(U,He.start,X.fat_addrs,X.ssz)),X[He.start].name=He.name,He.content=X[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:he!==V&&He.start!==V&&X[he]&&(He.content=w(He,X[he].data,(X[we]||{}).data))),He.content&&Sn(He.content,0),Y[Ge]=He,fe.push(He)}}function K(P,X){return new Date((ka(P,X+4)/1e7*Math.pow(2,32)+ka(P,X)/1e7-11644473600)*1e3)}function te(P,X){return d(),p(h.readFileSync(P),X)}function J(P,X){var U=X&&X.type;switch(U||wt&&Buffer.isBuffer(P)&&(U="buffer"),U||"base64"){case"file":return te(P,X);case"base64":return p(Ca(Ia(P)),X);case"binary":return p(Ca(P),X)}return p(P,X)}function k(P,X){var U=X||{},H=U.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=H+"/",P.FileIndex[0]={name:H,type:5}),U.CLSID&&(P.FileIndex[0].clsid=U.CLSID),I(P)}function I(P){var X="Sh33tJ5";if(!tt.find(P,"/"+X)){var U=ye(4);U[0]=55,U[1]=U[3]=50,U[2]=54,P.FileIndex.push({name:X,type:2,content:U,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+X),R(P)}}function R(P,X){k(P);for(var U=!1,H=!1,q=P.FullPaths.length-1;q>=0;--q){var Y=P.FileIndex[q];switch(Y.type){case 0:H?U=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Y.R*Y.L*Y.C)&&(U=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!X)){var fe=new Date(1987,1,19),we=0,he=Object.create?Object.create(null):{},pe=[];for(q=0;q<P.FullPaths.length;++q)he[P.FullPaths[q]]=!0,P.FileIndex[q].type!==0&&pe.push([P.FullPaths[q],P.FileIndex[q]]);for(q=0;q<pe.length;++q){var me=n(pe[q][0]);H=he[me],H||(pe.push([me,{name:a(me).replace("/",""),type:1,clsid:ne,ct:fe,mt:fe,content:null}]),he[me]=!0)}for(pe.sort(function(Ge,Me){return r(Ge[0],Me[0])}),P.FullPaths=[],P.FileIndex=[],q=0;q<pe.length;++q)P.FullPaths[q]=pe[q][0],P.FileIndex[q]=pe[q][1];for(q=0;q<pe.length;++q){var Pe=P.FileIndex[q],Ve=P.FullPaths[q];if(Pe.name=a(Ve).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||ne,q===0)Pe.C=pe.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Ve.slice(-1)=="/"){for(we=q+1;we<pe.length&&n(P.FullPaths[we])!=Ve;++we);for(Pe.C=we>=pe.length?-1:we,we=q+1;we<pe.length&&n(P.FullPaths[we])!=n(Ve);++we);Pe.R=we>=pe.length?-1:we,Pe.type=1}else n(P.FullPaths[q+1]||"")==n(Ve)&&(Pe.R=q+1),Pe.type=2}}}function M(P,X){var U=X||{};if(U.fileType=="mad")return jo(P,U);if(R(P),U.fileType==="zip")return Gt(P,U);var H=(function(Ge){for(var Me=0,He=0,Ye=0;Ye<Ge.FileIndex.length;++Ye){var Yt=Ge.FileIndex[Ye];if(Yt.content){var Qt=Yt.content.length;Qt>0&&(Qt<4096?Me+=Qt+63>>6:He+=Qt+511>>9)}}for(var ur=Ge.FullPaths.length+3>>2,Rn=Me+7>>3,ri=Me+127>>7,ni=Rn+He+ur+ri,pa=ni+127>>7,Rs=pa<=109?0:Math.ceil((pa-109)/127);ni+pa+Rs+127>>7>pa;)Rs=++pa<=109?0:Math.ceil((pa-109)/127);var In=[1,Rs,pa,ri,ur,He,Me,0];return Ge.FileIndex[0].size=Me<<6,In[7]=(Ge.FileIndex[0].start=In[0]+In[1]+In[2]+In[3]+In[4]+In[5])+(In[6]+7>>3),In})(P),q=ye(H[7]<<9),Y=0,fe=0;{for(Y=0;Y<8;++Y)q.write_shift(1,Te[Y]);for(Y=0;Y<8;++Y)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),Y=0;Y<3;++Y)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,H[2]),q.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:V),q.write_shift(4,H[3]),q.write_shift(-4,H[1]?H[0]-1:V),q.write_shift(4,H[1]),Y=0;Y<109;++Y)q.write_shift(-4,Y<H[2]?H[1]+Y:-1)}if(H[1])for(fe=0;fe<H[1];++fe){for(;Y<236+fe*127;++Y)q.write_shift(-4,Y<H[2]?H[1]+Y:-1);q.write_shift(-4,fe===H[1]-1?V:fe+1)}var we=function(Ge){for(fe+=Ge;Y<fe-1;++Y)q.write_shift(-4,Y+1);Ge&&(++Y,q.write_shift(-4,V))};for(fe=Y=0,fe+=H[1];Y<fe;++Y)q.write_shift(-4,oe.DIFSECT);for(fe+=H[2];Y<fe;++Y)q.write_shift(-4,oe.FATSECT);we(H[3]),we(H[4]);for(var he=0,pe=0,me=P.FileIndex[0];he<P.FileIndex.length;++he)me=P.FileIndex[he],me.content&&(pe=me.content.length,!(pe<4096)&&(me.start=fe,we(pe+511>>9)));for(we(H[6]+7>>3);q.l&511;)q.write_shift(-4,oe.ENDOFCHAIN);for(fe=Y=0,he=0;he<P.FileIndex.length;++he)me=P.FileIndex[he],me.content&&(pe=me.content.length,!(!pe||pe>=4096)&&(me.start=fe,we(pe+63>>6)));for(;q.l&511;)q.write_shift(-4,oe.ENDOFCHAIN);for(Y=0;Y<H[4]<<2;++Y){var Pe=P.FullPaths[Y];if(!Pe||Pe.length===0){for(he=0;he<17;++he)q.write_shift(4,0);for(he=0;he<3;++he)q.write_shift(4,-1);for(he=0;he<12;++he)q.write_shift(4,0);continue}me=P.FileIndex[Y],Y===0&&(me.start=me.size?me.start-1:V);var Ve=Y===0&&U.root||me.name;if(pe=2*(Ve.length+1),q.write_shift(64,Ve,"utf16le"),q.write_shift(2,pe),q.write_shift(1,me.type),q.write_shift(1,me.color),q.write_shift(-4,me.L),q.write_shift(-4,me.R),q.write_shift(-4,me.C),me.clsid)q.write_shift(16,me.clsid,"hex");else for(he=0;he<4;++he)q.write_shift(4,0);q.write_shift(4,me.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,me.start),q.write_shift(4,me.size),q.write_shift(4,0)}for(Y=1;Y<P.FileIndex.length;++Y)if(me=P.FileIndex[Y],me.size>=4096)if(q.l=me.start+1<<9,wt&&Buffer.isBuffer(me.content))me.content.copy(q,q.l,0,me.size),q.l+=me.size+511&-512;else{for(he=0;he<me.size;++he)q.write_shift(1,me.content[he]);for(;he&511;++he)q.write_shift(1,0)}for(Y=1;Y<P.FileIndex.length;++Y)if(me=P.FileIndex[Y],me.size>0&&me.size<4096)if(wt&&Buffer.isBuffer(me.content))me.content.copy(q,q.l,0,me.size),q.l+=me.size+63&-64;else{for(he=0;he<me.size;++he)q.write_shift(1,me.content[he]);for(;he&63;++he)q.write_shift(1,0)}if(wt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function O(P,X){var U=P.FullPaths.map(function(he){return he.toUpperCase()}),H=U.map(function(he){var pe=he.split("/");return pe[pe.length-(he.slice(-1)=="/"?2:1)]}),q=!1;X.charCodeAt(0)===47?(q=!0,X=U[0].slice(0,-1)+X):q=X.indexOf("/")!==-1;var Y=X.toUpperCase(),fe=q===!0?U.indexOf(Y):H.indexOf(Y);if(fe!==-1)return P.FileIndex[fe];var we=!Y.match(pf);for(Y=Y.replace(Jn,""),we&&(Y=Y.replace(pf,"!")),fe=0;fe<U.length;++fe)if((we?U[fe].replace(pf,"!"):U[fe]).replace(Jn,"")==Y||(we?H[fe].replace(pf,"!"):H[fe]).replace(Jn,"")==Y)return P.FileIndex[fe];return null}var D=64,V=-2,_e="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(P,X,U){d();var H=M(P,U);h.writeFileSync(X,H)}function ae(P){for(var X=new Array(P.length),U=0;U<P.length;++U)X[U]=String.fromCharCode(P[U]);return X.join("")}function Le(P,X){var U=M(P,X);switch(X&&X.type||"buffer"){case"file":return d(),h.writeFileSync(X.filename,U),U;case"binary":return typeof U=="string"?U:ae(U);case"base64":return jf(typeof U=="string"?U:ae(U));case"buffer":if(wt)return Buffer.isBuffer(U)?U:bs(U);case"array":return typeof U=="string"?Ca(U):U}return U}var Q;function L(P){try{var X=P.InflateRaw,U=new X;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)Q=P;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function W(P,X){if(!Q)return en(P,X);var U=Q.InflateRaw,H=new U,q=H._processChunk(P.slice(P.l),H._finishFlushFlag);return P.l+=H.bytesRead,q}function G(P){return Q?Q.deflateRawSync(P):ct(P)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(P){var X=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(X>>16|X>>8|X)&255}for(var Ae=typeof Uint8Array<"u",Ie=Ae?new Uint8Array(256):[],nt=0;nt<256;++nt)Ie[nt]=Ne(nt);function ee(P,X){var U=Ie[P&255];return X<=8?U>>>8-X:(U=U<<8|Ie[P>>8&255],X<=16?U>>>16-X:(U=U<<8|Ie[P>>16&255],U>>>24-X))}function Ft(P,X){var U=X&7,H=X>>>3;return(P[H]|(U<=6?0:P[H+1]<<8))>>>U&3}function ft(P,X){var U=X&7,H=X>>>3;return(P[H]|(U<=5?0:P[H+1]<<8))>>>U&7}function It(P,X){var U=X&7,H=X>>>3;return(P[H]|(U<=4?0:P[H+1]<<8))>>>U&15}function at(P,X){var U=X&7,H=X>>>3;return(P[H]|(U<=3?0:P[H+1]<<8))>>>U&31}function Ue(P,X){var U=X&7,H=X>>>3;return(P[H]|(U<=1?0:P[H+1]<<8))>>>U&127}function $t(P,X,U){var H=X&7,q=X>>>3,Y=(1<<U)-1,fe=P[q]>>>H;return U<8-H||(fe|=P[q+1]<<8-H,U<16-H)||(fe|=P[q+2]<<16-H,U<24-H)||(fe|=P[q+3]<<24-H),fe&Y}function Dt(P,X,U){var H=X&7,q=X>>>3;return H<=5?P[q]|=(U&7)<<H:(P[q]|=U<<H&255,P[q+1]=(U&7)>>8-H),X+3}function Ut(P,X,U){var H=X&7,q=X>>>3;return U=(U&1)<<H,P[q]|=U,X+1}function Ur(P,X,U){var H=X&7,q=X>>>3;return U<<=H,P[q]|=U&255,U>>>=8,P[q+1]=U,X+8}function Za(P,X,U){var H=X&7,q=X>>>3;return U<<=H,P[q]|=U&255,U>>>=8,P[q+1]=U&255,P[q+2]=U>>>8,X+16}function qn(P,X){var U=P.length,H=2*U>X?2*U:X+5,q=0;if(U>=X)return P;if(wt){var Y=Tw(H);if(P.copy)P.copy(Y);else for(;q<P.length;++q)Y[q]=P[q];return Y}else if(Ae){var fe=new Uint8Array(H);if(fe.set)fe.set(P);else for(;q<U;++q)fe[q]=P[q];return fe}return P.length=H,P}function Lt(P){for(var X=new Array(P),U=0;U<P;++U)X[U]=0;return X}function Jr(P,X,U){var H=1,q=0,Y=0,fe=0,we=0,he=P.length,pe=Ae?new Uint16Array(32):Lt(32);for(Y=0;Y<32;++Y)pe[Y]=0;for(Y=he;Y<U;++Y)P[Y]=0;he=P.length;var me=Ae?new Uint16Array(he):Lt(he);for(Y=0;Y<he;++Y)pe[q=P[Y]]++,H<q&&(H=q),me[Y]=0;for(pe[0]=0,Y=1;Y<=H;++Y)pe[Y+16]=we=we+pe[Y-1]<<1;for(Y=0;Y<he;++Y)we=P[Y],we!=0&&(me[Y]=pe[we+16]++);var Pe=0;for(Y=0;Y<he;++Y)if(Pe=P[Y],Pe!=0)for(we=ee(me[Y],H)>>H-Pe,fe=(1<<H+4-Pe)-1;fe>=0;--fe)X[we|fe<<Pe]=Pe&15|Y<<4;return H}var gn=Ae?new Uint16Array(512):Lt(512),Xn=Ae?new Uint16Array(32):Lt(32);if(!Ae){for(var Pt=0;Pt<512;++Pt)gn[Pt]=0;for(Pt=0;Pt<32;++Pt)Xn[Pt]=0}(function(){for(var P=[],X=0;X<32;X++)P.push(5);Jr(P,Xn,32);var U=[];for(X=0;X<=143;X++)U.push(8);for(;X<=255;X++)U.push(9);for(;X<=279;X++)U.push(7);for(;X<=287;X++)U.push(8);Jr(U,gn,288)})();var Nn=(function(){for(var X=Ae?new Uint8Array(32768):[],U=0,H=0;U<Se.length-1;++U)for(;H<Se[U+1];++H)X[H]=U;for(;H<32768;++H)X[H]=29;var q=Ae?new Uint8Array(259):[];for(U=0,H=0;U<le.length-1;++U)for(;H<le[U+1];++H)q[H]=U;function Y(we,he){for(var pe=0;pe<we.length;){var me=Math.min(65535,we.length-pe),Pe=pe+me==we.length;for(he.write_shift(1,+Pe),he.write_shift(2,me),he.write_shift(2,~me&65535);me-- >0;)he[he.l++]=we[pe++]}return he.l}function fe(we,he){for(var pe=0,me=0,Pe=Ae?new Uint16Array(32768):[];me<we.length;){var Ve=Math.min(65535,we.length-me);if(Ve<10){for(pe=Dt(he,pe,+(me+Ve==we.length)),pe&7&&(pe+=8-(pe&7)),he.l=pe/8|0,he.write_shift(2,Ve),he.write_shift(2,~Ve&65535);Ve-- >0;)he[he.l++]=we[me++];pe=he.l*8;continue}pe=Dt(he,pe,+(me+Ve==we.length)+2);for(var Ge=0;Ve-- >0;){var Me=we[me];Ge=(Ge<<5^Me)&32767;var He=-1,Ye=0;if((He=Pe[Ge])&&(He|=me&-32768,He>me&&(He-=32768),He<me))for(;we[He+Ye]==we[me+Ye]&&Ye<250;)++Ye;if(Ye>2){Me=q[Ye],Me<=22?pe=Ur(he,pe,Ie[Me+1]>>1)-1:(Ur(he,pe,3),pe+=5,Ur(he,pe,Ie[Me-23]>>5),pe+=3);var Yt=Me<8?0:Me-4>>2;Yt>0&&(Za(he,pe,Ye-le[Me]),pe+=Yt),Me=X[me-He],pe=Ur(he,pe,Ie[Me]>>3),pe-=3;var Qt=Me<4?0:Me-2>>1;Qt>0&&(Za(he,pe,me-He-Se[Me]),pe+=Qt);for(var ur=0;ur<Ye;++ur)Pe[Ge]=me&32767,Ge=(Ge<<5^we[me])&32767,++me;Ve-=Ye-1}else Me<=143?Me=Me+48:pe=Ut(he,pe,1),pe=Ur(he,pe,Ie[Me]),Pe[Ge]=me&32767,++me}pe=Ur(he,pe,0)-1}return he.l=(pe+7)/8|0,he.l}return function(he,pe){return he.length<8?Y(he,pe):fe(he,pe)}})();function ct(P){var X=ye(50+Math.floor(P.length*1.1)),U=Nn(P,X);return X.slice(0,U)}var ar=Ae?new Uint16Array(32768):Lt(32768),Zr=Ae?new Uint16Array(32768):Lt(32768),Re=Ae?new Uint16Array(128):Lt(128),Xe=1,Ke=1;function Ze(P,X){var U=at(P,X)+257;X+=5;var H=at(P,X)+1;X+=5;var q=It(P,X)+4;X+=4;for(var Y=0,fe=Ae?new Uint8Array(19):Lt(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,pe=Ae?new Uint8Array(8):Lt(8),me=Ae?new Uint8Array(8):Lt(8),Pe=fe.length,Ve=0;Ve<q;++Ve)fe[Z[Ve]]=Y=ft(P,X),he<Y&&(he=Y),pe[Y]++,X+=3;var Ge=0;for(pe[0]=0,Ve=1;Ve<=he;++Ve)me[Ve]=Ge=Ge+pe[Ve-1]<<1;for(Ve=0;Ve<Pe;++Ve)(Ge=fe[Ve])!=0&&(we[Ve]=me[Ge]++);var Me=0;for(Ve=0;Ve<Pe;++Ve)if(Me=fe[Ve],Me!=0){Ge=Ie[we[Ve]]>>8-Me;for(var He=(1<<7-Me)-1;He>=0;--He)Re[Ge|He<<Me]=Me&7|Ve<<3}var Ye=[];for(he=1;Ye.length<U+H;)switch(Ge=Re[Ue(P,X)],X+=Ge&7,Ge>>>=3){case 16:for(Y=3+Ft(P,X),X+=2,Ge=Ye[Ye.length-1];Y-- >0;)Ye.push(Ge);break;case 17:for(Y=3+ft(P,X),X+=3;Y-- >0;)Ye.push(0);break;case 18:for(Y=11+Ue(P,X),X+=7;Y-- >0;)Ye.push(0);break;default:Ye.push(Ge),he<Ge&&(he=Ge);break}var Yt=Ye.slice(0,U),Qt=Ye.slice(U);for(Ve=U;Ve<286;++Ve)Yt[Ve]=0;for(Ve=H;Ve<30;++Ve)Qt[Ve]=0;return Xe=Jr(Yt,ar,286),Ke=Jr(Qt,Zr,30),X}function _r(P,X){if(P[0]==3&&!(P[1]&3))return[Do(X),2];for(var U=0,H=0,q=Tw(X||1<<18),Y=0,fe=q.length>>>0,we=0,he=0;(H&1)==0;){if(H=ft(P,U),U+=3,H>>>1)H>>1==1?(we=9,he=5):(U=Ze(P,U),we=Xe,he=Ke);else{U&7&&(U+=8-(U&7));var pe=P[U>>>3]|P[(U>>>3)+1]<<8;if(U+=32,pe>0)for(!X&&fe<Y+pe&&(q=qn(q,Y+pe),fe=q.length);pe-- >0;)q[Y++]=P[U>>>3],U+=8;continue}for(;;){!X&&fe<Y+32767&&(q=qn(q,Y+32767),fe=q.length);var me=$t(P,U,we),Pe=H>>>1==1?gn[me]:ar[me];if(U+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)q[Y++]=Pe;else{if(Pe==256)break;Pe-=257;var Ve=Pe<8?0:Pe-4>>2;Ve>5&&(Ve=0);var Ge=Y+le[Pe];Ve>0&&(Ge+=$t(P,U,Ve),U+=Ve),me=$t(P,U,he),Pe=H>>>1==1?Xn[me]:Zr[me],U+=Pe&15,Pe>>>=4;var Me=Pe<4?0:Pe-2>>1,He=Se[Pe];for(Me>0&&(He+=$t(P,U,Me),U+=Me),!X&&fe<Ge&&(q=qn(q,Ge+100),fe=q.length);Y<Ge;)q[Y]=q[Y-He],++Y}}}return X?[q,U+7>>>3]:[q.slice(0,Y),U+7>>>3]}function en(P,X){var U=P.slice(P.l||0),H=_r(U,X);return P.l+=H[1],H[0]}function jr(P,X){if(P)typeof console<"u"&&console.error(X);else throw new Error(X)}function ln(P,X){var U=P;Sn(U,0);var H=[],q=[],Y={FileIndex:H,FullPaths:q};k(Y,{root:X.root});for(var fe=U.length-4;(U[fe]!=80||U[fe+1]!=75||U[fe+2]!=5||U[fe+3]!=6)&&fe>=0;)--fe;U.l=fe+4,U.l+=4;var we=U.read_shift(2);U.l+=6;var he=U.read_shift(4);for(U.l=he,fe=0;fe<we;++fe){U.l+=20;var pe=U.read_shift(4),me=U.read_shift(4),Pe=U.read_shift(2),Ve=U.read_shift(2),Ge=U.read_shift(2);U.l+=8;var Me=U.read_shift(4),He=u(U.slice(U.l+Pe,U.l+Pe+Ve));U.l+=Pe+Ve+Ge;var Ye=U.l;U.l=Me+4,Zn(U,pe,me,Y,He),U.l=Ye}return Y}function Zn(P,X,U,H,q){P.l+=2;var Y=P.read_shift(2),fe=P.read_shift(2),we=l(P);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var he=P.read_shift(4),pe=P.read_shift(4),me=P.read_shift(4),Pe=P.read_shift(2),Ve=P.read_shift(2),Ge="",Me=0;Me<Pe;++Me)Ge+=String.fromCharCode(P[P.l++]);if(Ve){var He=u(P.slice(P.l,P.l+Ve));(He[21589]||{}).mt&&(we=He[21589].mt),((q||{})[21589]||{}).mt&&(we=q[21589].mt)}P.l+=Ve;var Ye=P.slice(P.l,P.l+pe);switch(fe){case 8:Ye=W(P,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Yt=!1;Y&8&&(he=P.read_shift(4),he==134695760&&(he=P.read_shift(4),Yt=!0),pe=P.read_shift(4),me=P.read_shift(4)),pe!=X&&jr(Yt,"Bad compressed size: "+X+" != "+pe),me!=U&&jr(Yt,"Bad uncompressed size: "+U+" != "+me),qt(H,Ge,Ye,{unsafe:!0,mt:we})}function Gt(P,X){var U=X||{},H=[],q=[],Y=ye(1),fe=U.compression?8:0,we=0,he=0,pe=0,me=0,Pe=0,Ve=P.FullPaths[0],Ge=Ve,Me=P.FileIndex[0],He=[],Ye=0;for(he=1;he<P.FullPaths.length;++he)if(Ge=P.FullPaths[he].slice(Ve.length),Me=P.FileIndex[he],!(!Me.size||!Me.content||Ge=="Sh33tJ5")){var Yt=me,Qt=ye(Ge.length);for(pe=0;pe<Ge.length;++pe)Qt.write_shift(1,Ge.charCodeAt(pe)&127);Qt=Qt.slice(0,Qt.l),He[Pe]=uF.buf(Me.content,0);var ur=Me.content;fe==8&&(ur=G(ur)),Y=ye(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,we),Y.write_shift(2,fe),Me.mt?o(Y,Me.mt):Y.write_shift(4,0),Y.write_shift(-4,He[Pe]),Y.write_shift(4,ur.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,Qt.length),Y.write_shift(2,0),me+=Y.length,H.push(Y),me+=Qt.length,H.push(Qt),me+=ur.length,H.push(ur),Y=ye(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,we),Y.write_shift(2,fe),Y.write_shift(4,0),Y.write_shift(-4,He[Pe]),Y.write_shift(4,ur.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,Qt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,Yt),Ye+=Y.l,q.push(Y),Ye+=Qt.length,q.push(Qt),++Pe}return Y=ye(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Pe),Y.write_shift(2,Pe),Y.write_shift(4,Ye),Y.write_shift(4,me),Y.write_shift(2,0),mn([mn(H),mn(q),Y])}var Ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wr(P,X){if(P.ctype)return P.ctype;var U=P.name||"",H=U.match(/\.([^\.]+)$/);return H&&Ir[H[1]]||X&&(H=(U=X).match(/[\.\\]([^\.\\])+$/),H&&Ir[H[1]])?Ir[H[1]]:"application/octet-stream"}function tn(P){for(var X=jf(P),U=[],H=0;H<X.length;H+=76)U.push(X.slice(H,H+76));return U.join(`\r
`)+`\r
`}function Ns(P){var X=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var me=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],H=X.split(`\r
`),q=0;q<H.length;++q){var Y=H[q];if(Y.length==0){U.push("");continue}for(var fe=0;fe<Y.length;){var we=76,he=Y.slice(fe,fe+we);he.charAt(we-1)=="="?we--:he.charAt(we-2)=="="?we-=2:he.charAt(we-3)=="="&&(we-=3),he=Y.slice(fe,fe+we),fe+=we,fe<Y.length&&(he+="="),U.push(he)}}return U.join(`\r
`)}function Ti(P){for(var X=[],U=0;U<P.length;++U){for(var H=P[U];U<=P.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+P[++U];X.push(H)}for(var q=0;q<X.length;++q)X[q]=X[q].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Ca(X.join(`\r
`))}function cn(P,X,U){for(var H="",q="",Y="",fe,we=0;we<10;++we){var he=X[we];if(!he||he.match(/^\s*$/))break;var pe=he.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":H=pe[2].trim();break;case"content-type":Y=pe[2].trim();break;case"content-transfer-encoding":q=pe[2].trim();break}}switch(++we,q.toLowerCase()){case"base64":fe=Ca(Ia(X.slice(we).join("")));break;case"quoted-printable":fe=Ti(X.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var me=qt(P,H.slice(U.length),fe,{unsafe:!0});Y&&(me.ctype=Y)}function ei(P,X){if(ae(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=X&&X.root||"",H=(wt&&Buffer.isBuffer(P)?P.toString("binary"):ae(P)).split(`\r
`),q=0,Y="";for(q=0;q<H.length;++q)if(Y=H[q],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),U||(U=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),Y.slice(0,U.length)!=U););var fe=(H[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var we="--"+(fe[1]||""),he=[],pe=[],me={FileIndex:he,FullPaths:pe};k(me);var Pe,Ve=0;for(q=0;q<H.length;++q){var Ge=H[q];Ge!==we&&Ge!==we+"--"||(Ve++&&cn(me,H.slice(Pe,q),U),Pe=q)}return me}function jo(P,X){var U=X||{},H=U.boundary||"SheetJS";H="------="+H;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Y=P.FullPaths[0],fe=Y,we=P.FileIndex[0],he=1;he<P.FullPaths.length;++he)if(fe=P.FullPaths[he].slice(Y.length),we=P.FileIndex[he],!(!we.size||!we.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var pe=we.content,me=wt&&Buffer.isBuffer(pe)?pe.toString("binary"):ae(pe),Pe=0,Ve=Math.min(1024,me.length),Ge=0,Me=0;Me<=Ve;++Me)(Ge=me.charCodeAt(Me))>=32&&Ge<128&&++Pe;var He=Pe>=Ve*4/5;q.push(H),q.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+fe),q.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),q.push("Content-Type: "+wr(we,fe)),q.push(""),q.push(He?Ns(me):tn(me))}return q.push(H+`--\r
`),q.join(`\r
`)}function ti(P){var X={};return k(X,P),X}function qt(P,X,U,H){var q=H&&H.unsafe;q||k(P);var Y=!q&&tt.find(P,X);if(!Y){var fe=P.FullPaths[0];X.slice(0,fe.length)==fe?fe=X:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+X).replace("//","/")),Y={name:a(X),type:2},P.FileIndex.push(Y),P.FullPaths.push(fe),q||tt.utils.cfb_gc(P)}return Y.content=U,Y.size=U?U.length:0,H&&(H.CLSID&&(Y.clsid=H.CLSID),H.mt&&(Y.mt=H.mt),H.ct&&(Y.ct=H.ct)),Y}function Wn(P,X){k(P);var U=tt.find(P,X);if(U){for(var H=0;H<P.FileIndex.length;++H)if(P.FileIndex[H]==U)return P.FileIndex.splice(H,1),P.FullPaths.splice(H,1),!0}return!1}function da(P,X,U){k(P);var H=tt.find(P,X);if(H){for(var q=0;q<P.FileIndex.length;++q)if(P.FileIndex[q]==H)return P.FileIndex[q].name=a(U),P.FullPaths[q]=U,!0}return!1}function ma(P){R(P,!0)}return e.find=O,e.read=J,e.parse=p,e.write=Le,e.writeFile=ke,e.utils={cfb_new:ti,cfb_add:qt,cfb_del:Wn,cfb_mov:da,cfb_gc:ma,ReadShift:Ef,CheckField:$A,prep_blob:Sn,bconcat:mn,use_zlib:L,_deflateRaw:ct,_inflateRaw:en,consts:oe},e})();function fF(t){return typeof t=="string"?gm(t):Array.isArray(t)?PO(t):t}function f0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=gm(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Pi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([fF(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Vo(e)),u.write(e),u.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function hF(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Rr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Nw(t,e){for(var r=[],n=Rr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function vm(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function _m(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function dF(t){for(var e=[],r=Rr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Ld=new Date(1899,11,30,0,0,0);function on(t,e){var r=t.getTime(),n=Ld.getTime()+(t.getTimezoneOffset()-Ld.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var CA=new Date,mF=Ld.getTime()+(CA.getTimezoneOffset()-Ld.getTimezoneOffset())*6e4,Rw=CA.getTimezoneOffset();function ym(t){var e=new Date;return e.setTime(t*24*60*60*1e3+mF),e.getTimezoneOffset()!==Rw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Rw)*6e4),e}function pF(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var Iw=new Date("2017-02-19T19:06:09.000Z"),NA=isNaN(Iw.getFullYear())?new Date("2/19/17"):Iw,gF=NA.getFullYear()==2017;function xr(t,e){var r=new Date(t);if(gF)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(NA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Rl(t,e){if(wt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Pi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Pi(gA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Pi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Pi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function Cr(t,e){for(var r="";r.length<e;)r+=t;return r}function _i(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var xF=["january","february","march","april","may","june","july","august","september","october","november","december"];function eu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&xF.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var vF=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}})();function RA(t){return t?t.content&&t.type?Rl(t.content,!0):t.data?mf(t.data):t.asNodeBuffer&&wt?mf(t.asNodeBuffer().toString("binary")):t.asBinary?mf(t.asBinary()):t._data&&t._data.getContent?mf(Rl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function IA(t){if(!t)return null;if(t.data)return _w(t.data);if(t.asNodeBuffer&&wt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?_w(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function _F(t){return t&&t.name.slice(-4)===".bin"?IA(t):RA(t)}function Wa(t,e){for(var r=t.FullPaths||Rr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Ox(t,e){var r=Wa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function $r(t,e,r){if(!r)return _F(Ox(t,e));if(!e)return null;try{return $r(t,e)}catch{return null}}function Na(t,e,r){if(!r)return RA(Ox(t,e));if(!e)return null;try{return Na(t,e)}catch{return null}}function yF(t,e,r){return IA(Ox(t,e))}function Dw(t){for(var e=t.FullPaths||Rr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Tt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return wt?n=bs(r):n=VO(r),tt.utils.cfb_add(t,e,n)}tt.utils.cfb_add(t,e,r)}else t.file(e,r)}function Fx(){return tt.utils.cfb_new()}function DA(t,e){switch(e.type){case"base64":return tt.read(t,{type:"base64"});case"binary":return tt.read(t,{type:"binary"});case"buffer":case"array":return tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function gf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ow=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,wF=/<[^>]*>/g,Gn=Br.match(Ow)?Ow:wF,EF=/<\w*:/,SF=/<(\/?)\w+:/;function ut(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(TF),u=0,h="",d=0,p="",v="",_=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(_=(a=v.charCodeAt(o+1))==34||a==39?1:0,h=v.slice(o+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var y=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[y]&&p.slice(u-3,u)=="ext")continue;n[y]=h,n[y.toLowerCase()]=h}}return n}function Xi(t){return t.replace(SF,"<$1")}var OA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Mx=vm(OA),Vt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,h){return OA[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}})(),Lx=/[&<>'"]/g,AF=/[\u0000-\u0008\u000b-\u001f]/g;function nr(t){var e=t+"";return e.replace(Lx,function(r){return Mx[r]}).replace(AF,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Fw(t){return nr(t).replace(/ /g,"_x0020_")}var FA=/[\u0000-\u001f]/g;function Px(t){var e=t+"";return e.replace(Lx,function(r){return Mx[r]}).replace(/\n/g,"<br/>").replace(FA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function bF(t){var e=t+"";return e.replace(Lx,function(r){return Mx[r]}).replace(FA,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Mw=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function kF(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function mr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pp(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function Lw(t){var e=Do(2*t.length),r,n,a=1,o=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function Pw(t){return bs(t,"binary").toString("utf8")}var Gh="foo bar baz",cr=wt&&(Pw(Gh)==Pp(Gh)&&Pw||Lw(Gh)==Pp(Gh)&&Lw)||Pp,Pi=wt?function(t){return bs(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Hf=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),MA=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),CF=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),NF=/<\/?(?:vt:)?variant>/g,RF=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vw(t,e){var r=ut(t),n=t.match(CF(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(NF,"").match(RF);l&&a.push({v:cr(l[2]),t:l[1]})}),a}var LA=/(^\s|\s$|\n)/;function bn(t,e){return"<"+t+(e.match(LA)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Gf(t){return Rr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Be(t,e,r){return"<"+t+(r!=null?Gf(r):"")+(e!=null?(e.match(LA)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Ag(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function IF(t,e){switch(typeof t){case"string":var r=Be("vt:lpwstr",nr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",nr(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",Ag(t));throw new Error("Unable to serialize "+t)}function Vx(t){if(wt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return cr(Vo(Rx(t)));throw new Error("Bad input format: expected Buffer or string")}var qf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,an={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ba={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function DF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function OF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=n?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var Bw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},Uw=wt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:bs(e)})):Bw(t)}:Bw,jw=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(ms(t,a)));return n.join("").replace(Jn,"")},Bx=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Jn,""):jw(t,e,r)}:jw,zw=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},PA=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):zw(t,e,r)}:zw,Hw=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Oc(t,a)));return n.join("")},h0=wt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Hw(e,r,n)}:Hw,VA=function(t,e){var r=ka(t,e);return r>0?h0(t,e+4,e+4+r-1):""},BA=VA,UA=function(t,e){var r=ka(t,e);return r>0?h0(t,e+4,e+4+r-1):""},jA=UA,zA=function(t,e){var r=2*ka(t,e);return r>0?h0(t,e+4,e+4+r-1):""},HA=zA,GA=function(e,r){var n=ka(e,r);return n>0?Bx(e,r+4,r+4+n):""},qA=GA,XA=function(t,e){var r=ka(t,e);return r>0?h0(t,e+4,e+4+r):""},WA=XA,KA=function(t,e){return DF(t,e)},Pd=KA,Ux=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(BA=function(e,r){if(!Buffer.isBuffer(e))return VA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jA=function(e,r){if(!Buffer.isBuffer(e))return UA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},HA=function(e,r){if(!Buffer.isBuffer(e))return zA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},qA=function(e,r){if(!Buffer.isBuffer(e))return GA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},WA=function(e,r){if(!Buffer.isBuffer(e))return XA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Pd=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):KA(e,r)},Ux=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Oc=function(t,e){return t[e]},ms=function(t,e){return t[e+1]*256+t[e]},FF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ka=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},pl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},MF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ef(t,e){var r="",n,a,o=[],l,u,h,d;switch(e){case"dbcs":if(d=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(ms(this,d)),d+=2;t*=2;break;case"utf8":r=h0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Bx(this,this.l,this.l+t);break;case"wstr":return Ef.call(this,t,"dbcs");case"lpstr-ansi":r=BA(this,this.l),t=4+ka(this,this.l);break;case"lpstr-cp":r=jA(this,this.l),t=4+ka(this,this.l);break;case"lpwstr":r=HA(this,this.l),t=4+2*ka(this,this.l);break;case"lpp4":t=4+ka(this,this.l),r=qA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ka(this,this.l),r=WA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Oc(this,this.l+t++))!==0;)o.push(Hh(l));r=o.join("");break;case"_wstr":for(t=0,r="";(l=ms(this,this.l+t))!==0;)o.push(Hh(l)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Oc(this,d),this.l=d+1,u=Ef.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Hh(ms(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Oc(this,d),this.l=d+1,u=Ef.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Hh(Oc(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=Oc(this,this.l),this.l++,n;case 2:return n=(e==="i"?FF:ms)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?pl:MF)(this,this.l),this.l+=4,n):(a=ka(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Pd(this,this.l):a=Pd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=PA(this,this.l,t);break}}return this.l+=t,r}var LF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},PF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},VF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function BF(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)VF(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,LF(this,e,this.l);break;case 8:if(n=8,r==="f"){OF(this,e,this.l);break}case 16:break;case-4:n=4,PF(this,e,this.l);break}return this.l+=n,this}function $A(t,e){var r=PA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=Ef,t.chk=$A,t.write_shift=BF}function Hn(t,e){t.l+=e}function ye(t){var e=Do(t);return Sn(e,0),e}function ks(t,e,r){if(t){var n,a,o;Sn(t,t.l||0);for(var l=t.length,u=0,h=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=Qf[u]||Qf[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;h=t.l+o;var p=d.f&&d.f(t,o,r);if(t.l=h,e(p,d,u))return}}}function fa(){var t=[],e=wt?256:2048,r=function(d){var p=ye(d);return Sn(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},l=function(){return a(),mn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:l,_bufs:t}}function Oe(t,e,r,n){var a=+e,o;if(!isNaN(a)){n||(n=Qf[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=t.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Ux(r)&&t.push(r)}}function Sf(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gw(t,e,r){var n=vr(t);return n.s=Sf(n.s,e.s,r),n.e=Sf(n.e,e.s,r),n}function Af(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=zF(r)),!t.rRel&&t.rRel!=null&&(r=UF(r)),r}function Vp(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Er(t.s.c)+":"+(t.e.cRel?"":"$")+Er(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Vr(t.s.r)+":"+(t.e.rRel?"":"$")+Vr(t.e.r):Af(t.s,e.biff)+":"+Af(t.e,e.biff)}function jx(t){return parseInt(jF(t),10)-1}function Vr(t){return""+(t+1)}function UF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jF(t){return t.replace(/\$(\d+)$/,"$1")}function zx(t){for(var e=HF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Er(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function zF(t){return t.replace(/^([A-Z])/,"$$$1")}function HF(t){return t.replace(/^\$([A-Z])/,"$1")}function GF(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ha(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function vt(t,e){return typeof e>"u"||typeof e=="number"?vt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function qw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Qa(t.z,r?on(e):e)}catch{}try{return t.w=Qa((t.XF||{}).numFmtId||(r?14:0),r?on(e):e)}catch{return""+e}}function Ss(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Cs[t.v]||t.v:e==null?qw(t,t.v):qw(t,e))}function Bo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function YA(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?Sr(n.origin):n.origin;l=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Bt(o["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(d.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var y={v:e[v][_]},S=l+v,w=u+_;if(d.s.r>S&&(d.s.r=S),d.s.c>w&&(d.s.c=w),d.e.r<S&&(d.e.r=S),d.e.c<w&&(d.e.c=w),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))y=e[v][_];else if(Array.isArray(y.v)&&(y.f=e[v][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||st[14],n.cellDates?(y.t="d",y.w=Qa(y.z,on(y.v))):(y.t="n",y.v=on(y.v),y.w=Qa(y.z,y.v))):y.t="s";if(a)o[S]||(o[S]=[]),o[S][w]&&o[S][w].z&&(y.z=o[S][w].z),o[S][w]=y;else{var b=ot({c:w,r:S});o[b]&&o[b].z&&(y.z=o[b].z),o[b]=y}}}return d.s.c<1e7&&(o["!ref"]=vt(d)),o}function hu(t,e){return YA(null,t,e)}function qF(t){return t.read_shift(4,"i")}function yi(t,e){return e||(e=ye(4)),e.write_shift(4,t),e}function jn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function pn(t,e){var r=!1;return e==null&&(r=!0,e=ye(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function XF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function WF(t,e){return e||(e=ye(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Hx(t,e){var r=t.l,n=t.read_shift(1),a=jn(t),o=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(XF(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function KF(t,e){var r=!1;return e==null&&(r=!0,e=ye(15+4*t.t.length)),e.write_shift(1,0),pn(t.t,e),r?e.slice(0,e.l):e}var $F=Hx;function YF(t,e){var r=!1;return e==null&&(r=!0,e=ye(23+4*t.t.length)),e.write_shift(1,1),pn(t.t,e),e.write_shift(4,1),WF({},e),r?e.slice(0,e.l):e}function Ja(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Vl(t,e){return e==null&&(e=ye(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Bl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ul(t,e){return e==null&&(e=ye(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var QF=jn,QA=pn;function Gx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Vd(t,e){var r=!1;return e==null&&(r=!0,e=ye(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var JF=jn,bg=Gx,qx=Vd;function Xx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Pd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):pl(e,0)>>2;return r?a/100:a}function JA(t,e){e==null&&(e=ye(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function ZA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function ZF(t,e){return e||(e=ye(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var jl=ZA,du=ZF;function Un(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Il(t,e){return(e||ye(8)).write_shift(8,t,"f")}function eM(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=_l[a];d&&(e.rgb=Wf(d));break;case 2:e.rgb=Wf([l,u,h]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function Bd(t,e){if(e||(e=ye(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function tM(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function rM(t,e){e||(e=ye(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function eb(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function nM(t){return eb(t,1)}function aM(t){return eb(t,2)}var Wx=2,oa=3,qh=11,Xw=12,Ud=19,Xh=64,iM=65,sM=71,oM=4108,lM=4126,dn=80,tb=81,cM=[dn,tb],kg={1:{n:"CodePage",t:Wx},2:{n:"Category",t:dn},3:{n:"PresentationFormat",t:dn},4:{n:"ByteCount",t:oa},5:{n:"LineCount",t:oa},6:{n:"ParagraphCount",t:oa},7:{n:"SlideCount",t:oa},8:{n:"NoteCount",t:oa},9:{n:"HiddenCount",t:oa},10:{n:"MultimediaClipCount",t:oa},11:{n:"ScaleCrop",t:qh},12:{n:"HeadingPairs",t:oM},13:{n:"TitlesOfParts",t:lM},14:{n:"Manager",t:dn},15:{n:"Company",t:dn},16:{n:"LinksUpToDate",t:qh},17:{n:"CharacterCount",t:oa},19:{n:"SharedDoc",t:qh},22:{n:"HyperlinksChanged",t:qh},23:{n:"AppVersion",t:oa,p:"version"},24:{n:"DigSig",t:iM},26:{n:"ContentType",t:dn},27:{n:"ContentStatus",t:dn},28:{n:"Language",t:dn},29:{n:"Version",t:dn},255:{},2147483648:{n:"Locale",t:Ud},2147483651:{n:"Behavior",t:Ud},1919054434:{}},Cg={1:{n:"CodePage",t:Wx},2:{n:"Title",t:dn},3:{n:"Subject",t:dn},4:{n:"Author",t:dn},5:{n:"Keywords",t:dn},6:{n:"Comments",t:dn},7:{n:"Template",t:dn},8:{n:"LastAuthor",t:dn},9:{n:"RevNumber",t:dn},10:{n:"EditTime",t:Xh},11:{n:"LastPrinted",t:Xh},12:{n:"CreatedDate",t:Xh},13:{n:"ModifiedDate",t:Xh},14:{n:"PageCount",t:oa},15:{n:"WordCount",t:oa},16:{n:"CharCount",t:oa},17:{n:"Thumbnail",t:sM},18:{n:"Application",t:dn},19:{n:"DocSecurity",t:oa},255:{},2147483648:{n:"Locale",t:Ud},2147483651:{n:"Behavior",t:Ud},1919054434:{}},Ww={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},uM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fM(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var hM=fM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),_l=vr(hM),Cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ng={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Wh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Kx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dM(t){var e=Kx();if(!t||!t.match)return e;var r={};if((t.match(Gn)||[]).forEach(function(n){var a=ut(n);switch(a[0].replace(EF,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Ng[a.ContentType]]!==void 0&&e[Ng[a.ContentType]].push(a.PartName);break}}),e.xmlns!==an.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function nb(t,e){var r=dF(Ng),n=[],a;n[n.length]=Br,n[n.length]=Be("Types",null,{xmlns:an.CT,"xmlns:xsd":an.xsd,"xmlns:xsi":an.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Be("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){t[h]&&t[h].length>0&&(a=t[h][0],n[n.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Wh[h][e.bookType]||Wh[h].xlsx}))},l=function(h){(t[h]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Wh[h][e.bookType]||Wh[h].xlsx})})},u=function(h){(t[h]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function bf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Gn)||[]).forEach(function(a){var o=ut(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:gf(o.Target,e);r[u]=l,n[o.Id]=l}}),r["!id"]=n,r}function Gc(t){var e=[Br,Be("Relationships",null,{xmlns:an.RELS})];return Rr(t["!id"]).forEach(function(r){e[e.length]=Be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function rr(t,e,r,n,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[Et.HLINK,Et.XPATH,Et.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var mM="application/vnd.oasis.opendocument.spreadsheet";function pM(t,e){for(var r=Vx(t),n,a;n=qf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ut(n[0],!1),a.path=="/"&&a.type!==mM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function gM(t){var e=[Br];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Kw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function xM(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function vM(t){var e=[Br];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Kw(t[r][0],t[r][1])),e.push(xM("",t[r][0]));return e.push(Kw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function ab(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dd.version+"</meta:generator></office:meta></office:document-meta>"}var Ya=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_M=(function(){for(var t=new Array(Ya.length),e=0;e<Ya.length;++e){var r=Ya[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function ib(t){var e={};t=cr(t);for(var r=0;r<Ya.length;++r){var n=Ya[r],a=t.match(_M[r]);a!=null&&a.length>0&&(e[n[1]]=Vt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=xr(e[n[1]]))}return e}function Bp(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=nr(e),n[n.length]=r?Be(t,e,r):bn(t,e))}function sb(t,e){var r=e||{},n=[Br,Be("cp:coreProperties",null,{"xmlns:cp":an.CORE_PROPS,"xmlns:dc":an.dc,"xmlns:dcterms":an.dcterms,"xmlns:dcmitype":an.dcmitype,"xmlns:xsi":an.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Bp("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Ag(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&Bp("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Ag(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var o=0;o!=Ya.length;++o){var l=Ya[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Bp(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ob=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function lb(t,e,r,n){var a=[];if(typeof t=="string")a=Vw(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(p){return{v:p}}));var l=typeof e=="string"?Vw(e,n).map(function(p){return p.v}):e,u=0,h=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=l.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=l.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=l.slice(u,u+h);break}u+=h}}function yM(t,e,r){var n={};return e||(e={}),t=cr(t),yl.forEach(function(a){var o=(t.match(Hf(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=Vt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&lb(n.HeadingPairs,n.TitlesOfParts,e,r),e}function cb(t){var e=[],r=Be;return t||(t={}),t.Application="SheetJS",e[e.length]=Br,e[e.length]=Be("Properties",null,{xmlns:an.EXT_PROPS,"xmlns:vt":an.vt}),yl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=nr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+nr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var TM=/<[^>]+>[^<]*/g;function wM(t,e){var r={},n="",a=t.match(TM);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=ut(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Vt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var h=l.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Vt(p);break;case"bool":r[n]=mr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=xr(p);break;case"cy":case"error":r[n]=Vt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,h)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function ub(t){var e=[Br,Be("Properties",null,{xmlns:an.CUST_PROPS,"xmlns:vt":an.vt})];if(!t)return e.join("");var r=1;return Rr(t).forEach(function(a){++r,e[e.length]=Be("property",IF(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:nr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Rg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Up;function EM(t,e,r){Up||(Up=vm(Rg)),e=Up[e]||e,t[e]=r}function SM(t,e){var r=[];return Rr(Rg).map(function(n){for(var a=0;a<Ya.length;++a)if(Ya[a][1]==n)return Ya[a];for(a=0;a<yl.length;++a)if(yl[a][1]==n)return yl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];n[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(bn(Rg[n[1]]||n[1],a))}}),Be("DocumentProperties",r.join(""),{xmlns:ba.o})}function AM(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Rr(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var l=0;l<Ya.length;++l)if(o==Ya[l][1])return;for(l=0;l<yl.length;++l)if(o==yl[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=t[o],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),a.push(Be(Fw(o),u,{"dt:dt":h}))}}),e&&Rr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Be(Fw(o),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+ba.o+'">'+a.join("")+"</"+n+">"}function $x(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function bM(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),a+=o);var l=ye(8);return l.write_shift(4,n),l.write_shift(4,a),l}function fb(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function hb(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function db(t,e,r){return e===31?hb(t):fb(t,e,r)}function Ig(t,e,r){return db(t,e,r===!1?0:4)}function kM(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return db(t,e,0)}function CM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Jn,""),t.l-a&2&&(t.l+=2)}return r}function NM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Jn,"");return r}function RM(t){var e=t.l,r=jd(t,tb);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=jd(t,oa);return[r,n]}function IM(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(RM(t));return r}function $w(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Jn,"").replace(pf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function mb(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function DM(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function jd(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==Xw&&n!==e&&cM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Xw?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return fb(t,n,4).replace(Jn,"");case 31:return hb(t);case 64:return $x(t);case 65:return mb(t);case 71:return DM(t);case 80:return Ig(t,n,!o.raw).replace(Jn,"");case 81:return kM(t,n).replace(Jn,"");case 4108:return IM(t);case 4126:case 4127:return n==4127?CM(t):NM(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Yw(t,e){var r=ye(4),n=ye(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ye(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=bM(e);break;case 31:case 80:for(n=ye(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return mn([r,n])}function Qw(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0,u=0,h=-1,d={};for(l=0;l!=a;++l){var p=t.read_shift(4),v=t.read_shift(4);o[l]=[p,v+r]}o.sort(function(z,N){return z[1]-N[1]});var _={};for(l=0;l!=a;++l){if(t.l!==o[l][1]){var y=!0;if(l>0&&e)switch(e[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,y=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],y=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],y=!1);break}if((!e||l==0)&&t.l<=o[l][1]&&(y=!1,t.l=o[l][1]),y)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(e){var S=e[o[l][0]];if(_[S.n]=jd(t,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:pi(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(o[l][0]===1){if(u=_.CodePage=jd(t,Wx),pi(u),h!==-1){var w=t.l;t.l=o[h][1],d=$w(t,u),t.l=w}}else if(o[l][0]===0){if(u===0){h=l,t.l=o[l+1][1];continue}d=$w(t,u)}else{var b=d[o[l][0]],F;switch(t[t.l]){case 65:t.l+=4,F=mb(t);break;case 30:t.l+=4,F=Ig(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,F=Ig(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,F=t.read_shift(4,"i");break;case 19:t.l+=4,F=t.read_shift(4);break;case 5:t.l+=4,F=t.read_shift(8,"f");break;case 11:t.l+=4,F=Mr(t,4);break;case 64:t.l+=4,F=xr($x(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[b]=F}}return t.l=r+n,_}var pb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function OM(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Jw(t,e,r){var n=ye(8),a=[],o=[],l=8,u=0,h=ye(8),d=ye(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),o.push(h),a.push(d),l+=8+h.length,!e){d=ye(8),d.write_shift(4,0),a.unshift(d);var p=[ye(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(h=ye(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=mn(p),o.unshift(h),l+=8+h.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(pb.indexOf(t[u][0])>-1||ob.indexOf(t[u][0])>-1)&&t[u][1]!=null){var _=t[u][1],y=0;if(e){y=+e[t[u][0]];var S=r[y];if(S.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}h=Yw(S.t,_)}else{var b=OM(_);b==-1&&(b=31,_=String(_)),h=Yw(b,_)}o.push(h),d=ye(8),d.write_shift(4,e?y:2+u),a.push(d),l+=8+h.length}var F=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,F),F+=o[u].length;return n.write_shift(4,l),n.write_shift(4,o.length),mn([n].concat(a).concat(o))}function Zw(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var a,o,l,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==tt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),h=n.read_shift(4));var v=Qw(n,e),_={SystemIdentifier:d};for(var y in v)_[y]=v[y];if(_.FMTID=o,a===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var S;try{S=Qw(n,null)}catch{}for(y in S)_[y]=S[y];return _.FMTID=[o,l],_}function eE(t,e,r,n,a,o){var l=ye(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var h=Jw(t,r,n);if(u.push(h),a){var d=Jw(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+h.length),u.push(d)}return mn(u)}function co(t,e){return t.read_shift(e),null}function FM(t,e){e||(e=ye(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function MM(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Mr(t,e){return t.read_shift(e)===1}function Qn(t,e){return e||(e=ye(2)),e.write_shift(2,+!!t),e}function Yr(t){return t.read_shift(2,"u")}function Ka(t,e){return e||(e=ye(2)),e.write_shift(2,t),e}function gb(t,e){return MM(t,e,Yr)}function LM(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function xb(t,e,r){return r||(r=ye(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function d0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function PM(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,u,h={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),n&&(t.l+=u),h.t=p,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function VM(t){var e=t.t||"",r=ye(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ye(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return mn(a)}function Dl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function m0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Dl(t,n,r)}function zl(t,e,r){if(r.biff>5)return m0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function vb(t,e,r){return r||(r=ye(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function BM(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function UM(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Jn,"");return n&&(t.l+=24),a}function jM(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(Jn,"");return r+l}function zM(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UM(t);case"0303000000000000c000000000000046":return jM(t);default:throw new Error("Unsupported Moniker "+r)}}function Kh(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Jn,""):"";return r}function tE(t,e){e||(e=ye(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function HM(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,l,u,h,d="",p,v;a&16&&(o=Kh(t,r-t.l)),a&128&&(l=Kh(t,r-t.l)),(a&257)===257&&(u=Kh(t,r-t.l)),(a&257)===1&&(h=zM(t,r-t.l)),a&8&&(d=Kh(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(v=$x(t)),t.l=r;var _=l||u||h||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var y={Target:_};return p&&(y.guid=p),v&&(y.time=v),o&&(y.Tooltip=o),y}function GM(t){var e=ye(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),o=a>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(o==28)n=n.slice(1),tE(n,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),o&8&&tE(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)e.write_shift(1,n.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function _b(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function yb(t,e){var r=_b(t);return r[3]=0,r}function Wi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ol(t,e,r,n){return n||(n=ye(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function qM(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function XM(t,e,r){return e===0?"":zl(t,e,r)}function WM(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,o,l]}function Tb(t){var e=t.read_shift(2),r=Xx(t);return[e,r]}function KM(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=d0(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Tm(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function wb(t,e){return e||(e=ye(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Eb(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var $M=Eb;function Sb(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function YM(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function QM(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Fn(t){t.l+=2,t.l+=t.read_shift(2)}var JM={0:Fn,4:Fn,5:Fn,6:Fn,7:QM,8:Fn,9:Fn,10:Fn,11:Fn,12:Fn,13:YM,14:Fn,15:Fn,16:Fn,17:Fn,18:Fn,19:Fn,20:Fn,21:Sb};function ZM(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(JM[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function $h(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Yx(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=ye(a);return o.write_shift(2,n),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function e9(t,e){return e===0||t.read_shift(2),1200}function t9(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=zl(t,0,r);return t.read_shift(e+n-t.l),a}function r9(t,e){var r=!e||e.biff==8,n=ye(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function n9(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function a9(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=d0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function i9(t,e){var r=!e||e.biff>=8?2:1,n=ye(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function s9(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0;l!=a&&t.l<r;++l)o.push(PM(t));return o.Count=n,o.Unique=a,o}function o9(t,e){var r=ye(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=VM(t[a]);var o=mn([r].concat(n));return o.parts=[r.length].concat(n.map(function(l){return l.length})),o}function l9(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function c9(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function u9(t){var e=qM(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function f9(t){return t.read_shift(2),t.read_shift(4)}function rE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function h9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:u,Selected:h,TabRatio:d}}function d9(){var t=ye(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function m9(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function p9(t){var e=ye(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function g9(){}function x9(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=d0(t,0,r),n}function v9(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,o=ye(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}function _9(t){var e=Wi(t);return e.isst=t.read_shift(4),e}function y9(t,e,r,n){var a=ye(10);return Ol(t,e,n,a),a.write_shift(4,r),a}function T9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Wi(t);r.biff==2&&t.l++;var o=m0(t,n-t.l,r);return a.val=o,a}function w9(t,e,r,n,a){var o=!a||a.biff==8,l=ye(8+ +o+(1+o)*r.length);return Ol(t,e,n,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function E9(t,e,r){var n=t.read_shift(2),a=zl(t,0,r);return[n,a]}function S9(t,e,r,n){var a=r&&r.biff==5;n||(n=ye(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var A9=zl;function nE(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:h}}}function b9(t,e){var r=e.biff==8||!e.biff?4:2,n=ye(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function k9(t){var e=t.read_shift(2),r=t.read_shift(2),n=Tb(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function C9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(Tb(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function N9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function R9(t,e,r,n){var a={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return a.patternType=uM[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function I9(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=R9(t,e,n.fStyle,r),n}function aE(t,e,r,n){var a=r&&r.biff==5;n||(n=ye(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function D9(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function O9(t){var e=ye(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function iE(t,e,r){var n=Wi(t);(r.biff==2||e==9)&&++t.l;var a=LM(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function F9(t,e,r,n,a,o){var l=ye(8);return Ol(t,e,n,l),xb(r,o,l),l}function M9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Wi(t),a=Un(t);return n.val=a,n}function L9(t,e,r,n){var a=ye(14);return Ol(t,e,n,a),Il(r,a),a}var sE=XM;function P9(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=Dl(t,o),u=[];n>t.l;)u.push(m0(t));return[o,a,l,u]}function oE(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=KM(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var V9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function lE(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Dl(t,l,r);a&32&&(d=V9[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:ZV(t,p,r,u);return{chKey:o,Name:d,itab:h,rgce:v}}function Ab(t,e,r){if(r.biff<8)return B9(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(WM(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function B9(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=d0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function U9(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=Dl(t,n,r),l=Dl(t,a,r);return[o,l]}function j9(t,e,r){var n=Eb(t);t.l++;var a=t.read_shift(1);return e-=8,[eB(t,e,r),a,n]}function cE(t,e,r){var n=$M(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,QV(t,e,r)]}function z9(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function H9(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=zl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,o]}}function G9(t,e,r){return H9(t,e,r)}function q9(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Tm(t));return r}function X9(t){var e=ye(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)wb(t[r],e);return e}function W9(t,e,r){if(r&&r.biff<8)return $9(t,e,r);var n=Sb(t),a=ZM(t,e-22,n[1]);return{cmo:n,ft:a}}var K9={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function $9(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((K9[n]||Hn)(t,e,r)),{cmo:[a,n,o],ft:l}}function Y9(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=BM(t,6,r);var u=t.read_shift(2);t.read_shift(2),Yr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],v=Dl(t,t.lens[d+1]-t.lens[d]-1);if(a+=v,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function Q9(t,e){var r=Tm(t);t.l+=16;var n=HM(t,e-24);return[r,n]}function J9(t){var e=ye(24),r=Sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return mn([e,GM(t[1])])}function Z9(t,e){t.read_shift(2);var r=Tm(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Jn,""),[r,n]}function e7(t){var e=t[1].Tooltip,r=ye(10+2*(e.length+1));r.write_shift(2,2048);var n=Sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function t7(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Ww[r]||r,r=t.read_shift(2),e[1]=Ww[r]||r,e}function r7(t){return t||(t=ye(4)),t.write_shift(2,1),t.write_shift(2,1),t}function n7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(yb(t));return r}function a7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(yb(t));return r}function i7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function bb(t,e,r){if(!r.cellStyles)return Hn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:o,w:l,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function s7(t,e){var r=ye(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function o7(t,e){var r={};return e<32||(t.l+=16,r.header=Un(t),r.footer=Un(t),t.l+=2),r}function l7(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function c7(t){for(var e=ye(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var u7=Wi,f7=gb,h7=m0;function d7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function m7(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Wi(t);++t.l;var a=zl(t,e-7,r);return n.t="str",n.val=a,n}function p7(t){var e=Wi(t);++t.l;var r=Un(t);return e.t="n",e.val=r,e}function g7(t,e,r){var n=ye(15);return v0(n,t,e),n.write_shift(8,r,"f"),n}function x7(t){var e=Wi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function v7(t,e,r){var n=ye(9);return v0(n,t,e),n.write_shift(2,r),n}function _7(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function y7(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function T7(t,e,r){var n=t.l+e,a=Wi(t),o=t.read_shift(2),l=Dl(t,o,r);return t.l=n,a.t="str",a.val=l,a}var w7=[2,3,48,49,131,139,140,245],Dg=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=vm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],p=Do(1);switch(h.type){case"base64":p=Ca(Ia(u));break;case"binary":p=Ca(u);break;case"buffer":case"array":p=u;break}Sn(p,0);var v=p.read_shift(1),_=!!(v&136),y=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,b=521;v==2&&(w=p.read_shift(2)),p.l+=3,v!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(b=p.read_shift(2));var F=p.read_shift(2),z=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(z=t[p[p.l]]),p.l+=1,p.l+=2),S&&(p.l+=36);for(var N=[],K={},te=Math.min(p.length,v==2?521:b-10-(y?264:0)),J=S?32:11;p.l<te&&p[p.l]!=13;)switch(K={},K.name=Uf.utils.decode(z,p.slice(p.l,p.l+J)).replace(/[\u0000\r\n].*$/g,""),p.l+=J,K.type=String.fromCharCode(p.read_shift(1)),v!=2&&!S&&(K.offset=p.read_shift(4)),K.len=p.read_shift(1),v==2&&(K.offset=p.read_shift(2)),K.dec=p.read_shift(1),K.name.length&&N.push(K),v!=2&&(p.l+=S?13:14),K.type){case"B":(!y||K.len!=8)&&h.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(p[p.l]!==13&&(p.l=b-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=b;var k=0,I=0;for(d[0]=[],I=0;I!=N.length;++I)d[0][I]=N[I].name;for(;w-- >0;){if(p[p.l]===42){p.l+=F;continue}for(++p.l,d[++k]=[],I=0,I=0;I!=N.length;++I){var R=p.slice(p.l,p.l+N[I].len);p.l+=N[I].len,Sn(R,0);var M=Uf.utils.decode(z,R);switch(N[I].type){case"C":M.trim().length&&(d[k][I]=M.replace(/\s+$/,""));break;case"D":M.length===8?d[k][I]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):d[k][I]=M;break;case"F":d[k][I]=parseFloat(M.trim());break;case"+":case"I":d[k][I]=S?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":d[k][I]=!0;break;case"N":case"F":d[k][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[k][I]="##MEMO##"+(S?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(d[k][I]=+M||0);break;case"@":d[k][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[k][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[k][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][I]=-R.read_shift(-8,"f");break;case"B":if(y&&N[I].len==8){d[k][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=N[I].len;break;case"0":if(N[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[I].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=N,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=hu(r(u,d),d);return p["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,p}function a(u,h){try{return Bo(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,h){var d=h||{};if(+d.codepage>=0&&pi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=fa(),v=Gd(u,{header:1,raw:!0,cellDates:!0}),_=v[0],y=v.slice(1),S=u["!cols"]||[],w=0,b=0,F=0,z=1;for(w=0;w<_.length;++w){if(((S[w]||{}).DBF||{}).name){_[w]=S[w].DBF.name,++F;continue}if(_[w]!=null){if(++F,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(b=0;b<1024;++b)if(_.indexOf(_[w]+"_"+b)==-1){_[w]+="_"+b;break}}}}var N=Bt(u["!ref"]),K=[],te=[],J=[];for(w=0;w<=N.e.c-N.s.c;++w){var k="",I="",R=0,M=[];for(b=0;b<y.length;++b)y[b][w]!=null&&M.push(y[b][w]);if(M.length==0||_[w]==null){K[w]="?";continue}for(b=0;b<M.length;++b){switch(typeof M[b]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=M[b]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(M[b]).length),k=k&&k!=I?"C":I}R>250&&(R=250),I=((S[w]||{}).DBF||{}).type,I=="C"&&S[w].DBF.len>R&&(R=S[w].DBF.len),k=="B"&&I=="N"&&(k="N",J[w]=S[w].DBF.dec,R=S[w].DBF.len),te[w]=k=="C"||I=="N"?R:o[k]||0,z+=te[w],K[w]=k}var O=p.next(32);for(O.write_shift(4,318902576),O.write_shift(4,y.length),O.write_shift(2,296+32*F),O.write_shift(2,z),w=0;w<4;++w)O.write_shift(4,0);for(O.write_shift(4,0|(+e[pA]||3)<<8),w=0,b=0;w<_.length;++w)if(_[w]!=null){var D=p.next(32),V=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,V,"sbcs"),D.write_shift(1,K[w]=="?"?"C":K[w],"sbcs"),D.write_shift(4,b),D.write_shift(1,te[w]||o[K[w]]||0),D.write_shift(1,J[w]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),b+=te[w]||o[K[w]]||0}var _e=p.next(264);for(_e.write_shift(4,13),w=0;w<65;++w)_e.write_shift(4,0);for(w=0;w<y.length;++w){var Te=p.next(z);for(Te.write_shift(1,0),b=0;b<_.length;++b)if(_[b]!=null)switch(K[b]){case"L":Te.write_shift(1,y[w][b]==null?63:y[w][b]?84:70);break;case"B":Te.write_shift(8,y[w][b]||0,"f");break;case"N":var ne="0";for(typeof y[w][b]=="number"&&(ne=y[w][b].toFixed(J[b]||0)),F=0;F<te[b]-ne.length;++F)Te.write_shift(1,32);Te.write_shift(1,ne,"sbcs");break;case"D":y[w][b]?(Te.write_shift(4,("0000"+y[w][b].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(y[w][b].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+y[w][b].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(y[w][b]!=null?y[w][b]:"").slice(0,te[b]);for(Te.write_shift(1,oe,"sbcs"),F=0;F<te[b]-oe.length;++F)Te.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),kb=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Rr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,y){var S=t[y];return typeof S=="number"?yw(S):S},n=function(_,y,S){var w=y.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return w==59?_:yw(w)};t["|"]=254;function a(_,y){switch(y.type){case"base64":return o(Ia(_),y);case"binary":return o(_,y);case"buffer":return o(wt&&Buffer.isBuffer(_)?_.toString("binary"):Vo(_),y);case"array":return o(Rl(_),y)}throw new Error("Unrecognized type "+y.type)}function o(_,y){var S=_.split(/[\n\r]+/),w=-1,b=-1,F=0,z=0,N=[],K=[],te=null,J={},k=[],I=[],R=[],M=0,O;for(+y.codepage>=0&&pi(+y.codepage);F!==S.length;++F){M=0;var D=S[F].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),V=D.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),_e=V[0],Te;if(D.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&K.push(D.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,oe=!1,ke=!1,ae=!1,Le=-1,Q=-1;for(z=1;z<V.length;++z)switch(V[z].charAt(0)){case"A":break;case"X":b=parseInt(V[z].slice(1))-1,oe=!0;break;case"Y":for(w=parseInt(V[z].slice(1))-1,oe||(b=0),O=N.length;O<=w;++O)N[O]=[];break;case"K":Te=V[z].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(_i(Te))?isNaN(eu(Te).getDate())||(Te=xr(Te)):(Te=_i(Te),te!==null&&uu(te)&&(Te=ym(Te))),ne=!0;break;case"E":ae=!0;var L=qc(V[z].slice(1),{r:w,c:b});N[w][b]=[N[w][b],L];break;case"S":ke=!0,N[w][b]=[N[w][b],"S5S"];break;case"G":break;case"R":Le=parseInt(V[z].slice(1))-1;break;case"C":Q=parseInt(V[z].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}if(ne&&(N[w][b]&&N[w][b].length==2?N[w][b][0]=Te:N[w][b]=Te,te=null),ke){if(ae)throw new Error("SYLK shared formula cannot have own formula");var W=Le>-1&&N[Le][Q];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");N[w][b][1]=qb(W[1],{r:w-Le,c:b-Q})}break;case"F":var G=0;for(z=1;z<V.length;++z)switch(V[z].charAt(0)){case"X":b=parseInt(V[z].slice(1))-1,++G;break;case"Y":for(w=parseInt(V[z].slice(1))-1,O=N.length;O<=w;++O)N[O]=[];break;case"M":M=parseInt(V[z].slice(1))/20;break;case"F":break;case"G":break;case"P":te=K[parseInt(V[z].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=V[z].slice(1).split(" "),O=parseInt(R[0],10);O<=parseInt(R[1],10);++O)M=parseInt(R[2],10),I[O-1]=M===0?{hidden:!0}:{wch:M},Oo(I[O-1]);break;case"C":b=parseInt(V[z].slice(1))-1,I[b]||(I[b]={});break;case"R":w=parseInt(V[z].slice(1))-1,k[w]||(k[w]={}),M>0?(k[w].hpt=M,k[w].hpx=ru(M)):M===0&&(k[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}G<1&&(te=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(J["!rows"]=k),I.length>0&&(J["!cols"]=I),y&&y.sheetRows&&(N=N.slice(0,y.sheetRows)),[N,J]}function l(_,y){var S=a(_,y),w=S[0],b=S[1],F=hu(w,y);return Rr(b).forEach(function(z){F[z]=b[z]}),F}function u(_,y){return Bo(l(_,y),y)}function h(_,y,S,w){var b="C;Y"+(S+1)+";X"+(w+1)+";K";switch(_.t){case"n":b+=_.v||0,_.f&&!_.F&&(b+=";E"+rv(_.f,{r:S,c:w}));break;case"b":b+=_.v?"TRUE":"FALSE";break;case"e":b+=_.w||_.v;break;case"d":b+='"'+(_.w||_.v)+'"';break;case"s":b+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(_,y){y.forEach(function(S,w){var b="F;W"+(w+1)+" "+(w+1)+" ";S.hidden?b+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=Kf(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=$f(S.wpx)),typeof S.wch=="number"&&(b+=Math.round(S.wch))),b.charAt(b.length-1)!=" "&&_.push(b)})}function p(_,y){y.forEach(function(S,w){var b="F;";S.hidden?b+="M0;":S.hpt?b+="M"+20*S.hpt+";":S.hpx&&(b+="M"+20*Yf(S.hpx)+";"),b.length>2&&_.push(b+"R"+(w+1))})}function v(_,y){var S=["ID;PWXL;N;E"],w=[],b=Bt(_["!ref"]),F,z=Array.isArray(_),N=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&d(S,_["!cols"]),_["!rows"]&&p(S,_["!rows"]),S.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var K=b.s.r;K<=b.e.r;++K)for(var te=b.s.c;te<=b.e.c;++te){var J=ot({r:K,c:te});F=z?(_[K]||[])[te]:_[J],!(!F||F.v==null&&(!F.f||F.F))&&w.push(h(F,_,K,te))}return S.join(N)+N+w.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:l,from_sheet:v}})(),Cb=(function(){function t(o,l){switch(l.type){case"base64":return e(Ia(o),l);case"binary":return e(o,l);case"buffer":return e(wt&&Buffer.isBuffer(o)?o.toString("binary"):Vo(o),l);case"array":return e(Rl(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),h=-1,d=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],d=0;continue}if(!(h<0)){var _=u[p].trim().split(","),y=_[0],S=_[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+y){case-1:if(w==="BOT"){v[++h]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[h][d]=!0:w==="FALSE"?v[h][d]=!1:isNaN(_i(S))?isNaN(eu(S).getDate())?v[h][d]=S:v[h][d]=xr(S):v[h][d]=_i(S),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[h][d++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(o,l){return hu(t(o,l),l)}function n(o,l){return Bo(r(o,l),l)}var a=(function(){var o=function(h,d,p,v,_){h.push(d),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},l=function(h,d,p,v){h.push(d+","+p),h.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var d=[],p=Bt(h["!ref"]),v,_=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,p.e.r-p.s.r+1,""),o(d,"TUPLES",0,p.e.c-p.s.c+1,""),o(d,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){l(d,-1,0,"BOT");for(var S=p.s.c;S<=p.e.c;++S){var w=ot({r:y,c:S});if(v=_?(h[y]||[])[S]:h[w],!v){l(d,1,0,"");continue}switch(v.t){case"n":var b=v.w;!b&&v.v!=null&&(b=v.v),b==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,b,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Qa(v.z||st[14],on(xr(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var F=`\r
`,z=d.join(F);return z}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),Nb=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var y=v.split(`
`),S=-1,w=-1,b=0,F=[];b!==y.length;++b){var z=y[b].trim().split(":");if(z[0]==="cell"){var N=Sr(z[1]);if(F.length<=N.r)for(S=F.length;S<=N.r;++S)F[S]||(F[S]=[]);switch(S=N.r,w=N.c,z[2]){case"t":F[S][w]=t(z[3]);break;case"v":F[S][w]=+z[3];break;case"vtf":var K=z[z.length-1];case"vtc":z[3]==="nl"?F[S][w]=!!+z[4]:F[S][w]=+z[4],z[2]=="vtf"&&(F[S][w]=[F[S][w],K])}}}return _&&_.sheetRows&&(F=F.slice(0,_.sheetRows)),F}function n(v,_){return hu(r(v,_),_)}function a(v,_){return Bo(n(v,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var _=[],y=[],S,w="",b=ha(v["!ref"]),F=Array.isArray(v),z=b.s.r;z<=b.e.r;++z)for(var N=b.s.c;N<=b.e.c;++N)if(w=ot({r:z,c:N}),S=F?(v[z]||[])[N]:v[w],!(!S||S.v==null||S.t==="z")){switch(y=["cell",w,"t"],S.t){case"s":case"str":y.push(e(S.v));break;case"n":S.f?(y[2]="vtf",y[3]="n",y[4]=S.v,y[5]=e(S.f)):(y[2]="v",y[3]=S.v);break;case"b":y[2]="vt"+(S.f?"f":"c"),y[3]="nl",y[4]=S.v?"1":"0",y[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var K=on(xr(S.v));y[2]="vtc",y[3]="nd",y[4]=""+K,y[5]=S.w||Qa(S.z||st[14],K);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[o,l,u,l,d(v),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}})(),tu=(function(){function t(p,v,_,y,S){S.raw?v[_][y]=p:p===""||(p==="TRUE"?v[_][y]=!0:p==="FALSE"?v[_][y]=!1:isNaN(_i(p))?isNaN(eu(p).getDate())?v[_][y]=p:v[_][y]=xr(p):v[_][y]=_i(p))}function e(p,v){var _=v||{},y=[];if(!p||p.length===0)return y;for(var S=p.split(/[\r\n]/),w=S.length-1;w>=0&&S[w].length===0;)--w;for(var b=10,F=0,z=0;z<=w;++z)F=S[z].indexOf(" "),F==-1?F=S[z].length:F++,b=Math.max(b,F);for(z=0;z<=w;++z){y[z]=[];var N=0;for(t(S[z].slice(0,b).trim(),y,z,N,_),N=1;N<=(S[z].length-b)/10+1;++N)t(S[z].slice(b+(N-1)*10,b+N*10).trim(),y,z,N,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var v={},_=!1,y=0,S=0;y<p.length;++y)(S=p.charCodeAt(y))==34?_=!_:!_&&S in r&&(v[S]=(v[S]||0)+1);S=[];for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&S.push([v[y],y]);if(!S.length){v=n;for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&S.push([v[y],y])}return S.sort(function(w,b){return w[0]-b[0]||n[w[1]]-n[b[1]]}),r[S.pop()[1]]||44}function o(p,v){var _=v||{},y="",S=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=a(p.slice(0,1024)):_&&_.FS?y=_.FS:y=a(p.slice(0,1024));var b=0,F=0,z=0,N=0,K=0,te=y.charCodeAt(0),J=!1,k=0,I=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var R=_.dateNF!=null?lF(_.dateNF):null;function M(){var O=p.slice(N,K),D={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)D.t="z";else if(_.raw)D.t="s",D.v=O;else if(O.trim().length===0)D.t="s",D.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(D.t="s",D.v=O.slice(2,-1).replace(/""/g,'"')):PP(O)?(D.t="n",D.f=O.slice(1)):(D.t="s",D.v=O);else if(O=="TRUE")D.t="b",D.v=!0;else if(O=="FALSE")D.t="b",D.v=!1;else if(!isNaN(z=_i(O)))D.t="n",_.cellText!==!1&&(D.w=O),D.v=z;else if(!isNaN(eu(O).getDate())||R&&O.match(R)){D.z=_.dateNF||st[14];var V=0;R&&O.match(R)&&(O=cF(O,_.dateNF,O.match(R)||[]),V=1),_.cellDates?(D.t="d",D.v=xr(O,V)):(D.t="n",D.v=on(xr(O,V))),_.cellText!==!1&&(D.w=Qa(D.z,D.v instanceof Date?on(D.v):D.v)),_.cellNF||delete D.z}else D.t="s",D.v=O;if(D.t=="z"||(_.dense?(S[b]||(S[b]=[]),S[b][F]=D):S[ot({c:F,r:b})]=D),N=K+1,I=p.charCodeAt(N),w.e.c<F&&(w.e.c=F),w.e.r<b&&(w.e.r=b),k==te)++F;else if(F=0,++b,_.sheetRows&&_.sheetRows<=b)return!0}e:for(;K<p.length;++K)switch(k=p.charCodeAt(K)){case 34:I===34&&(J=!J);break;case te:case 10:case 13:if(!J&&M())break e;break}return K-N>0&&M(),S["!ref"]=vt(w),S}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):hu(e(p,v),v)}function u(p,v){var _="",y=v.type=="string"?[0,0,0,0]:uv(p,v);switch(v.type){case"base64":_=Ia(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof Uf<"u"||(_=wt&&Buffer.isBuffer(p)?p.toString("binary"):Vo(p));break;case"array":_=Rl(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=cr(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=cr(_):v.type=="binary"&&typeof Uf<"u",_.slice(0,19)=="socialcalc:version:"?Nb.to_sheet(v.type=="string"?_:cr(_),v):l(_,v)}function h(p,v){return Bo(u(p,v),v)}function d(p){for(var v=[],_=Bt(p["!ref"]),y,S=Array.isArray(p),w=_.s.r;w<=_.e.r;++w){for(var b=[],F=_.s.c;F<=_.e.c;++F){var z=ot({r:w,c:F});if(y=S?(p[w]||[])[F]:p[z],!y||y.v==null){b.push("          ");continue}for(var N=(y.w||(Ss(y),y.w)||"").slice(0,10);N.length<10;)N+=" ";b.push(N+(F===0?" ":""))}v.push(b.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function E7(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=kb.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return tu.to_workbook(t,e)}}var Tl=(function(){function t(L,W,G){if(L){Sn(L,L.l||0);for(var Z=G.Enum||Le;L.l<L.length;){var le=L.read_shift(2),Se=Z[le]||Z[65535],Ne=L.read_shift(2),Ae=L.l+Ne,Ie=Se.f&&Se.f(L,Ne,G);if(L.l=Ae,W(Ie,Se,le))return}}}function e(L,W){switch(W.type){case"base64":return r(Ca(Ia(L)),W);case"binary":return r(Ca(L),W);case"buffer":case"array":return r(L,W)}throw"Unsupported type "+W.type}function r(L,W){if(!L)return L;var G=W||{},Z=G.dense?[]:{},le="Sheet1",Se="",Ne=0,Ae={},Ie=[],nt=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Ft=G.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)G.Enum=Le,t(L,function(Ue,$t,Dt){switch(Dt){case 0:G.vers=Ue,Ue>=4096&&(G.qpro=!0);break;case 6:ee=Ue;break;case 204:Ue&&(Se=Ue);break;case 222:Se=Ue;break;case 15:case 51:G.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:Dt==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=G.dateNF||st[14],G.cellDates&&(Ue[1].t="d",Ue[1].v=ym(Ue[1].v))),G.qpro&&Ue[3]>Ne&&(Z["!ref"]=vt(ee),Ae[le]=Z,Ie.push(le),Z=G.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},Ne=Ue[3],le=Se||"Sheet"+(Ne+1),Se="");var Ut=G.dense?(Z[Ue[0].r]||[])[Ue[0].c]:Z[ot(Ue[0])];if(Ut){Ut.t=Ue[1].t,Ut.v=Ue[1].v,Ue[1].z!=null&&(Ut.z=Ue[1].z),Ue[1].f!=null&&(Ut.f=Ue[1].f);break}G.dense?(Z[Ue[0].r]||(Z[Ue[0].r]=[]),Z[Ue[0].r][Ue[0].c]=Ue[1]):Z[ot(Ue[0])]=Ue[1];break}},G);else if(L[2]==26||L[2]==14)G.Enum=Q,L[2]==14&&(G.qpro=!0,L.l=0),t(L,function(Ue,$t,Dt){switch(Dt){case 204:le=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>Ne&&(Z["!ref"]=vt(ee),Ae[le]=Z,Ie.push(le),Z=G.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},Ne=Ue[3],le="Sheet"+(Ne+1)),Ft>0&&Ue[0].r>=Ft)break;G.dense?(Z[Ue[0].r]||(Z[Ue[0].r]=[]),Z[Ue[0].r][Ue[0].c]=Ue[1]):Z[ot(Ue[0])]=Ue[1],ee.e.c<Ue[0].c&&(ee.e.c=Ue[0].c),ee.e.r<Ue[0].r&&(ee.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(nt[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:nt[Ue[0]]=Ue[1],Ue[0]==Ne&&(le=Ue[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(Z["!ref"]=vt(ee),Ae[Se||le]=Z,Ie.push(Se||le),!nt.length)return{SheetNames:Ie,Sheets:Ae};for(var ft={},It=[],at=0;at<nt.length;++at)Ae[Ie[at]]?(It.push(nt[at]||Ie[at]),ft[nt[at]]=Ae[nt[at]]||Ae[Ie[at]]):(It.push(nt[at]),ft[nt[at]]={"!ref":"A1"});return{SheetNames:It,Sheets:ft}}function n(L,W){var G=W||{};if(+G.codepage>=0&&pi(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=fa(),le=Bt(L["!ref"]),Se=Array.isArray(L),Ne=[];je(Z,0,o(1030)),je(Z,6,h(le));for(var Ae=Math.min(le.e.r,8191),Ie=le.s.r;Ie<=Ae;++Ie)for(var nt=Vr(Ie),ee=le.s.c;ee<=le.e.c;++ee){Ie===le.s.r&&(Ne[ee]=Er(ee));var Ft=Ne[ee]+nt,ft=Se?(L[Ie]||[])[ee]:L[Ft];if(!(!ft||ft.t=="z"))if(ft.t=="n")(ft.v|0)==ft.v&&ft.v>=-32768&&ft.v<=32767?je(Z,13,y(Ie,ee,ft.v)):je(Z,14,w(Ie,ee,ft.v));else{var It=Ss(ft);je(Z,15,v(Ie,ee,It.slice(0,239)))}}return je(Z,1),Z.end()}function a(L,W){var G=W||{};if(+G.codepage>=0&&pi(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=fa();je(Z,0,l(L));for(var le=0,Se=0;le<L.SheetNames.length;++le)(L.Sheets[L.SheetNames[le]]||{})["!ref"]&&je(Z,27,ae(L.SheetNames[le],Se++));var Ne=0;for(le=0;le<L.SheetNames.length;++le){var Ae=L.Sheets[L.SheetNames[le]];if(!(!Ae||!Ae["!ref"])){for(var Ie=Bt(Ae["!ref"]),nt=Array.isArray(Ae),ee=[],Ft=Math.min(Ie.e.r,8191),ft=Ie.s.r;ft<=Ft;++ft)for(var It=Vr(ft),at=Ie.s.c;at<=Ie.e.c;++at){ft===Ie.s.r&&(ee[at]=Er(at));var Ue=ee[at]+It,$t=nt?(Ae[ft]||[])[at]:Ae[Ue];if(!(!$t||$t.t=="z"))if($t.t=="n")je(Z,23,M(ft,at,Ne,$t.v));else{var Dt=Ss($t);je(Z,22,k(ft,at,Ne,Dt.slice(0,239)))}}++Ne}}return je(Z,1),Z.end()}function o(L){var W=ye(2);return W.write_shift(2,L),W}function l(L){var W=ye(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var G=0,Z=0,le=0,Se=0;Se<L.SheetNames.length;++Se){var Ne=L.SheetNames[Se],Ae=L.Sheets[Ne];if(!(!Ae||!Ae["!ref"])){++le;var Ie=ha(Ae["!ref"]);G<Ie.e.r&&(G=Ie.e.r),Z<Ie.e.c&&(Z=Ie.e.c)}}return G>8191&&(G=8191),W.write_shift(2,G),W.write_shift(1,le),W.write_shift(1,Z),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function u(L,W,G){var Z={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&G.qpro?(Z.s.c=L.read_shift(1),L.l++,Z.s.r=L.read_shift(2),Z.e.c=L.read_shift(1),L.l++,Z.e.r=L.read_shift(2),Z):(Z.s.c=L.read_shift(2),Z.s.r=L.read_shift(2),W==12&&G.qpro&&(L.l+=2),Z.e.c=L.read_shift(2),Z.e.r=L.read_shift(2),W==12&&G.qpro&&(L.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function h(L){var W=ye(8);return W.write_shift(2,L.s.c),W.write_shift(2,L.s.r),W.write_shift(2,L.e.c),W.write_shift(2,L.e.r),W}function d(L,W,G){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(Z[0].c=L.read_shift(1),Z[3]=L.read_shift(1),Z[0].r=L.read_shift(2),L.l+=2):(Z[2]=L.read_shift(1),Z[0].c=L.read_shift(2),Z[0].r=L.read_shift(2)),Z}function p(L,W,G){var Z=L.l+W,le=d(L,W,G);if(le[1].t="s",G.vers==20768){L.l++;var Se=L.read_shift(1);return le[1].v=L.read_shift(Se,"utf8"),le}return G.qpro&&L.l++,le[1].v=L.read_shift(Z-L.l,"cstr"),le}function v(L,W,G){var Z=ye(7+G.length);Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,L),Z.write_shift(1,39);for(var le=0;le<Z.length;++le){var Se=G.charCodeAt(le);Z.write_shift(1,Se>=128?95:Se)}return Z.write_shift(1,0),Z}function _(L,W,G){var Z=d(L,W,G);return Z[1].v=L.read_shift(2,"i"),Z}function y(L,W,G){var Z=ye(7);return Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,L),Z.write_shift(2,G,"i"),Z}function S(L,W,G){var Z=d(L,W,G);return Z[1].v=L.read_shift(8,"f"),Z}function w(L,W,G){var Z=ye(13);return Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,L),Z.write_shift(8,G,"f"),Z}function b(L,W,G){var Z=L.l+W,le=d(L,W,G);if(le[1].v=L.read_shift(8,"f"),G.qpro)L.l=Z;else{var Se=L.read_shift(2);K(L.slice(L.l,L.l+Se),le),L.l+=Se}return le}function F(L,W,G){var Z=W&32768;return W&=-32769,W=(Z?L:0)+(W>=8192?W-16384:W),(Z?"":"$")+(G?Er(W):Vr(W))}var z={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(L,W){Sn(L,0);for(var G=[],Z=0,le="",Se="",Ne="",Ae="";L.l<L.length;){var Ie=L[L.l++];switch(Ie){case 0:G.push(L.read_shift(8,"f"));break;case 1:Se=F(W[0].c,L.read_shift(2),!0),le=F(W[0].r,L.read_shift(2),!1),G.push(Se+le);break;case 2:{var nt=F(W[0].c,L.read_shift(2),!0),ee=F(W[0].r,L.read_shift(2),!1);Se=F(W[0].c,L.read_shift(2),!0),le=F(W[0].r,L.read_shift(2),!1),G.push(nt+ee+":"+Se+le)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(L.read_shift(2));break;case 6:{for(var Ft="";Ie=L[L.l++];)Ft+=String.fromCharCode(Ie);G.push('"'+Ft.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:Ae=G.pop(),Ne=G.pop(),G.push(["AND","OR"][Ie-20]+"("+Ne+","+Ae+")");break;default:if(Ie<32&&N[Ie])Ae=G.pop(),Ne=G.pop(),G.push(Ne+N[Ie]+Ae);else if(z[Ie]){if(Z=z[Ie][1],Z==69&&(Z=L[L.l++]),Z>G.length){console.error("WK1 bad formula parse 0x"+Ie.toString(16)+":|"+G.join("|")+"|");return}var ft=G.slice(-Z);G.length-=Z,G.push(z[Ie][0]+"("+ft.join(",")+")")}else return Ie<=7?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=24?console.error("WK1 unsupported op "+Ie.toString(16)):Ie<=30?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=115?console.error("WK1 unsupported function opcode "+Ie.toString(16)):console.error("WK1 unrecognized opcode "+Ie.toString(16))}}G.length==1?W[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function te(L){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=L.read_shift(2),W[3]=L[L.l++],W[0].c=L[L.l++],W}function J(L,W){var G=te(L);return G[1].t="s",G[1].v=L.read_shift(W-4,"cstr"),G}function k(L,W,G,Z){var le=ye(6+Z.length);le.write_shift(2,L),le.write_shift(1,G),le.write_shift(1,W),le.write_shift(1,39);for(var Se=0;Se<Z.length;++Se){var Ne=Z.charCodeAt(Se);le.write_shift(1,Ne>=128?95:Ne)}return le.write_shift(1,0),le}function I(L,W){var G=te(L);G[1].v=L.read_shift(2);var Z=G[1].v>>1;if(G[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return G[1].v=Z,G}function R(L,W){var G=te(L),Z=L.read_shift(4),le=L.read_shift(4),Se=L.read_shift(2);if(Se==65535)return Z===0&&le===3221225472?(G[1].t="e",G[1].v=15):Z===0&&le===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Ne=Se&32768;return Se=(Se&32767)-16446,G[1].v=(1-Ne*2)*(le*Math.pow(2,Se+32)+Z*Math.pow(2,Se)),G}function M(L,W,G,Z){var le=ye(14);if(le.write_shift(2,L),le.write_shift(1,G),le.write_shift(1,W),Z==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var Se=0,Ne=0,Ae=0,Ie=0;return Z<0&&(Se=1,Z=-Z),Ne=Math.log2(Z)|0,Z/=Math.pow(2,Ne-31),Ie=Z>>>0,(Ie&2147483648)==0&&(Z/=2,++Ne,Ie=Z>>>0),Z-=Ie,Ie|=2147483648,Ie>>>=0,Z*=Math.pow(2,32),Ae=Z>>>0,le.write_shift(4,Ae),le.write_shift(4,Ie),Ne+=16383+(Se?32768:0),le.write_shift(2,Ne),le}function O(L,W){var G=R(L);return L.l+=W-14,G}function D(L,W){var G=te(L),Z=L.read_shift(4);return G[1].v=Z>>6,G}function V(L,W){var G=te(L),Z=L.read_shift(8,"f");return G[1].v=Z,G}function _e(L,W){var G=V(L);return L.l+=W-10,G}function Te(L,W){return L[L.l+W-1]==0?L.read_shift(W,"cstr"):""}function ne(L,W){var G=L[L.l++];G>W-1&&(G=W-1);for(var Z="";Z.length<G;)Z+=String.fromCharCode(L[L.l++]);return Z}function oe(L,W,G){if(!(!G.qpro||W<21)){var Z=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var le=L.read_shift(W-21,"cstr");return[Z,le]}}function ke(L,W){for(var G={},Z=L.l+W;L.l<Z;){var le=L.read_shift(2);if(le==14e3){for(G[le]=[0,""],G[le][0]=L.read_shift(2);L[L.l];)G[le][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return G}function ae(L,W){var G=ye(5+L.length);G.write_shift(2,14e3),G.write_shift(2,W);for(var Z=0;Z<L.length;++Z){var le=L.charCodeAt(Z);G[G.l++]=le>127?95:le}return G[G.l++]=0,G}var Le={0:{n:"BOF",f:Yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function S7(t){var e={},r=t.match(Gn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=ut(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=kx[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var A7=(function(){var t=Hf("t"),e=Hf("rPr");function r(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Vt(l[1])},h=o.match(e);return h&&(u.s=S7(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),b7=(function(){var e=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),l.push("</"+h+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),k7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,C7=/<(?:\w+:)?r>/,N7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Qx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Vt(cr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=cr(t),r&&(n.h=Px(n.t))):t.match(C7)&&(n.r=cr(t),n.t=Vt(cr((t.replace(N7,"").match(k7)||[]).join("").replace(Gn,""))),r&&(n.h=b7(A7(n.r)))),n):{t:""}}var R7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,I7=/<(?:\w+:)?(?:si|sstItem)>/g,D7=/<\/(?:\w+:)?(?:si|sstItem)>/;function O7(t,e){var r=[],n="";if(!t)return r;var a=t.match(R7);if(a){n=a[2].replace(I7,"").split(D7);for(var o=0;o!=n.length;++o){var l=Qx(n[o].trim(),e);l!=null&&(r[r.length]=l)}a=ut(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var F7=/^\s|\s$|[\t\n\r]/;function Rb(t,e){if(!e.bookSST)return"";var r=[Br];r[r.length]=Be("sst",null,{xmlns:Pl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(F7)&&(o+=' xml:space="preserve"'),o+=">"+nr(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function M7(t){return[t.read_shift(4),t.read_shift(4)]}function L7(t,e){var r=[],n=!1;return ks(t,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function P7(t,e){return e||(e=ye(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var V7=KF;function B7(t){var e=fa();Oe(e,159,P7(t));for(var r=0;r<t.length;++r)Oe(e,19,V7(t[r]));return Oe(e,160),e.end()}function Ib(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function vs(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function U7(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=vs(t,4),e.U=vs(t,4),e.W=vs(t,4),e}function j7(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function z7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(j7(t));return e}function H7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function G7(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=vs(t,4),e.U=vs(t,4),e.W=vs(t,4),e}function q7(t){var e=G7(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Db(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Ob(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function X7(t){var e=vs(t);switch(e.Minor){case 2:return[e.Minor,W7(t)];case 3:return[e.Minor,K7()];case 4:return[e.Minor,$7(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function W7(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Db(t,r),a=Ob(t,t.length-t.l);return{t:"Std",h:n,v:a}}function K7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $7(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Gn,function(o){var l=ut(o);switch(Xi(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function Y7(t,e){var r={},n=r.EncryptionVersionInfo=vs(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Db(t,a),e-=a,r.EncryptionVerifier=Ob(t,e),r}function Q7(t){var e={},r=e.EncryptionVersionInfo=vs(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Jx(t){var e=0,r,n=Ib(t),a=n.length+1,o,l,u,h,d;for(r=Do(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^l;return e^52811}var Fb=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},o=function(l){for(var u=e[l.length-1],h=104,d=l.length-1;d>=0;--d)for(var p=l[d],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(l){for(var u=Ib(l),h=o(u),d=u.length,p=Do(16),v=0;v!=16;++v)p[v]=0;var _,y,S;for((d&1)===1&&(_=h>>8,p[d]=a(t[0],_),--d,_=h&255,y=u[u.length-1],p[d]=a(y,_));d>0;)--d,_=h>>8,p[d]=a(u[d],_),--d,_=h&255,p[d]=a(u[d],_);for(d=15,S=15-u.length;S>0;)_=h>>8,p[d]=a(t[S],_),--d,--S,_=h&255,p[d]=a(u[d],_),--d,--S;return p}})(),J7=function(t,e,r,n,a){a||(a=e),n||(n=Fb(t));var o,l;for(o=0;o!=e.length;++o)l=e[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},Z7=function(t){var e=0,r=Fb(t);return function(n){var a=J7("",n,e,r);return e=a[1],a[0]}};function eL(t,e,r,n){var a={key:Yr(t),verificationBytes:Yr(t)};return r.password&&(a.verifier=Jx(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Z7(r.password)),a}function tL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Q7(t):n.Data=Y7(t,e),n}function rL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?tL(t,e-2,n):eL(t,r.biff>=8?e:e-2,r,n),n}var Mb=(function(){function t(a,o){switch(o.type){case"base64":return e(Ia(a),o);case"binary":return e(a,o);case"buffer":return e(wt&&Buffer.isBuffer(a)?a.toString("binary"):Vo(a),o);case"array":return e(Rl(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,y=0,S,w=-1;S=_.exec(p);){switch(S[0]){case"\\cell":var b=p.slice(y,_.lastIndex-S[0].length);if(b[0]==" "&&(b=b.slice(1)),++w,b.length){var F={v:b,t:"s"};Array.isArray(u)?u[v][w]=F:u[ot({r:v,c:w})]=F}break}y=_.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=vt(d),u}function r(a,o){return Bo(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=Bt(a["!ref"]),u,h=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=ot({r:d,c:p});u=h?(a[d]||[])[p]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Ss(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function nL(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Wf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function aL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),l=a-o;if(l===0)return[0,0,e];var u=0,h=0,d=a+o;switch(h=l/(d>1?2-d:d),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,h,d/2]}function iL(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,l[0]+=a,l[1]+=h;break;case 1:h=a*(2-u),l[0]+=h,l[1]+=a;break;case 2:h=a*(u-2),l[1]+=a,l[2]+=h;break;case 3:h=a*(4-u),l[1]+=h,l[2]+=a;break;case 4:h=a*(u-4),l[2]+=a,l[0]+=h;break;case 5:h=a*(6-u),l[2]+=h,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function zd(t,e){if(e===0)return t;var r=aL(nL(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Wf(iL(r))}var Lb=6,sL=15,oL=1,Bn=Lb;function Kf(t){return Math.floor((t+Math.round(128/Bn)/256)*Bn)}function $f(t){return Math.floor((t-5)/Bn*100+.5)/100}function Hd(t){return Math.round((t*Bn+5)/Bn*256)/256}function jp(t){return Hd($f(Kf(t)))}function Zx(t){var e=Math.abs(t-jp(t)),r=Bn;if(e>.005)for(Bn=oL;Bn<sL;++Bn)Math.abs(t-jp(t))<=e&&(e=Math.abs(t-jp(t)),r=Bn);Bn=r}function Oo(t){t.width?(t.wpx=Kf(t.width),t.wch=$f(t.wpx),t.MDW=Bn):t.wpx?(t.wch=$f(t.wpx),t.width=Hd(t.wch),t.MDW=Bn):typeof t.wch=="number"&&(t.width=Hd(t.wch),t.wpx=Kf(t.width),t.MDW=Bn),t.customWidth&&delete t.customWidth}var lL=96,Pb=lL;function Yf(t){return t*96/Pb}function ru(t){return t*Pb/96}var cL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function uL(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(Gn)||[]).forEach(function(l){var u=ut(l);switch(Xi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=mr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=mr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function fL(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(Gn)||[]).forEach(function(l){var u=ut(l);switch(Xi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function hL(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(Gn)||[]).forEach(function(l){var u=ut(l);switch(Xi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=cr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?mr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?mr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?mr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?mr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?mr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?mr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?mr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=kx[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=mr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=_l[a.color.index];a.color.index==81&&(h=_l[1]),h||(h=_l[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=zd(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function dL(t,e,r){e.NumberFmt=[];for(var n=Rr(st),a=0;a<n.length;++a)e.NumberFmt[n[a]]=st[n[a]];var o=t[0].match(Gn);if(o)for(a=0;a<o.length;++a){var l=ut(o[a]);switch(Xi(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Vt(cr(l.formatCode)),h=parseInt(l.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}xs(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function mL(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:nr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Yh=["numFmtId","fillId","fontId","borderId","xfId"],Qh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pL(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Gn)||[]).forEach(function(o){var l=ut(o),u=0;switch(Xi(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<Yh.length;++u)n[Yh[u]]&&(n[Yh[u]]=parseInt(n[Yh[u]],10));for(u=0;u<Qh.length;++u)n[Qh[u]]&&(n[Qh[u]]=mr(n[Qh[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};l.vertical&&(h.vertical=l.vertical),l.horizontal&&(h.horizontal=l.horizontal),l.textRotation!=null&&(h.textRotation=l.textRotation),l.indent&&(h.indent=l.indent),l.wrapText&&(h.wrapText=mr(l.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function gL(t){var e=[];return e[e.length]=Be("cellXfs",null),t.forEach(function(r){e[e.length]=Be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var xL=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&dL(v,p,d),(v=u.match(a))&&hL(v,p,h,d),(v=u.match(n))&&fL(v,p,h,d),(v=u.match(o))&&uL(v,p,h,d),(v=u.match(r))&&pL(v,p,d),p}})();function Vb(t,e){var r=[Br,Be("styleSheet",null,{xmlns:Pl[0],"xmlns:vt":an.vt})],n;return t.SSF&&(n=mL(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=gL(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function vL(t,e){var r=t.read_shift(2),n=jn(t);return[r,n]}function _L(t,e,r){r||(r=ye(6+4*e.length)),r.write_shift(2,t),pn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function yL(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=tM(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=eM(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jn(t),n}function TL(t,e){e||(e=ye(153)),e.write_shift(2,t.sz*20),rM(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Bd(t.color,e);var n=0;return n=2,e.write_shift(1,n),pn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var wL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zp,EL=Hn;function uE(t,e){e||(e=ye(84)),zp||(zp=vm(wL));var r=zp[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Bd({auto:1},e),Bd({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function SL(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function Bb(t,e,r){r||(r=ye(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function cf(t,e){return e||(e=ye(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var AL=Hn;function bL(t,e){return e||(e=ye(51)),e.write_shift(1,0),cf(null,e),cf(null,e),cf(null,e),cf(null,e),cf(null,e),e.length>e.l?e.slice(0,e.l):e}function kL(t,e){return e||(e=ye(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Vd(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CL(t,e,r){var n=ye(2052);return n.write_shift(4,t),Vd(e,n),Vd(r,n),n.length>n.l?n.slice(0,n.l):n}function NL(t,e,r){var n={};n.NumberFmt=[];for(var a in st)n.NumberFmt[a]=st[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return ks(t,function(h,d,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],xs(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=zd(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(d.T>0)o.push(p);else if(d.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function RL(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Oe(t,615,yi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Oe(t,44,_L(a,e[a]))}),Oe(t,616))}}function IL(t){var e=1;Oe(t,611,yi(e)),Oe(t,43,TL({sz:12,color:{theme:1},name:"Calibri",family:2})),Oe(t,612)}function DL(t){var e=2;Oe(t,603,yi(e)),Oe(t,45,uE({patternType:"none"})),Oe(t,45,uE({patternType:"gray125"})),Oe(t,604)}function OL(t){var e=1;Oe(t,613,yi(e)),Oe(t,46,bL()),Oe(t,614)}function FL(t){var e=1;Oe(t,626,yi(e)),Oe(t,47,Bb({numFmtId:0},65535)),Oe(t,627)}function ML(t,e){Oe(t,617,yi(e.length)),e.forEach(function(r){Oe(t,47,Bb(r,0))}),Oe(t,618)}function LL(t){var e=1;Oe(t,619,yi(e)),Oe(t,48,kL({xfId:0,name:"Normal"})),Oe(t,620)}function PL(t){var e=0;Oe(t,505,yi(e)),Oe(t,506)}function VL(t){var e=0;Oe(t,508,CL(e,"TableStyleMedium9","PivotStyleMedium4")),Oe(t,509)}function BL(t,e){var r=fa();return Oe(r,278),RL(r,t.SSF),IL(r),DL(r),OL(r),FL(r),ML(r,e.cellXfs),LL(r),PL(r),VL(r),Oe(r,279),r.end()}var UL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function jL(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Gn)||[]).forEach(function(a){var o=ut(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[UL.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function zL(){}function HL(){}var GL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,XL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function WL(t,e,r){e.themeElements={};var n;[["clrScheme",GL,jL],["fontScheme",qL,zL],["fmtScheme",XL,HL]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var KL=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ub(t,e){(!t||t.length===0)&&(t=ev());var r,n={};if(!(r=t.match(KL)))throw new Error("themeElements not found in theme");return WL(r[0],n,e),n.raw=t,n}function ev(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Br];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $L(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=DA(o,{type:"array"})}catch{return}var u=Na(l,"theme/theme/theme1.xml",!0);if(u)return Ub(u,r)}}function YL(t){return t.read_shift(4)}function QL(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=JL(t,4);break;case 2:e.xclrValue=_b(t);break;case 3:e.xclrValue=YL(t);break;case 4:t.l+=4;break}return t.l+=8,e}function JL(t,e){return Hn(t,e)}function ZL(t,e){return Hn(t,e)}function eP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=QL(t);break;case 6:n[1]=ZL(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function tP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(eP(t,r-t.l));return{ixfe:n,ext:o}}function rP(t,e){e.forEach(function(r){r[0]})}function nP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:jn(t)}}function aP(t){var e=ye(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),pn(t.name,e),e.slice(0,e.l)}function iP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function sP(t){var e=ye(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function oP(t,e){var r=ye(8+2*e.length);return r.write_shift(4,t),pn(e,r),r.slice(0,r.l)}function lP(t){return t.l+=4,t.read_shift(4)!=0}function cP(t,e){var r=ye(8);return r.write_shift(4,t),r.write_shift(4,1),r}function uP(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return ks(t,function(h,d,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function fP(){var t=fa();return Oe(t,332),Oe(t,334,yi(1)),Oe(t,335,aP({name:"XLDAPR",version:12e4,flags:3496657072})),Oe(t,336),Oe(t,339,oP(1,"XLDAPR")),Oe(t,52),Oe(t,35,yi(514)),Oe(t,4096,yi(0)),Oe(t,4097,Ka(1)),Oe(t,36),Oe(t,53),Oe(t,340),Oe(t,337,cP(1)),Oe(t,51,sP([[1,0]])),Oe(t,338),Oe(t,333),t.end()}function hP(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,l;return t.replace(Gn,function(u){var h=ut(u);switch(Xi(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function jb(){var t=[Br];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function dP(t){var e=[];if(!t)return e;var r=1;return(t.match(Gn)||[]).forEach(function(n){var a=ut(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function mP(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function pP(t,e,r){var n=[];return ks(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function gP(t,e,r,n){if(!t)return t;var a=n||{},o=!1;ks(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function xP(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Pc=1024;function zb(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":ba.v,"xmlns:o":ba.o,"xmlns:x":ba.x,"xmlns:mv":ba.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Pc<t*1e3;)Pc+=1e3;return e.forEach(function(o){var l=Sr(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",h,u),p={on:"t",obscured:"t"};++Pc,a=a.concat(["<v:shape"+Gf({id:"_x0000_s"+Pc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,p),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),bn("x:AutoFill","False"),bn("x:Row",String(l.r)),bn("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function fE(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(l){var u=Sr(l.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[l.ref]=o;var h=Bt(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=vt(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:r};l.h&&(p.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function vP(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=ut(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Sr(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Qx(v[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function Hb(t){var e=[Br,Be("comments",null,{xmlns:Pl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var o=nr(a.a);r.indexOf(o)==-1&&(r.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(a=r.indexOf(nr(h.a))),o.push(h.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(bn("t",nr(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(bn("t",nr(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function _P(t,e){var r=[],n=!1,a={},o=0;return t.replace(Gn,function(u,h){var d=ut(u);switch(Xi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":a.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function yP(t,e,r){var n=[Br,Be("ThreadedComments",null,{xmlns:an.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var h={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=h.id:h.parentId=o,l.ID=h.id,l.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Be("threadedComment",bn("text",l.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function TP(t,e){var r=[],n=!1;return t.replace(Gn,function(o){var l=ut(o);switch(Xi(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function wP(t){var e=[Br,Be("personList",null,{xmlns:an.TCMNT,"xmlns:x":Pl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function EP(t){var e={};e.iauthor=t.read_shift(4);var r=jl(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function SP(t,e){return e==null&&(e=ye(36)),e.write_shift(4,t[1].iauthor),du(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var AP=jn;function bP(t){return pn(t.slice(0,54))}function kP(t,e){var r=[],n=[],a={},o=!1;return ks(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function CP(t){var e=fa(),r=[];return Oe(e,628),Oe(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Oe(e,632,bP(a.a)))})}),Oe(e,631),Oe(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:Sr(n[0]),e:Sr(n[0])};Oe(e,635,SP([o,a])),a.t&&a.t.length>0&&Oe(e,637,YF(a)),Oe(e,636),delete a.iauthor})}),Oe(e,634),Oe(e,629),e.end()}var NP="application/vnd.ms-office.vbaProject";function RP(t){var e=tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),tt.write(e)}function IP(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&tt.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var Gb=["xlsb","xlsm","xlam","biff8","xla"];function DP(){return{"!type":"dialog"}}function OP(){return{"!type":"dialog"}}function FP(){return{"!type":"macro"}}function MP(){return{"!type":"macro"}}var qc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,l){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,a+(u?"":"$")+Er(p)+(h?"":"$")+Vr(d)}return function(a,o){return e=o,a.replace(t,r)}})(),tv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rv=(function(){return function(e,r){return e.replace(tv,function(n,a,o,l,u,h){var d=zx(l)-(o?0:r.c),p=jx(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=d==0?"":o?d+1:"["+d+"]";return a+"R"+v+"C"+_})}})();function qb(t,e){return t.replace(tv,function(r,n,a,o,l,u){return n+(a=="$"?a+o:Er(zx(o)+e.c))+(l=="$"?l+u:Vr(jx(u)+e.r))})}function LP(t,e,r){var n=ha(e),a=n.s,o=Sr(r),l={r:o.r-a.r,c:o.c-a.c};return qb(t,l)}function PP(t){return t.length!=1}function hE(t){return t.replace(/_xlfn\./g,"")}function Wr(t){t.l+=1}function Fo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Xb(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Wb(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),l=Fo(t),u=Fo(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function Wb(t){var e=Fo(t),r=Fo(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function VP(t,e,r){if(r.biff<8)return Wb(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=Fo(t),l=Fo(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function Kb(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return BP(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Fo(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function BP(t){var e=Fo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function UP(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jP(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return zP(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function zP(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function HP(t,e,r){var n=(t[t.l++]&96)>>5,a=Xb(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function GP(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=Xb(t,o,r);return[n,a,l]}function qP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function XP(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function WP(t,e,r){var n=(t[t.l++]&96)>>5,a=VP(t,e-1,r);return[n,a]}function KP(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function dE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function $P(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function YP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function QP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function JP(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function ZP(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function $b(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function eV(t){return t.read_shift(2),$b(t)}function tV(t){return t.read_shift(2),$b(t)}function rV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=Kb(t,0,r);return[n,a]}function nV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=jP(t,0,r);return[n,a]}function aV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=Kb(t,0,r);return[n,a,o]}function iV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[lB[a],Jb[a],n]}function sV(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:oV(t);return[a,(o[0]===0?Jb:oB)[o[1]]]}function oV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function lV(t,e,r){t.l+=r&&r.biff==2?3:4}function cV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function uV(t){return t.l++,Cs[t.read_shift(1)]}function fV(t){return t.l++,t.read_shift(2)}function hV(t){return t.l++,t.read_shift(1)!==0}function dV(t){return t.l++,Un(t)}function mV(t,e,r){return t.l++,d0(t,e-1,r)}function pV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Cs[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Un(t);break;case 2:r[1]=zl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function gV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?jl:Tm)(t));return a}function xV(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=pV(t,r.biff);return l}function vV(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function _V(t,e,r){if(r.biff==5)return yV(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function yV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function TV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function wV(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function EV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function SV(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var AV=Hn,bV=Hn,kV=Hn;function p0(t,e,r){return t.l+=2,[UP(t)]}function nv(t){return t.l+=6,[]}var CV=p0,NV=nv,RV=nv,IV=p0;function Yb(t){return t.l+=2,[Yr(t),t.read_shift(2)&1]}var DV=p0,OV=Yb,FV=nv,MV=p0,LV=p0,PV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function VV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),l=PV[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:o}}function BV(t){return t.l+=2,[t.read_shift(4)]}function UV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function jV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function zV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function HV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function GV(t){return t.l+=4,[0,0]}var mE={1:{n:"PtgExp",f:cV},2:{n:"PtgTbl",f:kV},3:{n:"PtgAdd",f:Wr},4:{n:"PtgSub",f:Wr},5:{n:"PtgMul",f:Wr},6:{n:"PtgDiv",f:Wr},7:{n:"PtgPower",f:Wr},8:{n:"PtgConcat",f:Wr},9:{n:"PtgLt",f:Wr},10:{n:"PtgLe",f:Wr},11:{n:"PtgEq",f:Wr},12:{n:"PtgGe",f:Wr},13:{n:"PtgGt",f:Wr},14:{n:"PtgNe",f:Wr},15:{n:"PtgIsect",f:Wr},16:{n:"PtgUnion",f:Wr},17:{n:"PtgRange",f:Wr},18:{n:"PtgUplus",f:Wr},19:{n:"PtgUminus",f:Wr},20:{n:"PtgPercent",f:Wr},21:{n:"PtgParen",f:Wr},22:{n:"PtgMissArg",f:Wr},23:{n:"PtgStr",f:mV},26:{n:"PtgSheet",f:UV},27:{n:"PtgEndSheet",f:jV},28:{n:"PtgErr",f:uV},29:{n:"PtgBool",f:hV},30:{n:"PtgInt",f:fV},31:{n:"PtgNum",f:dV},32:{n:"PtgArray",f:KP},33:{n:"PtgFunc",f:iV},34:{n:"PtgFuncVar",f:sV},35:{n:"PtgName",f:vV},36:{n:"PtgRef",f:rV},37:{n:"PtgArea",f:HP},38:{n:"PtgMemArea",f:TV},39:{n:"PtgMemErr",f:AV},40:{n:"PtgMemNoMem",f:bV},41:{n:"PtgMemFunc",f:wV},42:{n:"PtgRefErr",f:EV},43:{n:"PtgAreaErr",f:qP},44:{n:"PtgRefN",f:nV},45:{n:"PtgAreaN",f:WP},46:{n:"PtgMemAreaN",f:zV},47:{n:"PtgMemNoMemN",f:HV},57:{n:"PtgNameX",f:_V},58:{n:"PtgRef3d",f:aV},59:{n:"PtgArea3d",f:GP},60:{n:"PtgRefErr3d",f:SV},61:{n:"PtgAreaErr3d",f:XP},255:{}},qV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},XV={1:{n:"PtgElfLel",f:Yb},2:{n:"PtgElfRw",f:MV},3:{n:"PtgElfCol",f:CV},6:{n:"PtgElfRwV",f:LV},7:{n:"PtgElfColV",f:IV},10:{n:"PtgElfRadical",f:DV},11:{n:"PtgElfRadicalS",f:FV},13:{n:"PtgElfColS",f:NV},15:{n:"PtgElfColSV",f:RV},16:{n:"PtgElfRadicalLel",f:OV},25:{n:"PtgList",f:VV},29:{n:"PtgSxName",f:BV},255:{}},WV={0:{n:"PtgAttrNoop",f:GV},1:{n:"PtgAttrSemi",f:ZP},2:{n:"PtgAttrIf",f:QP},4:{n:"PtgAttrChoose",f:$P},8:{n:"PtgAttrGoto",f:YP},16:{n:"PtgAttrSum",f:lV},32:{n:"PtgAttrBaxcel",f:dE},33:{n:"PtgAttrBaxcel",f:dE},64:{n:"PtgAttrSpace",f:eV},65:{n:"PtgAttrSpaceSemi",f:tV},128:{n:"PtgAttrIfError",f:JP},255:{}};function g0(t,e,r,n){if(n.biff<8)return Hn(t,e);for(var a=t.l+e,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=xV(t,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=gV(t,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&o.push(Hn(t,e)),o}function x0(t,e,r){for(var n=t.l+e,a,o,l=[];n!=t.l;)e=n-t.l,o=t[t.l],a=mE[o]||mE[qV[o]],(o===24||o===25)&&(a=(o===24?XV:WV)[t[t.l+1]]),!a||!a.f?Hn(t,e):l.push([a.n,a.f(t,e,r)]);return l}function KV(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var l=n[o];l?l[0]===2?a.push('"'+l[1].replace(/"/g,'""')+'"'):a.push(l[1]):a.push("")}e.push(a.join(","))}return e.join(";")}var $V={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function YV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Qb(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function pE(t,e,r){var n=Qb(t,e,r);return n=="#REF"?n:YV(n,r)}function Pn(t,e,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],h,d,p,v=0,_=0,y,S="";if(!t[0]||!t[0][0])return"";for(var w=-1,b="",F=0,z=t[0].length;F<z;++F){var N=t[0][F];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:b=Cr(" ",t[0][w][1][1]);break;case 1:b=Cr("\r",t[0][w][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}d=d+b,w=-1}u.push(d+$V[N[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Sf(N[1][1],l,a),u.push(Af(p,o));break;case"PtgRefN":p=r?Sf(N[1][1],r,a):N[1][1],u.push(Af(p,o));break;case"PtgRef3d":v=N[1][1],p=Sf(N[1][2],l,a),S=pE(n,v,a),u.push(S+"!"+Af(p,o));break;case"PtgFunc":case"PtgFuncVar":var K=N[1][0],te=N[1][1];K||(K=0),K&=127;var J=K==0?[]:u.slice(-K);u.length-=K,te==="User"&&(te=J.shift()),u.push(te+"("+J.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":y=Gw(N[1][1],r?{s:r}:l,a),u.push(Vp(y,a));break;case"PtgArea":y=Gw(N[1][1],l,a),u.push(Vp(y,a));break;case"PtgArea3d":v=N[1][1],y=N[1][2],S=pE(n,v,a),u.push(S+"!"+Vp(y,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=N[1][2];var k=(n.names||[])[_-1]||(n[0]||[])[_],I=k?k.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var R=N[1][1];_=N[1][2];var M;if(a.biff<=5)R<0&&(R=-R),n[R]&&(M=n[R][_]);else{var O="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][_]&&n[R][_].itab>0&&(O=n.SheetNames[n[R][_].itab-1]+"!"):O=n.SheetNames[_-1]+"!"),n[R]&&n[R][_])O+=n[R][_].Name;else if(n[0]&&n[0][_])O+=n[0][_].Name;else{var D=(Qb(n,R,a)||"").split(";;");D[_-1]?O=D[_-1]:O+="SH33TJSERRX"}u.push(O);break}M||(M={Name:"SH33TJSERRY"}),u.push(M.Name);break;case"PtgParen":var V="(",_e=")";if(w>=0){switch(b="",t[0][w][1][0]){case 2:V=Cr(" ",t[0][w][1][1])+V;break;case 3:V=Cr("\r",t[0][w][1][1])+V;break;case 4:_e=Cr(" ",t[0][w][1][1])+_e;break;case 5:_e=Cr("\r",t[0][w][1][1])+_e;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(V+u.pop()+_e);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:N[1][1],r:N[1][0]};var Te={c:r.c,r:r.r};if(n.sharedf[ot(p)]){var ne=n.sharedf[ot(p)];u.push(Pn(ne,l,Te,n,a))}else{var oe=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Pn(d[1],l,Te,n,a)),oe=!0;break}oe||u.push(N[1])}break;case"PtgArray":u.push("{"+KV(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=F;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&ke.indexOf(t[0][F][0])==-1){N=t[0][w];var ae=!0;switch(N[1][0]){case 4:ae=!1;case 0:b=Cr(" ",N[1][1]);break;case 5:ae=!1;case 1:b=Cr("\r",N[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((ae?b:"")+u.pop()+(ae?"":b)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function QV(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Hn(t,e-2)];var u=x0(t,l,r);return e!==l+a&&(o=g0(t,e-l-a,u,r)),t.l=n,[u,o]}function JV(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Hn(t,e-2)];var u=x0(t,l,r);return e!==l+a&&(o=g0(t,e-l-a,u,r)),t.l=n,[u,o]}function ZV(t,e,r,n){var a=t.l+e,o=x0(t,n,r),l;return a!==t.l&&(l=g0(t,a-t.l,o,r)),[o,l]}function eB(t,e,r){var n=t.l+e,a,o=t.read_shift(2),l=x0(t,o,r);return o==65535?[[],Hn(t,e-2)]:(e!==o+2&&(a=g0(t,n-o-2,l,r)),[l,a])}function tB(t){var e;if(ms(t,t.l+6)!==65535)return[Un(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function rB(t){if(t==null){var e=ye(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Il(t);return Il(0)}function Hp(t,e,r){var n=t.l+e,a=Wi(t);r.biff==2&&++t.l;var o=tB(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=JV(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function nB(t,e,r,n,a){var o=Ol(e,r,a),l=rB(t.v),u=ye(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=ye(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var v=mn([o,l,u,d]);return v}function wm(t,e,r){var n=t.read_shift(4),a=x0(t,n,r),o=t.read_shift(4),l=o>0?g0(t,o,a,r):null;return[a,l]}var aB=wm,Em=wm,iB=wm,sB=wm,oB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Jb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function cB(t){var e="of:="+t.replace(tv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Gp(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function uB(t){return t.replace(/\./,"!")}var kf={},Xc={},Cf=typeof Map<"u";function av(t,e,r){var n=0,a=t.length;if(r){if(Cf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var o=Cf?r.get(e):r[e];n<o.length;++n)if(t[o[n]].t===e)return t.Count++,o[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Cf?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Sm(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Bn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=$f(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Hd(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function wl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Uo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){xs(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===n)return a;return t[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function Zb(t,e,r,n,a,o){try{n.cellNF&&(t.z=st[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=xr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(st[e]==null&&xs(oF[e]||"General",e),t.t==="e")t.w=t.w||Cs[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=zf(t.v);else if(t.t==="d"){var l=on(t.v);(l|0)===l?t.w=l.toString(10):t.w=zf(l)}else{if(t.v===void 0)return"";t.w=Nl(t.v,Xc)}else t.t==="d"?t.w=Qa(e,on(t.v),Xc):t.w=Qa(e,t.v,Xc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=zd(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=zd(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function fB(t,e,r){if(t&&t["!ref"]){var n=Bt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function hB(t,e){var r=Bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=vt(r))}var dB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,mB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,pB=/<(?:\w:)?hyperlink [^>]*>/mg,gB=/"(\w*:\w*)"/,xB=/<(?:\w:)?col\b[^>]*[\/]?>/g,vB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_B=/<(?:\w:)?pageMargins[^>]*\/>/g,ek=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,TB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wB(t,e,r,n,a,o,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",v=t.match(mB);v?(d=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):d=p=t;var _=d.match(ek);_?iv(_[0],u,a,r):(_=d.match(yB))&&SB(_[0],_[1]||"",u,a,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var S=d.slice(y,y+50).match(gB);S&&hB(u,S[1])}var w=d.match(TB);w&&w[1]&&PB(w[1],a);var b=[];if(e.cellStyles){var F=d.match(xB);F&&DB(b,F)}v&&UB(v[1],u,e,h,o,l);var z=p.match(vB);z&&(u["!autofilter"]=FB(z[0]));var N=[],K=p.match(dB);if(K)for(y=0;y!=K.length;++y)N[y]=Bt(K[y].slice(K[y].indexOf('"')+1));var te=p.match(pB);te&&NB(u,te,n);var J=p.match(_B);if(J&&(u["!margins"]=RB(ut(J[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=vt(h)),e.sheetRows>0&&u["!ref"]){var k=Bt(u["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>h.e.r&&(k.e.r=h.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>h.e.c&&(k.e.c=h.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),u["!fullref"]=u["!ref"],u["!ref"]=vt(k))}return b.length>0&&(u["!cols"]=b),N.length>0&&(u["!merges"]=N),u}function EB(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+vt(t[r])+'"/>';return e+"</mergeCells>"}function iv(t,e,r,n){var a=ut(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Vt(cr(a.codeName)))}function SB(t,e,r,n,a){iv(t.slice(0,t.indexOf(">")),r,n,a)}function AB(t,e,r,n,a){var o=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}o=!0,l.codeName=Pi(nr(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+Be("outlinePr",null,d)}!o&&!u||(a[a.length]=Be("sheetPr",u,l))}var bB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CB(t){var e={sheet:1};return bB.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),kB.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Jx(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function NB(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=ut(cr(e[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Vt(o.location))):(o.Target="#"+Vt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Bt(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=ot({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=o)}}}function RB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function IB(t){return wl(t),Be("pageMargins",null,t)}function DB(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=ut(e[n],!0);a.hidden&&(a.hidden=mr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Zx(a.width)),Oo(a);o<=l;)t[o++]=vr(a)}}function OB(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Be("col",null,Sm(a,n)));return r[r.length]="</cols>",r.join("")}function FB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function MB(t,e,r,n){var a=typeof t.ref=="string"?t.ref:vt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ha(a);l.s.r==l.e.r&&(l.e.r=ha(e["!ref"]).e.r,a=vt(l));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Be("autoFilter",null,{ref:a})}var LB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function PB(t,e){e.Views||(e.Views=[{}]),(t.match(LB)||[]).forEach(function(r,n){var a=ut(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),mr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function VB(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function BB(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Cs[t.v];break;case"d":n&&n.cellDates?a=xr(t.v,-1).toISOString():(t=vr(t),t.t="n",a=""+(t.v=on(xr(t.v)))),typeof t.z>"u"&&(t.z=st[14]);break;default:a=t.v;break}var u=bn("v",nr(a)),h={r:e},d=Uo(n.cellXfs,t,n);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=bn("v",""+av(n.Strings,t.v,n.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=o&&(t.t=o,t.v=l),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Be("f",nr(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),Be("c",u,h)}var UB=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Hf("v"),l=Hf("f");return function(h,d,p,v,_,y){for(var S=0,w="",b=[],F=[],z=0,N=0,K=0,te="",J,k,I=0,R=0,M,O,D=0,V=0,_e=Array.isArray(y.CellXf),Te,ne=[],oe=[],ke=Array.isArray(d),ae=[],Le={},Q=!1,L=!!p.sheetStubs,W=h.split(e),G=0,Z=W.length;G!=Z;++G){w=W[G].trim();var le=w.length;if(le!==0){var Se=0;e:for(S=0;S<le;++S)switch(w[S]){case">":if(w[S-1]!="/"){++S;break e}if(p&&p.cellStyles){if(k=ut(w.slice(Se,S),!0),I=k.r!=null?parseInt(k.r,10):I+1,R=-1,p.sheetRows&&p.sheetRows<I)continue;Le={},Q=!1,k.ht&&(Q=!0,Le.hpt=parseFloat(k.ht),Le.hpx=ru(Le.hpt)),k.hidden=="1"&&(Q=!0,Le.hidden=!0),k.outlineLevel!=null&&(Q=!0,Le.level=+k.outlineLevel),Q&&(ae[I-1]=Le)}break;case"<":Se=S;break}if(Se>=S)break;if(k=ut(w.slice(Se,S),!0),I=k.r!=null?parseInt(k.r,10):I+1,R=-1,!(p.sheetRows&&p.sheetRows<I)){v.s.r>I-1&&(v.s.r=I-1),v.e.r<I-1&&(v.e.r=I-1),p&&p.cellStyles&&(Le={},Q=!1,k.ht&&(Q=!0,Le.hpt=parseFloat(k.ht),Le.hpx=ru(Le.hpt)),k.hidden=="1"&&(Q=!0,Le.hidden=!0),k.outlineLevel!=null&&(Q=!0,Le.level=+k.outlineLevel),Q&&(ae[I-1]=Le)),b=w.slice(S).split(t);for(var Ne=0;Ne!=b.length&&b[Ne].trim().charAt(0)=="<";++Ne);for(b=b.slice(Ne),S=0;S!=b.length;++S)if(w=b[S].trim(),w.length!==0){if(F=w.match(r),z=S,N=0,K=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,F!=null&&F.length===2){for(z=0,te=F[1],N=0;N!=te.length&&!((K=te.charCodeAt(N)-64)<1||K>26);++N)z=26*z+K;--z,R=z}else++R;for(N=0;N!=w.length&&w.charCodeAt(N)!==62;++N);if(++N,k=ut(w.slice(0,N),!0),k.r||(k.r=ot({r:I-1,c:R})),te=w.slice(N),J={t:""},(F=te.match(o))!=null&&F[1]!==""&&(J.v=Vt(F[1])),p.cellFormula){if((F=te.match(l))!=null&&F[1]!==""){if(J.f=Vt(cr(F[1])).replace(/\r\n/g,`
`),p.xlfn||(J.f=hE(J.f)),F[0].indexOf('t="array"')>-1)J.F=(te.match(a)||[])[1],J.F.indexOf(":")>-1&&ne.push([Bt(J.F),J.F]);else if(F[0].indexOf('t="shared"')>-1){O=ut(F[0]);var Ae=Vt(cr(F[1]));p.xlfn||(Ae=hE(Ae)),oe[parseInt(O.si,10)]=[O,Ae,k.r]}}else(F=te.match(/<f[^>]*\/>/))&&(O=ut(F[0]),oe[O.si]&&(J.f=LP(oe[O.si][1],oe[O.si][2],k.r)));var Ie=Sr(k.r);for(N=0;N<ne.length;++N)Ie.r>=ne[N][0].s.r&&Ie.r<=ne[N][0].e.r&&Ie.c>=ne[N][0].s.c&&Ie.c<=ne[N][0].e.c&&(J.F=ne[N][1])}if(k.t==null&&J.v===void 0)if(J.f||J.F)J.v=0,J.t="n";else if(L)J.t="z";else continue;else J.t=k.t||"n";switch(v.s.c>R&&(v.s.c=R),v.e.c<R&&(v.e.c=R),J.t){case"n":if(J.v==""||J.v==null){if(!L)continue;J.t="z"}else J.v=parseFloat(J.v);break;case"s":if(typeof J.v>"u"){if(!L)continue;J.t="z"}else M=kf[parseInt(J.v,10)],J.v=M.t,J.r=M.r,p.cellHTML&&(J.h=M.h);break;case"str":J.t="s",J.v=J.v!=null?cr(J.v):"",p.cellHTML&&(J.h=Px(J.v));break;case"inlineStr":F=te.match(n),J.t="s",F!=null&&(M=Qx(F[1]))?(J.v=M.t,p.cellHTML&&(J.h=M.h)):J.v="";break;case"b":J.v=mr(J.v);break;case"d":p.cellDates?J.v=xr(J.v,1):(J.v=on(xr(J.v,1)),J.t="n");break;case"e":(!p||p.cellText!==!1)&&(J.w=J.v),J.v=rb[J.v];break}if(D=V=0,Te=null,_e&&k.s!==void 0&&(Te=y.CellXf[k.s],Te!=null&&(Te.numFmtId!=null&&(D=Te.numFmtId),p.cellStyles&&Te.fillId!=null&&(V=Te.fillId))),Zb(J,D,V,p,_,y),p.cellDates&&_e&&J.t=="n"&&uu(st[D])&&(J.t="d",J.v=ym(J.v)),k.cm&&p.xlmeta){var nt=(p.xlmeta.Cell||[])[+k.cm-1];nt&&nt.type=="XLDAPR"&&(J.D=!0)}if(ke){var ee=Sr(k.r);d[ee.r]||(d[ee.r]=[]),d[ee.r][ee.c]=J}else d[k.r]=J}}}}ae.length>0&&(d["!rows"]=ae)}})();function jB(t,e,r,n){var a=[],o=[],l=Bt(t["!ref"]),u="",h,d="",p=[],v=0,_=0,y=t["!rows"],S=Array.isArray(t),w={r:d},b,F=-1;for(_=l.s.c;_<=l.e.c;++_)p[_]=Er(_);for(v=l.s.r;v<=l.e.r;++v){for(o=[],d=Vr(v),_=l.s.c;_<=l.e.c;++_){h=p[_]+d;var z=S?(t[v]||[])[_]:t[h];z!==void 0&&(u=BB(z,h,t,e))!=null&&o.push(u)}(o.length>0||y&&y[v])&&(w={r:d},y&&y[v]&&(b=y[v],b.hidden&&(w.hidden=1),F=-1,b.hpx?F=Yf(b.hpx):b.hpt&&(F=b.hpt),F>-1&&(w.ht=F,w.customHeight=1),b.level&&(w.outlineLevel=b.level)),a[a.length]=Be("row",o.join(""),w))}if(y)for(;v<y.length;++v)y&&y[v]&&(w={r:v+1},b=y[v],b.hidden&&(w.hidden=1),F=-1,b.hpx?F=Yf(b.hpx):b.hpt&&(F=b.hpt),F>-1&&(w.ht=F,w.customHeight=1),b.level&&(w.outlineLevel=b.level),a[a.length]=Be("row","",w));return a.join("")}function tk(t,e,r,n){var a=[Br,Be("worksheet",null,{xmlns:Pl[0],"xmlns:r":an.r})],o=r.SheetNames[t],l=0,u="",h=r.Sheets[o];h==null&&(h={});var d=h["!ref"]||"A1",p=Bt(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=vt(p)}n||(n={}),h["!comments"]=[];var v=[];AB(h,r,t,e,a),a[a.length]=Be("dimension",null,{ref:d}),a[a.length]=VB(h,e,t,r),e.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(a[a.length]=OB(h,h["!cols"])),a[l=a.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=jB(h,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),h["!protect"]&&(a[a.length]=CB(h["!protect"])),h["!autofilter"]!=null&&(a[a.length]=MB(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(a[a.length]=EB(h["!merges"]));var _=-1,y,S=-1;return h["!links"].length>0&&(a[a.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(S=rr(n,-1,nr(w[1].Target).replace(/#.*$/,""),Et.HLINK),y["r:id"]="rId"+S),(_=w[1].Target.indexOf("#"))>-1&&(y.location=nr(w[1].Target.slice(_+1))),w[1].Tooltip&&(y.tooltip=nr(w[1].Tooltip)),a[a.length]=Be("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(a[a.length]=IB(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=bn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(S=rr(n,-1,"../drawings/drawing"+(t+1)+".xml",Et.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+S}),h["!drawing"]=v),h["!comments"].length>0&&(S=rr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Et.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+S}),h["!legacy"]=S),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function zB(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function HB(t,e,r){var n=ye(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var o=320;a.hpx?o=Yf(a.hpx)*20:a.hpt&&(o=a.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,_=-1,y=p<<10;y<p+1<<10;++y){d.c=y;var S=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ot(d)];S&&(v<0&&(v=y),_=y)}v<0||(++u,n.write_shift(4,v),n.write_shift(4,_))}var w=n.l;return n.l=h,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function GB(t,e,r,n){var a=HB(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Oe(t,0,a)}var qB=jl,XB=du;function WB(){}function KB(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=QF(t),r}function $B(t,e,r){r==null&&(r=ye(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Bd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),QA(t,r),r.slice(0,r.l)}function YB(t){var e=Ja(t);return[e]}function QB(t,e,r){return r==null&&(r=ye(8)),Vl(e,r)}function JB(t){var e=Bl(t);return[e]}function ZB(t,e,r){return r==null&&(r=ye(4)),Ul(e,r)}function eU(t){var e=Ja(t),r=t.read_shift(1);return[e,r,"b"]}function tU(t,e,r){return r==null&&(r=ye(9)),Vl(e,r),r.write_shift(1,t.v?1:0),r}function rU(t){var e=Bl(t),r=t.read_shift(1);return[e,r,"b"]}function nU(t,e,r){return r==null&&(r=ye(5)),Ul(e,r),r.write_shift(1,t.v?1:0),r}function aU(t){var e=Ja(t),r=t.read_shift(1);return[e,r,"e"]}function iU(t,e,r){return r==null&&(r=ye(9)),Vl(e,r),r.write_shift(1,t.v),r}function sU(t){var e=Bl(t),r=t.read_shift(1);return[e,r,"e"]}function oU(t,e,r){return r==null&&(r=ye(8)),Ul(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function lU(t){var e=Ja(t),r=t.read_shift(4);return[e,r,"s"]}function cU(t,e,r){return r==null&&(r=ye(12)),Vl(e,r),r.write_shift(4,e.v),r}function uU(t){var e=Bl(t),r=t.read_shift(4);return[e,r,"s"]}function fU(t,e,r){return r==null&&(r=ye(8)),Ul(e,r),r.write_shift(4,e.v),r}function hU(t){var e=Ja(t),r=Un(t);return[e,r,"n"]}function dU(t,e,r){return r==null&&(r=ye(16)),Vl(e,r),Il(t.v,r),r}function rk(t){var e=Bl(t),r=Un(t);return[e,r,"n"]}function mU(t,e,r){return r==null&&(r=ye(12)),Ul(e,r),Il(t.v,r),r}function pU(t){var e=Ja(t),r=Xx(t);return[e,r,"n"]}function gU(t,e,r){return r==null&&(r=ye(12)),Vl(e,r),JA(t.v,r),r}function xU(t){var e=Bl(t),r=Xx(t);return[e,r,"n"]}function vU(t,e,r){return r==null&&(r=ye(8)),Ul(e,r),JA(t.v,r),r}function _U(t){var e=Ja(t),r=Hx(t);return[e,r,"is"]}function yU(t){var e=Ja(t),r=jn(t);return[e,r,"str"]}function TU(t,e,r){return r==null&&(r=ye(12+4*t.v.length)),Vl(e,r),pn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function wU(t){var e=Bl(t),r=jn(t);return[e,r,"str"]}function EU(t,e,r){return r==null&&(r=ye(8+4*t.v.length)),Ul(e,r),pn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=Em(t,n-t.l,r);l[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return l}function AU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=Em(t,n-t.l,r);l[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return l}function bU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=Un(t),l=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=Em(t,n-t.l,r);l[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return l}function kU(t,e,r){var n=t.l+e,a=Ja(t);a.r=r["!row"];var o=jn(t),l=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=Em(t,n-t.l,r);l[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return l}var CU=jl,NU=du;function RU(t,e){return e==null&&(e=ye(4)),e.write_shift(4,t),e}function IU(t,e){var r=t.l+e,n=jl(t),a=Gx(t),o=jn(t),l=jn(t),u=jn(t);t.l=r;var h={rfx:n,relId:a,loc:o,display:u};return l&&(h.Tooltip=l),h}function DU(t,e){var r=ye(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));du({s:Sr(t[0]),e:Sr(t[0])},r),qx("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return pn(a||"",r),pn(t[1].Tooltip||"",r),pn("",r),r.slice(0,r.l)}function OU(){}function FU(t,e,r){var n=t.l+e,a=ZA(t),o=t.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=aB(t,n-t.l,r);l[1]=u}else t.l=n;return l}function MU(t,e,r){var n=t.l+e,a=jl(t),o=[a];if(r.cellFormula){var l=sB(t,n-t.l,r);o[1]=l,t.l=n}else t.l=n;return o}function LU(t,e,r){r==null&&(r=ye(18));var n=Sm(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var nk=["left","right","top","bottom","header","footer"];function PU(t){var e={};return nk.forEach(function(r){e[r]=Un(t)}),e}function VU(t,e){return e==null&&(e=ye(48)),wl(t),nk.forEach(function(r){Il(t[r],e)}),e}function BU(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function UU(t,e,r){r==null&&(r=ye(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function jU(t){var e=ye(24);return e.write_shift(4,4),e.write_shift(4,1),du(t,e),e}function zU(t,e){return e==null&&(e=ye(66)),e.write_shift(2,t.password?Jx(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function HU(){}function GU(){}function qU(t,e,r,n,a,o,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,y,S,w,b,F,z,N,K,te,J=[];u.biff=12,u["!row"]=0;var k=0,I=!1,R=[],M={},O=u.supbooks||a.supbooks||[[]];if(O.sharedf=M,O.arrayf=R,O.SheetNames=a.SheetNames||a.Sheets.map(function(ke){return ke.name}),!u.supbooks&&(u.supbooks=O,a.Names))for(var D=0;D<a.Names.length;++D)O[0][D+1]=a.Names[D];var V=[],_e=[],Te=!1;Qf[16]={n:"BrtShortReal",f:rk};var ne;if(ks(t,function(ae,Le,Q){if(!_)switch(Q){case 148:d=ae;break;case 0:y=ae,u.sheetRows&&u.sheetRows<=y.r&&(_=!0),K=Vr(b=y.r),u["!row"]=y.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=ru(ae.hpt)),_e[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:ae[2]},ae[2]){case"n":S.v=ae[1];break;case"s":N=kf[ae[1]],S.v=N.t,S.r=N.r;break;case"b":S.v=!!ae[1];break;case"e":S.v=ae[1],u.cellText!==!1&&(S.w=Cs[S.v]);break;case"str":S.t="s",S.v=ae[1];break;case"is":S.t="s",S.v=ae[1].t;break}if((w=l.CellXf[ae[0].iStyleRef])&&Zb(S,w.numFmtId,null,u,o,l),F=ae[0].c==-1?F+1:ae[0].c,u.dense?(h[b]||(h[b]=[]),h[b][F]=S):h[Er(F)+K]=S,u.cellFormula){for(I=!1,k=0;k<R.length;++k){var L=R[k];y.r>=L[0].s.r&&y.r<=L[0].e.r&&F>=L[0].s.c&&F<=L[0].e.c&&(S.F=vt(L[0]),I=!0)}!I&&ae.length>3&&(S.f=ae[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>F&&(p.s.c=F),p.e.r<y.r&&(p.e.r=y.r),p.e.c<F&&(p.e.c=F),u.cellDates&&w&&S.t=="n"&&uu(st[w.numFmtId])){var W=xl(S.v);W&&(S.t="d",S.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;S={t:"z",v:void 0},F=ae[0].c==-1?F+1:ae[0].c,u.dense?(h[b]||(h[b]=[]),h[b][F]=S):h[Er(F)+K]=S,p.s.r>y.r&&(p.s.r=y.r),p.s.c>F&&(p.s.c=F),p.e.r<y.r&&(p.e.r=y.r),p.e.c<F&&(p.e.c=F),ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 176:J.push(ae);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ae-1];break;case 494:var G=n["!id"][ae.relId];for(G?(ae.Target=G.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=G):ae.relId==""&&(ae.Target="#"+ae.loc),b=ae.rfx.s.r;b<=ae.rfx.e.r;++b)for(F=ae.rfx.s.c;F<=ae.rfx.e.c;++F)u.dense?(h[b]||(h[b]=[]),h[b][F]||(h[b][F]={t:"z",v:void 0}),h[b][F].l=ae):(z=ot({c:F,r:b}),h[z]||(h[z]={t:"z",v:void 0}),h[z].l=ae);break;case 426:if(!u.cellFormula)break;R.push(ae),te=u.dense?h[b][F]:h[Er(F)+K],te.f=Pn(ae[1],p,{r:y.r,c:F},O,u),te.F=vt(ae[0]);break;case 427:if(!u.cellFormula)break;M[ot(ae[0].s)]=ae[1],te=u.dense?h[b][F]:h[Er(F)+K],te.f=Pn(ae[1],p,{r:y.r,c:F},O,u);break;case 60:if(!u.cellStyles)break;for(;ae.e>=ae.s;)V[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},Te||(Te=!0,Zx(ae.w/256)),Oo(V[ae.e+1]);break;case 161:h["!autofilter"]={ref:vt(ae)};break;case 476:h["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(h["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Le.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=vt(d||p)),u.sheetRows&&h["!ref"]){var oe=Bt(h["!ref"]);u.sheetRows<=+oe.e.r&&(oe.e.r=u.sheetRows-1,oe.e.r>p.e.r&&(oe.e.r=p.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>p.e.c&&(oe.e.c=p.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),h["!fullref"]=h["!ref"],h["!ref"]=vt(oe))}return J.length>0&&(h["!merges"]=J),V.length>0&&(h["!cols"]=V),_e.length>0&&(h["!rows"]=_e),h}function XU(t,e,r,n,a,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||st[14],e.v=on(xr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var h={r,c:n};switch(h.s=Uo(a.cellXfs,e,a),e.l&&o["!links"].push([ot(h),e.l]),e.c&&o["!comments"].push([ot(h),e.c]),e.t){case"s":case"str":return a.bookSST?(u=av(a.Strings,e.v,a.revStrings),h.t="s",h.v=u,l?Oe(t,18,fU(e,h)):Oe(t,7,cU(e,h))):(h.t="str",l?Oe(t,17,EU(e,h)):Oe(t,6,TU(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Oe(t,13,vU(e,h)):Oe(t,2,gU(e,h)):l?Oe(t,16,mU(e,h)):Oe(t,5,dU(e,h)),!0;case"b":return h.t="b",l?Oe(t,15,nU(e,h)):Oe(t,4,tU(e,h)),!0;case"e":return h.t="e",l?Oe(t,14,oU(e,h)):Oe(t,3,iU(e,h)),!0}return l?Oe(t,12,ZB(e,h)):Oe(t,1,QB(e,h)),!0}function WU(t,e,r,n){var a=Bt(e["!ref"]||"A1"),o,l="",u=[];Oe(t,145);var h=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=d;++p){l=Vr(p),GB(t,e,a,p);var v=!1;if(p<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){p===a.s.r&&(u[_]=Er(_)),o=u[_]+l;var y=h?(e[p]||[])[_]:e[o];if(!y){v=!1;continue}v=XU(t,y,p,_,n,e,v)}}Oe(t,146)}function KU(t,e){!e||!e["!merges"]||(Oe(t,177,RU(e["!merges"].length)),e["!merges"].forEach(function(r){Oe(t,176,NU(r))}),Oe(t,178))}function $U(t,e){!e||!e["!cols"]||(Oe(t,390),e["!cols"].forEach(function(r,n){r&&Oe(t,60,LU(n,r))}),Oe(t,391))}function YU(t,e){!e||!e["!ref"]||(Oe(t,648),Oe(t,649,jU(Bt(e["!ref"]))),Oe(t,650))}function QU(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=rr(r,-1,n[1].Target.replace(/#.*$/,""),Et.HLINK);Oe(t,494,DU(n,a))}}),delete e["!links"]}function JU(t,e,r,n){if(e["!comments"].length>0){var a=rr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Et.VML);Oe(t,551,qx("rId"+a)),e["!legacy"]=a}}function ZU(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:vt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=ha(o);u.s.r==u.e.r&&(u.e.r=ha(e["!ref"]).e.r,o=vt(u));for(var h=0;h<l.length;++h){var d=l[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+o;break}}h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Oe(t,161,du(Bt(o))),Oe(t,162)}}function ej(t,e,r){Oe(t,133),Oe(t,137,UU(e,r)),Oe(t,138),Oe(t,134)}function tj(t,e){e["!protect"]&&Oe(t,535,zU(e["!protect"]))}function rj(t,e,r,n){var a=fa(),o=r.SheetNames[t],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var h=Bt(l["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Oe(a,129),(r.vbaraw||l["!outline"])&&Oe(a,147,$B(u,l["!outline"])),Oe(a,148,XB(h)),ej(a,l,r.Workbook),$U(a,l),WU(a,l,t,e),tj(a,l),ZU(a,l,r,t),KU(a,l),QU(a,l,n),l["!margins"]&&Oe(a,476,VU(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&YU(a,l),JU(a,l,t,n),Oe(a,130),a.end()}function nj(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=Vt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function aj(t,e,r,n,a,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=nj(v);p.s.r=p.s.c=0,p.e.c=u,d=Er(u),_[0].forEach(function(y,S){l[d+Vr(S)]={t:"n",v:y,z:_[1]},h=S}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(l["!ref"]=vt(p)),l}function ij(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(ek);return u&&iv(u[0],o,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function sj(t,e){t.l+=10;var r=jn(t);return{name:r}}function oj(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ks(t,function(h,d,p){switch(p){case 550:o["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var sv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],lj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],cj=[],uj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function xE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=mr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function vE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=mr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function ak(t){vE(t.WBProps,sv),vE(t.CalcPr,uj),xE(t.WBView,lj),xE(t.Sheets,cj),Xc.date1904=mr(t.WBProps.date1904)}function fj(t){return!t.Workbook||!t.Workbook.WBProps?"false":mr(t.Workbook.WBProps.date1904)?"true":"false"}var hj="][*?/\\".split("");function ik(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dj(t,e,r){t.forEach(function(n,a){ik(n);for(var o=0;o<a;++o)if(n==t[o])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function mj(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];dj(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)fB(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var pj=/<\w+:workbook/;function gj(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(t.replace(Gn,function(h,d){var p=ut(h);switch(Xi(p[0])){case"<?xml":break;case"<workbook":h.match(pj)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sv.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=mr(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=cr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Vt(cr(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=cr(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),mr(p.hidden||"0")&&(o.Hidden=!0),l=d+h.length;break;case"</definedName>":o.Ref=Vt(cr(t.slice(l,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),Pl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ak(r),r}function sk(t){var e=[Br];e[e.length]=Be("workbook",null,{xmlns:Pl[0],"xmlns:r":an.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(sv.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var l={name:nr(t.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Be("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(e[e.length]=Be("definedName",nr(u.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function xj(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=bg(t),r.name=jn(t),r}function vj(t,e){return e||(e=ye(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),qx(t.strRelID,e),pn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function _j(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?jn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function yj(t,e){e||(e=ye(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),QA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Tj(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function wj(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=JF(t),l=iB(t,0,r),u=Gx(t);t.l=n;var h={Name:o,Ptg:l};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function Ej(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Qf[16]={n:"BrtFRTArchID$",f:Tj},ks(t,function(h,d,p){switch(p){case 156:l.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Pn(h.Ptg,null,null,l,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,h]):l[0]=[p,h],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(h),l.XTI=l.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),ak(r),r.Names=o,r.supbooks=l,r}function Sj(t,e){Oe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Oe(t,156,vj(a))}Oe(t,144)}function Aj(t,e){e||(e=ye(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return pn("SheetJS",e),pn(Dd.version,e),pn(Dd.version,e),pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function bj(t,e){e||(e=ye(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function kj(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&o==-1&&(o=n);o>a||(Oe(t,135),Oe(t,158,bj(a)),Oe(t,136))}}function Cj(t,e){var r=fa();return Oe(r,131),Oe(r,128,Aj()),Oe(r,153,yj(t.Workbook&&t.Workbook.WBProps||null)),kj(r,t),Sj(r,t),Oe(r,132),r.end()}function Nj(t,e,r){return e.slice(-4)===".bin"?Ej(t,r):gj(t,r)}function Rj(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?qU(t,n,r,a,o,l,u):wB(t,n,r,a,o,l,u)}function Ij(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?oj(t,n,r,a,o):ij(t,n,r,a,o)}function Dj(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?FP():MP()}function Oj(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?DP():OP()}function Fj(t,e,r,n){return e.slice(-4)===".bin"?NL(t,r,n):xL(t,r,n)}function Mj(t,e,r){return Ub(t,r)}function Lj(t,e,r){return e.slice(-4)===".bin"?L7(t,r):O7(t,r)}function Pj(t,e,r){return e.slice(-4)===".bin"?kP(t,r):vP(t,r)}function Vj(t,e,r){return e.slice(-4)===".bin"?pP(t):dP(t)}function Bj(t,e,r,n){return r.slice(-4)===".bin"?gP(t,e,r,n):void 0}function Uj(t,e,r){return e.slice(-4)===".bin"?uP(t,e,r):hP(t,e,r)}function jj(t,e,r){return(e.slice(-4)===".bin"?Cj:sk)(t)}function zj(t,e,r,n,a){return(e.slice(-4)===".bin"?rj:tk)(t,r,n,a)}function Hj(t,e,r){return(e.slice(-4)===".bin"?BL:Vb)(t,r)}function Gj(t,e,r){return(e.slice(-4)===".bin"?B7:Rb)(t,r)}function qj(t,e,r){return(e.slice(-4)===".bin"?CP:Hb)(t)}function Xj(t){return(t.slice(-4)===".bin"?fP:jb)()}var ok=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,lk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function hi(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(ok),o,l,u,h;if(a)for(h=0;h!=a.length;++h)o=a[h].match(lk),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function Wj(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ok),a,o,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(lk),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Nf;function Kj(t,e){var r=Nf[t]||Vt(t);return r==="General"?Nl(e):Qa(r,e)}function $j(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=xr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Vt(e)]=a}function Yj(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Cs[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=zf(t.v):t.w=Nl(t.v):t.w=Kj(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=Nf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&uu(n)){var a=xl(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function Qj(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=cL[n.Pattern]||n.Pattern)}t[e.ID]=e}function Jj(t,e,r,n,a,o,l,u,h,d){var p="General",v=n.StyleID,_={};d=d||{};var y=[],S=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&y.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mr(t);break;case"String":n.t="s",n.r=Mw(Vt(t)),n.v=t.indexOf("<")>-1?Vt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(xr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Vt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=rb[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Mw(e||t));break}if(Yj(n,p,d),d.cellFormula!==!1)if(n.Formula){var w=Vt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=qc(w,a),delete n.Formula,n.ArrayRange=="RC"?n.F=qc("RC:RC",a):n.ArrayRange&&(n.F=qc(n.ArrayRange,a),h.push([Bt(n.F),n.F]))}else for(S=0;S<h.length;++S)a.r>=h[S][0].s.r&&a.r<=h[S][0].e.r&&a.c>=h[S][0].s.c&&a.c<=h[S][0].e.c&&(n.F=h[S][1]);d.cellStyles&&(y.forEach(function(b){!_.patternType&&b.patternType&&(_.patternType=b.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Zj(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function qp(t,e){var r=e||{};fu();var n=mf(Vx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=cr(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=vr(r);return l.type="string",tu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($t){a.indexOf("<"+$t)>=0&&(o=!0)}),o)return Vz(n,r);Nf={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},v=[],_=r.dense?[]:{},y="",S={},w={},b=hi('<Data ss:Type="String">'),F=0,z=0,N=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},J={},k="",I=0,R=[],M={},O={},D=0,V=[],_e=[],Te={},ne=[],oe,ke=!1,ae=[],Le=[],Q={},L=0,W=0,G={Sheets:[],WBProps:{date1904:!1}},Z={};qf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";u=qf.exec(n);)switch(u[3]=(le=u[3]).toLowerCase()){case"data":if(le=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?Jj(n.slice(F,u.index),k,b,h[h.length-1][0]=="comment"?Te:S,{c:z,r:N},te,ne[z],w,ae,r):(k="",b=hi(u[0]),F=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(_e.length>0&&(S.c=_e),(!r.sheetRows||r.sheetRows>N)&&S.v!==void 0&&(r.dense?(_[N]||(_[N]=[]),_[N][z]=S):_[Er(z)+Vr(N)]=S),S.HRef&&(S.l={Target:Vt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(L=z+(parseInt(S.MergeAcross,10)|0),W=N+(parseInt(S.MergeDown,10)|0),R.push({s:{c:z,r:N},e:{c:L,r:W}})),!r.sheetStubs)S.MergeAcross?z=L+1:++z;else if(S.MergeAcross||S.MergeDown){for(var Se=z;Se<=L;++Se)for(var Ne=N;Ne<=W;++Ne)(Se>z||Ne>N)&&(r.dense?(_[Ne]||(_[Ne]=[]),_[Ne][Se]={t:"z"}):_[Er(Se)+Vr(Ne)]={t:"z"});z=L+1}else++z;else S=Wj(u[0]),S.Index&&(z=+S.Index-1),z<K.s.c&&(K.s.c=z),z>K.e.c&&(K.e.c=z),u[0].slice(-2)==="/>"&&++z,_e=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<K.s.r&&(K.s.r=N),N>K.e.r&&(K.e.r=N),u[0].slice(-2)==="/>"&&(w=hi(u[0]),w.Index&&(N=+w.Index-1)),z=0,++N):(w=hi(u[0]),w.Index&&(N=+w.Index-1),Q={},(w.AutoFitHeight=="0"||w.Height)&&(Q.hpx=parseInt(w.Height,10),Q.hpt=Yf(Q.hpx),Le[N]=Q),w.Hidden=="1"&&(Q.hidden=!0,Le[N]=Q));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));v.push(y),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(_["!ref"]=vt(K),r.sheetRows&&r.sheetRows<=K.e.r&&(_["!fullref"]=_["!ref"],K.e.r=r.sheetRows-1,_["!ref"]=vt(K))),R.length&&(_["!merges"]=R),ne.length>0&&(_["!cols"]=ne),Le.length>0&&(_["!rows"]=Le),p[y]=_}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=z=0,h.push([u[3],!1]),d=hi(u[0]),y=Vt(d.Name),_=r.dense?[]:{},R=[],ae=[],Le=[],Z={name:y,Hidden:0},G.Sheets.push(Z);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ne=[],ke=!1}break;case"style":u[1]==="/"?Qj(te,J,r):J=hi(u[0]);break;case"numberformat":J.nf=Vt(hi(u[0]).Format||"General"),Nf[J.nf]&&(J.nf=Nf[J.nf]);for(var Ae=0;Ae!=392&&st[Ae]!=J.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(st[Ae]==null){xs(J.nf,Ae);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(oe=hi(u[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!ke&&oe.wpx>10){ke=!0,Bn=Lb;for(var Ie=0;Ie<ne.length;++Ie)ne[Ie]&&Oo(ne[Ie])}ke&&Oo(oe),ne[oe.Index-1||ne.length]=oe;for(var nt=0;nt<+oe.Span;++nt)ne[ne.length]=vr(oe);break;case"namedrange":if(u[1]==="/")break;G.Names||(G.Names=[]);var ee=ut(u[0]),Ft={Name:ee.Name,Ref:qc(ee.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Ft.Sheet=G.Sheets.length-1),G.Names.push(Ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?k+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;J.Interior=hi(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?EM(M,le,n.slice(D,u.index)):D=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));Zj(Te),_e.push(Te)}else h.push([u[3],!1]),d=hi(u[0]),Te={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ft=hi(u[0]);_["!autofilter"]={ref:qc(ft.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return EE(n,r);var It=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:It=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:It=!1}break;case"excelworkbook":switch(u[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:It=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:It=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(D,u.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else D=u.index+u[0].length;break;case"header":_["!margins"]||wl(_["!margins"]={},"xlml"),isNaN(+ut(u[0]).Margin)||(_["!margins"].header=+ut(u[0]).Margin);break;case"footer":_["!margins"]||wl(_["!margins"]={},"xlml"),isNaN(+ut(u[0]).Margin)||(_["!margins"].footer=+ut(u[0]).Margin);break;case"pagemargins":var at=ut(u[0]);_["!margins"]||wl(_["!margins"]={},"xlml"),isNaN(+at.Top)||(_["!margins"].top=+at.Top),isNaN(+at.Left)||(_["!margins"].left=+at.Left),isNaN(+at.Right)||(_["!margins"].right=+at.Right),isNaN(+at.Bottom)||(_["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:It=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:It=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:It=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:It=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:It=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:It=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:It=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:It=!1}break;case"smarttags":break;default:It=!1;break}if(It||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?$j(O,le,V,n.slice(D,u.index)):(V=u,D=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Ue={};return!r.bookSheets&&!r.bookProps&&(Ue.Sheets=p),Ue.SheetNames=v,Ue.Workbook=G,Ue.SSF=vr(st),Ue.Props=M,Ue.Custprops=O,Ue}function Og(t,e){switch(lv(e=e||{}),e.type||"base64"){case"base64":return qp(Ia(t),e);case"binary":case"buffer":case"file":return qp(t,e);case"array":return qp(Vo(t),e)}}function ez(t,e){var r=[];return t.Props&&r.push(SM(t.Props,e)),t.Custprops&&r.push(AM(t.Props,t.Custprops)),r.join("")}function tz(){return""}function rz(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var o=[];o.push(Be("NumberFormat",null,{"ss:Format":nr(st[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Be("Style",o.join(""),l))}),Be("Styles",r.join(""))}function ck(t){return Be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+rv(t.Ref,{r:0,c:0})})}function nz(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(ck(a)))}return Be("Names",r.join(""))}function az(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(ck(u)))}return o.join("")}function iz(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(bn("ProtectContents","True")),t["!protect"].objects&&a.push(bn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(bn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(bn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(bn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Be("WorksheetOptions",a.join(""),{xmlns:ba.x})}function sz(t){return t.map(function(e){var r=kF(e.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function oz(t,e,r,n,a,o,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+nr(rv(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var h=Sr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==l.r?"":"["+(h.r-l.r)+"]")+"C"+(h.c==l.c?"":"["+(h.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=nr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=nr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=l.c||d[p].s.r!=l.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var v="",_="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",_=String(t.v);break;case"b":v="Boolean",_=t.v?"1":"0";break;case"e":v="Error",_=Cs[t.v];break;case"d":v="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||st[14]);break;case"s":v="String",_=bF(t.v||"");break}var y=Uo(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=l.c+1;var S=t.v!=null?_:"",w=t.t=="z"?"":'<Data ss:Type="'+v+'">'+S+"</Data>";return(t.c||[]).length>0&&(w+=sz(t.c)),Be("Cell",w,u)}function lz(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=ru(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function cz(t,e,r,n){if(!t["!ref"])return"";var a=Bt(t["!ref"]),o=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(b,F){Oo(b);var z=!!b.width,N=Sm(F,b),K={"ss:Index":F+1};z&&(K["ss:Width"]=Kf(N.width)),b.hidden&&(K["ss:Hidden"]="1"),u.push(Be("Column",null,K))});for(var h=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var p=[lz(d,(t["!rows"]||[])[d])],v=a.s.c;v<=a.e.c;++v){var _=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>d)&&!(o[l].e.c<v)&&!(o[l].e.r<d)){(o[l].s.c!=v||o[l].s.r!=d)&&(_=!0);break}if(!_){var y={r:d,c:v},S=ot(y),w=h?(t[d]||[])[v]:t[S];p.push(oz(w,S,t,e,r,n,y))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function uz(t,e,r){var n=[],a=r.SheetNames[t],o=r.Sheets[a],l=o?az(o,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?cz(o,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(iz(o,e,t,r)),n.join("")}function fz(t,e){e||(e={}),t.SSF||(t.SSF=vr(st)),t.SSF&&(fu(),xm(t.SSF),e.revssf=_m(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Uo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(ez(t,e)),r.push(tz()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Be("Worksheet",uz(n,e,t),{"ss:Name":nr(t.SheetNames[n])}));return r[2]=rz(t,e),r[3]=nz(t),Br+Be("Workbook",r.join(""),{xmlns:ba.ss,"xmlns:o":ba.o,"xmlns:x":ba.x,"xmlns:ss":ba.ss,"xmlns:dt":ba.dt,"xmlns:html":ba.html})}function hz(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=nM(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=aM(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var dz=[60,1084,2066,2165,2175];function mz(t,e,r,n,a){var o=n,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var h=ms(r,r.l),d=Fg[h],p=0;d!=null&&dz.indexOf(h)>-1;)o=ms(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+o),l.push(u),r.l+=4+o,d=Fg[h=ms(r,r.l)];var v=mn(l);Sn(v,0);var _=0;v.lens=[];for(var y=0;y<l.length;++y)v.lens.push(_),_+=l[y].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,a)}function Oi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=st[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Cs[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=zf(t.v):t.w=Nl(t.v):t.w=Qa(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&uu(st[n]||String(n))){var a=xl(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Jh(t,e,r){return{v:t,ixfe:e,t:r}}function pz(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},l={},u=null,h=[],d="",p={},v,_="",y,S,w,b,F={},z=[],N,K,te=[],J=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},R=function(ct){return ct<8?_l[ct]:ct<64&&J[ct-8]||_l[ct]},M=function(ct,ar,Zr){var Re=ar.XF.data;if(!(!Re||!Re.patternType||!Zr||!Zr.cellStyles)){ar.s={},ar.s.patternType=Re.patternType;var Xe;(Xe=Wf(R(Re.icvFore)))&&(ar.s.fgColor={rgb:Xe}),(Xe=Wf(R(Re.icvBack)))&&(ar.s.bgColor={rgb:Xe})}},O=function(ct,ar,Zr){if(!(Q>1)&&!(Zr.sheetRows&&ct.r>=Zr.sheetRows)){if(Zr.cellStyles&&ar.XF&&ar.XF.data&&M(ct,ar,Zr),delete ar.ixfe,delete ar.XF,v=ct,_=ot(ct),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<l.s.r&&(l.s.r=ct.r),ct.c<l.s.c&&(l.s.c=ct.c),ct.r+1>l.e.r&&(l.e.r=ct.r+1),ct.c+1>l.e.c&&(l.e.c=ct.c+1),Zr.cellFormula&&ar.f){for(var Re=0;Re<z.length;++Re)if(!(z[Re][0].s.c>ct.c||z[Re][0].s.r>ct.r)&&!(z[Re][0].e.c<ct.c||z[Re][0].e.r<ct.r)){ar.F=vt(z[Re][0]),(z[Re][0].s.c!=ct.c||z[Re][0].s.r!=ct.r)&&delete ar.f,ar.f&&(ar.f=""+Pn(z[Re][1],l,ct,ae,D));break}}Zr.dense?(a[ct.r]||(a[ct.r]=[]),a[ct.r][ct.c]=ar):a[_]=ar}},D={enc:!1,sbcch:0,snames:[],sharedf:F,arrayf:z,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var V,_e=[],Te=[],ne=[],oe=[],ke=!1,ae=[];ae.SheetNames=D.snames,ae.sharedf=D.sharedf,ae.arrayf=D.arrayf,ae.names=[],ae.XTI=[];var Le=0,Q=0,L=0,W=[],G=[],Z;D.codepage=1200,pi(1200);for(var le=!1;t.l<t.length-1;){var Se=t.l,Ne=t.read_shift(2);if(Ne===0&&Le===10)break;var Ae=t.l===t.length?0:t.read_shift(2),Ie=Fg[Ne];if(Ie&&Ie.f){if(e.bookSheets&&Le===133&&Ne!==133)break;if(Le=Ne,Ie.r===2||Ie.r==12){var nt=t.read_shift(2);if(Ae-=2,!D.enc&&nt!==Ne&&((nt&255)<<8|nt>>8)!==Ne)throw new Error("rt mismatch: "+nt+"!="+Ne);Ie.r==12&&(t.l+=10,Ae-=10)}var ee={};if(Ne===10?ee=Ie.f(t,Ae,D):ee=mz(Ne,Ie,t,Ae,D),Q==0&&[9,521,1033,2057].indexOf(Le)===-1)continue;switch(Ne){case 34:r.opts.Date1904=k.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=ee,!e.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=ee;break;case 66:var Ft=Number(ee);switch(Ft){case 21010:Ft=1200;break;case 32768:Ft=1e4;break;case 32769:Ft=1252;break}pi(D.codepage=Ft),le=!0;break;case 317:D.rrtabid=ee;break;case 25:D.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:D.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(a["!type"]="dialog"),ee.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ee.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(ee);break;case 430:ae.push([ee]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(ee);break;case 24:case 536:Z={Name:ee.Name,Ref:Pn(ee.rgce,l,null,ae,D)},ee.itab>0&&(Z.Sheet=ee.itab-1),ae.names.push(Z),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(G[ee.itab-1]={ref:vt(ee.rgce[0][0][1][2])});break;case 22:D.ExternCount=ee;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(ee),ae.XTI=ae.XTI.concat(ee);break;case 2196:if(D.biff<8)break;Z!=null&&(Z.Comment=ee[1]);break;case 18:a["!protect"]=ee;break;case 19:ee!==0&&D.WTF&&console.error("Password verifier: "+ee);break;case 133:o[ee.pos]=ee,D.snames.push(ee.name);break;case 10:{if(--Q)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=vt(l),e.sheetRows&&e.sheetRows<=l.e.r){var ft=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=vt(l),l.e.r=ft}l.e.r++,l.e.c++}_e.length>0&&(a["!merges"]=_e),Te.length>0&&(a["!objects"]=Te),ne.length>0&&(a["!cols"]=ne),oe.length>0&&(a["!rows"]=oe),k.Sheets.push(I)}d===""?p=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),D.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(D.biff=5,le=!0,pi(D.codepage=28591)),D.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(D.biff=2),Q++)break;if(a=e.dense?[]:{},D.biff<8&&!le&&(le=!0,pi(D.codepage=e.codepage||1252)),D.biff<5||ee.BIFFVer==0&&ee.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var It={pos:t.l-Ae,name:d};o[It.pos]=It,D.snames.push(d)}else d=(o[Se]||{name:""}).name;ee.dt==32&&(a["!type"]="chart"),ee.dt==64&&(a["!type"]="macro"),_e=[],Te=[],D.arrayf=z=[],ne=[],oe=[],ke=!1,I={Hidden:(o[Se]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[ee.r]||[])[ee.c]:a[ot({c:ee.c,r:ee.r})])&&++ee.c,N={ixfe:ee.ixfe,XF:te[ee.ixfe]||{},v:ee.val,t:"n"},L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:ee.c,r:ee.r},N,e);break;case 5:case 517:N={ixfe:ee.ixfe,XF:te[ee.ixfe],v:ee.val,t:ee.t},L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:ee.c,r:ee.r},N,e);break;case 638:N={ixfe:ee.ixfe,XF:te[ee.ixfe],v:ee.rknum,t:"n"},L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:ee.c,r:ee.r},N,e);break;case 189:for(var at=ee.c;at<=ee.C;++at){var Ue=ee.rkrec[at-ee.c][0];N={ixfe:Ue,XF:te[Ue],v:ee.rkrec[at-ee.c][1],t:"n"},L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:at,r:ee.r},N,e)}break;case 6:case 518:case 1030:{if(ee.val=="String"){u=ee;break}if(N=Jh(ee.val,ee.cell.ixfe,ee.tt),N.XF=te[N.ixfe],e.cellFormula){var $t=ee.formula;if($t&&$t[0]&&$t[0][0]&&$t[0][0][0]=="PtgExp"){var Dt=$t[0][0][1][0],Ut=$t[0][0][1][1],Ur=ot({r:Dt,c:Ut});F[Ur]?N.f=""+Pn(ee.formula,l,ee.cell,ae,D):N.F=((e.dense?(a[Dt]||[])[Ut]:a[Ur])||{}).F}else N.f=""+Pn(ee.formula,l,ee.cell,ae,D)}L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O(ee.cell,N,e),u=ee}break;case 7:case 519:if(u)u.val=ee,N=Jh(ee,u.cell.ixfe,"s"),N.XF=te[N.ixfe],e.cellFormula&&(N.f=""+Pn(u.formula,l,u.cell,ae,D)),L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O(u.cell,N,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{z.push(ee);var Za=ot(ee[0].s);if(y=e.dense?(a[ee[0].s.r]||[])[ee[0].s.c]:a[Za],e.cellFormula&&y){if(!u||!Za||!y)break;y.f=""+Pn(ee[1],l,ee[0],ae,D),y.F=vt(ee[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;F[ot(u.cell)]=ee[0],y=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ot(u.cell)],(y||{}).f=""+Pn(ee[0],l,v,ae,D)}}break;case 253:N=Jh(h[ee.isst].t,ee.ixfe,"s"),h[ee.isst].h&&(N.h=h[ee.isst].h),N.XF=te[N.ixfe],L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:ee.c,r:ee.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:ee.ixfe,XF:te[ee.ixfe],t:"z"},L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:ee.c,r:ee.r},N,e));break;case 190:if(e.sheetStubs)for(var qn=ee.c;qn<=ee.C;++qn){var Lt=ee.ixfe[qn-ee.c];N={ixfe:Lt,XF:te[Lt],t:"z"},L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:qn,r:ee.r},N,e)}break;case 214:case 516:case 4:N=Jh(ee.val,ee.ixfe,"s"),N.XF=te[N.ixfe],L>0&&(N.z=W[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),O({c:ee.c,r:ee.r},N,e);break;case 0:case 512:Q===1&&(l=ee);break;case 252:h=ee;break;case 1054:if(D.biff==4){W[L++]=ee[1];for(var Jr=0;Jr<L+163&&st[Jr]!=ee[1];++Jr);Jr>=163&&xs(ee[1],L+163)}else xs(ee[1],ee[0]);break;case 30:{W[L++]=ee;for(var gn=0;gn<L+163&&st[gn]!=ee;++gn);gn>=163&&xs(ee,L+163)}break;case 229:_e=_e.concat(ee);break;case 93:Te[ee.cmo[0]]=D.lastobj=ee;break;case 438:D.lastobj.TxO=ee;break;case 127:D.lastobj.ImData=ee;break;case 440:for(b=ee[0].s.r;b<=ee[0].e.r;++b)for(w=ee[0].s.c;w<=ee[0].e.c;++w)y=e.dense?(a[b]||[])[w]:a[ot({c:w,r:b})],y&&(y.l=ee[1]);break;case 2048:for(b=ee[0].s.r;b<=ee[0].e.r;++b)for(w=ee[0].s.c;w<=ee[0].e.c;++w)y=e.dense?(a[b]||[])[w]:a[ot({c:w,r:b})],y&&y.l&&(y.l.Tooltip=ee[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;y=e.dense?(a[ee[0].r]||[])[ee[0].c]:a[ot(ee[0])];var Xn=Te[ee[2]];y||(e.dense?(a[ee[0].r]||(a[ee[0].r]=[]),y=a[ee[0].r][ee[0].c]={t:"z"}):y=a[ot(ee[0])]={t:"z"},l.e.r=Math.max(l.e.r,ee[0].r),l.s.r=Math.min(l.s.r,ee[0].r),l.e.c=Math.max(l.e.c,ee[0].c),l.s.c=Math.min(l.s.c,ee[0].c)),y.c||(y.c=[]),S={a:ee[1],t:Xn.TxO.t},y.c.push(S)}break;case 2173:rP(te[ee.ixfe],ee.ext);break;case 125:{if(!D.cellStyles)break;for(;ee.e>=ee.s;)ne[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},ke||(ke=!0,Zx(ee.w/256)),Oo(ne[ee.e+1])}break;case 520:{var Pt={};ee.level!=null&&(oe[ee.r]=Pt,Pt.level=ee.level),ee.hidden&&(oe[ee.r]=Pt,Pt.hidden=!0),ee.hpt&&(oe[ee.r]=Pt,Pt.hpt=ee.hpt,Pt.hpx=ru(ee.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||wl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=ee;break;case 161:a["!margins"]||wl(a["!margins"]={}),a["!margins"].header=ee.header,a["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(k.Views[0].RTL=!0);break;case 146:J=ee;break;case 2198:V=ee;break;case 140:K=ee;break;case 442:d?I.CodeName=ee||I.name:k.WBProps.CodeName=ee||"ThisWorkbook";break}}else Ie||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),t.l+=Ae}return r.SheetNames=Rr(o).sort(function(Nn,ct){return Number(Nn)-Number(ct)}).map(function(Nn){return o[Nn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&G.forEach(function(Nn,ct){r.Sheets[r.SheetNames[ct]]["!autofilter"]=Nn}),r.Strings=h,r.SSF=vr(st),D.enc&&(r.Encryption=D.enc),V&&(r.Themes=V),r.Metadata={},K!==void 0&&(r.Metadata.Country=K),ae.names.length>0&&(k.Names=ae.names),r.Workbook=k,r}var Rf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gz(t,e,r){var n=tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Zw(n,kg,Rf.DSI);for(var o in a)e[o]=a[o]}catch(d){if(r.WTF)throw d}var l=tt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=Zw(l,Cg,Rf.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(lb(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function xz(t,e){var r=[],n=[],a=[],o=0,l,u=Nw(kg,"n"),h=Nw(Cg,"n");if(t.Props)for(l=Rr(t.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Props[l[o]]]);if(t.Custprops)for(l=Rr(t.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Custprops[l[o]]]);var d=[];for(o=0;o<a.length;++o)pb.indexOf(a[o][0])>-1||ob.indexOf(a[o][0])>-1||a[o][1]!=null&&d.push(a[o]);n.length&&tt.utils.cfb_add(e,"/SummaryInformation",eE(n,Rf.SI,h,Cg)),(r.length||d.length)&&tt.utils.cfb_add(e,"/DocumentSummaryInformation",eE(r,Rf.DSI,u,kg,d.length?d:null,Rf.UDI))}function uk(t,e){e||(e={}),lv(e),Nx(),e.codepage&&Cx(e.codepage);var r,n;if(t.FullPaths){if(tt.find(t,"/encryption"))throw new Error("File is password-protected");r=tt.find(t,"!CompObj"),n=tt.find(t,"/Workbook")||tt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ca(Ia(t));break;case"binary":t=Ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var a,o;if(r&&hz(r),e.bookProps&&!e.bookSheets)a={};else{var l=wt?"buffer":"array";if(n&&n.content)a=pz(n.content,e);else if((o=tt.find(t,"PerfectOffice_MAIN"))&&o.content)a=Tl.to_workbook(o.content,(e.type=l,e));else if((o=tt.find(t,"NativeContent_MAIN"))&&o.content)a=Tl.to_workbook(o.content,(e.type=l,e));else throw(o=tt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=RP(t))}var u={};return t.FullPaths&&gz(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function vz(t,e){var r=e||{},n=tt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,a,fk(t,r)),r.biff==8&&(t.Props||t.Custprops)&&xz(t,n),r.biff==8&&t.vbaraw&&IP(n,tt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Qf={0:{f:zB},1:{f:YB},2:{f:pU},3:{f:aU},4:{f:eU},5:{f:hU},6:{f:yU},7:{f:lU},8:{f:kU},9:{f:bU},10:{f:SU},11:{f:AU},12:{f:JB},13:{f:xU},14:{f:sU},15:{f:rU},16:{f:rk},17:{f:wU},18:{f:uU},19:{f:Hx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:wj},40:{},42:{},43:{f:yL},44:{f:vL},45:{f:EL},46:{f:AL},47:{f:SL},48:{},49:{f:qF},50:{},51:{f:iP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bb},62:{f:_U},63:{f:mP},64:{f:HU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:KB},148:{f:qB,p:16},151:{f:OU},152:{},153:{f:_j},154:{},155:{},156:{f:xj},157:{},158:{},159:{T:1,f:M7},160:{T:-1},161:{T:1,f:jl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:CU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nP},336:{T:-1},337:{f:lP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ab},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:FU},427:{f:MU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:PU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:WB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:AP},633:{T:1},634:{T:-1},635:{T:1,f:EP},636:{T:-1},637:{f:$F},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:sj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:GU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fg={6:{f:Hp},10:{f:co},12:{f:Yr},13:{f:Yr},14:{f:Mr},15:{f:Mr},16:{f:Un},17:{f:Mr},18:{f:Mr},19:{f:Yr},20:{f:sE},21:{f:sE},23:{f:Ab},24:{f:lE},25:{f:Mr},26:{},27:{},28:{f:G9},29:{},34:{f:Mr},35:{f:oE},38:{f:Un},39:{f:Un},40:{f:Un},41:{f:Un},42:{f:Mr},43:{f:Mr},47:{f:rL},49:{f:x9},51:{f:Yr},60:{},61:{f:h9},64:{f:Mr},65:{f:g9},66:{f:Yr},77:{},80:{},81:{},82:{},85:{f:Yr},89:{},90:{},91:{},92:{f:t9},93:{f:W9},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:bb},128:{f:D9},129:{f:n9},130:{f:Yr},131:{f:Mr},132:{f:Mr},133:{f:a9},134:{},140:{f:t7},141:{f:Yr},144:{},146:{f:a7},151:{},152:{},153:{},154:{},155:{},156:{f:Yr},157:{},158:{},160:{f:f7},161:{f:o7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:C9},190:{f:N9},193:{f:co},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yr},220:{},221:{f:Mr},222:{},224:{f:I9},225:{f:e9},226:{f:co},227:{},229:{f:q9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:s9},253:{f:_9},255:{f:l9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:gb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:co},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:P9},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:Y9},439:{f:Mr},440:{f:Q9},441:{},442:{f:m0},443:{},444:{f:Yr},445:{},446:{},448:{f:co},449:{f:f9,r:2},450:{f:co},512:{f:nE},513:{f:u7},515:{f:M9},516:{f:T9},517:{f:iE},519:{f:h7},520:{f:c9},523:{},545:{f:cE},549:{f:rE},566:{},574:{f:m9},638:{f:k9},659:{},1048:{},1054:{f:E9},1084:{},1212:{f:j9},2048:{f:Z9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:$h},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:co},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:i7,r:12},2173:{f:tP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:U9,r:12},2197:{},2198:{f:$L,r:12},2199:{},2200:{},2201:{},2202:{f:z9,r:12},2203:{f:co},2204:{},2205:{},2206:{},2207:{},2211:{f:u9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:l7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:n7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:nE},1:{},2:{f:x7},3:{f:p7},4:{f:m7},5:{f:iE},7:{f:_7},8:{},9:{f:$h},11:{},22:{f:Yr},30:{f:A9},31:{},32:{},33:{f:cE},36:{},37:{f:rE},50:{f:y7},62:{},52:{},67:{},68:{f:Yr},69:{},86:{},126:{},127:{f:d7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:T7},223:{},234:{},354:{},421:{},518:{f:Hp},521:{f:$h},536:{f:lE},547:{f:oE},561:{},579:{},1030:{f:Hp},1033:{f:$h},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function je(t,e,r,n){var a=e;if(!isNaN(a)){var o=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Ux(r)&&t.push(r)}}function _z(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return je(t,e,r,a);var o=e;if(!isNaN(o)){for(var l=r.parts||[],u=0,h=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,o),p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<a;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function v0(t,e,r){return t||(t=ye(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function yz(t,e,r,n){var a=ye(9);return v0(a,t,e),xb(r,n||"b",a),a}function Tz(t,e,r){var n=ye(8+2*r.length);return v0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function wz(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?on(xr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?je(t,2,v7(r,n,a)):je(t,3,g7(r,n,a));return;case"b":case"e":je(t,5,yz(r,n,e.v,e.t));return;case"s":case"str":je(t,4,Tz(r,n,(e.v||"").slice(0,255)));return}je(t,1,v0(null,r,n))}function Ez(t,e,r,n){var a=Array.isArray(e),o=Bt(e["!ref"]||"A1"),l,u="",h=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=vt(o)}for(var d=o.s.r;d<=o.e.r;++d){u=Vr(d);for(var p=o.s.c;p<=o.e.c;++p){d===o.s.r&&(h[p]=Er(p)),l=h[p]+u;var v=a?(e[d]||[])[p]:e[l];v&&wz(t,v,d,p)}}}function Sz(t,e){for(var r=e||{},n=fa(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return je(n,r.biff==4?1033:r.biff==3?521:9,Yx(t,16,r)),Ez(n,t.Sheets[t.SheetNames[a]],a,r),je(n,10),n.end()}function Az(t,e,r){je(t,49,v9({sz:12,name:"Arial"},r))}function bz(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&je(t,1054,S9(a,e[a],r))})}function kz(t,e){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),je(t,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),wb(Bt(e["!ref"]||"A1"),r),r.write_shift(4,4),je(t,2152,r)}function Cz(t,e){for(var r=0;r<16;++r)je(t,224,aE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){je(t,224,aE(n,0,e))})}function Nz(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];je(t,440,J9(n)),n[1].Tooltip&&je(t,2048,e7(n))}delete e["!links"]}function Rz(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&je(t,125,s7(Sm(a,n),a))})}}function Iz(t,e,r,n,a){var o=16+Uo(a.cellXfs,e,a);if(e.v==null&&!e.bf){je(t,513,Ol(r,n,o));return}if(e.bf)je(t,6,nB(e,r,n,a,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?on(xr(e.v)):e.v;je(t,515,L9(r,n,l,o));break;case"b":case"e":je(t,517,F9(r,n,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var u=av(a.Strings,e.v,a.revStrings);je(t,253,y9(r,n,u,o))}else je(t,516,w9(r,n,(e.v||"").slice(0,255),o,a));break;default:je(t,513,Ol(r,n,o))}}function Dz(t,e,r){var n=fa(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},h=Array.isArray(o),d=e.biff==8,p,v="",_=[],y=Bt(o["!ref"]||"A1"),S=d?65536:16384;if(y.e.c>255||y.e.r>=S){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,S-1)}je(n,2057,Yx(r,16,e)),je(n,13,Ka(1)),je(n,12,Ka(100)),je(n,15,Qn(!0)),je(n,17,Qn(!1)),je(n,16,Il(.001)),je(n,95,Qn(!0)),je(n,42,Qn(!1)),je(n,43,Qn(!1)),je(n,130,Ka(1)),je(n,128,O9()),je(n,131,Qn(!1)),je(n,132,Qn(!1)),d&&Rz(n,o["!cols"]),je(n,512,b9(y,e)),d&&(o["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){v=Vr(w);for(var b=y.s.c;b<=y.e.c;++b){w===y.s.r&&(_[b]=Er(b)),p=_[b]+v;var F=h?(o[w]||[])[b]:o[p];F&&(Iz(n,F,w,b,e),d&&F.l&&o["!links"].push([p,F.l]))}}var z=u.CodeName||u.name||a;return d&&je(n,574,p9((l.Views||[])[0])),d&&(o["!merges"]||[]).length&&je(n,229,X9(o["!merges"])),d&&Nz(n,o),je(n,442,vb(z)),d&&kz(n,o),je(n,10),n.end()}function Oz(t,e,r){var n=fa(),a=(t||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,h=r.biff==5;if(je(n,2057,Yx(t,5,r)),r.bookType=="xla"&&je(n,135),je(n,225,u?Ka(1200):null),je(n,193,FM(2)),h&&je(n,191),h&&je(n,192),je(n,226),je(n,92,r9("SheetJS",r)),je(n,66,Ka(u?1200:1252)),u&&je(n,353,Ka(0)),u&&je(n,448),je(n,317,c7(t.SheetNames.length)),u&&t.vbaraw&&je(n,211),u&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";je(n,442,vb(d))}je(n,156,Ka(17)),je(n,25,Qn(!1)),je(n,18,Qn(!1)),je(n,19,Ka(0)),u&&je(n,431,Qn(!1)),u&&je(n,444,Ka(0)),je(n,61,d9()),je(n,64,Qn(!1)),je(n,141,Ka(0)),je(n,34,Qn(fj(t)=="true")),je(n,14,Qn(!0)),u&&je(n,439,Qn(!1)),je(n,218,Ka(0)),Az(n,t,r),bz(n,t.SSF,r),Cz(n,r),u&&je(n,352,Qn(!1));var p=n.end(),v=fa();u&&je(v,140,r7()),u&&r.Strings&&_z(v,252,o9(r.Strings)),je(v,10);var _=v.end(),y=fa(),S=0,w=0;for(w=0;w<t.SheetNames.length;++w)S+=(u?12:11)+(u?2:1)*t.SheetNames[w].length;var b=p.length+S+_.length;for(w=0;w<t.SheetNames.length;++w){var F=o[w]||{};je(y,133,i9({pos:b,hs:F.Hidden||0,dt:0,name:t.SheetNames[w]},r)),b+=e[w].length}var z=y.end();if(S!=z.length)throw new Error("BS8 "+S+" != "+z.length);var N=[];return p.length&&N.push(p),z.length&&N.push(z),_.length&&N.push(_),mn(N)}function Fz(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(fu(),xm(t.SSF),r.revssf=_m(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,cv(r),r.cellXfs=[],Uo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=Dz(a,r,t);return n.unshift(Oz(t,n,r)),mn(n)}function fk(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ha(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return Fz(t,e);case 4:case 3:case 2:return Sz(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function _E(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=a.index,u=o&&o.index||t.length,h=vF(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,v=0,_=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(l=0;l<h.length;++l){var w=h[l].trim(),b=w.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(b!="<td"&&b!="<th")){var F=w.split(/<\/t[dh]>/i);for(u=0;u<F.length;++u){var z=F[u].trim();if(z.match(/<t[dh]/i)){for(var N=z,K=0;N.charAt(0)=="<"&&(K=N.indexOf(">"))>-1;)N=N.slice(K+1);for(var te=0;te<S.length;++te){var J=S[te];J.s.c==p&&J.s.r<d&&d<=J.e.r&&(p=J.e.c+1,te=-1)}var k=ut(z.slice(0,z.indexOf(">")));_=k.colspan?+k.colspan:1,((v=+k.rowspan)>1||_>1)&&S.push({s:{r:d,c:p},e:{r:d+(v||1)-1,c:p+_-1}});var I=k.t||k["data-t"]||"";if(!N.length){p+=_;continue}if(N=MA(N),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!N.length){p+=_;continue}var R={t:"s",v:N};r.raw||!N.trim().length||I=="s"||(N==="TRUE"?R={t:"b",v:!0}:N==="FALSE"?R={t:"b",v:!1}:isNaN(_i(N))?isNaN(eu(N).getDate())||(R={t:"d",v:xr(N)},r.cellDates||(R={t:"n",v:on(R.v)}),R.z=r.dateNF||st[14]):R={t:"n",v:_i(N)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=R):n[ot({r:d,c:p})]=R,p+=_}}}}return n["!ref"]=vt(y),S.length&&(n["!merges"]=S),n}function Mz(t,e,r,n){for(var a=t["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,h=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,h=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var p=ot({r,c:l}),v=n.dense?(t[r]||[])[l]:t[p],_=v&&v.v!=null&&(v.h||Px(v.w||(Ss(v),v.w)||""))||"",y={};u>1&&(y.rowspan=u),h>1&&(y.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(y["data-t"]=v&&v.t||"z",v.v!=null&&(y["data-v"]=v.v),v.z!=null&&(y["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),y.id=(n.id||"sjs")+"-"+p,o.push(Be("td",_,y))}}var S="<tr>";return S+o.join("")+"</tr>"}var Lz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Pz="</body></html>";function Vz(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Bo(_E(r[0],e),e);var n=hv();return r.forEach(function(a,o){dv(n,_E(a,e),"Sheet"+(o+1))}),n}function Bz(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function hk(t,e){var r=e||{},n=r.header!=null?r.header:Lz,a=r.footer!=null?r.footer:Pz,o=[n],l=ha(t["!ref"]);r.dense=Array.isArray(t),o.push(Bz(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(Mz(t,l,u,r));return o.push("</table>"+a),o.join("")}function dk(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var p=ha(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var v=[],_=0,y=t["!rows"]||(t["!rows"]=[]),S=0,w=0,b=0,F=0,z=0,N=0;for(t["!cols"]||(t["!cols"]=[]);S<u.length&&w<h;++S){var K=u[S];if(yE(K)){if(n.display)continue;y[w]={hidden:!0}}var te=K.children;for(b=F=0;b<te.length;++b){var J=te[b];if(!(n.display&&yE(J))){var k=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):MA(J.innerHTML),I=J.getAttribute("data-z")||J.getAttribute("z");for(_=0;_<v.length;++_){var R=v[_];R.s.c==F+o&&R.s.r<w+a&&w+a<=R.e.r&&(F=R.e.c+1-o,_=-1)}N=+J.getAttribute("colspan")||1,((z=+J.getAttribute("rowspan")||1)>1||N>1)&&v.push({s:{r:w+a,c:F+o},e:{r:w+a+(z||1)-1,c:F+o+(N||1)-1}});var M={t:"s",v:k},O=J.getAttribute("data-t")||J.getAttribute("t")||"";k!=null&&(k.length==0?M.t=O||"z":n.raw||k.trim().length==0||O=="s"||(k==="TRUE"?M={t:"b",v:!0}:k==="FALSE"?M={t:"b",v:!1}:isNaN(_i(k))?isNaN(eu(k).getDate())||(M={t:"d",v:xr(k)},n.cellDates||(M={t:"n",v:on(M.v)}),M.z=n.dateNF||st[14]):M={t:"n",v:_i(k)})),M.z===void 0&&I!=null&&(M.z=I);var D="",V=J.getElementsByTagName("A");if(V&&V.length)for(var _e=0;_e<V.length&&!(V[_e].hasAttribute("href")&&(D=V[_e].getAttribute("href"),D.charAt(0)!="#"));++_e);D&&D.charAt(0)!="#"&&(M.l={Target:D}),n.dense?(t[w+a]||(t[w+a]=[]),t[w+a][F+o]=M):t[ot({c:F+o,r:w+a})]=M,d.e.c<F+o&&(d.e.c=F+o),F+=N}}++w}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,w-1+a),t["!ref"]=vt(d),w>=h&&(t["!fullref"]=vt((d.e.r=u.length-S+w-1+a,d))),t}function mk(t,e){var r=e||{},n=r.dense?[]:{};return dk(n,t,e)}function Uz(t,e){return Bo(mk(t,e),e)}function yE(t){var e="",r=jz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function jz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function zz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Vt(e.replace(/<[^>]*>/g,""));return[r]}var TE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function pk(t,e){var r=e||{},n=Vx(t),a=[],o,l,u={name:""},h="",d=0,p,v,_={},y=[],S=r.dense?[]:{},w,b,F={value:""},z="",N=0,K=[],te=-1,J=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,R={},M=[],O={},D=0,V=0,_e=[],Te=1,ne=1,oe=[],ke={Names:[]},ae={},Le=["",""],Q=[],L={},W="",G=0,Z=!1,le=!1,Se=0;for(qf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=qf.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?S["!ref"]=vt(k):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(S["!fullref"]=S["!ref"],k.e.r=r.sheetRows-1,S["!ref"]=vt(k)),M.length&&(S["!merges"]=M),_e.length&&(S["!rows"]=_e),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),_[p.name]=S,le=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=ut(w[0],!1),te=J=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,S=r.dense?[]:{},M=[],_e=[],le=!0);break;case"table-row-group":w[1]==="/"?--I:++I;break;case"table-row":case"":if(w[1]==="/"){te+=Te,Te=1;break}if(v=ut(w[0],!1),v.?te=v.-1:te==-1&&(te=0),Te=+v["number-rows-repeated"]||1,Te<10)for(Se=0;Se<Te;++Se)I>0&&(_e[te+Se]={level:I});J=-1;break;case"covered-table-cell":w[1]!=="/"&&++J,r.sheetStubs&&(r.dense?(S[te]||(S[te]=[]),S[te][J]={t:"z"}):S[ot({r:te,c:J})]={t:"z"}),z="",K=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++J,F=ut(w[0],!1),ne=parseInt(F["number-columns-repeated"]||"1",10),b={t:"z",v:null},F.formula&&r.cellFormula!=!1&&(b.f=gE(Vt(F.formula))),(F.||F["value-type"])=="string"&&(b.t="s",b.v=Vt(F["string-value"]||""),r.dense?(S[te]||(S[te]=[]),S[te][J]=b):S[ot({r:te,c:J})]=b),J+=ne-1;else if(w[1]!=="/"){++J,z="",N=0,K=[],ne=1;var Ne=Te?te+Te-1:te;if(J>k.e.c&&(k.e.c=J),J<k.s.c&&(k.s.c=J),te<k.s.r&&(k.s.r=te),Ne>k.e.r&&(k.e.r=Ne),F=ut(w[0],!1),Q=[],L={},b={t:F.||F["value-type"],v:null},r.cellFormula)if(F.formula&&(F.formula=Vt(F.formula)),F["number-matrix-columns-spanned"]&&F["number-matrix-rows-spanned"]&&(D=parseInt(F["number-matrix-rows-spanned"],10)||0,V=parseInt(F["number-matrix-columns-spanned"],10)||0,O={s:{r:te,c:J},e:{r:te+D-1,c:J+V-1}},b.F=vt(O),oe.push([O,b.F])),F.formula)b.f=gE(F.formula);else for(Se=0;Se<oe.length;++Se)te>=oe[Se][0].s.r&&te<=oe[Se][0].e.r&&J>=oe[Se][0].s.c&&J<=oe[Se][0].e.c&&(b.F=oe[Se][1]);switch((F["number-columns-spanned"]||F["number-rows-spanned"])&&(D=parseInt(F["number-rows-spanned"],10)||0,V=parseInt(F["number-columns-spanned"],10)||0,O={s:{r:te,c:J},e:{r:te+D-1,c:J+V-1}},M.push(O)),F["number-columns-repeated"]&&(ne=parseInt(F["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=mr(F["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(F.value);break;case"percentage":b.t="n",b.v=parseFloat(F.value);break;case"currency":b.t="n",b.v=parseFloat(F.value);break;case"date":b.t="d",b.v=xr(F["date-value"]),r.cellDates||(b.t="n",b.v=on(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=pF(F["time-value"])/86400,r.cellDates&&(b.t="d",b.v=ym(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(F.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",F["string-value"]!=null&&(z=Vt(F["string-value"]),K=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(Z=!1,b.t==="s"&&(b.v=z||"",K.length&&(b.R=K),Z=N==0),ae.Target&&(b.l=ae),Q.length>0&&(b.c=Q,Q=[]),z&&r.cellText!==!1&&(b.w=z),Z&&(b.t="z",delete b.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=te))for(var Ae=0;Ae<Te;++Ae){if(ne=parseInt(F["number-columns-repeated"]||"1",10),r.dense)for(S[te+Ae]||(S[te+Ae]=[]),S[te+Ae][J]=Ae==0?b:vr(b);--ne>0;)S[te+Ae][J+ne]=vr(b);else for(S[ot({r:te+Ae,c:J})]=b;--ne>0;)S[ot({r:te+Ae,c:J+ne})]=vr(b);k.e.c<=J&&(k.e.c=J)}ne=parseInt(F["number-columns-repeated"]||"1",10),J+=ne-1,ne=0,b={},z="",K=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;L.t=z,K.length&&(L.R=K),L.a=W,Q.push(L)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);W="",G=0,z="",N=0,K=[];break;case"creator":w[1]==="/"?W=n.slice(G,w.index):G=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);z="",N=0,K=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(R[u.name]=h,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=ut(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ut(w[0],!1),h+=TE[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ut(w[0],!1),h+=TE[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":l=ut(w[0],!1),Le=Gp(l["cell-range-address"]);var Ie={Name:l.name,Ref:Le[0]+"!"+Le[1]};le&&(Ie.Sheet=y.length),ke.Names.push(Ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!F||!F["string-value"])){var nt=zz(n.slice(N,w.index));z=(z.length>0?z+`
`:"")+nt[0]}else ut(w[0],!1),N=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Le=Gp(ut(w[0])["target-range-address"]),_[Le[0]]["!autofilter"]={ref:Le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ae=ut(w[0],!1),!ae.href)break;ae.Target=Vt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Le=Gp(ae.Target.slice(1)),ae.Target="#"+Le[0]+"!"+Le[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var ee={Sheets:_,SheetNames:y,Workbook:ke};return r.bookSheets&&delete ee.Sheets,ee}function wE(t,e){e=e||{},Wa(t,"META-INF/manifest.xml")&&pM($r(t,"META-INF/manifest.xml"),e);var r=Na(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=pk(cr(r),e);return Wa(t,"meta.xml")&&(n.Props=ib($r(t,"meta.xml"))),n}function EE(t,e){return pk(t,e)}var Hz=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Gf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Br+e}})(),SE=(function(){var t=function(o){return nr(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(o,l,u){var h=[];h.push('      <table:table table:name="'+nr(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,v=ha(o["!ref"]||"A1"),_=o["!merges"]||[],y=0,S=Array.isArray(o);if(o["!cols"])for(p=0;p<=v.e.c;++p)h.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var w="",b=o["!rows"]||[];for(d=0;d<v.s.r;++d)w=b[d]?' table:style-name="ro'+b[d].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=v.e.r;++d){for(w=b[d]?' table:style-name="ro'+b[d].ods+'"':"",h.push("        <table:table-row"+w+`>
`),p=0;p<v.s.c;++p)h.push(e);for(;p<=v.e.c;++p){var F=!1,z={},N="";for(y=0;y!=_.length;++y)if(!(_[y].s.c>p)&&!(_[y].s.r>d)&&!(_[y].e.c<p)&&!(_[y].e.r<d)){(_[y].s.c!=p||_[y].s.r!=d)&&(F=!0),z["table:number-columns-spanned"]=_[y].e.c-_[y].s.c+1,z["table:number-rows-spanned"]=_[y].e.r-_[y].s.r+1;break}if(F){h.push(r);continue}var K=ot({r:d,c:p}),te=S?(o[d]||[])[p]:o[K];if(te&&te.f&&(z["table:formula"]=nr(cB(te.f)),te.F&&te.F.slice(0,K.length)==K)){var J=ha(te.F);z["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,z["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1}if(!te){h.push(e);continue}switch(te.t){case"b":N=te.v?"TRUE":"FALSE",z["office:value-type"]="boolean",z["office:boolean-value"]=te.v?"true":"false";break;case"n":N=te.w||String(te.v||0),z["office:value-type"]="float",z["office:value"]=te.v||0;break;case"s":case"str":N=te.v==null?"":te.v,z["office:value-type"]="string";break;case"d":N=te.w||xr(te.v).toISOString(),z["office:value-type"]="date",z["office:date-value"]=xr(te.v).toISOString(),z["table:style-name"]="ce1";break;default:h.push(e);continue}var k=t(N);if(te.l&&te.l.Target){var I=te.l.Target;I=I.charAt(0)=="#"?"#"+uB(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),k=Be("text:a",k,{"xlink:href":I.replace(/&/g,"&amp;")})}h.push("          "+Be("table:table-cell",Be("text:p",k,{}),z)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var v=d["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Oo(v),v.ods=u;var _=d["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++u}}});var h=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=h;var v=d["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var h=[Br],d=Gf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Gf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+p+`>
`),h.push(ab().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),a(h,l),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)h.push(n(l.Sheets[l.SheetNames[v]],l,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function gk(t,e){if(e.bookType=="fods")return SE(t,e);var r=Fx(),n="",a=[],o=[];return n="mimetype",Tt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(r,n,SE(t,e)),a.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",Tt(r,n,Hz(t,e)),a.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",Tt(r,n,Br+ab()),a.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",Tt(r,n,vM(o)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(r,n,gM(a)),r}function Fl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Mg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):cr(Vo(t))}function Gz(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ca(Pi(t))}function qz(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Mo(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function AE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Xz(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Wz(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=r>=0?0:128}function Jf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function tr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Nr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ht(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=Jf(t,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Jf(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:o};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function wn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(tr(n*8+a.type)),a.type==2&&e.push(tr(a.data.length)),e.push(a.data))})}),Mo(e)}function ov(t,e){return t?.map(function(r){return e(r.data)})||[]}function qa(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=Jf(t,n),o=Ht(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Nr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=Ht(u.data),d=Nr(h[3][0].data);l.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(l.merge=Nr(o[3][0].data)>>>0>0),r.push(l)}return r}function kc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:tr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:tr(l.data.length)}],n[2].push({data:wn(l.meta),type:2})});var o=wn(n);e.push(tr(o.length)),e.push(o),a.forEach(function(l){return e.push(l)})}),Mo(e)}function Kz(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Jf(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Mo(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(a.push(a[0].slice(-h)),d-=h;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-h,-h+d))}}var p=Mo(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Xa(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Kz(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Mo(e)}function Cc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var o=tr(n),l=o.length;e.push(o),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Mo(e)}function $z(t,e,r,n){var a=Fl(t),o=a.getUint32(4,!0),l=(n>1?12:8)+AE(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,p=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=AE(o&(n>1?12288:4096))*4,o&16&&(h=a.getUint32(l,!0),l+=4),o&32&&(d=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:e[h]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function Yz(t,e,r){var n=Fl(t),a=n.getUint32(8,!0),o=12,l=-1,u=-1,h=NaN,d=NaN,p=new Date(2001,0,1);a&1&&(h=Xz(t,o),o+=16),a&2&&(d=n.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function Xp(t,e){var r=new Uint8Array(32),n=Fl(r),a=12,o=0;switch(r[0]=5,t.t){case"n":r[1]=2,Wz(r,a,t.v),o|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,o,!0),r.slice(0,a)}function Wp(t,e){var r=new Uint8Array(32),n=Fl(r),a=12,o=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,o,!0),r.slice(0,a)}function Qz(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return $z(t,e,r,t[0]);case 5:return Yz(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ln(t){var e=Ht(t);return Jf(e[1][0].data)}function bE(t,e){var r=Ht(e.data),n=Nr(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=Ht(l.data),h=Nr(u[1][0].data)>>>0;switch(n){case 1:o[h]=Mg(u[3][0].data);break;case 8:{var d=t[Ln(u[9][0].data)][0],p=Ht(d.data),v=t[Ln(p[1][0].data)][0],_=Nr(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var y=Ht(v.data);o[h]=y[3].map(function(S){return Mg(S.data)}).join("")}break}}),o}function Jz(t,e){var r,n,a,o,l,u,h,d,p,v,_,y,S,w,b=Ht(t),F=Nr(b[1][0].data)>>>0,z=Nr(b[2][0].data)>>>0,N=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&Nr(b[8][0].data)>0||!1,K,te;if((o=(a=b[7])==null?void 0:a[0])!=null&&o.data&&e!=0)K=(u=(l=b[7])==null?void 0:l[0])==null?void 0:u.data,te=(d=(h=b[6])==null?void 0:h[0])==null?void 0:d.data;else if((v=(p=b[4])==null?void 0:p[0])!=null&&v.data&&e!=1)K=(y=(_=b[4])==null?void 0:_[0])==null?void 0:y.data,te=(w=(S=b[3])==null?void 0:S[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var J=N?4:1,k=Fl(K),I=[],R=0;R<K.length/2;++R){var M=k.getUint16(R*2,!0);M<65535&&I.push([R,M])}if(I.length!=z)throw"Expected ".concat(z," cells, found ").concat(I.length);var O=[];for(R=0;R<I.length-1;++R)O[I[R][0]]=te.subarray(I[R][1]*J,I[R+1][1]*J);return I.length>=1&&(O[I[I.length-1][0]]=te.subarray(I[I.length-1][1]*J)),{R:F,cells:O}}function Zz(t,e){var r,n=Ht(e.data),a=(r=n?.[7])!=null&&r[0]?Nr(n[7][0].data)>>>0>0?1:0:-1,o=ov(n[5],function(l){return Jz(l,a)});return{nrows:Nr(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(h,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=h}),l},[])}}function eH(t,e,r){var n,a=Ht(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Nr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Nr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=vt(o);var l=Ht(a[4][0].data),u=bE(t,t[Ln(l[4][0].data)][0]),h=(n=l[17])!=null&&n[0]?bE(t,t[Ln(l[17][0].data)][0]):[],d=Ht(l[3][0].data),p=0;d[1].forEach(function(v){var _=Ht(v.data),y=t[Ln(_[2][0].data)][0],S=Nr(y.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var w=Zz(t,y);w.data.forEach(function(b,F){b.forEach(function(z,N){var K=ot({r:p+F,c:N}),te=Qz(z,u,h);te&&(r[K]=te)})}),p+=w.nrows})}function tH(t,e){var r=Ht(e.data),n={"!ref":"A1"},a=t[Ln(r[2][0].data)],o=Nr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return eH(t,a[0],n),n}function rH(t,e){var r,n=Ht(e.data),a={name:(r=n[1])!=null&&r[0]?Mg(n[1][0].data):"",sheets:[]},o=ov(n[2],Ln);return o.forEach(function(l){t[l].forEach(function(u){var h=Nr(u.meta[1][0].data);h==6e3&&a.sheets.push(tH(t,u))})}),a}function nH(t,e){var r=hv(),n=Ht(e.data),a=ov(n[1],Ln);if(a.forEach(function(o){t[o].forEach(function(l){var u=Nr(l.meta[1][0].data);if(u==2){var h=rH(t,l);h.sheets.forEach(function(d,p){dv(r,d,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Kp(t){var e,r,n,a,o={},l=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=Xa(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=qa(d)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Nr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(h){o[h].forEach(function(d){var p=Nr(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return nH(o,u)}function aH(t,e,r){var n,a,o,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=t[8])==null?void 0:o[0])==null?void 0:l.data)&&Nr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Fl(t[7][0].data),p=0,v=[],_=Fl(t[4][0].data),y=0,S=[],w=0;w<e.length;++w){if(e[w]==null){d.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}d.setUint16(w*2,p,!0),_.setUint16(w*2,y,!0);var b,F;switch(typeof e[w]){case"string":b=Xp({t:"s",v:e[w]},r),F=Wp({t:"s",v:e[w]},r);break;case"number":b=Xp({t:"n",v:e[w]},r),F=Wp({t:"n",v:e[w]},r);break;case"boolean":b=Xp({t:"b",v:e[w]},r),F=Wp({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}v.push(b),p+=b.length,S.push(F),y+=F.length,++h}for(t[2][0].data=tr(h);w<t[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return t[6][0].data=Mo(v),t[3][0].data=Mo(S),h}function iH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ha(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var o=Gd(r,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(W){return W.forEach(function(G){typeof G=="string"&&l.push(G)})});var u={},h=[],d=tt.read(e.numbers,{type:"base64"});d.FileIndex.map(function(W,G){return[W,d.FullPaths[G]]}).forEach(function(W){var G=W[0],Z=W[1];if(G.type==2&&G.name.match(/\.iwa/)){var le=G.content,Se=Xa(le),Ne=qa(Se);Ne.forEach(function(Ae){h.push(Ae.id),u[Ae.id]={deps:[],location:Z,type:Nr(Ae.messages[0].meta[1][0].data)}})}}),h.sort(function(W,G){return W-G});var p=h.filter(function(W){return W>1}).map(function(W){return[W,tr(W)]});d.FileIndex.map(function(W,G){return[W,d.FullPaths[G]]}).forEach(function(W){var G=W[0];if(W[1],!!G.name.match(/\.iwa/)){var Z=qa(Xa(G.content));Z.forEach(function(le){le.messages.forEach(function(Se){p.forEach(function(Ne){le.messages.some(function(Ae){return Nr(Ae.meta[1][0].data)!=11006&&qz(Ae.data,Ne[1])})&&u[Ne[0]].deps.push(le.id)})})})}});for(var v=tt.find(d,u[1].location),_=qa(Xa(v.content)),y,S=0;S<_.length;++S){var w=_[S];w.id==1&&(y=w)}var b=Ln(Ht(y.messages[0].data)[1][0].data);for(v=tt.find(d,u[b].location),_=qa(Xa(v.content)),S=0;S<_.length;++S)w=_[S],w.id==b&&(y=w);for(b=Ln(Ht(y.messages[0].data)[2][0].data),v=tt.find(d,u[b].location),_=qa(Xa(v.content)),S=0;S<_.length;++S)w=_[S],w.id==b&&(y=w);for(b=Ln(Ht(y.messages[0].data)[2][0].data),v=tt.find(d,u[b].location),_=qa(Xa(v.content)),S=0;S<_.length;++S)w=_[S],w.id==b&&(y=w);var F=Ht(y.messages[0].data);{F[6][0].data=tr(n.e.r+1),F[7][0].data=tr(n.e.c+1);var z=Ln(F[46][0].data),N=tt.find(d,u[z].location),K=qa(Xa(N.content));{for(var te=0;te<K.length&&K[te].id!=z;++te);if(K[te].id!=z)throw"Bad ColumnRowUIDMapArchive";var J=Ht(K[te].messages[0].data);J[1]=[],J[2]=[],J[3]=[];for(var k=0;k<=n.e.c;++k){var I=[];I[1]=I[2]=[{type:0,data:tr(k+420690)}],J[1].push({type:2,data:wn(I)}),J[2].push({type:0,data:tr(k)}),J[3].push({type:0,data:tr(k)})}J[4]=[],J[5]=[],J[6]=[];for(var R=0;R<=n.e.r;++R)I=[],I[1]=I[2]=[{type:0,data:tr(R+726270)}],J[4].push({type:2,data:wn(I)}),J[5].push({type:0,data:tr(R)}),J[6].push({type:0,data:tr(R)});K[te].messages[0].data=wn(J)}N.content=Cc(kc(K)),N.size=N.content.length,delete F[46];var M=Ht(F[4][0].data);{M[7][0].data=tr(n.e.r+1);var O=Ht(M[1][0].data),D=Ln(O[2][0].data);N=tt.find(d,u[D].location),K=qa(Xa(N.content));{if(K[0].id!=D)throw"Bad HeaderStorageBucket";var V=Ht(K[0].messages[0].data);for(R=0;R<o.length;++R){var _e=Ht(V[2][0].data);_e[1][0].data=tr(R),_e[4][0].data=tr(o[R].length),V[2][R]={type:V[2][0].type,data:wn(_e)}}K[0].messages[0].data=wn(V)}N.content=Cc(kc(K)),N.size=N.content.length;var Te=Ln(M[2][0].data);N=tt.find(d,u[Te].location),K=qa(Xa(N.content));{if(K[0].id!=Te)throw"Bad HeaderStorageBucket";for(V=Ht(K[0].messages[0].data),k=0;k<=n.e.c;++k)_e=Ht(V[2][0].data),_e[1][0].data=tr(k),_e[4][0].data=tr(n.e.r+1),V[2][k]={type:V[2][0].type,data:wn(_e)};K[0].messages[0].data=wn(V)}N.content=Cc(kc(K)),N.size=N.content.length;var ne=Ln(M[4][0].data);(function(){for(var W=tt.find(d,u[ne].location),G=qa(Xa(W.content)),Z,le=0;le<G.length;++le){var Se=G[le];Se.id==ne&&(Z=Se)}var Ne=Ht(Z.messages[0].data);{Ne[3]=[];var Ae=[];l.forEach(function(ee,Ft){Ae[1]=[{type:0,data:tr(Ft)}],Ae[2]=[{type:0,data:tr(1)}],Ae[3]=[{type:2,data:Gz(ee)}],Ne[3].push({type:2,data:wn(Ae)})})}Z.messages[0].data=wn(Ne);var Ie=kc(G),nt=Cc(Ie);W.content=nt,W.size=W.content.length})();var oe=Ht(M[3][0].data);{var ke=oe[1][0];delete oe[2];var ae=Ht(ke.data);{var Le=Ln(ae[2][0].data);(function(){for(var W=tt.find(d,u[Le].location),G=qa(Xa(W.content)),Z,le=0;le<G.length;++le){var Se=G[le];Se.id==Le&&(Z=Se)}var Ne=Ht(Z.messages[0].data);{delete Ne[6],delete oe[7];var Ae=new Uint8Array(Ne[5][0].data);Ne[5]=[];for(var Ie=0,nt=0;nt<=n.e.r;++nt){var ee=Ht(Ae);Ie+=aH(ee,o[nt],l),ee[1][0].data=tr(nt),Ne[5].push({data:wn(ee),type:2})}Ne[1]=[{type:0,data:tr(n.e.c+1)}],Ne[2]=[{type:0,data:tr(n.e.r+1)}],Ne[3]=[{type:0,data:tr(Ie)}],Ne[4]=[{type:0,data:tr(n.e.r+1)}]}Z.messages[0].data=wn(Ne);var Ft=kc(G),ft=Cc(Ft);W.content=ft,W.size=W.content.length})()}ke.data=wn(ae)}M[3][0].data=wn(oe)}F[4][0].data=wn(M)}y.messages[0].data=wn(F);var Q=kc(_),L=Cc(Q);return v.content=L,v.size=v.content.length,d}function xk(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function lv(t){xk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function cv(t){xk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function sH(t){return Et.WS.indexOf(t)>-1?"sheet":t==Et.CS?"chart":t==Et.DS?"dialog":t==Et.MS?"macro":t&&t.length?t:"sheet"}function oH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,sH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function lH(t,e,r,n,a,o,l,u,h,d,p,v){try{o[n]=bf(Na(t,r,!0),e);var _=$r(t,e),y;switch(u){case"sheet":y=Rj(_,e,a,h,o[n],d,p,v);break;case"chart":if(y=Ij(_,e,a,h,o[n],d,p,v),!y||!y["!drawel"])break;var S=gf(y["!drawel"].Target,e),w=Xf(S),b=xP(Na(t,S,!0),bf(Na(t,w,!0),S)),F=gf(b,S),z=Xf(F);y=aj(Na(t,F,!0),F,h,bf(Na(t,z,!0),F),d,y);break;case"macro":y=Dj(_,e,a,h,o[n],d,p,v);break;case"dialog":y=Oj(_,e,a,h,o[n],d,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=y;var N=[];o&&o[n]&&Rr(o[n]).forEach(function(K){var te="";if(o[n][K].Type==Et.CMNT){te=gf(o[n][K].Target,e);var J=Pj($r(t,te,!0),te,h);if(!J||!J.length)return;fE(y,J,!1)}o[n][K].Type==Et.TCMNT&&(te=gf(o[n][K].Target,e),N=N.concat(_P($r(t,te,!0),h)))}),N&&N.length&&fE(y,N,!0,h.people||[])}catch(K){if(h.WTF)throw K}}function Ha(t){return t.charAt(0)=="/"?t.slice(1):t}function cH(t,e){if(fu(),e=e||{},lv(e),Wa(t,"META-INF/manifest.xml")||Wa(t,"objectdata.xml"))return wE(t,e);if(Wa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Kp<"u"){if(t.FileIndex)return Kp(t);var r=tt.utils.cfb_new();return Dw(t).forEach(function(_e){Tt(r,_e,yF(t,_e))}),Kp(r)}throw new Error("Unsupported NUMBERS file")}if(!Wa(t,"[Content_Types].xml"))throw Wa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Dw(t),a=dM(Na(t,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",$r(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!$r(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(kf=[],a.sst)try{kf=Lj($r(t,Ha(a.sst)),a.sst,e)}catch(_e){if(e.WTF)throw _e}e.cellStyles&&a.themes.length&&(h=Mj(Na(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=Fj($r(t,Ha(a.style)),a.style,h,e))}a.links.map(function(_e){try{var Te=bf(Na(t,Xf(Ha(_e))),_e);return Bj($r(t,Ha(_e)),Te,_e,e)}catch{}});var p=Nj($r(t,Ha(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=$r(t,Ha(a.coreprops[0]),!0),_&&(v=ib(_)),a.extprops.length!==0&&(_=$r(t,Ha(a.extprops[0]),!0),_&&yM(_,v,e)));var y={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Na(t,Ha(a.custprops[0]),!0),_&&(y=wM(_,e)));var S={};if((e.bookSheets||e.bookProps)&&(p.Sheets?l=p.Sheets.map(function(Te){return Te.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(S.Props=v,S.Custprops=y),e.bookSheets&&typeof l<"u"&&(S.SheetNames=l),e.bookSheets?S.SheetNames:e.bookProps))return S;l={};var w={};e.bookDeps&&a.calcchain&&(w=Vj($r(t,Ha(a.calcchain)),a.calcchain));var b=0,F={},z,N;{var K=p.Sheets;v.Worksheets=K.length,v.SheetNames=[];for(var te=0;te!=K.length;++te)v.SheetNames[te]=K[te].name}var J=o?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Wa(t,I)||(I="xl/_rels/workbook."+J+".rels");var R=bf(Na(t,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=Uj($r(t,Ha(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=TP($r(t,Ha(a.people[0])),e)),R&&(R=oH(R,p.Sheets));var M=$r(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=v.Worksheets;++b){var O="sheet";if(R&&R[b]?(z="xl/"+R[b][1].replace(/[\/]?xl\//,""),Wa(t,z)||(z=R[b][1]),Wa(t,z)||(z=I.replace(/_rels\/.*$/,"")+R[b][1]),O=R[b][2]):(z="xl/worksheets/sheet"+(b+1-M)+"."+J,z=z.replace(/sheet0\./,"sheet.")),N=z.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(v.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,V=0;V!=e.sheets.length;++V)typeof e.sheets[V]=="number"&&e.sheets[V]==b&&(D=1),typeof e.sheets[V]=="string"&&e.sheets[V].toLowerCase()==v.SheetNames[b].toLowerCase()&&(D=1);if(!D)continue e}}lH(t,z,N,v.SheetNames[b],b,F,l,O,e,p,h,d)}return S={Directory:a,Workbook:p,Props:v,Custprops:y,Deps:w,Sheets:l,SheetNames:v.SheetNames,Strings:kf,Styles:d,Themes:h,SSF:vr(st)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(_e,Te){_e=_e.replace(/^Root Entry[\/]/,""),S.keys.push(_e),S.files[_e]=t.FileIndex[Te]}))),e&&e.bookVBA&&(a.vba.length>0?S.vbaraw=$r(t,Ha(a.vba[0]),!0):a.defaults&&a.defaults.bin===NP&&(S.vbaraw=$r(t,"xl/vbaProject.bin",!0))),S}function uH(t,e){var r=e||{},n="Workbook",a=tt.find(t,n);try{if(n="/!DataSpaces/Version",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(U7(a.content),n="/!DataSpaces/DataSpaceMap",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=z7(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=H7(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);q7(a.content)}catch{}if(n="/EncryptionInfo",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=X7(a.content);if(n="/EncryptedPackage",a=tt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function fH(t,e){return e.bookType=="ods"?gk(t,e):e.bookType=="numbers"?iH(t,e):e.bookType=="xlsb"?hH(t,e):dH(t,e)}function hH(t,e){Pc=1024,t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(fu(),xm(t.SSF),e.revssf=_m(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Gb.indexOf(e.bookType)>-1,a=Kx();cv(e=e||{});var o=Fx(),l="",u=0;if(e.cellXfs=[],Uo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Tt(o,l,sb(t.Props,e)),a.coreprops.push(l),rr(e.rels,2,l,Et.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,Tt(o,l,cb(t.Props)),a.extprops.push(l),rr(e.rels,3,l,Et.EXT_PROPS),t.Custprops!==t.Props&&Rr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(o,l,ub(t.Custprops)),a.custprops.push(l),rr(e.rels,4,l,Et.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,Tt(o,l,zj(u-1,l,e,t,p)),a.sheets.push(l),rr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Et.WS[0]),v){var y=v["!comments"],S=!1,w="";y&&y.length>0&&(w="xl/comments"+u+"."+r,Tt(o,w,qj(y,w)),a.comments.push(w),rr(p,-1,"../comments"+u+"."+r,Et.CMNT),S=!0),v["!legacy"]&&S&&Tt(o,"xl/drawings/vmlDrawing"+u+".vml",zb(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&Tt(o,Xf(l),Gc(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Tt(o,l,Gj(e.Strings,l,e)),a.strs.push(l),rr(e.wbrels,-1,"sharedStrings."+r,Et.SST)),l="xl/workbook."+r,Tt(o,l,jj(t,l)),a.workbooks.push(l),rr(e.rels,1,l,Et.WB),l="xl/theme/theme1.xml",Tt(o,l,ev(t.Themes,e)),a.themes.push(l),rr(e.wbrels,-1,"theme/theme1.xml",Et.THEME),l="xl/styles."+r,Tt(o,l,Hj(t,l,e)),a.styles.push(l),rr(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(o,l,t.vbaraw),a.vba.push(l),rr(e.wbrels,-1,"vbaProject.bin",Et.VBA)),l="xl/metadata."+r,Tt(o,l,Xj(l)),a.metadata.push(l),rr(e.wbrels,-1,"metadata."+r,Et.XLMETA),Tt(o,"[Content_Types].xml",nb(a,e)),Tt(o,"_rels/.rels",Gc(e.rels)),Tt(o,"xl/_rels/workbook."+r+".rels",Gc(e.wbrels)),delete e.revssf,delete e.ssf,o}function dH(t,e){Pc=1024,t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(fu(),xm(t.SSF),e.revssf=_m(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Cf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Gb.indexOf(e.bookType)>-1,a=Kx();cv(e=e||{});var o=Fx(),l="",u=0;if(e.cellXfs=[],Uo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Tt(o,l,sb(t.Props,e)),a.coreprops.push(l),rr(e.rels,2,l,Et.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,Tt(o,l,cb(t.Props)),a.extprops.push(l),rr(e.rels,3,l,Et.EXT_PROPS),t.Custprops!==t.Props&&Rr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(o,l,ub(t.Custprops)),a.custprops.push(l),rr(e.rels,4,l,Et.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},_=t.Sheets[t.SheetNames[u-1]],y=(_||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,Tt(o,l,tk(u-1,e,t,v)),a.sheets.push(l),rr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Et.WS[0]),_){var S=_["!comments"],w=!1,b="";if(S&&S.length>0){var F=!1;S.forEach(function(z){z[1].forEach(function(N){N.T==!0&&(F=!0)})}),F&&(b="xl/threadedComments/threadedComment"+u+"."+r,Tt(o,b,yP(S,p,e)),a.threadedcomments.push(b),rr(v,-1,"../threadedComments/threadedComment"+u+"."+r,Et.TCMNT)),b="xl/comments"+u+"."+r,Tt(o,b,Hb(S)),a.comments.push(b),rr(v,-1,"../comments"+u+"."+r,Et.CMNT),w=!0}_["!legacy"]&&w&&Tt(o,"xl/drawings/vmlDrawing"+u+".vml",zb(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&Tt(o,Xf(l),Gc(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Tt(o,l,Rb(e.Strings,e)),a.strs.push(l),rr(e.wbrels,-1,"sharedStrings."+r,Et.SST)),l="xl/workbook."+r,Tt(o,l,sk(t)),a.workbooks.push(l),rr(e.rels,1,l,Et.WB),l="xl/theme/theme1.xml",Tt(o,l,ev(t.Themes,e)),a.themes.push(l),rr(e.wbrels,-1,"theme/theme1.xml",Et.THEME),l="xl/styles."+r,Tt(o,l,Vb(t,e)),a.styles.push(l),rr(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(o,l,t.vbaraw),a.vba.push(l),rr(e.wbrels,-1,"vbaProject.bin",Et.VBA)),l="xl/metadata."+r,Tt(o,l,jb()),a.metadata.push(l),rr(e.wbrels,-1,"metadata."+r,Et.XLMETA),p.length>1&&(l="xl/persons/person.xml",Tt(o,l,wP(p)),a.people.push(l),rr(e.wbrels,-1,"persons/person.xml",Et.PEOPLE)),Tt(o,"[Content_Types].xml",nb(a,e)),Tt(o,"_rels/.rels",Gc(e.rels)),Tt(o,"xl/_rels/workbook."+r+".rels",Gc(e.wbrels)),delete e.revssf,delete e.ssf,o}function uv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ia(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mH(t,e){return tt.find(t,"EncryptedPackage")?uH(t,e):uk(t,e)}function pH(t,e){var r,n=t,a=e||{};return a.type||(a.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r=DA(n,a),cH(r,a)}function vk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Og(t.slice(r),e);default:break e}return tu.to_workbook(t,e)}function gH(t,e){var r="",n=uv(t,e);switch(e.type){case"base64":r=Ia(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Rl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=cr(r)),e.type="binary",vk(r,e)}function xH(t,e){var r=t;return e.type=="base64"&&(r=Ia(r)),r=Uf.utils.decode(1200,r.slice(2),"str"),e.type="binary",vk(r,e)}function vH(t){return t.match(/[^\x00-\x7F]/)?Pi(t):t}function $p(t,e,r,n){return n?(r.type="string",tu.to_workbook(t,r)):tu.to_workbook(e,r)}function Zf(t,e){Nx();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Zf(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xc={},r.dateNF&&(Xc.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",n=hF(t),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=vH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=vr(r),r.type="array",Zf(Rx(n),r)}switch((a=uv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return mH(tt.read(n,r),r);break;case 9:if(a[1]<=8)return uk(n,r);break;case 60:return Og(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return E7(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Cb.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?pH(n,r):$p(t,n,r,o);case 239:return a[3]===60?Og(n,r):$p(t,n,r,o);case 255:if(a[1]===254)return xH(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Tl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Tl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Dg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Mb.to_workbook(n,r);break;case 10:case 13:case 32:return gH(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return w7.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Dg.to_workbook(n,r):$p(t,n,r,o)}function _k(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return f0(e.file,tt.write(t,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return tt.write(t,e)}function _H(t,e){var r=vr(e||{}),n=fH(t,r);return yH(n,r)}function yH(t,e){var r={},n=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?tt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(gm(a))}return e.password&&typeof encrypt_agile<"u"?_k(encrypt_agile(a,e.password),e):e.type==="file"?f0(e.file,a):e.type=="string"?cr(a):a}function TH(t,e){var r=e||{},n=vz(t,r);return _k(n,r)}function Mi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return jf(Pi(n));case"binary":return Pi(n);case"string":return t;case"file":return f0(e.file,n,"utf8");case"buffer":return wt?bs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function wH(t,e){switch(e.type){case"base64":return jf(t);case"binary":return t;case"string":return t;case"file":return f0(e.file,t,"binary");case"buffer":return wt?bs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Zh(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?jf(r):e.type=="string"?cr(r):r;case"file":return f0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function yk(t,e){Nx(),mj(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=yk(t,r);return r.type="array",gm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Mi(fz(t,r),r);case"slk":case"sylk":return Mi(kb.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Mi(hk(t.Sheets[t.SheetNames[a]],r),r);case"txt":return wH(wk(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Mi(fv(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Mi(Cb.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return Zh(Dg.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Mi(tu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Mi(Mb.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Mi(Nb.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Mi(gk(t,r),r);case"wk1":return Zh(Tl.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return Zh(Tl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Zh(fk(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),TH(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return _H(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function EH(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Tk(t,e,r){var n={};return n.type="file",n.file=e,EH(n),yk(t,n)}function SH(t,e,r,n,a,o,l,u){var h=Vr(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var y=e.s.c;y<=e.e.c;++y){var S=l?t[r][y]:t[n[y]+h];if(S===void 0||S.t===void 0){if(d===void 0)continue;o[y]!=null&&(_[o[y]]=d);continue}var w=S.v;switch(S.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[y]!=null){if(w==null)if(S.t=="e"&&w===null)_[o[y]]=null;else if(d!==void 0)_[o[y]]=d;else if(p&&w===null)_[o[y]]=null;else continue;else _[o[y]]=p&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?w:Ss(S,w,u);w!=null&&(v=!1)}}return{row:_,isempty:v}}function Gd(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":h=Bt(p);break;case"number":h=Bt(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(a=0);var v=Vr(h.s.r),_=[],y=[],S=0,w=0,b=Array.isArray(t),F=h.s.r,z=0,N={};b&&!t[F]&&(t[F]=[]);var K=d.skipHidden&&t["!cols"]||[],te=d.skipHidden&&t["!rows"]||[];for(z=h.s.c;z<=h.e.c;++z)if(!(K[z]||{}).hidden)switch(_[z]=Er(z),r=b?t[F][z]:t[_[z]+v],n){case 1:o[z]=z-h.s.c;break;case 2:o[z]=_[z];break;case 3:o[z]=d.header[z-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Ss(r,null,d),w=N[l]||0,!w)N[l]=1;else{do u=l+"_"+w++;while(N[u]);N[l]=w,N[u]=1}o[z]=u}for(F=h.s.r+a;F<=h.e.r;++F)if(!(te[F]||{}).hidden){var J=SH(t,h,F,_,n,o,b,d);(J.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[S++]=J.row)}return y.length=S,y}var kE=/"/g;function AH(t,e,r,n,a,o,l,u){for(var h=!0,d=[],p="",v=Vr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var y=u.dense?(t[r]||[])[_]:t[n[_]+v];if(y==null)p="";else if(y.v!=null){h=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:Ss(y,null,u));for(var S=0,w=0;S!==p.length;++S)if((w=p.charCodeAt(S))===a||w===o||w===34||u.forceQuotes){p='"'+p.replace(kE,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(h=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(kE,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&h?null:d.join(l)}function fv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Bt(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(v[S]=Er(S));for(var w=0,b=a.s.r;b<=a.e.r;++b)(y[b]||{}).hidden||(p=AH(t,a,b,v,l,h,o,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((w++?u:"")+p)));return delete n.dense,r.join("")}function wk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=fv(t,e);return r}function bH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Bt(t["!ref"]),o="",l=[],u,h=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=Er(u);for(var p=a.s.r;p<=a.e.r;++p)for(o=Vr(p),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function Ek(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?Sr(n.origin):n.origin;l=h.r,u=h.c}var d,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var v=Bt(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+a)}else l==-1&&(l=0,p.e.r=e.length-1+a);var _=n.header||[],y=0;e.forEach(function(w,b){Rr(w).forEach(function(F){(y=_.indexOf(F))==-1&&(_[y=_.length]=F);var z=w[F],N="z",K="",te=ot({c:u+y,r:l+b+a});d=e0(o,te),z&&typeof z=="object"&&!(z instanceof Date)?o[te]=z:(typeof z=="number"?N="n":typeof z=="boolean"?N="b":typeof z=="string"?N="s":z instanceof Date?(N="d",n.cellDates||(N="n",z=on(z)),K=n.dateNF||st[14]):z===null&&n.nullError&&(N="e",z=0),d?(d.t=N,d.v=z,delete d.w,delete d.R,K&&(d.z=K)):o[te]=d={t:N,v:z},K&&(d.z=K))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var S=Vr(l);if(a)for(y=0;y<_.length;++y)o[Er(y+u)+S]={t:"s",v:_[y]};return o["!ref"]=vt(p),o}function kH(t,e){return Ek(null,t,e)}function e0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?e0(t,ot(e)):e0(t,ot({r:e,c:r||0}))}function CH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function hv(){return{SheetNames:[],Sheets:{}}}function dv(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(ik(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function NH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=CH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function RH(t,e){return t.z=e,t}function Sk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function IH(t,e,r){return Sk(t,"#"+e,r)}function DH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function OH(t,e,r,n){for(var a=typeof e!="string"?e:Bt(e),o=typeof e=="string"?e:vt(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var h=e0(t,l,u);h.t="n",h.F=o,delete h.v,l==a.s.r&&u==a.s.c&&(h.f=r,n&&(h.D=!0))}return t}var ps={encode_col:Er,encode_row:Vr,encode_cell:ot,encode_range:vt,decode_col:zx,decode_row:jx,split_cell:GF,decode_cell:Sr,decode_range:ha,format_cell:Ss,sheet_add_aoa:YA,sheet_add_json:Ek,sheet_add_dom:dk,aoa_to_sheet:hu,json_to_sheet:kH,table_to_sheet:mk,table_to_book:Uz,sheet_to_csv:fv,sheet_to_txt:wk,sheet_to_json:Gd,sheet_to_html:hk,sheet_to_formulae:bH,sheet_to_row_object_array:Gd,sheet_get_cell:e0,book_new:hv,book_append_sheet:dv,book_set_sheet_visibility:NH,cell_set_number_format:RH,cell_set_hyperlink:Sk,cell_set_internal_link:IH,cell_add_comment:DH,sheet_set_array_formula:OH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Aa="kho-suon-muoi-official-system-v1",Ak=t=>{if(!t)return{text:"Khng xc nh",color:"text-gray-500"};if(t==="Vnh vin")return{text:"Vnh vin",color:"text-blue-400"};const e=new Date,n=new Date(t)-e;if(n<=0)return{text:" ht hn",color:"text-red-500"};const a=Math.floor(n/(1e3*60*60*24)),o=Math.floor(n/(1e3*60*60)%24),l=Math.floor(n/(1e3*60)%24);return a>365?{text:"Vnh vin",color:"text-blue-400"}:a>30?{text:`${a} ngy`,color:"text-green-500"}:a>7?{text:`${a} ngy ${o}h`,color:"text-green-400"}:a>0?{text:`${a} ngy ${o}h`,color:"text-yellow-500"}:{text:`${o} gi ${l}p`,color:"text-red-500 animate-pulse"}},dl={green:{border:"border-green-500/50",text:"text-green-500",bg:"bg-green-500/10",glow:"shadow-[0_0_15px_rgba(34,197,94,0.1)]",solid:"bg-green-500"},blue:{border:"border-blue-500/50",text:"text-blue-500",bg:"bg-blue-500/10",glow:"shadow-[0_0_15px_rgba(59,130,246,0.1)]",solid:"bg-blue-500"},purple:{border:"border-purple-500/50",text:"text-purple-500",bg:"bg-purple-500/10",glow:"shadow-[0_0_15px_rgba(168,85,247,0.1)]",solid:"bg-purple-500"},orange:{border:"border-orange-500/50",text:"text-orange-500",bg:"bg-orange-500/10",glow:"shadow-[0_0_15px_rgba(249,115,22,0.1)]",solid:"bg-orange-500"},red:{border:"border-red-500/50",text:"text-red-500",bg:"bg-red-500/10",glow:"shadow-[0_0_15px_rgba(239,68,68,0.1)]",solid:"bg-red-500"},pink:{border:"border-pink-500/50",text:"text-pink-500",bg:"bg-pink-500/10",glow:"shadow-[0_0_15px_rgba(236,72,153,0.1)]",solid:"bg-pink-500"},yellow:{border:"border-yellow-500/50",text:"text-yellow-500",bg:"bg-yellow-500/10",glow:"shadow-[0_0_15px_rgba(234,179,8,0.1)]",solid:"bg-yellow-500"},cyan:{border:"border-cyan-500/50",text:"text-cyan-500",bg:"bg-cyan-500/10",glow:"shadow-[0_0_15px_rgba(6,182,212,0.1)]",solid:"bg-cyan-500"}},bk=(t=new Date)=>{const e=t.getTimezoneOffset();return new Date(t.getTime()-e*60*1e3).toISOString().split("T")[0]},FH=({isOpen:t,title:e,message:r,onConfirm:n,onCancel:a})=>t?E.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[" ",E.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:a})," ",E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-sm shadow-2xl animate-modal-pop overflow-hidden",children:[" ",E.jsxs("div",{className:"p-6 flex flex-col items-center text-center",children:[" ",E.jsx("div",{className:"w-12 h-12 rounded-full bg-red-900/20 flex items-center justify-center mb-4",children:E.jsx(hA,{className:"text-red-500 w-6 h-6"})})," ",E.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:e})," ",E.jsx("p",{className:"text-sm text-gray-400 mb-6",children:r})," ",E.jsxs("div",{className:"flex gap-3 w-full",children:[" ",E.jsx("button",{onClick:a,className:"flex-1 bg-[#18181b] hover:bg-[#27272a] text-gray-300 py-2.5 rounded-lg text-sm font-medium transition-colors",children:"Hy"})," ",E.jsx("button",{onClick:n,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2.5 rounded-lg text-sm font-medium shadow-lg shadow-red-900/20 transition-colors",children:"Xa Ngay"})," "]})," "]})," "]})," "]}):null,MH=({onClose:t})=>{const[e,r]=qe.useState(""),[n,a]=qe.useState(""),[o,l]=qe.useState("30"),[u,h]=qe.useState(!1),[d,p]=qe.useState([]),[v,_]=qe.useState(null);qe.useEffect(()=>{const F=f4(Sa,"artifacts",Aa,"public","data","license_keys"),z=Mc(F,N=>{const K=[];N.forEach(te=>{te.id!=="license_keys"&&K.push({id:te.id,...te.data()})}),p(K)});return()=>z()},[]);const y=async()=>{if(!e||!n)return alert("Thiu thng tin");h(!0);try{const F=new Date;o==="9999"?F.setFullYear(F.getFullYear()+100):F.setDate(F.getDate()+parseInt(o)),await Fc(ca(Sa,"artifacts",Aa,"public","data","license_keys",e),{password:n,expiryDate:F.toISOString(),status:"active",createdAt:new Date().toISOString()}),alert(` to Key: ${e}`),r(""),a("")}catch(F){alert("Li: "+F.message)}finally{h(!1)}},S=async F=>{confirm(`Xa ti khon ${F}?`)&&await T4(ca(Sa,"artifacts",Aa,"public","data","license_keys",F))},w=async(F,z)=>{await fI(ca(Sa,"artifacts",Aa,"public","data","license_keys",F),z),_(null)},b=async(F,z)=>{const N=new Date(F.expiryDate)>new Date?new Date(F.expiryDate):new Date;z===9999?N.setFullYear(N.getFullYear()+100):N.setDate(N.getDate()+z),await w(F.id,{expiryDate:N.toISOString()}),alert(" gia hn!")};return E.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4",children:[" ",E.jsx("div",{className:"absolute inset-0 bg-black/95 backdrop-blur-md",onClick:t})," ",E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-4xl h-[90vh] shadow-2xl animate-modal-pop flex flex-col overflow-hidden",children:[" ",E.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center bg-[#121212]",children:[" ",E.jsxs("h3",{className:"text-green-500 font-bold flex items-center gap-2 text-lg",children:[E.jsx(fA,{size:24})," QUN L LICENSE"]})," ",E.jsx("button",{onClick:t,children:E.jsx(pm,{size:24,className:"text-gray-500 hover:text-white"})})," "]})," ",E.jsxs("div",{className:"flex flex-col md:flex-row h-full overflow-hidden",children:[" ",E.jsxs("div",{className:"w-full md:w-1/3 p-4 border-r border-[#27272a] bg-[#0f0f10] overflow-y-auto",children:[" ",E.jsx("h4",{className:"text-sm font-bold text-white mb-4 uppercase tracking-wider",children:"To ti khon mi"})," ",E.jsxs("div",{className:"space-y-3",children:[" ",E.jsx("input",{type:"text",placeholder:"Tn ng nhp",className:"w-full bg-[#18181b] border border-[#27272a] p-3 rounded text-sm text-white outline-none focus:border-green-500",value:e,onChange:F=>r(F.target.value)})," ",E.jsx("input",{type:"text",placeholder:"Mt khu",className:"w-full bg-[#18181b] border border-[#27272a] p-3 rounded text-sm text-white outline-none focus:border-green-500",value:n,onChange:F=>a(F.target.value)})," ",E.jsxs("div",{className:"space-y-1",children:[" ",E.jsx("label",{className:"text-xs text-gray-500",children:"Thi hn s dng:"})," ",E.jsxs("select",{className:"w-full bg-[#18181b] border border-[#27272a] text-white text-sm p-3 rounded outline-none focus:border-green-500",value:o,onChange:F=>l(F.target.value),children:[" ",E.jsx("option",{value:"1",children:"1 Ngy"})," ",E.jsx("option",{value:"3",children:"3 Ngy"})," ",E.jsx("option",{value:"7",children:"1 Tun"})," ",E.jsx("option",{value:"30",children:"1 Thng"})," ",E.jsx("option",{value:"365",children:"1 Nm"})," ",E.jsx("option",{value:"9999",children:"Vnh vin"})," "]})," "]})," ",E.jsx("button",{onClick:y,disabled:u,className:"w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded mt-2 shadow-lg shadow-green-900/20",children:u?"ang to...":"Cp License"})," "]})," "]})," ",E.jsxs("div",{className:"w-full md:w-2/3 p-0 bg-[#050505] overflow-y-auto",children:[" ",E.jsxs("table",{className:"w-full text-left border-collapse",children:[" ",E.jsx("thead",{className:"bg-[#121212] text-xs uppercase text-gray-500 sticky top-0 z-10",children:E.jsxs("tr",{children:[E.jsx("th",{className:"p-3 border-b border-[#27272a]",children:"User"}),E.jsx("th",{className:"p-3 border-b border-[#27272a]",children:"Mt khu"}),E.jsx("th",{className:"p-3 border-b border-[#27272a]",children:"Cn li"}),E.jsx("th",{className:"p-3 border-b border-[#27272a] text-right",children:"Thao tc"})]})})," ",E.jsxs("tbody",{children:[" ",d.map(F=>{const z=Ak(F.expiryDate);return E.jsxs("tr",{className:"border-b border-[#27272a] hover:bg-[#121212] group",children:[" ",E.jsx("td",{className:"p-3 font-medium text-white",children:F.id})," ",E.jsx("td",{className:"p-3 font-mono text-gray-400",children:v===F.id?E.jsxs("div",{className:"flex gap-1",children:[E.jsx("input",{type:"text",className:"w-20 bg-[#27272a] text-white text-xs p-1 rounded",defaultValue:F.password,id:`pass-${F.id}`}),E.jsx("button",{onClick:()=>w(F.id,{password:document.getElementById(`pass-${F.id}`).value}),className:"text-green-500 bg-green-900/20 px-2 rounded text-xs",children:"OK"})]}):E.jsx("span",{onClick:()=>_(F.id),className:"cursor-pointer hover:text-white",children:F.password})})," ",E.jsx("td",{className:`p-3 text-xs ${z.color} font-bold`,children:z.text})," ",E.jsxs("td",{className:"p-3 text-right",children:[" ",E.jsxs("div",{className:"flex justify-end gap-2",children:[" ",E.jsxs("div",{className:"relative group/extend",children:[E.jsx("button",{className:"p-1.5 bg-[#1f2937] hover:bg-blue-600 text-blue-500 hover:text-white rounded transition-colors",children:E.jsx(cA,{size:14})}),E.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-[#18181b] border border-[#27272a] rounded shadow-xl hidden group-hover/extend:block z-20 min-w-[120px]",children:[E.jsx("button",{onClick:()=>b(F,30),className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-[#27272a] hover:text-white",children:"+ 1 Thng"}),E.jsx("button",{onClick:()=>b(F,365),className:"w-full text-left px-3 py-2 text-xs text-gray-300 hover:bg-[#27272a] hover:text-white",children:"+ 1 Nm"})]})]})," ",E.jsx("button",{onClick:()=>S(F.id),className:"p-1.5 bg-[#1f2937] hover:bg-red-600 text-red-500 hover:text-white rounded transition-colors",children:E.jsx(Bf,{size:14})})," "]})," "]})," "]},F.id)})," "]})," "]})," "]})," "]})," "]})," "]})},LH=({onClose:t,data:e,globalSettings:r,onUpdateSetting:n,globalItems:a,lastImportTime:o})=>{const[l,u]=qe.useState("negative"),[h,d]=qe.useState(""),[p,v]=qe.useState(!1),_=N=>r[N]||{min:5,ignore:!1},y=qe.useMemo(()=>{const N={};return e.forEach(K=>N[K.code]=K.actual),a.map(K=>({...K,actual:N[K.code]}))},[a,e]),S=y.filter(N=>{const K=_(N.code),te=parseFloat(N.cukcuk);return!K.ignore&&!isNaN(te)&&te<0}),w=y.filter(N=>{const K=_(N.code);if(!(N.actual!==void 0&&N.actual!==null&&String(N.actual).trim()!==""))return!1;const J=parseFloat(N.actual),k=parseFloat(N.cukcuk)||0,I=J-k;return!K.ignore&&I<0}),b=y.filter(N=>{const K=_(N.code),te=parseFloat(N.cukcuk);return!K.ignore&&!isNaN(te)&&te>=0&&te<=K.min}),F=()=>{let N=[],K="";if(l==="negative"?(N=S,K="AmHeThong"):l==="negative_actual"?(N=w,K="AmThucTe"):l==="low"&&(N=b,K="SapHet"),N.length===0)return alert("Khng c d liu!");const te=ps.json_to_sheet(N),J=ps.book_new();ps.book_append_sheet(J,te,"BaoCao"),Tk(J,`BaoCao_${K}.xlsx`)},z=(N,K)=>{const te=_(N.code),J=parseFloat(N.cukcuk);let k="-",I="text-gray-400";return K==="negative_actual"?(k=(parseFloat(N.actual||0)-parseFloat(N.cukcuk||0)).toFixed(2),I="text-red-500 font-bold"):isNaN(J)||(k=Number(J).toFixed(2).replace(/\.00$/,""),I=J<0?"text-red-500 font-bold":"text-yellow-500 font-bold"),E.jsxs("tr",{className:"border-b border-[#27272a] hover:bg-[#121212] group",children:[" ",E.jsx("td",{className:"px-3 py-3 font-mono text-xs text-gray-500",children:N.code})," ",E.jsx("td",{className:"px-3 py-3 text-sm text-gray-300 font-medium",children:N.name})," ",E.jsx("td",{className:"px-3 py-3 text-xs text-center text-gray-500",children:N.unit})," ",K!=="settings"&&E.jsx("td",{className:`px-3 py-3 text-sm text-right ${I}`,children:k})," ",(K==="low"||K==="settings")&&E.jsxs("td",{className:"px-3 py-3 text-center",children:[" ",K==="low"?E.jsx("span",{className:"text-yellow-600 font-mono text-xs font-bold",children:te.min}):E.jsx("input",{type:"number",className:"w-16 bg-[#18181b] border border-[#27272a] text-center text-gray-300 rounded px-1 py-1 text-xs focus:border-yellow-600 outline-none",value:te.min,onChange:R=>n(N.code,{...te,min:parseFloat(R.target.value)||0})})," "]})," ",E.jsxs("td",{className:"px-3 py-3 text-right",children:[" ",E.jsx("button",{onClick:()=>n(N.code,{...te,ignore:!te.ignore}),className:`p-1.5 rounded transition-colors flex items-center justify-center w-8 h-8 ml-auto ${te.ignore?"bg-[#27272a] text-gray-500":"bg-green-900/30 text-green-500"}`,children:te.ignore?E.jsx(U8,{size:16}):E.jsx(z8,{size:16})})," "]})," "]},N.code)};return E.jsxs("div",{className:"fixed inset-0 z-[85] flex items-center justify-center p-4",children:[" ",E.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t})," ",E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-4xl h-[85vh] shadow-2xl animate-modal-pop flex flex-col",children:[" ",E.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center bg-[#121212]",children:[" ",E.jsxs("h3",{className:"text-lg font-bold text-white flex gap-2 items-center",children:[E.jsx(nA,{className:"text-yellow-500"})," Bo Co Nhanh"]})," ",E.jsxs("div",{className:"flex items-center gap-3",children:[" ",!p&&E.jsxs("button",{onClick:F,className:"bg-green-700 hover:bg-green-600 text-white text-xs px-3 py-1.5 rounded flex items-center gap-1 transition-colors",children:[E.jsx(wg,{size:14})," Xut Excel"]})," ",E.jsx("button",{onClick:()=>v(!p),className:`p-2 rounded-lg transition-colors ${p?"bg-blue-500/20 text-blue-500":"text-gray-400 hover:text-white hover:bg-[#27272a]"}`,title:"Cu hnh",children:E.jsx(uA,{size:20})})," ",E.jsx("button",{onClick:t,children:E.jsx(pm,{className:"text-gray-500 hover:text-white"})})," "]})," "]})," ",!p&&E.jsxs("div",{className:"flex border-b border-[#27272a] bg-[#0a0a0a] mt-2",children:[" ",E.jsxs("button",{onClick:()=>u("negative"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2 ${l==="negative"?"border-red-500 text-red-500 bg-red-500/5":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[E.jsx(hA,{size:14})," m H Thng ",E.jsx("span",{className:"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full ml-1",children:S.length})]})," ",E.jsxs("button",{onClick:()=>u("negative_actual"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2 ${l==="negative_actual"?"border-orange-500 text-orange-500 bg-orange-500/5":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[E.jsx(yO,{size:14})," m Thc T ",E.jsx("span",{className:"bg-orange-500 text-black text-[10px] px-1.5 py-0.5 rounded-full ml-1",children:w.length})]})," ",E.jsxs("button",{onClick:()=>u("low"),className:`flex-1 py-3 text-sm font-bold border-b-2 transition-colors flex items-center justify-center gap-2 ${l==="low"?"border-yellow-500 text-yellow-500 bg-yellow-500/5":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[E.jsx(wg,{size:14,className:"rotate-180"})," Sp Ht ",E.jsx("span",{className:"bg-yellow-500 text-black text-[10px] px-1.5 py-0.5 rounded-full ml-1",children:b.length})]})," "]})," ",p&&E.jsx("div",{className:"p-3 border-b border-[#27272a] bg-[#0f0f10]",children:E.jsx("input",{type:"text",className:"bg-[#18181b] border border-[#27272a] text-gray-200 text-sm rounded-lg w-full pl-4 p-2 outline-none focus:border-blue-500 placeholder-gray-600",placeholder:"Tm kim ci t...",value:h,onChange:N=>d(N.target.value),autoFocus:!0})})," ",E.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-[#050505] p-4",children:[" ",E.jsxs("table",{className:"w-full text-left border-collapse",children:[" ",E.jsxs("thead",{className:"bg-[#121212] text-xs uppercase text-gray-500 sticky top-0 z-10",children:[" ",E.jsxs("tr",{children:[E.jsx("th",{className:"px-3 py-2 border-b border-[#27272a]",children:"M"}),E.jsx("th",{className:"px-3 py-2 border-b border-[#27272a]",children:"Tn Hng"}),E.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-center",children:"VT"}),!p&&E.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-right",children:l==="negative_actual"?"Lch":"Tn CukCuk"}),(l==="low"||p)&&E.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-center text-yellow-600",children:"Min"}),E.jsx("th",{className:"px-3 py-2 border-b border-[#27272a] text-right",children:"Theo Di"})]})," "]})," ",E.jsxs("tbody",{children:[" ",!p&&l==="negative"&&S.map(N=>z(N,"negative"))," ",!p&&l==="negative_actual"&&w.map(N=>z(N,"negative_actual"))," ",!p&&l==="low"&&b.map(N=>z(N,"low"))," ",p&&y.filter(N=>N.name.toLowerCase().includes(h.toLowerCase())).map(N=>z(N,"settings"))," "]})," "]})," "]})," "]})," "]})},kk=({onClose:t,onPaste:e,currentData:r,mode:n="number"})=>{const[a,o]=qe.useState(""),[l,u]=qe.useState([]);qe.useEffect(()=>{const d=a.split(/\r?\n/).filter(p=>p.trim()!=="");u(n==="number"?d.map(p=>p.trim()):d.map((p,v)=>{let _=p.trim().split(/[\t]+|\s{2,}/);return{order:v+1,code:_[0]||"",name:_[1]||"Cha c tn",unit:_[2]||"?"}}))},[a,n]);const h=()=>{e(l),t()};return E.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center p-4",children:[" ",E.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t})," ",E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-5xl h-[90vh] shadow-2xl animate-modal-pop flex flex-col",children:[" ",E.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center bg-[#121212]",children:[" ",E.jsx("h3",{className:"text-lg font-bold text-white",children:"Nhp Nhanh"})," ",E.jsx("button",{onClick:t,children:E.jsx(pm,{className:"text-gray-500 hover:text-white"})})," "]})," ",E.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[" ",E.jsx("div",{className:"flex-1 flex flex-col p-4 border-r border-[#27272a]",children:E.jsx("textarea",{className:"flex-1 w-full bg-[#18181b] border border-[#27272a] rounded-lg p-4 outline-none text-xs md:text-sm text-gray-300 font-mono resize-none focus:border-yellow-600 transition-colors whitespace-pre",placeholder:"Dn d liu vo y...",value:a,onChange:d=>o(d.target.value),autoFocus:!0})})," ",E.jsx("div",{className:"flex-1 flex flex-col p-4 bg-[#050505]",children:E.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar border border-[#27272a] rounded-lg bg-[#0a0a0a]",children:E.jsxs("table",{className:"w-full text-xs text-left text-gray-400",children:[E.jsx("thead",{className:"text-[10px] text-gray-500 uppercase bg-[#121212] sticky top-0",children:E.jsx("tr",{children:E.jsx("th",{className:"px-3 py-2",children:"D liu"})})}),E.jsx("tbody",{children:l.map((d,p)=>E.jsx("tr",{className:"border-b border-[#27272a]",children:E.jsx("td",{className:"px-3 py-2",children:n==="item"?d.name:d})},p))})]})})})," "]})," ",E.jsx("div",{className:"p-4 border-t border-[#27272a] flex justify-end gap-3 bg-[#121212]",children:E.jsxs("button",{onClick:h,disabled:l.length===0,className:"bg-yellow-600 hover:bg-yellow-500 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2",children:[E.jsx(R8,{size:16})," p dng"]})})," "]})," "]})},PH=({selectedDate:t,onChange:e,onClose:r,calendarMap:n})=>{const[a,o]=qe.useState(new Date(t)),l=qe.useMemo(()=>{const u=a.getFullYear(),h=a.getMonth(),d=new Date(u,h,1),p=[],v=d.getDay()===0?6:d.getDay()-1;for(let _=v;_>0;_--)p.push({date:null,inactive:!0});for(;d.getMonth()===h;){const _=bk(d),y=n[_]||{hasActual:!1,hasCukCuk:!1,isDone:!1};p.push({date:new Date(d),dateStr:_,...y}),d.setDate(d.getDate()+1)}return p},[a,t,n]);return E.jsxs("div",{className:"fixed inset-0 z-[90] flex items-center justify-center p-4",children:[E.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:r}),E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-lg shadow-2xl animate-modal-pop p-6",children:[E.jsxs("div",{className:"flex justify-between items-center mb-6",children:[E.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[E.jsx(bx,{className:"text-green-500"})," Lch Kim K"]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("button",{onClick:()=>o(new Date(a.getFullYear(),a.getMonth()-1,1)),children:E.jsx(sA,{className:"text-gray-400"})}),E.jsxs("span",{className:"text-sm font-mono",children:[a.getMonth()+1,"/",a.getFullYear()]}),E.jsx("button",{onClick:()=>o(new Date(a.getFullYear(),a.getMonth()+1,1)),children:E.jsx(k8,{className:"text-gray-400"})})]})]}),E.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["T2","T3","T4","T5","T6","T7","CN"].map(u=>E.jsx("div",{className:"text-center text-xs text-gray-500 font-bold mb-2",children:u},u)),l.map((u,h)=>{if(u.inactive)return E.jsx("div",{},h);let d="border-[#27272a] text-gray-500 hover:bg-[#18181b]",p=null;return u.dateStr===t?d="border-white bg-white/10 text-white shadow-lg":u.hasActual?d="border-green-500 bg-green-900/30 text-green-500":u.hasCukCuk&&(d="border-orange-500 bg-orange-900/30 text-orange-500"),u.isDone&&(p=E.jsx("div",{className:"absolute top-1 right-1",children:E.jsx(aA,{size:12,className:"text-white bg-green-500 rounded-full p-[1px]"})})),E.jsxs("button",{onClick:()=>{e(u.dateStr),r()},className:`relative h-14 rounded border flex flex-col items-center justify-center transition-all ${d}`,children:[E.jsx("span",{className:"text-sm font-bold",children:u.date.getDate()}),p,(u.hasActual||u.hasCukCuk)&&E.jsxs("div",{className:"flex gap-1 mt-1",children:[u.hasActual&&E.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),u.hasCukCuk&&E.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500"})]})]},h)})]})]})]})},VH=({template:t,onClose:e,onSave:r})=>{const[n,a]=qe.useState(t.data||[]),[o,l]=qe.useState(!1),u=()=>{r({...t,data:n}),e()},h=v=>{const _=n.length>0?Math.max(...n.map(y=>y.order)):0;a([...n,...v.map((y,S)=>({...y,order:_+S+1}))])},d=v=>{const _=[...n];_.splice(v,1),a(_)},p=(v,_,y)=>{const S=[...n];S[v][_]=y,a(S)};return E.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4",children:[" ",E.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:e})," ",E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-xl w-full max-w-2xl h-[80vh] flex flex-col shadow-2xl animate-modal-pop",children:[" ",E.jsxs("div",{className:"p-4 border-b border-[#27272a] flex justify-between items-center",children:[E.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[E.jsx(Eg,{size:18})," Sa Mu"]}),E.jsx("button",{onClick:e,children:E.jsx(pm,{className:"text-gray-500 hover:text-white"})})]})," ",E.jsxs("div",{className:"p-2 border-b border-[#27272a] bg-[#121212] flex gap-2",children:[E.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-green-900/30 text-green-500 border border-green-900/50 rounded text-xs",children:[E.jsx(bO,{size:14})," Nhp t Excel"]}),E.jsxs("button",{onClick:()=>a([...n,{order:n.length+1,code:"",name:"Mi",unit:"KG"}]),className:"flex items-center gap-2 px-3 py-1.5 bg-[#1f2937] text-gray-300 border border-gray-700 rounded text-xs",children:[E.jsx(cA,{size:14})," Thm dng"]})]})," ",E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[" ",E.jsxs("table",{className:"w-full text-sm text-left text-gray-400",children:[" ",E.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-[#121212] sticky top-0",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-2 py-2",children:"#"}),E.jsx("th",{className:"px-2 py-2",children:"M"}),E.jsx("th",{className:"px-2 py-2",children:"Tn"}),E.jsx("th",{className:"px-2 py-2",children:"VT"}),E.jsx("th",{className:"px-2 py-2 text-right",children:"Xa"})]})})," ",E.jsx("tbody",{children:n.map((v,_)=>E.jsxs("tr",{className:"border-b border-[#27272a] hover:bg-[#121212] group",children:[E.jsx("td",{className:"px-2 py-2 text-gray-600",children:_+1}),E.jsx("td",{className:"px-2 py-2",children:E.jsx("input",{className:"bg-transparent text-green-500 w-full outline-none font-mono",value:v.code,onChange:y=>p(_,"code",y.target.value)})}),E.jsx("td",{className:"px-2 py-2",children:E.jsx("input",{className:"bg-transparent text-white w-full outline-none",value:v.name,onChange:y=>p(_,"name",y.target.value)})}),E.jsx("td",{className:"px-2 py-2",children:E.jsx("input",{className:"bg-transparent text-gray-400 w-full outline-none text-center",value:v.unit,onChange:y=>p(_,"unit",y.target.value)})}),E.jsx("td",{className:"px-2 py-2 text-right",children:E.jsx("button",{onClick:()=>d(_),className:"text-red-500 opacity-50 group-hover:opacity-100",children:E.jsx(Bf,{size:14})})})]},_))})," "]})," "]})," ",E.jsx("div",{className:"p-4 border-t border-[#27272a] flex justify-end",children:E.jsx("button",{onClick:u,className:"bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-medium",children:"Lu Thay i"})})," "]})," ",o&&E.jsx(kk,{mode:"item",onClose:()=>l(!1),onPaste:h,currentData:[]})," "]})},BH=({username:t,onLogout:e,expiryDate:r})=>{const[n,a]=qe.useState({text:"...",color:"text-gray-500"});qe.useEffect(()=>{const Re=()=>{const Ke=Ak(r);a(Ke)};Re();const Xe=setInterval(Re,6e4);return()=>clearInterval(Xe)},[r]);const[o,l]=qe.useState(""),[u,h]=qe.useState([]),[d,p]=qe.useState(bk()),[v,_]=qe.useState("gray"),[y,S]=qe.useState(""),[w,b]=qe.useState(""),[F,z]=qe.useState(!1),[N,K]=qe.useState(!1),[te,J]=qe.useState(null),[k,I]=qe.useState(!1),[R,M]=qe.useState(!1),[O,D]=qe.useState(!1),[V,_e]=qe.useState(!1),[Te,ne]=qe.useState("number"),[oe,ke]=qe.useState([]),[ae,Le]=qe.useState(""),[Q,L]=qe.useState([]),W=qe.useRef(null),[G,Z]=qe.useState(""),[le,Se]=qe.useState(""),[Ne,Ae]=qe.useState("green"),[Ie,nt]=qe.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[ee,Ft]=qe.useState({}),[ft,It]=qe.useState({});qe.useEffect(()=>{if(!t)return;const Re=ca(Sa,"artifacts",Aa,"public","data","user_templates",t),Xe=Mc(Re,Ke=>{Ke.exists()?L(Ke.data().list||[]):L([])});return()=>Xe()},[t]),qe.useEffect(()=>{if(!t)return;const Re=ca(Sa,"artifacts",Aa,"public","data","daily_inventory",`${t}_${d}`),Xe=Mc(Re,Ke=>{if(Ke.exists()){const Ze=Ke.data();h(Ze.items||[]),_(Ze.theme||"gray"),S(Ze.templateName||""),b(Ze.templateLabel||"")}else h([]),_("gray"),S(""),b("")});return()=>Xe()},[t,d]),qe.useEffect(()=>{if(!t)return;const Re=ca(Sa,"artifacts",Aa,"public","data","user_settings",t),Xe=Mc(Re,Ke=>{if(Ke.exists()){const Ze=Ke.data();Ft(Ze.settings||{}),ke(Ze.items||[]),Le(Ze.lastImportTime||"")}});return()=>Xe()},[t]),qe.useEffect(()=>{if(!t)return;const Re=f4(Sa,"artifacts",Aa,"public","data","daily_inventory"),Xe=Mc(Re,Ke=>{const Ze={};Ke.forEach(_r=>{if(_r.id.startsWith(`${t}_`)){const en=_r.id.replace(`${t}_`,""),ln=_r.data().items||[],Zn=ln.some(wr=>wr.actual!==void 0&&wr.actual!==0&&wr.actual!=="0"),Gt=ln.some(wr=>wr.cukcuk!==void 0&&wr.cukcuk!==0&&wr.cukcuk!=="0"),Ir=Zn&&Gt;Ze[en]={hasActual:Zn,hasCukCuk:Gt,isDone:Ir}}}),It(Ze)});return()=>Xe()},[t]);const at=async(Re,Xe,Ke,Ze)=>{if(!t)return;const _r=ca(Sa,"artifacts",Aa,"public","data","daily_inventory",`${t}_${d}`);await Fc(_r,{items:Re,theme:Xe||v,templateName:Ke||y,templateLabel:Ze||w,updatedAt:new Date().toISOString()})},Ue=async Re=>{if(!t)return;const Xe=ca(Sa,"artifacts",Aa,"public","data","user_templates",t);await Fc(Xe,{list:Re})},$t=async(Re,Xe)=>{const Ke={...ee,[Re]:Xe},Ze=ca(Sa,"artifacts",Aa,"public","data","user_settings",t);await Fc(Ze,{settings:Ke,items:oe,lastImportTime:ae},{merge:!0})},Dt=Re=>{const Xe=Re.target.files[0];if(!Xe)return;const Ke=new FileReader;Ke.onload=async Ze=>{const _r=Ze.target.result,en=Zf(_r,{type:"binary"}),jr=en.SheetNames[0],ln=en.Sheets[jr],Zn=ps.sheet_to_json(ln,{header:1}),Gt=[],Ir={};let wr=0;Zn.forEach(qt=>{if(qt.length>=12){const Wn=String(qt[1]).trim(),da=qt[2],ma=qt[4],P=qt[11];if(Wn&&!isNaN(parseFloat(P))){const X=parseFloat(P);Ir[Wn]=X,Gt.push({code:Wn,name:da,unit:ma,cukcuk:X})}}});const tn=[...oe],Ns=new Set(oe.map(qt=>qt.code));Gt.forEach(qt=>{if(!Ns.has(qt.code))tn.push(qt),Ns.add(qt.code);else{const Wn=tn.findIndex(da=>da.code===qt.code);Wn!==-1&&(tn[Wn]={...tn[Wn],cukcuk:qt.cukcuk})}});const Ti={...ee};Gt.forEach(qt=>{Ti[qt.code]||(Ti[qt.code]={min:5,ignore:!1})});const cn=new Date,ei=`${cn.getHours()}:${String(cn.getMinutes()).padStart(2,"0")} ${cn.getDate()}/${cn.getMonth()+1}/${cn.getFullYear()}`,jo=ca(Sa,"artifacts",Aa,"public","data","user_settings",t);await Fc(jo,{items:tn,settings:Ti,lastImportTime:ei});const ti=u.map(qt=>Ir[qt.code]!==void 0?(wr++,{...qt,cukcuk:Ir[qt.code]}):qt);at(ti),Gt.length>0?alert(` nhp d liu CukCuk thnh cng!
- Tng: ${Gt.length} m
-  khp: ${wr} m`):alert("Khng tm thy d liu hp l.")},Ke.readAsBinaryString(Xe),Re.target.value=""},Ut=Re=>{const Xe=Re.data.map(Ke=>({...Ke,actual:0,cukcuk:"",note:""}));at(Xe,Re.color,Re.name,Re.label||"KIM K"),z(!1)},Ur=()=>{if(G){const Re={id:Date.now(),name:G,label:le||"KIM K KHC",desc:"Mi",color:Ne,iconColor:dl[Ne].text,borderColor:dl[Ne].border,bgColor:dl[Ne].bg,data:[]};Ue([...Q,Re]),Z(""),Se("")}},Za=()=>{if(u.length===0)return alert("Cha c d liu!");const Re=ps.json_to_sheet(u.map(Ke=>({STT:Ke.order,M:Ke.code,Tn:Ke.name,VT:Ke.unit,"Thc T":Ke.actual,CukCuk:Ke.cukcuk,Lch:(parseFloat(Ke.actual)||0)-(parseFloat(Ke.cukcuk)||0),"Ghi Ch":Ke.note}))),Xe=ps.book_new();ps.book_append_sheet(Xe,Re,"KiemKe"),Tk(Xe,`KiemKe_${d}.xlsx`)},qn=Re=>{if(Te==="number"){const Xe=[...u],Ke=u.filter(Ze=>Ze.name.toLowerCase().includes(o.toLowerCase())||Ze.code.toLowerCase().includes(o.toLowerCase()));Re.forEach((Ze,_r)=>{if(_r<Ke.length){const en=u.indexOf(Ke[_r]);en!==-1&&(Xe[en].actual=Ze)}}),at(Xe)}else{const Xe=Re.map(Ke=>({...Ke,actual:0,cukcuk:"",note:""}));at(Xe)}},Lt=(Re,Xe,Ke)=>{const Ze=[...u];Ze[Re][Xe]=Ke,h(Ze)},Jr=(Re,Xe,Ke)=>{let Ze=Ke;(Ke===""||Ke===null)&&(Ze=0);const _r=[...u];_r[Re][Xe]=Ze,at(_r)},gn=(Re,Xe,Ke)=>{nt({isOpen:!0,title:Re,message:Xe,onConfirm:Ke})},Xn=u.filter(Re=>Re.name.toLowerCase().includes(o.toLowerCase())||Re.code.toLowerCase().includes(o.toLowerCase())),Pt=dl[v]||{border:"border-gray-700",text:"text-gray-400",bg:"bg-gray-800",glow:""},Nn=w||"CHA KHI TO",ct=new Date(d),ar=`${ct.getDate()}/${ct.getMonth()+1}`,Zr=ct.getDay()===0?"CN":`T${ct.getDay()+1}`;return E.jsxs("div",{className:"h-screen w-full bg-[#050505] text-gray-300 font-sans flex flex-col items-center justify-center overflow-hidden relative pt-20",children:[E.jsx("input",{type:"file",ref:W,className:"hidden",accept:".xlsx, .xls, .csv",onChange:Dt}),E.jsxs("div",{className:"w-full max-w-[1800px] h-[95vh] flex flex-col p-4 space-y-4 animate-[fade-in-up_0.5s_ease-out] relative z-10",children:[E.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-[#0a0a0a] border border-[#27272a] p-3 rounded-xl shadow-lg shrink-0 relative",children:[t==="admin"&&E.jsxs("div",{className:"absolute -top-3 -left-3 z-50",children:[" ",E.jsxs("button",{onClick:()=>_e(!0),className:"bg-red-900/50 hover:bg-red-700 text-red-500 hover:text-white p-2 rounded-full border border-red-900 shadow-xl transition-all hover:scale-110",title:"Admin",children:[" ",E.jsx(fA,{size:20})," "]})," "]}),E.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[E.jsxs("div",{className:"relative w-full md:w-96",children:[E.jsx(Sg,{className:"absolute left-3 top-2.5 text-gray-500 w-5 h-5"}),E.jsx("input",{type:"text",className:"bg-[#18181b] border border-[#27272a] text-gray-200 text-sm rounded-lg w-full pl-10 p-2.5 outline-none focus:border-green-500",placeholder:"Tm tn hng...",value:o,onChange:Re=>l(Re.target.value)})]}),r&&E.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[#18181b] border border-[#27272a] rounded-lg text-xs font-medium text-gray-400 hidden md:flex",children:[E.jsx(O8,{size:14,className:n.color}),E.jsxs("span",{children:["Cn li: ",E.jsx("span",{className:"text-white font-mono",children:n.text})]})]})]}),E.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto overflow-x-auto",children:[E.jsxs("button",{onClick:()=>D(!0),className:"bg-[#854d0e] hover:bg-[#a16207] text-yellow-100 border border-yellow-900/50 rounded-lg p-2.5 flex items-center gap-2",title:"Bo co",children:[E.jsx(nA,{className:"w-4 h-4"})," Bo Co"]}),E.jsx("button",{onClick:Za,className:"bg-[#1f2937] hover:bg-[#374151] text-gray-200 border border-gray-700 rounded-lg p-2.5",title:"Xut Excel",children:E.jsx(wg,{className:"w-4 h-4"})}),u.length>0&&E.jsx("button",{onClick:()=>gn("Xa Ht","Xa ht d liu ngy ny?",async()=>{const Re=ca(Sa,"artifacts",Aa,"public","data","daily_inventory",`${t}_${d}`);await T4(Re),nt({...Ie,isOpen:!1})}),className:"bg-red-900/20 hover:bg-red-900/40 text-red-500 border border-red-900/50 rounded-lg p-2.5",children:E.jsx(Bf,{className:"w-4 h-4"})}),E.jsxs("button",{onClick:()=>{K(!1),z(!0)},className:"bg-[#f97316] hover:bg-[#ea580c] text-white font-medium rounded-lg text-sm px-5 py-2.5 flex items-center gap-2",children:[E.jsx(lO,{className:"w-4 h-4"})," THM MU"]}),E.jsxs("button",{onClick:()=>W.current.click(),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm px-5 py-2.5 flex items-center gap-2 shadow-lg shadow-blue-900/20",children:[E.jsx(K8,{className:"w-4 h-4"})," Nhp CukCuk"]})]})]}),E.jsxs("div",{className:`bg-[#0a0a0a] border ${Pt.border} rounded-xl shadow-2xl overflow-hidden flex flex-col flex-1 transition-colors duration-500 ${Pt.glow}`,children:[E.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[#27272a] bg-[#0f0f10] shrink-0",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("span",{className:`text-xs font-bold px-3 py-1.5 rounded border tracking-wider uppercase ${Pt.bg} ${Pt.text} ${Pt.border}`,children:Nn}),E.jsxs("button",{onClick:()=>M(!0),className:`flex items-center gap-2 border rounded-lg px-4 py-1.5 transition-all group ${v==="gray"?"border-[#27272a] bg-[#18181b] text-white":`${Pt.border} ${Pt.bg} ${Pt.text}`}`,children:[E.jsx(bx,{size:16}),E.jsx("span",{className:"text-sm font-bold",children:ar}),E.jsxs("span",{className:"text-xs opacity-80",children:["(",Zr,")"]}),E.jsx(iA,{size:14})]})]}),u.length>0&&E.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[Xn.length," MT HNG"]})]}),E.jsxs("div",{className:"sticky-header grid grid-cols-[60px_120px_1fr_100px_150px_120px_150px_100px_200px] gap-4 px-8 py-4 bg-[#121214] border-b border-[#27272a] text-[12px] font-bold text-gray-500 uppercase shrink-0 tracking-wide",children:[E.jsx("div",{className:"text-center",children:"#"})," ",E.jsx("div",{className:"text-left pl-2",children:"M Hng"})," ",E.jsx("div",{className:"text-left",children:"Tn Hng Ha"})," ",E.jsx("div",{className:"text-center",children:"VT"})," ",E.jsxs("div",{className:"text-right text-yellow-600/80 flex justify-end gap-2 items-center cursor-pointer hover:text-yellow-500",onClick:()=>{ne("number"),I(!0)},children:["THC T ",E.jsx(Eg,{size:14})]})," ",E.jsx("div",{className:"text-right pr-2",children:"Tng"})," ",E.jsxs("div",{className:"text-right text-blue-500/80 flex justify-end gap-2 items-center cursor-pointer hover:text-blue-400",children:["CUKCUK ",E.jsx(P8,{size:14})]})," ",E.jsx("div",{className:"text-right pr-2",children:"Lch"})," ",E.jsx("div",{className:"pl-2",children:"Ghi Ch"})]}),E.jsx("div",{className:"flex-1 bg-[#050505]/50 relative overflow-y-auto custom-scrollbar",children:u.length===0?E.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-12 text-center text-gray-600",children:[E.jsx(lA,{className:"w-10 h-10 mb-4 opacity-50"}),E.jsx("p",{children:"Cha c d liu. Vui lng chn THM MU."})]}):E.jsx("div",{className:"",children:Xn.map((Re,Xe)=>{const Ke=(parseFloat(Re.actual)||0)-(parseFloat(Re.cukcuk)||0);let Ze="text-gray-600",_r="bg-transparent";Ke>0?(Ze="text-green-500",_r="bg-green-900/20"):Ke<0&&(Ze="text-red-500",_r="bg-red-900/20");const en=Ke!==0?(Ke>0?"+":"")+parseFloat(Ke.toFixed(2)):"-";return E.jsxs("div",{className:"grid grid-cols-[60px_120px_1fr_100px_150px_120px_150px_100px_200px] gap-4 px-8 py-3 border-b border-[#27272a] text-sm items-center hover:bg-[#121214] transition-colors",children:[E.jsx("div",{className:"text-center text-gray-600 font-mono text-xs",children:Re.order}),E.jsx("div",{className:"text-left pl-2 text-green-500/80 font-mono text-xs",children:Re.code}),E.jsx("div",{className:"text-left text-gray-300 font-medium truncate pr-4",title:Re.name,children:Re.name}),E.jsx("div",{className:"flex justify-center",children:E.jsx("span",{className:"text-xs text-gray-500 bg-[#18181b] px-2 py-1 rounded border border-[#27272a] min-w-[50px] text-center",children:Re.unit})}),E.jsx("div",{className:"text-right",children:E.jsx("input",{type:"number",className:"w-full bg-[#18181b] border border-[#27272a] text-yellow-500 text-right text-sm rounded px-3 py-1.5 outline-none focus:border-yellow-500 transition-colors",value:Re.actual,onChange:jr=>Lt(Xe,"actual",jr.target.value),onBlur:jr=>Jr(Xe,"actual",jr.target.value),onFocus:jr=>jr.target.select(),placeholder:"0"})}),E.jsx("div",{className:"text-right pr-2 text-gray-500 font-mono",children:Re.actual||"0"}),E.jsx("div",{className:"text-right",children:E.jsx("input",{type:"number",className:"w-full bg-[#18181b] border border-[#27272a] text-blue-400 text-right text-sm rounded px-3 py-1.5 outline-none focus:border-blue-500 transition-colors",value:Re.cukcuk,onChange:jr=>Lt(Xe,"cukcuk",jr.target.value)})}),E.jsx("div",{className:`text-right pr-2 font-mono font-bold ${Ze} ${_r} rounded px-2 py-1`,children:en}),E.jsx("div",{className:"pl-2",children:E.jsx("input",{type:"text",className:"w-full bg-transparent border-b border-transparent text-gray-400 text-xs py-1 outline-none focus:border-gray-500 transition-colors placeholder-gray-700",placeholder:"...",value:Re.note,onChange:jr=>Lt(Xe,"note",jr.target.value)})})]},Xe)})})})]}),E.jsxs("div",{className:"fixed bottom-6 right-6 flex flex-col gap-3 z-50",children:[E.jsx("a",{href:"https://zalo.me/0342627280",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform",children:E.jsx(iO,{size:20,className:"text-white"})}),E.jsx("a",{href:"https://www.facebook.com/khanhnguyen3102004?locale=vi_VN",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-blue-700 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform",children:E.jsx(G8,{size:20,className:"text-white"})})]})]}),te&&E.jsx(VH,{template:te,onClose:()=>J(null),onSave:Re=>Ue(Q.map(Xe=>Xe.id===Re.id?Re:Xe))}),k&&E.jsx(kk,{currentData:Xn,onClose:()=>I(!1),onPaste:qn,mode:Te}),R&&E.jsx(PH,{selectedDate:d,onChange:p,onClose:()=>M(!1),calendarMap:ft}),O&&E.jsx(LH,{onClose:()=>D(!1),data:u,globalSettings:ee,onUpdateSetting:$t,globalItems:oe,lastImportTime:ae}),V&&E.jsx(MH,{onClose:()=>_e(!1)}),E.jsx(FH,{isOpen:Ie.isOpen,title:Ie.title,message:Ie.message,onConfirm:()=>{Ie.onConfirm(),nt({...Ie,isOpen:!1})},onCancel:()=>nt({...Ie,isOpen:!1})}),F&&E.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[E.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:()=>z(!1)}),E.jsxs("div",{className:"relative bg-[#0a0a0a] border border-[#27272a] rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-modal-pop flex flex-col",children:[E.jsxs("div",{className:"p-6 pb-2 text-center relative",children:[N&&E.jsx("button",{onClick:()=>K(!1),className:"absolute top-5 left-5 p-2 rounded-full text-gray-500 hover:text-white",children:E.jsx(sA,{className:"w-5 h-5"})}),E.jsx("button",{onClick:()=>{K(!0),z(!0)},className:"absolute top-5 right-5 p-2 rounded-full text-gray-500 hover:text-white hover:bg-[#27272a]",title:"Qun l",children:E.jsx(uA,{className:"w-5 h-5"})}),E.jsx("h2",{className:"text-xl font-bold text-white",children:N?"QUN L MU":"CHN MU TN"})]}),E.jsx("div",{className:"p-6 pt-4 space-y-3",children:N?E.jsxs("div",{className:"space-y-4",children:[Q.map(Re=>E.jsxs("div",{className:"flex justify-between items-center p-3 bg-[#121212] border border-[#27272a] rounded-lg",children:[E.jsx("span",{className:"text-sm text-gray-300",children:Re.name}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:()=>J(Re),className:"text-gray-400 hover:text-white p-1",children:E.jsx(Eg,{size:16})}),E.jsx("button",{onClick:()=>gn("Xa Mu","Xa mu ny?",()=>Ue(Q.filter(Xe=>Xe.id!==Re.id))),className:"text-red-500 hover:text-red-400 p-1",children:E.jsx(Bf,{size:16})})]})]},Re.id)),E.jsxs("div",{className:"pt-2 border-t border-[#27272a]",children:[E.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Chn mu:"}),E.jsx("div",{className:"flex gap-2 mb-4 justify-center",children:Object.keys(dl).map(Re=>E.jsx("button",{onClick:()=>Ae(Re),className:`w-6 h-6 rounded-full ${dl[Re].solid} transition-all ${Ne===Re?"ring-2 ring-white scale-125":"opacity-50 hover:opacity-100"}`},Re))}),E.jsxs("div",{className:"space-y-2",children:[E.jsx("input",{type:"text",placeholder:"Tn mu...",className:"w-full bg-[#18181b] border border-[#27272a] text-white text-sm rounded-lg p-2.5 outline-none focus:border-gray-500",value:G,onChange:Re=>Z(Re.target.value)}),E.jsx("input",{type:"text",placeholder:"Tiu ...",className:"w-full bg-[#18181b] border border-[#27272a] text-white text-sm rounded-lg p-2.5 outline-none focus:border-gray-500",value:le,onChange:Re=>Se(Re.target.value)})]}),E.jsx("button",{onClick:Ur,className:`w-full text-white py-2.5 mt-3 rounded-lg text-sm font-bold shadow-lg transition-all ${dl[Ne].solid} hover:opacity-90`,children:"Thm"})]})]}):Q.length>0?Q.map(Re=>E.jsxs("button",{className:`w-full flex items-center gap-4 p-4 rounded-xl border border-[#27272a] bg-[#121212] hover:scale-[1.02] text-left ${Re.borderColor} ${Re.bgColor}`,onClick:()=>Ut(Re),children:[E.jsx("div",{className:`p-3 rounded-lg bg-[#18181b] ${Re.iconColor}`,children:E.jsx(Y8,{className:"w-6 h-6"})}),E.jsxs("div",{children:[E.jsx("h3",{className:"font-bold text-gray-200",children:Re.name}),E.jsx("p",{className:"text-xs text-gray-500",children:Re.desc})]})]},Re.id)):E.jsx("div",{className:"text-center text-gray-500 italic py-4",children:"Cha c mu no."})})]})]})]})},UH={apiKey:"AIzaSyDLtUuwz4Tr4bP5a1mmibbD6T8W03o3fG8",authDomain:"kho-sm.firebaseapp.com",projectId:"kho-sm",storageBucket:"kho-sm.firebasestorage.app",messagingSenderId:"348912048474",appId:"1:348912048474:web:ddf803e0ad8d4c2dcb7b63",measurementId:"G-DH32VXB5JT"},jH=Xd(UH),CE=hx(jH),NE="kho-suon-muoi-official-system-v1",zH=({username:t})=>{const[e,r]=qe.useState([]),[n,a]=qe.useState(""),[o,l]=qe.useState(""),[u,h]=qe.useState(new Date().toISOString().split("T")[0]),[d,p]=qe.useState(!1),[v,_]=qe.useState(!1),[y,S]=qe.useState("processing");qe.useEffect(()=>{if(!t)return;const M=ca(CE,"artifacts",NE,"public","data","incoming_goods",`${t}_${u}`),O=Mc(M,D=>{D.exists()?r(D.data().items||[]):r([])});return()=>O()},[t,u]);const w=async(M,O)=>{const V=ca(CE,"artifacts",NE,"public","data","incoming_goods",`${t}_${O||u}`);await Fc(V,{items:M,updatedAt:new Date().toISOString()})},b=()=>{const M=new Date;return`${M.getDate()}/${M.getMonth()+1} ${String(M.getHours()).padStart(2,"0")}:${String(M.getMinutes()).padStart(2,"0")}`},F=async M=>{if(!M||M.length===0)return;let O=[],D=u;for(let _e of M){const Te=await _e.arrayBuffer(),ne=Zf(Te,{type:"array"});ne.SheetNames.forEach(oe=>{const ke=ne.Sheets[oe],ae=ps.sheet_to_json(ke,{header:1});let Le="Cha r NCC",Q="",L=!1;ae.forEach(W=>{const G=String(W.join(","));if(G.includes("Tn nh cung cp:")&&(Le=G.split("Tn nh cung cp:")[1].split(",")[0].trim()),G.includes("Ngy:")){const Z=G.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);if(Z){const le=new Date(Z[3],Z[2]-1,Z[1]);le.setDate(le.getDate()+1),D=le.toISOString().split("T")[0],Q=`${Z[1]}/${Z[2]}/${Z[3]}`}}if(G.includes("STT,M NVL,Nguyn vt liu")){L=!0;return}G.includes("Cng tin hng")&&(L=!1),L&&W[0]&&!isNaN(parseFloat(W[0]))&&O.push({id:Math.random().toString(36).substr(2,9),vendor:Le,orderDate:Q,name:String(W[2]||"").trim(),unit:String(W[3]||"").trim(),ordered:parseFloat(W[4])||0,received:"",st_arrived:!1,ts_arrived:"",st_count:!1,ts_count:"",st_group:!1,ts_group:"",st_cukcuk:!1,ts_cukcuk:"",note:"",updatedAt:new Date().toISOString()})})})}h(D);const V=[...e,...O];r(V),await w(V,D)},z=async M=>{const O=M.target.files;if(!O||O.length===0)return;let D=[];for(let oe of O){const ke=await oe.arrayBuffer(),ae=Zf(ke,{type:"array"});ae.SheetNames.forEach(Le=>{const Q=ps.sheet_to_json(ae.Sheets[Le],{header:1});let L=!1;Q.forEach(W=>{const G=String(W.join(","));if(G.includes("STT,M NVL,Nguyn vt liu")){L=!0;return}G.includes("Cng tin hng")&&(L=!1),L&&W[0]&&!isNaN(parseFloat(W[0]))&&D.push({name:String(W[2]||"").trim().toLowerCase(),qty:parseFloat(W[5])||0})})})}const V=b();let _e=[],Te=0;const ne=e.map(oe=>{const ke=D.filter(ae=>ae.name===oe.name.toLowerCase());if(ke.length>0){const ae=ke.reduce((Q,L)=>Q+L.qty,0),Le=oe.received===""?0:parseFloat(oe.received);return Le!==ae&&_e.push(`- ${oe.name}: Nhp (${Le})  Tng CukCuk (${ae})`),Te++,{...oe,st_cukcuk:!0,ts_cukcuk:oe.ts_cukcuk||V,updatedAt:new Date().toISOString()}}return oe});if(!(_e.length>0&&!window.confirm(`PHT HIN LCH ${_e.length} MN TRN TNG CC FILE:
${_e.join(`
`)}

Bn c mun XC NHN lch v vn tch hon thnh CukCuk?`))){if(Te===0){alert("Khng tm thy mt hng no khp trong cc file CukCuk  chn!");return}r(ne),await w(ne),alert(`i chiu thnh cng!  tch CukCuk cho ${Te} mn t cc file nhp.`),M.target.value=null}},N=(M,O)=>{const D=b(),V=e.map(_e=>{if(_e.id===M){const Te=!_e[O],ne=O.split("_")[1];let oe={..._e,[O]:Te,[`ts_${ne}`]:Te?D:"",updatedAt:new Date().toISOString()};return O==="st_count"&&(Te?(_e.received||(oe.received=_e.ordered),oe.st_arrived=!0,oe.ts_arrived=_e.ts_arrived||D):oe.received=""),oe}return _e});r(V),w(V)},K=(M,O,D)=>{const V=b(),Te=e.filter(ke=>ke.vendor===M&&ke.orderDate===O).every(ke=>ke[D]),ne=D.split("_")[1],oe=e.map(ke=>{if(ke.vendor===M&&ke.orderDate===O){const ae=!Te;let Le={...ke,[D]:ae,[`ts_${ne}`]:ae?V:"",updatedAt:new Date().toISOString()};return D==="st_count"&&(ae?(Le.received=ke.ordered,Le.st_arrived=!0,Le.ts_arrived=ke.ts_arrived||V):Le.received=""),Le}return ke});r(oe),w(oe)},te=M=>`${M.vendor}_${M.orderDate}`,J=e.reduce((M,O)=>{const D=te(O);return M[D]||(M[D]={vendor:O.vendor,date:O.orderDate,items:[]}),M[D].items.push(O),M},{}),k=Object.keys(J).filter(M=>{const O=J[M],D=O.items.length>0&&O.items.every(Te=>Te.st_arrived&&Te.st_cukcuk),V=y==="completed"?D:!D,_e=O.vendor.toLowerCase().includes(n.toLowerCase())||O.items.some(Te=>Te.name.toLowerCase().includes(n.toLowerCase()));return V&&_e}).sort(),I=e.filter(M=>!M.st_arrived),R=I.filter(M=>M.name.toLowerCase().includes(o.toLowerCase())||M.vendor.toLowerCase().includes(o.toLowerCase()));return E.jsxs("div",{className:"w-full h-full p-6 pt-24 bg-[#050505] text-white flex flex-col items-center",children:[E.jsx("style",{children:"input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.custom-scrollbar::-webkit-scrollbar{width:6px}.custom-scrollbar::-webkit-scrollbar-thumb{background:#333;border-radius:10px}"}),E.jsxs("div",{className:"w-full max-w-[1550px] flex flex-col gap-6 font-sans",children:[E.jsxs("div",{onDragOver:M=>{M.preventDefault(),p(!0)},onDragLeave:()=>p(!1),onDrop:M=>{M.preventDefault(),p(!1),F(M.dataTransfer.files)},className:`relative border-2 border-dashed rounded-[32px] p-8 flex justify-between items-center transition-all ${d?"border-orange-500 bg-orange-500/10 scale-[1.01]":"border-[#27272a] bg-[#0a0a0a]"}`,children:[E.jsxs("div",{className:"flex items-center gap-6 pointer-events-none",children:[E.jsx(M8,{size:48,className:"text-orange-600"}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-xl font-black uppercase italic tracking-tighter",children:"Ko th ha n"}),E.jsx("p",{className:"text-gray-500 text-sm",children:"H tr nhp nhiu file n hng & file CukCuk cng lc."})]})]}),E.jsxs("div",{className:"flex gap-4 items-center z-10",children:[E.jsx("input",{type:"date",value:u,onChange:M=>h(M.target.value),className:"bg-[#111] border border-[#27272a] px-4 py-2 rounded-xl text-sm font-mono outline-none cursor-pointer"}),E.jsxs("label",{className:"bg-[#1a1a1a] text-orange-500 border border-orange-500/30 px-6 py-3 rounded-2xl font-black cursor-pointer hover:bg-orange-500 hover:text-white transition-all uppercase text-xs flex items-center gap-2 text-center",children:[E.jsx(X8,{size:16})," Check nhp hng CukCuk",E.jsx("input",{type:"file",multiple:!0,className:"hidden",accept:".xlsx, .xls, .csv",onChange:z})]}),E.jsxs("label",{className:"bg-orange-600 text-white px-8 py-3 rounded-2xl font-black cursor-pointer hover:bg-orange-500 transition-all uppercase text-xs text-center",children:["Nhp ha n t hng",E.jsx("input",{type:"file",multiple:!0,className:"hidden",accept:".xlsx, .xls, .csv",onChange:M=>F(M.target.files)})]})]})]}),E.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-[#0a0a0a] border border-[#27272a] p-4 rounded-[28px]",children:[E.jsxs("div",{className:"flex bg-[#111] p-1.5 rounded-2xl border border-white/5",children:[E.jsxs("button",{onClick:()=>S("processing"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase flex items-center gap-2 ${y==="processing"?"bg-orange-600 shadow-lg":"text-gray-500"}`,children:[E.jsx(gw,{size:16})," ang kim"]}),E.jsxs("button",{onClick:()=>S("completed"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase flex items-center gap-2 ${y==="completed"?"bg-green-600 shadow-lg":"text-gray-500"}`,children:[E.jsx(rO,{size:16})," Hon thnh"]})]}),E.jsxs("div",{className:"relative flex-1 w-full",children:[E.jsx(Sg,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 w-4 h-4"}),E.jsx("input",{type:"text",placeholder:"Tm NVL hoc NCC...",className:"w-full bg-[#050505] border border-white/5 rounded-2xl pl-12 py-3 outline-none text-sm",value:n,onChange:M=>a(M.target.value)})]}),E.jsxs("button",{onClick:()=>_(!v),className:`px-6 py-3 rounded-2xl text-xs font-black uppercase flex items-center gap-2 border ${v?"bg-red-600 border-red-600 text-white":"border-[#27272a] text-gray-500"}`,children:[E.jsx(w8,{size:16})," Bo co"]})]}),v&&E.jsxs("div",{className:"bg-[#1a1010] border border-red-900/30 rounded-[32px] p-6 shadow-2xl animate-in slide-in-from-top-4",children:[E.jsxs("div",{className:"flex justify-between items-center mb-4",children:[E.jsxs("h3",{className:"text-red-500 font-black uppercase flex items-center gap-2",children:[E.jsx(oA,{size:20})," CHA V KHO (",I.length,")"]}),E.jsxs("div",{className:"relative w-64",children:[E.jsx(Sg,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-red-900 w-3 h-3"}),E.jsx("input",{type:"text",placeholder:"Lc hng...",className:"w-full bg-black/40 border border-red-900/20 rounded-xl pl-9 py-2 outline-none text-xs",value:o,onChange:M=>l(M.target.value)})]})]}),E.jsxs("div",{className:"grid grid-cols-4 bg-black/40 p-3 rounded-t-xl text-[9px] font-bold text-gray-500 uppercase tracking-widest border-b border-red-900/20 text-center",children:[E.jsx("div",{children:"Ngy t"}),E.jsx("div",{children:"Tn Mt Hng"}),E.jsx("div",{children:"S Lng"}),E.jsx("div",{children:"NCC"})]}),E.jsx("div",{className:"max-h-64 overflow-y-auto custom-scrollbar",children:R.map((M,O)=>E.jsxs("div",{className:"grid grid-cols-4 p-3 border-b border-red-900/10 text-sm hover:bg-white/5",children:[E.jsx("div",{className:"text-gray-500 font-mono text-[10px]",children:M.orderDate}),E.jsx("div",{className:"font-bold text-gray-200 line-clamp-1",children:M.name}),E.jsxs("div",{className:"text-center text-red-400 font-black",children:[M.ordered," ",M.unit]}),E.jsx("div",{className:"text-right text-orange-500/70 text-[10px] font-bold truncate",children:M.vendor})]},O))})]}),E.jsx("div",{className:"flex flex-col gap-10 mb-20",children:k.map(M=>{const O=J[M];return E.jsxs("div",{className:`bg-[#0a0a0a] border border-[#27272a] rounded-[32px] overflow-hidden shadow-2xl ${y==="completed"?"opacity-70 border-green-900/30":""}`,children:[E.jsxs("div",{className:"bg-[#121212] px-8 py-5 border-b border-[#27272a] flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("div",{className:`w-2 h-10 rounded-full ${y==="completed"?"bg-green-600":"bg-orange-600"}`}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter leading-none",children:O.vendor}),E.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase font-mono mt-1 flex items-center gap-1.5",children:[E.jsx(bx,{size:10,className:"text-orange-600"})," Ngy t: ",O.date]})]})]}),E.jsx("button",{onClick:()=>{confirm("Xa ha n ny?")&&w(e.filter(D=>te(D)!==M))},className:"text-red-500 text-xs font-bold border border-red-900/20 px-4 py-2 rounded-xl",children:"Xa H"})]}),E.jsxs("div",{className:"grid grid-cols-[300px_2.5fr_80px_100px_160px_1.5fr_50px] bg-[#080808] text-[9px] font-black text-gray-600 uppercase py-4 px-8 border-b border-[#27272a] text-center",children:[E.jsxs("div",{className:"flex justify-between px-2 pr-6 border-r border-[#27272a]/50",children:[E.jsx(td,{label:"V",color:"text-green-500",onClick:()=>K(O.vendor,O.date,"st_arrived")}),E.jsx(td,{label:"SL",color:"text-yellow-500",onClick:()=>K(O.vendor,O.date,"st_count")}),E.jsx(td,{label:"Nhm",color:"text-blue-500",onClick:()=>K(O.vendor,O.date,"st_group")}),E.jsx(td,{label:"CukCuk",color:"text-purple-500",onClick:()=>K(O.vendor,O.date,"st_cukcuk")})]}),E.jsx("div",{className:"pl-6 text-left flex items-center",children:"Nguyn Vt Liu"}),E.jsx("div",{children:"VT"}),E.jsx("div",{className:"text-right pr-6",children:"SL t"}),E.jsx("div",{className:"text-orange-500 font-bold",children:"Thc Nhn"}),E.jsx("div",{className:"pl-12 text-left",children:"Ghi Ch"}),E.jsx("div",{children:"Xa"})]}),O.items.map(D=>{const V=(parseFloat(D.received)||0)-(parseFloat(D.ordered)||0);return E.jsxs("div",{className:"grid grid-cols-[300px_2.5fr_80px_100px_160px_1.5fr_50px] items-center py-4 px-8 border-b border-[#27272a]/40 hover:bg-white/[0.01]",children:[E.jsxs("div",{className:"flex justify-between px-2 pr-6 border-r border-[#27272a]/50 h-full items-center",children:[E.jsx(ed,{checked:D.st_arrived,time:D.ts_arrived,color:"bg-green-500",onClick:()=>N(D.id,"st_arrived"),icon:E.jsx(gw,{size:14})}),E.jsx(ed,{checked:D.st_count,time:D.ts_count,color:"bg-yellow-500",onClick:()=>N(D.id,"st_count"),icon:E.jsx(aA,{size:14})}),E.jsx(ed,{checked:D.st_group,time:D.ts_group,color:"bg-blue-500",onClick:()=>N(D.id,"st_group"),icon:E.jsx(xO,{size:14})}),E.jsx(ed,{checked:D.st_cukcuk,time:D.ts_cukcuk,color:"bg-purple-500",onClick:()=>N(D.id,"st_cukcuk"),icon:E.jsx(eO,{size:14})})]}),E.jsx("div",{className:"pl-6 font-bold text-sm text-gray-100 line-clamp-1 h-full flex items-center",children:D.name}),E.jsx("div",{className:"text-center text-gray-500 text-[10px] font-bold uppercase flex items-center justify-center",children:D.unit}),E.jsx("div",{className:"text-right pr-6 text-blue-400 font-mono font-bold text-lg",children:D.ordered}),E.jsxs("div",{className:"flex items-center justify-end gap-3 px-2 h-full",children:[E.jsx("input",{type:"number",value:D.received,className:"received-input bg-[#111] border border-white/5 rounded-xl w-20 py-2 text-right text-orange-500 font-mono font-bold text-lg outline-none",onChange:_e=>{const Te=e.map(ne=>ne.id===D.id?{...ne,received:_e.target.value}:ne);r(Te)},onBlur:()=>w(e)}),E.jsx("div",{className:`w-14 text-center text-xs font-mono font-black ${V<0?"text-red-500":V>0?"text-green-500":"text-gray-800"}`,children:D.received!==""&&(V===0?"OK":V>0?`+${V}`:V)})]}),E.jsx("input",{type:"text",value:D.note||"",onChange:_e=>{const Te=e.map(ne=>ne.id===D.id?{...ne,note:_e.target.value}:ne);r(Te)},onBlur:()=>w(e),className:"bg-transparent border-b border-transparent outline-none text-gray-600 text-[10px] ml-12 italic h-full flex items-center"}),E.jsx("button",{onClick:()=>w(e.filter(_e=>_e.id!==D.id)),className:"text-gray-800 hover:text-red-500 flex justify-center items-center",children:E.jsx(Bf,{size:16})})]},D.id)})]},M)})})]})]})},ed=({checked:t,time:e,color:r,onClick:n,icon:a})=>E.jsxs("div",{className:"flex flex-col items-center gap-1.5 min-w-[50px] justify-center",children:[E.jsx("button",{onClick:n,className:`w-10 h-10 rounded-2xl border-2 flex items-center justify-center transition-all ${t?`${r} border-transparent text-black shadow-lg scale-105`:"border-[#222] text-gray-700 hover:border-gray-500"}`,children:a}),E.jsx("div",{className:"h-4 flex items-center justify-center text-[7px] font-mono text-gray-500 font-black uppercase",children:t&&e?e:""})]}),td=({label:t,color:e,onClick:r})=>E.jsxs("div",{className:"flex flex-col items-center gap-1.5 cursor-pointer group min-w-[50px] justify-center",onClick:r,children:[E.jsx("span",{className:`${e} font-black`,children:t}),E.jsx("div",{className:"w-5 h-5 rounded-full border border-gray-700 group-hover:bg-orange-500 transition-all flex items-center justify-center",children:E.jsx(iA,{size:12,className:"text-white"})})]});function HH(){const[t,e]=qe.useState("login"),[r,n]=qe.useState("inventory"),[a,o]=qe.useState(null),[l,u]=qe.useState(null),h=()=>{e("dashboard")},d=()=>{e("login"),o(null),u(null),n("inventory")};return E.jsxs("div",{className:"relative w-full min-h-screen bg-[#050505] text-white overflow-hidden font-sans",children:[t==="dashboard"&&E.jsxs("div",{className:"animate-[fade-in-up_0.8s_ease-out] w-full h-full",children:[r==="inventory"&&E.jsx(BH,{username:a,onLogout:d,expiryDate:l}),r==="incoming"&&E.jsx(zH,{username:a})]}),E.jsx(DO,{onComplete:h,onLogoClick:()=>{},onLogout:d,onNavigate:n,currentView:r,isFinished:t==="dashboard",setUsername:o,setExpiryDate:u})]})}pC.createRoot(document.getElementById("root")).render(E.jsx(oC.StrictMode,{children:E.jsx(HH,{})}));
